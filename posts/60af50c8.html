<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>react-pc | 许小墨のBlog</title><meta name="author" content="许小墨,1440023258@qq.com"><meta name="copyright" content="许小墨"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="react-pchttps:&#x2F;&#x2F;www.html.cn&#x2F;create-react-app&#x2F; 1.创建项目12# 现在npx create-react-app admin-react-app --template typescript  熟悉目录结构 123456789101112131415161718- admin-app	-node_modules	-public	-src		App.css"><meta property="og:type" content="article"><meta property="og:title" content="react-pc"><meta property="og:url" content="https://angelxyj.github.io/posts/60af50c8.html"><meta property="og:site_name" content="许小墨のBlog"><meta property="og:description" content="react-pchttps:&#x2F;&#x2F;www.html.cn&#x2F;create-react-app&#x2F; 1.创建项目12# 现在npx create-react-app admin-react-app --template typescript  熟悉目录结构 123456789101112131415161718- admin-app	-node_modules	-public	-src		App.css"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://angelxyj.github.io/img/7.png"><meta property="article:published_time" content="2023-06-18T18:07:34.000Z"><meta property="article:modified_time" content="2024-10-01T16:38:42.729Z"><meta property="article:author" content="许小墨"><meta property="article:tag" content="前端"><meta property="article:tag" content="框架"><meta property="article:tag" content="React"><meta property="article:tag" content="React重制版"><meta property="article:tag" content="react-products"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://angelxyj.github.io/img/7.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://angelxyj.github.io/posts/60af50c8.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/favicon-16x16.png"><link rel="mask-icon" href="/img/siteicon/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"找不到您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!0},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: 许小墨",link:"链接: ",source:"来源: 许小墨のBlog",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体中文",cht_to_chs:"你已切换为简体中文",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!0,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!0},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"react-pc",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-10-01 16:38:42"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)})),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{const e=document.getElementById("loading-box"),d=document.body,o=()=>{d.style.overflow="",e.classList.add("loaded")},t=()=>{d.style.overflow="hidden",e.classList.remove("loaded")};t(),window.addEventListener("load",(()=>{o()})),document.addEventListener("pjax:send",(()=>{t()})),document.addEventListener("pjax:complete",(()=>{o()}))})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/touxiang.webp" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">198</div></a><a href="/%E6%A0%87%E7%AD%BE/"><div class="headline">标签</div><div class="length-num">183</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">42</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>电影</span></a></li><li><a class="site-page child" href="/poems/"><i class="fa-fw fas fa-book"></i> <span>文学鉴赏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-compass"></i> <span>关于</span></a></li><li><a class="site-page child" href="/sponsor/"><i class="fa-fw fas fa-thumbs-up"></i> <span>打赏</span></a></li><li><a class="site-page child" href="/resume/"><i class="fa-fw fas fa-book"></i> <span>简历</span></a></li><li><a class="site-page child" href="/TodoList"><i class="fa-fw fab fa-internet-explorer"></i> <span>计划</span></a></li><li><a class="site-page child" href="/ChatGPT/"><i class="fa-fw fas fa-fan"></i> <span>GPT</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('/img/7.png')"><nav id="nav"><span id="blog-info"><a href="/" title="许小墨のBlog"><span class="site-name">许小墨のBlog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>电影</span></a></li><li><a class="site-page child" href="/poems/"><i class="fa-fw fas fa-book"></i> <span>文学鉴赏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-compass"></i> <span>关于</span></a></li><li><a class="site-page child" href="/sponsor/"><i class="fa-fw fas fa-thumbs-up"></i> <span>打赏</span></a></li><li><a class="site-page child" href="/resume/"><i class="fa-fw fas fa-book"></i> <span>简历</span></a></li><li><a class="site-page child" href="/TodoList"><i class="fa-fw fab fa-internet-explorer"></i> <span>计划</span></a></li><li><a class="site-page child" href="/ChatGPT/"><i class="fa-fw fas fa-fan"></i> <span>GPT</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">react-pc</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-18T18:07:34.000Z" title="发表于 2023-06-18 18:07:34">2023-06-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-01T16:38:42.729Z" title="更新于 2024-10-01 16:38:42">2024-10-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/">前端开发</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/">框架开发</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/React/">React</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/React/React%E9%87%8D%E5%88%B6%E7%89%88/">React重制版</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/React/React%E9%87%8D%E5%88%B6%E7%89%88/react-products/">react-products</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">47.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>260分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="react-pc"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="react-pc"><a href="#react-pc" class="headerlink" title="react-pc"></a>react-pc</h1><p><a target="_blank" rel="noopener" href="https://www.html.cn/create-react-app/">https://www.html.cn/create-react-app/</a></p><h1 id="1-创建项目"><a href="#1-创建项目" class="headerlink" title="1.创建项目"></a>1.创建项目</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 现在</span></span><br><span class="line">npx create-react-app admin-react-app --template typescript</span><br></pre></td></tr></table></figure><p><strong>熟悉目录结构</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">- admin-app</span><br><span class="line">	-node_modules</span><br><span class="line">	-public</span><br><span class="line">	-src</span><br><span class="line">		App.css</span><br><span class="line">		App.test.tsx App.tsx的测试文件  npm run test 查看测试结果</span><br><span class="line">		App.tsx</span><br><span class="line">		index.css</span><br><span class="line">		index.tsx react应用程序的入口文件</span><br><span class="line">		logo.svg </span><br><span class="line">		react-app-env.d.ts // 声明文件 // 指令声明对包的依赖关系</span><br><span class="line">		reportWebVitals.ts // 测试性能</span><br><span class="line">		seupTests.ts // 使用jest做为测试工具</span><br><span class="line">	.gitignore</span><br><span class="line">	package-lock.json</span><br><span class="line">	package.json</span><br><span class="line">	README.md</span><br><span class="line">	tsconfig.json</span><br></pre></td></tr></table></figure><blockquote><p>*.d.ts 代表ts的声明文件</p></blockquote><h1 id="2-改造目录结构"><a href="#2-改造目录结构" class="headerlink" title="2.改造目录结构"></a>2.改造目录结构</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">src</span><br><span class="line">	api</span><br><span class="line">	components</span><br><span class="line">	layout</span><br><span class="line">	store</span><br><span class="line">	router</span><br><span class="line">	utils</span><br><span class="line">	views</span><br><span class="line">	App.tsx</span><br><span class="line">	index.tsx</span><br><span class="line">	logo.svg</span><br><span class="line">	react-app-env.d.ts</span><br><span class="line">	reportWebVitals.ts </span><br><span class="line">  seupTests.ts </span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reportWebVitals <span class="keyword">from</span> <span class="string">&#x27;./reportWebVitals&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(</span><br><span class="line">  <span class="comment">// document.getElementById(&#x27;root&#x27;) as HTMLElement</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLDivElement</span> <span class="comment">// 缩小类型范围</span></span><br><span class="line">);</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/App.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      App</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h1 id="3-安装一些必须的模块"><a href="#3-安装一些必须的模块" class="headerlink" title="3.安装一些必须的模块"></a>3.安装一些必须的模块</h1><h2 id="3-1-配置预处理器"><a href="#3-1-配置预处理器" class="headerlink" title="3.1 配置预处理器"></a>3.1 配置预处理器</h2><p>两种方式：</p><ul><li>抽离配置文件配置预处理器</li><li>不抽离配置文件craco进行预处理器配置</li></ul><blockquote><p>本项目推荐使用第二种方式</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i @craco/craco @types/node -D</span><br></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/@craco/craco">https://www.npmjs.com/package/@craco/craco</a></p><h3 id="3-1-1-配置别名"><a href="#3-1-1-配置别名" class="headerlink" title="3.1.1 配置别名@"></a>3.1.1 配置别名@</h3><p>项目根目录创建 <code>craco.config.js</code>，代码如下：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// craco.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">webpack</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为了使 TS 文件引入时的别名路径能够正常解析，需要配置 <code>tsconifg.json</code>，在 <code>compilerOptions</code>选项里添加 path 等属性。为了防止配置被覆盖，需要单独创建一个文件 <code>tsconfig.path.json</code>，添加以下代码</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsconfig.path.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/*&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;node&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>在 <code>tsconifg.json</code> 引入配置文件：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsconfig.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es5&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;lib&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;dom&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;dom.iterable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;esnext&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;allowJs&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;skipLibCheck&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;esModuleInterop&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;allowSyntheticDefaultImports&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;strict&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;forceConsistentCasingInFileNames&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;noFallthroughCasesInSwitch&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;moduleResolution&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;resolveJsonModule&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;isolatedModules&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;noEmit&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;jsx&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-jsx&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;extends&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./tsconfig.path.json&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;src&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>修改 <code>package.json</code> 如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;craco start&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;craco build&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;craco test&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm run start</span><br></pre></td></tr></table></figure><h2 id="3-2安装状态管理器"><a href="#3-2安装状态管理器" class="headerlink" title="3.2安装状态管理器"></a>3.2安装状态管理器</h2><p>根据项目需求 任选其一即可</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i redux -S</span><br><span class="line">$ cnpm i redux react-redux -S</span><br><span class="line">$ cnpm i redux react-redux redux-thunk -S</span><br><span class="line">$ cnpm i redux react-redux redux-saga -S</span><br><span class="line">$ cnpm i redux react-redux redux-thunk immutable redux-immutable -S</span><br><span class="line">$ cnpm i redux react-redux redux-saga immutable redux-immutable -S</span><br><span class="line">$ cnpm i mobx mobx-react -S</span><br></pre></td></tr></table></figure><blockquote><p>本项目不采用之前的状态管理模式，使用 rtk 技术</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i @reduxjs/toolkit redux react-redux redux-devtools -S</span><br></pre></td></tr></table></figure></blockquote><h2 id="3-3-路由"><a href="#3-3-路由" class="headerlink" title="3.3 路由"></a>3.3 路由</h2><p>2021年11月4日 发布了 react-router-dom的v6.0.0版本：<a target="_blank" rel="noopener" href="https://reactrouter.com/">https://reactrouter.com/</a></p><p>如需使用v5版本：<a target="_blank" rel="noopener" href="https://v5.reactrouter.com/web/guides/quick-start">https://v5.reactrouter.com/web/guides/quick-start</a> <code>cnpm i react-router-dom@5 -S</code></p><blockquote><p>本项目采用 V6版本</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i react-router-dom -S</span><br></pre></td></tr></table></figure><h2 id="3-4-数据验证"><a href="#3-4-数据验证" class="headerlink" title="3.4 数据验证"></a>3.4 数据验证</h2><blockquote><p>思考，有没有必要安装 prop-types ?</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i prop-types -S</span><br></pre></td></tr></table></figure><blockquote><p>本项目其实没有必要安装，因为所有的数据都是基于ts，而ts需要指定类型注解</p></blockquote><h2 id="3-5数据请求"><a href="#3-5数据请求" class="headerlink" title="3.5数据请求"></a>3.5数据请求</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i axios -S</span><br></pre></td></tr></table></figure><blockquote><p>以前版本中 cnpm i @types&#x2F;axios -S</p><p>Ts 中 @types&#x2F;* 为声明文件</p></blockquote><h2 id="3-6ui库"><a href="#3-6ui库" class="headerlink" title="3.6ui库"></a>3.6ui库</h2><p>官网地址：<a target="_blank" rel="noopener" href="https://ant.design/index-cn">https://ant.design/index-cn</a> 4.22.2</p><p>国内官方镜像地址：<a target="_blank" rel="noopener" href="https://ant-design.antgroup.com/index-cn">https://ant-design.antgroup.com/index-cn</a></p><p>国内gitee镜像地址：<a target="_blank" rel="noopener" href="https://ant-design.gitee.io/index-cn">https://ant-design.gitee.io/index-cn</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i antd -S</span><br></pre></td></tr></table></figure><p><code>src/index.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* src/index.css */</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;~antd/dist/antd.css&#x27;</span>;</span><br></pre></td></tr></table></figure><p><code>src/index.tsx</code></p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reportWebVitals <span class="keyword">from</span> <span class="string">&#x27;./reportWebVitals&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLDivElement</span></span><br><span class="line">);</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>测试组件库</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/App.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      App </span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">danger</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Primary</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>浏览器查看发现测试通过</p></blockquote><h3 id="3-6-1-自定义主题"><a href="#3-6-1-自定义主题" class="headerlink" title="3.6.1 自定义主题"></a>3.6.1 自定义主题</h3><p><a target="_blank" rel="noopener" href="https://ant-design.antgroup.com/docs/react/use-in-typescript-cn">https://ant-design.antgroup.com/docs/react/use-in-typescript-cn</a></p><p>按照 <a target="_blank" rel="noopener" href="https://ant-design.antgroup.com/docs/react/customize-theme-cn">配置主题</a> 的要求，自定义主题需要用到类似 <a target="_blank" rel="noopener" href="https://github.com/webpack-contrib/less-loader/">less-loader</a> 提供的 less 变量覆盖功能。我们可以引入 <a target="_blank" rel="noopener" href="https://github.com/DocSpring/craco-antd">craco-antd</a> 或者是 <code>craco-less</code>来帮助加载 less 样式和修改变量。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i craco-antd -D</span><br><span class="line">$ cnpm i craco-less -D</span><br></pre></td></tr></table></figure><p>首先把 <code>src/index.css</code> 文件修改为 <code>src/index.less</code>，然后修改样式引用为 less 文件。</p><p>修改 <code>craco.config.js</code>如下：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// craco.config.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CracoAntDesignPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;craco-antd&#x27;</span>); <span class="comment">// 推荐ts中写法</span></span><br><span class="line"><span class="comment">// const CracoLessPlugin = require(&#x27;craco-less&#x27;); // js以及ts写法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">webpack</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">plugin</span>: <span class="title class_">CracoAntDesignPlugin</span>,</span><br><span class="line">      <span class="attr">options</span>: &#123;</span><br><span class="line">        <span class="attr">customizeTheme</span>: &#123;</span><br><span class="line">          <span class="string">&#x27;@primary-color&#x27;</span>: <span class="string">&#x27;#1DA57A&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ]</span><br><span class="line">  <span class="comment">// plugins: [</span></span><br><span class="line">  <span class="comment">//   &#123;</span></span><br><span class="line">  <span class="comment">//     plugin: CracoLessPlugin,</span></span><br><span class="line">  <span class="comment">//     options: &#123;</span></span><br><span class="line">  <span class="comment">//       lessLoaderOptions: &#123;</span></span><br><span class="line">  <span class="comment">//         lessOptions: &#123;</span></span><br><span class="line">  <span class="comment">//           modifyVars: &#123; &#x27;@primary-color&#x27;: &#x27;#1DA57A&#x27; &#125;,</span></span><br><span class="line">  <span class="comment">//           javascriptEnabled: true,</span></span><br><span class="line">  <span class="comment">//         &#125;,</span></span><br><span class="line">  <span class="comment">//       &#125;,</span></span><br><span class="line">  <span class="comment">//     &#125;,</span></span><br><span class="line">  <span class="comment">//   &#125;,</span></span><br><span class="line">  <span class="comment">// ],</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这里利用了 <a target="_blank" rel="noopener" href="https://github.com/webpack/less-loader#less-options">less-loader</a> 的 <code>modifyVars</code> 来进行主题配置，变量和其他配置方式可以参考 <a target="_blank" rel="noopener" href="https://ant-design.antgroup.com/docs/react/customize-theme-cn">配置主题</a> 文档。修改后重启 <code>yarn start</code>，如果看到一个绿色的按钮就说明配置成功了。</p><p>antd 内建了深色主题和紧凑主题，你可以参照 <a target="_blank" rel="noopener" href="https://ant-design.antgroup.com/docs/react/customize-theme-cn#%E4%BD%BF%E7%94%A8%E6%9A%97%E8%89%B2%E4%B8%BB%E9%A2%98%E5%92%8C%E7%B4%A7%E5%87%91%E4%B8%BB%E9%A2%98">使用暗色主题和紧凑主题</a> 进行接入。</p><p>可以定制的变量列表如下：</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@primary-color</span>: <span class="number">#1890ff</span>; <span class="comment">// 全局主色</span></span><br><span class="line"><span class="keyword">@link-color</span>: <span class="number">#1890ff</span>; <span class="comment">// 链接色</span></span><br><span class="line"><span class="keyword">@success-color</span>: <span class="number">#52c41a</span>; <span class="comment">// 成功色</span></span><br><span class="line"><span class="keyword">@warning-color</span>: <span class="number">#faad14</span>; <span class="comment">// 警告色</span></span><br><span class="line"><span class="keyword">@error-color</span>: <span class="number">#f5222d</span>; <span class="comment">// 错误色</span></span><br><span class="line"><span class="keyword">@font-size-base</span>: <span class="number">14px</span>; <span class="comment">// 主字号</span></span><br><span class="line"><span class="keyword">@heading-color</span>: rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.85</span>); <span class="comment">// 标题色</span></span><br><span class="line"><span class="keyword">@text-color</span>: rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.65</span>); <span class="comment">// 主文本色</span></span><br><span class="line"><span class="keyword">@text-color-secondary</span>: rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.45</span>); <span class="comment">// 次文本色</span></span><br><span class="line"><span class="keyword">@disabled-color</span>: rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.25</span>); <span class="comment">// 失效色</span></span><br><span class="line"><span class="keyword">@border-radius-base</span>: <span class="number">2px</span>; <span class="comment">// 组件/浮层圆角</span></span><br><span class="line"><span class="keyword">@border-color-base</span>: <span class="number">#d9d9d9</span>; <span class="comment">// 边框色</span></span><br><span class="line"><span class="keyword">@box-shadow-base</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">6px</span> -<span class="number">4px</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.12</span>), <span class="number">0</span> <span class="number">6px</span> <span class="number">16px</span> <span class="number">0</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.08</span>),</span><br><span class="line">  <span class="number">0</span> <span class="number">9px</span> <span class="number">28px</span> <span class="number">8px</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.05</span>); <span class="comment">// 浮层阴影</span></span><br></pre></td></tr></table></figure><p>完整的配置如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// craco.config.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">CracoAntDesignPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;craco-antd&#x27;</span>); <span class="comment">// 推荐ts中写法</span></span><br><span class="line"><span class="comment">// const CracoLessPlugin = require(&#x27;craco-less&#x27;); // js以及ts写法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">webpack</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">plugin</span>: <span class="title class_">CracoAntDesignPlugin</span>,</span><br><span class="line">      <span class="attr">options</span>: &#123;</span><br><span class="line">        <span class="attr">customizeTheme</span>: &#123;</span><br><span class="line">          <span class="string">&#x27;@primary-color&#x27;</span>: <span class="string">&#x27;#1890ff&#x27;</span>, <span class="comment">// 全局主色</span></span><br><span class="line">          <span class="string">&#x27;@link-color&#x27;</span>: <span class="string">&#x27;#1890ff&#x27;</span>, <span class="comment">// 链接色</span></span><br><span class="line">          <span class="string">&#x27;@success-color&#x27;</span>: <span class="string">&#x27;#52c41a&#x27;</span>, <span class="comment">// 成功色</span></span><br><span class="line">          <span class="string">&#x27;@warning-color&#x27;</span>: <span class="string">&#x27;#faad14&#x27;</span>, <span class="comment">// 警告色</span></span><br><span class="line">          <span class="string">&#x27;@error-color&#x27;</span>: <span class="string">&#x27;#f5222d&#x27;</span>, <span class="comment">// 错误色</span></span><br><span class="line">          <span class="string">&#x27;@font-size-base&#x27;</span>: <span class="string">&#x27;14px&#x27;</span>, <span class="comment">// 主字号</span></span><br><span class="line">          <span class="string">&#x27;@heading-color&#x27;</span>: <span class="string">&#x27;rgba(0, 0, 0, 0.85)&#x27;</span>, <span class="comment">// 标题色</span></span><br><span class="line">          <span class="string">&#x27;@text-color&#x27;</span>: <span class="string">&#x27;rgba(0, 0, 0, 0.65)&#x27;</span>, <span class="comment">// 主文本色</span></span><br><span class="line">          <span class="string">&#x27;@text-color-secondary&#x27;</span>: <span class="string">&#x27;rgba(0, 0, 0, 0.45)&#x27;</span>, <span class="comment">// 次文本色</span></span><br><span class="line">          <span class="string">&#x27;@disabled-color&#x27;</span>: <span class="string">&#x27;rgba(0, 0, 0, 0.25)&#x27;</span>, <span class="comment">// 失效色</span></span><br><span class="line">          <span class="string">&#x27;@border-radius-base&#x27;</span>: <span class="string">&#x27;2px&#x27;</span>, <span class="comment">// 组件/浮层圆角</span></span><br><span class="line">          <span class="string">&#x27;@border-color-base&#x27;</span>: <span class="string">&#x27;#d9d9d9&#x27;</span>, <span class="comment">// 边框色</span></span><br><span class="line">          <span class="string">&#x27;@box-shadow-base&#x27;</span>: <span class="string">&#x27;0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)&#x27;</span> <span class="comment">// 浮层阴影</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ]</span><br><span class="line">  <span class="comment">// plugins: [</span></span><br><span class="line">  <span class="comment">//   &#123;</span></span><br><span class="line">  <span class="comment">//     plugin: CracoLessPlugin,</span></span><br><span class="line">  <span class="comment">//     options: &#123;</span></span><br><span class="line">  <span class="comment">//       lessLoaderOptions: &#123;</span></span><br><span class="line">  <span class="comment">//         lessOptions: &#123;</span></span><br><span class="line">  <span class="comment">//           modifyVars: &#123; &#x27;@primary-color&#x27;: &#x27;#1DA57A&#x27; &#125;,</span></span><br><span class="line">  <span class="comment">//           javascriptEnabled: true,</span></span><br><span class="line">  <span class="comment">//         &#125;,</span></span><br><span class="line">  <span class="comment">//       &#125;,</span></span><br><span class="line">  <span class="comment">//     &#125;,</span></span><br><span class="line">  <span class="comment">//   &#125;,</span></span><br><span class="line">  <span class="comment">// ],</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>同样，你可以使用 <a target="_blank" rel="noopener" href="https://github.com/timarney/react-app-rewired">react-app-rewired</a> 和 <a target="_blank" rel="noopener" href="https://github.com/arackaf/customize-cra">customize-cra</a> 来自定义 create-react-app 的 webpack 配置。</p></blockquote><h2 id="3-7其他第三方工具包"><a href="#3-7其他第三方工具包" class="headerlink" title="3.7其他第三方工具包"></a>3.7其他第三方工具包</h2><p><a target="_blank" rel="noopener" href="https://www.lodashjs.com/">https://www.lodashjs.com/</a></p><p>Lodash 工具包，项目必装，它提供了很多使用的函数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i lodash -S</span><br><span class="line">$ cnpm i @types/lodash -D</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> users = [</span><br><span class="line">  &#123; <span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;barney&#x27;</span>,  <span class="string">&#x27;active&#x27;</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">  &#123; <span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;fred&#x27;</span>,    <span class="string">&#x27;active&#x27;</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">  &#123; <span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;pebbles&#x27;</span>, <span class="string">&#x27;active&#x27;</span>: <span class="literal">true</span> &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(_.<span class="title function_">findIndex</span>(users, <span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">user</span> === <span class="string">&#x27;pebbles&#x27;</span>))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(users.<span class="title function_">findIndex</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">user</span> === <span class="string">&#x27;pebbles&#x27;</span>))</span><br></pre></td></tr></table></figure><h1 id="4-创建主布局文件"><a href="#4-创建主布局文件" class="headerlink" title="4.创建主布局文件"></a>4.创建主布局文件</h1><p>预览模板：<a target="_blank" rel="noopener" href="https://pro.ant.design/zh-CN/">https://pro.ant.design/zh-CN/</a></p><blockquote><p>src&#x2F;layout&#x2F;Index.tsx 作为后台管理系统的主页面布局(包含左侧的菜单栏，顶部，底部等)</p></blockquote><p><a target="_blank" rel="noopener" href="https://ant-design.gitee.io/components/layout-cn/#components-layout-demo-custom-trigger">https://ant-design.gitee.io/components/layout-cn/#components-layout-demo-custom-trigger</a></p><blockquote><p>不要照着代码敲，直接复制即可，给 Layout 组件添加 id为<code>admin-app</code></p></blockquote><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/Index.tsx 主要的布局文件</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">MenuFoldOutlined</span>,</span><br><span class="line">  <span class="title class_">MenuUnfoldOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">VideoCameraOutlined</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Header</span>, <span class="title class_">Sider</span>, <span class="title class_">Content</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [collapsed, setCollapsed] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span> <span class="attr">id</span>=<span class="string">&#x27;admin-app&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">items</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">key:</span> &#x27;<span class="attr">1</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">icon:</span> &lt;<span class="attr">UserOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">              label: &#x27;nav 1&#x27;,</span></span><br><span class="line"><span class="language-xml">            &#125;,</span></span><br><span class="line"><span class="language-xml">            &#123;</span></span><br><span class="line"><span class="language-xml">              key: &#x27;2&#x27;,</span></span><br><span class="line"><span class="language-xml">              icon: <span class="tag">&lt;<span class="name">VideoCameraOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">              label: &#x27;nav 2&#x27;,</span></span><br><span class="line"><span class="language-xml">            &#125;,</span></span><br><span class="line"><span class="language-xml">            &#123;</span></span><br><span class="line"><span class="language-xml">              key: &#x27;3&#x27;,</span></span><br><span class="line"><span class="language-xml">              icon: <span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">              label: &#x27;nav 3&#x27;,</span></span><br><span class="line"><span class="language-xml">            &#125;,</span></span><br><span class="line"><span class="language-xml">          ]&#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Layout</span> <span class="attr">className</span>=<span class="string">&quot;site-layout&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Header</span> <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> <span class="attr">0</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;React.createElement(collapsed ? MenuUnfoldOutlined : MenuFoldOutlined, &#123;</span></span><br><span class="line"><span class="language-xml">            className: &#x27;trigger&#x27;,</span></span><br><span class="line"><span class="language-xml">            onClick: () =&gt; setCollapsed(!collapsed),</span></span><br><span class="line"><span class="language-xml">          &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Content</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">margin:</span> &#x27;<span class="attr">24px</span> <span class="attr">16px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">padding:</span> <span class="attr">24</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">minHeight:</span> <span class="attr">280</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          Content</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Content</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>主组件引入 主界面的布局文件</p></blockquote><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/App.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Index</span> <span class="keyword">from</span> <span class="string">&#x27;./layout/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">AppProps</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="variable constant_">FC</span> = <span class="function">(<span class="params">props: AppProps</span>) =&gt;</span> (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Index</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure><blockquote><p>查看浏览器，预览运行结果</p></blockquote><blockquote><p>发现页面并不是全屏。审查元素设置 root以及 components-layout-demo-custom-trigger 高度为 100%</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* src/index.css */</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&#x27;~antd/dist/antd.less&#x27;</span>;</span><br><span class="line"></span><br><span class="line">// 设置全屏  --- 审查元素 一层一层找 坚决不放过任何一个遗漏的</span><br><span class="line"><span class="selector-tag">html</span>, <span class="selector-tag">body</span>, <span class="selector-id">#root</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#admin-app</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line">// 布局文件</span><br><span class="line">// <span class="selector-id">#components-layout-demo-custom-trigger</span> <span class="selector-class">.trigger</span> &#123;  // 组件库提供案例id，改成自己的</span><br><span class="line"><span class="selector-id">#admin-app</span> <span class="selector-class">.trigger</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">64px</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">transition</span>: color <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line">// <span class="selector-id">#components-layout-demo-custom-trigger</span> <span class="selector-class">.trigger</span><span class="selector-pseudo">:hover</span> </span><br><span class="line"><span class="selector-id">#admin-app</span> <span class="selector-class">.trigger</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#1890ff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// <span class="selector-id">#components-layout-demo-custom-trigger</span> <span class="selector-class">.logo</span> &#123;</span><br><span class="line"><span class="selector-id">#admin-app</span> <span class="selector-class">.logo</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">32px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.site-layout</span> <span class="selector-class">.site-layout-background</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="5-拆分主界面"><a href="#5-拆分主界面" class="headerlink" title="5.拆分主界面"></a>5.拆分主界面</h1><blockquote><p>先拆分左侧的菜单栏组件</p></blockquote><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">VideoCameraOutlined</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [collapsed] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">items</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">key:</span> &#x27;<span class="attr">1</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">icon:</span> &lt;<span class="attr">UserOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">            label: &#x27;nav 1&#x27;,</span></span><br><span class="line"><span class="language-xml">          &#125;,</span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            key: &#x27;2&#x27;,</span></span><br><span class="line"><span class="language-xml">            icon: <span class="tag">&lt;<span class="name">VideoCameraOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">            label: &#x27;nav 2&#x27;,</span></span><br><span class="line"><span class="language-xml">          &#125;,</span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            key: &#x27;3&#x27;,</span></span><br><span class="line"><span class="language-xml">            icon: <span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">            label: &#x27;nav 3&#x27;,</span></span><br><span class="line"><span class="language-xml">          &#125;,</span></span><br><span class="line"><span class="language-xml">        ]&#125;</span></span><br><span class="line"><span class="language-xml">      /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppHeader.tsx 头部组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">MenuFoldOutlined</span>,</span><br><span class="line">  <span class="title class_">MenuUnfoldOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Header</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppHeaderProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppHeader</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppHeaderProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [collapsed, setCollapsed] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Header</span> <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> <span class="attr">0</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;React.createElement(collapsed ? MenuUnfoldOutlined : MenuFoldOutlined, &#123;</span></span><br><span class="line"><span class="language-xml">        className: &#x27;trigger&#x27;,</span></span><br><span class="line"><span class="language-xml">        onClick: () =&gt; setCollapsed(!collapsed),</span></span><br><span class="line"><span class="language-xml">      &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppHeader</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppMain.tsx 内容区域</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppMainProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Content</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppMain</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppMainProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Content</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">margin:</span> &#x27;<span class="attr">24px</span> <span class="attr">16px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">padding:</span> <span class="attr">24</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">minHeight:</span> <span class="attr">280</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      Content</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Content</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppMain</span>;</span><br></pre></td></tr></table></figure><p>整和组件资源</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/index.ts</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">SideBar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./SideBar&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">AppHeader</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AppHeader&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">AppMain</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AppMain&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/Index.tsx 主要的布局文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>  <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppHeader</span>, <span class="title class_">AppMain</span>, <span class="title class_">SideBar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./components&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span> <span class="attr">id</span>=<span class="string">&#x27;admin-app&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* 左侧菜单栏 */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">SideBar</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Layout</span> <span class="attr">className</span>=<span class="string">&quot;site-layout&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 头部 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">AppHeader</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 内容 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">AppMain</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>此时点击头部的控制器，发现只有头部组件的 图标在切换，但是并没有影响左侧菜单的收缩</p><p>建议使用状态管理器管理控制的这个状态</p></blockquote><h1 id="6-使用rtk来管理状态"><a href="#6-使用rtk来管理状态" class="headerlink" title="6.使用rtk来管理状态"></a>6.使用rtk来管理状态</h1><p><a target="_blank" rel="noopener" href="http://cn.redux.js.org/">http://cn.redux.js.org/</a></p><p>参考链接：<a target="_blank" rel="noopener" href="http://cn.redux.js.org/tutorials/typescript-quick-start">http://cn.redux.js.org/tutorials/typescript-quick-start</a></p><h2 id="6-1-定义State和Dispatch类型"><a href="#6-1-定义State和Dispatch类型" class="headerlink" title="6.1 定义State和Dispatch类型"></a>6.1 定义State和Dispatch类型</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123; <span class="comment">// 整合模块</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// redux store  store.getState  store.subscribe  store.dispatch</span></span><br><span class="line"><span class="comment">// 定义State和dispatch类型  从 store 本身推断出 `RootState` 和 `AppDispatch` 类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">RootState</span> = <span class="title class_">ReturnType</span>&lt;<span class="keyword">typeof</span> store.<span class="property">getState</span>&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">AppDispatch</span> = <span class="keyword">typeof</span> store.<span class="property">dispatch</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure><blockquote><p>构建app的模块用于管理 头部和 左侧菜单的共同的状态</p></blockquote><h2 id="6-2-定义-Hooks-类型"><a href="#6-2-定义-Hooks-类型" class="headerlink" title="6.2 定义 Hooks 类型"></a>6.2 定义 Hooks 类型</h2><p>虽然可以将<code>RootState</code>and<code>AppDispatch</code>类型导入到每个组件中，但<strong>最好创建<code>useDispatch</code>and <code>useSelector</code>hooks 的类型化版本以在您的应用程序中使用</strong>。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/store/hook.ts 自定义useSelector 以及 useDispatch 避免后续组件使用时需要单独引入每一次 js不需要</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSelector, useDispatch, <span class="title class_">TypedUseSelectorHook</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppDispatch</span>, <span class="title class_">RootState</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在整个应用程序中使用，而不是简单的 `useDispatch` 和 `useSelector`</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">useAppDispatch</span>: <span class="function">() =&gt;</span> <span class="title class_">AppDispatch</span> = useDispatch <span class="comment">// () =&gt; AppDispatch 代表返回的是一个函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">useAppSelector</span>: <span class="title class_">TypedUseSelectorHook</span>&lt;<span class="title class_">RootState</span>&gt; = useSelector <span class="comment">// TypedUseSelectorHook&lt;RootState&gt; 类型注解</span></span><br><span class="line"><span class="comment">// 以后组件中不要再单独使用 useSelector, useDispatch，使用useAppSelector 以及useAppDispatch 代替</span></span><br></pre></td></tr></table></figure><h2 id="6-3-应用程序中使用"><a href="#6-3-应用程序中使用" class="headerlink" title="6.3 应用程序中使用"></a>6.3 应用程序中使用</h2><blockquote><p>创建状态管理</p></blockquote><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/store/modules/app.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice, <span class="title class_">PayloadAction</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span> <span class="comment">// PayloadAction 添加类型注解需要 js中不需要</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IState</span> &#123; <span class="comment">// js不需要</span></span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">collapsed</span>: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">initialState</span>: <span class="title class_">IState</span> = &#123; <span class="comment">// IState js不要</span></span><br><span class="line">  <span class="attr">count</span>: <span class="number">100</span>,</span><br><span class="line">  <span class="attr">collapsed</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 固定写法,定义模块，无法直接被使用，需要暴露相关的内容</span></span><br><span class="line"><span class="keyword">const</span> appSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;app&#x27;</span>, <span class="comment">// 模块名称</span></span><br><span class="line">  initialState, <span class="comment">// 初始化状态</span></span><br><span class="line">  <span class="attr">reducers</span>: &#123; <span class="comment">// 修改状态的方法</span></span><br><span class="line">    addCount (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">number</span>&gt;) &#123;</span><br><span class="line">     state.<span class="property">count</span> += action.<span class="property">payload</span> </span><br><span class="line">    &#125;,</span><br><span class="line">    setCollapsed (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">boolean</span>&gt;) &#123; <span class="comment">// js不需要</span></span><br><span class="line">      <span class="comment">// 修改状态</span></span><br><span class="line">      state.<span class="property">collapsed</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(appSlice)</span></span><br><span class="line"><span class="comment">// appSlice &#123; reducer: &#x27;需要的状态&#x27;, actions: &#x27;改变状态函数&#x27;, caseReducers: &#x27;类似actions&#x27;, getInitialState: &#x27;获取初始化状态&#x27;, name: &#x27;模块名称&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 暴露后续组件中可以修改状态的函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; addCount, setCollapsed &#125; = appSlice.<span class="property">actions</span> <span class="comment">// appSlice.actions 实际上就是 上面模块 reducers内的函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认暴露出去 模块的reducer</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> appSlice.<span class="property">reducer</span></span><br></pre></td></tr></table></figure><h2 id="6-4-整合reducer"><a href="#6-4-整合reducer" class="headerlink" title="6.4 整合reducer"></a>6.4 整合reducer</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> appReducer <span class="keyword">from</span> <span class="string">&#x27;./modules/app&#x27;</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123; <span class="comment">// 整合模块</span></span><br><span class="line">    <span class="attr">app</span>: appReducer</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// redux store  store.getState  store.subscribe  store.dispatch</span></span><br><span class="line"><span class="comment">// 定义State和dispatch类型  从 store 本身推断出 `RootState` 和 `AppDispatch` 类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">RootState</span> = <span class="title class_">ReturnType</span>&lt;<span class="keyword">typeof</span> store.<span class="property">getState</span>&gt; <span class="comment">// js 不需要</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">AppDispatch</span> = <span class="keyword">typeof</span> store.<span class="property">dispatch</span> <span class="comment">// js 不需要</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure><h2 id="6-5-入口文件配置状态管理器"><a href="#6-5-入口文件配置状态管理器" class="headerlink" title="6.5 入口文件配置状态管理器"></a>6.5 入口文件配置状态管理器</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@/index.less&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;@/App&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reportWebVitals <span class="keyword">from</span> <span class="string">&#x27;@/reportWebVitals&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLDivElement</span></span><br><span class="line">);</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span> = <span class="string">&#123;</span> <span class="attr">store</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="6-6-左侧菜单栏使用状态管理器"><a href="#6-6-左侧菜单栏使用状态管理器" class="headerlink" title="6.6 左侧菜单栏使用状态管理器"></a>6.6 左侧菜单栏使用状态管理器</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">VideoCameraOutlined</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="comment">// import &#123; useSelector &#125; from &#x27;react-redux&#x27;;</span></span><br><span class="line"><span class="comment">// import &#123; RootState &#125; from &#x27;@/store&#x27;;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// const [collapsed] = useState(false);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// const collapsed = useSelector(state =&gt; state.app.collapsed); // js中的写法</span></span><br><span class="line">  <span class="comment">// const collapsed = useSelector((state: RootState) =&gt; state.app.collapsed); // ts中的写法,组件引入类型，冗余度会高</span></span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>); <span class="comment">// ts推荐写法</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">items</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">key:</span> &#x27;<span class="attr">1</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">icon:</span> &lt;<span class="attr">UserOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">            label: &#x27;nav 1&#x27;,</span></span><br><span class="line"><span class="language-xml">          &#125;,</span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            key: &#x27;2&#x27;,</span></span><br><span class="line"><span class="language-xml">            icon: <span class="tag">&lt;<span class="name">VideoCameraOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">            label: &#x27;nav 2&#x27;,</span></span><br><span class="line"><span class="language-xml">          &#125;,</span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            key: &#x27;3&#x27;,</span></span><br><span class="line"><span class="language-xml">            icon: <span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">            label: &#x27;nav 3&#x27;,</span></span><br><span class="line"><span class="language-xml">          &#125;,</span></span><br><span class="line"><span class="language-xml">        ]&#125;</span></span><br><span class="line"><span class="language-xml">      /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><h2 id="6-7-头部组件使用状态管理器"><a href="#6-7-头部组件使用状态管理器" class="headerlink" title="6.7 头部组件使用状态管理器"></a>6.7 头部组件使用状态管理器</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppHeader.tsx 头部组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">MenuFoldOutlined</span>,</span><br><span class="line">  <span class="title class_">MenuUnfoldOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppDispatch, useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setCollapsed &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/modules/app&#x27;</span></span><br><span class="line"><span class="comment">// import &#123; useDispatch &#125; from &#x27;react-redux&#x27;;</span></span><br><span class="line"><span class="comment">// import &#123; AppDispatch &#125; from &#x27;@/store&#x27;;</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Header</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppHeaderProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppHeader</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppHeaderProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// const [collapsed, setCollapsed] = useState(false);</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// const dispatch: AppDispatch = useDispatch() // ts中添加类型注解</span></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useAppDispatch</span>() <span class="comment">// ts推荐写法</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Header</span> <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> <span class="attr">0</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* &#123;React.createElement(collapsed ? MenuUnfoldOutlined : MenuFoldOutlined, &#123;</span></span><br><span class="line"><span class="language-xml">        className: &#x27;trigger&#x27;,</span></span><br><span class="line"><span class="language-xml">        onClick: () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      &#125;)&#125; */&#125;</span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        collapsed ? <span class="tag">&lt;<span class="name">MenuUnfoldOutlined</span>  <span class="attr">className</span>=<span class="string">&quot;trigger&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;/&gt; : <span class="tag">&lt;<span class="name">MenuFoldOutlined</span>  <span class="attr">className</span>=<span class="string">&quot;trigger&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppHeader</span>;</span><br></pre></td></tr></table></figure><h2 id="6-8保留用户习惯-可选"><a href="#6-8保留用户习惯-可选" class="headerlink" title="6.8保留用户习惯-可选"></a>6.8保留用户习惯-可选</h2><p>永久存储 用户习惯</p><p>此时发现 头部的 按钮可以控制左侧菜单栏了，但是还没有满足需求</p><p>需求如下：保留用户的使用习惯</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/store/modules/app.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice, <span class="title class_">PayloadAction</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span> <span class="comment">// PayloadAction 添加类型注解需要 js中不需要</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IState</span> &#123; <span class="comment">// js不需要</span></span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">collapsed</span>: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">initialState</span>: <span class="title class_">IState</span> = &#123; <span class="comment">// IState js不要</span></span><br><span class="line">  <span class="attr">count</span>: <span class="number">100</span>,</span><br><span class="line">  <span class="comment">// collapsed: false // 每次一样</span></span><br><span class="line">  <span class="attr">collapsed</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;collapsed&#x27;</span>) === <span class="string">&#x27;true&#x27;</span> <span class="comment">// 保留用户的使用习惯</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 固定写法,定义模块，无法直接被使用，需要暴露相关的内容</span></span><br><span class="line"><span class="keyword">const</span> appSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;app&#x27;</span>, <span class="comment">// 模块名称</span></span><br><span class="line">  initialState, <span class="comment">// 初始化状态</span></span><br><span class="line">  <span class="attr">reducers</span>: &#123; <span class="comment">// 修改状态的方法</span></span><br><span class="line">    addCount (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">number</span>&gt;) &#123;</span><br><span class="line">     state.<span class="property">count</span> += action.<span class="property">payload</span> </span><br><span class="line">    &#125;,</span><br><span class="line">    setCollapsed (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">boolean</span>&gt;) &#123; <span class="comment">// js不需要</span></span><br><span class="line">      <span class="comment">// 修改状态</span></span><br><span class="line">      <span class="comment">// 保存到本地</span></span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;collapsed&#x27;</span>, <span class="title class_">String</span>(action.<span class="property">payload</span>)) <span class="comment">// 保留用户的使用习惯</span></span><br><span class="line">      state.<span class="property">collapsed</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(appSlice)</span></span><br><span class="line"><span class="comment">// appSlice &#123; reducer: &#x27;需要的状态&#x27;, actions: &#x27;改变状态函数&#x27;, caseReducers: &#x27;类似actions&#x27;, getInitialState: &#x27;获取初始化状态&#x27;, name: &#x27;模块名称&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 暴露后续组件中可以修改状态的函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; addCount, setCollapsed &#125; = appSlice.<span class="property">actions</span> <span class="comment">// appSlice.actions 实际上就是 上面模块 reducers内的函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认暴露出去 模块的reducer</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> appSlice.<span class="property">reducer</span></span><br></pre></td></tr></table></figure><h2 id="6-9-永久存储的-类-localStorage-的工具-store2"><a href="#6-9-永久存储的-类-localStorage-的工具-store2" class="headerlink" title="6.9 永久存储的 类 localStorage 的工具 store2"></a>6.9 永久存储的 类 localStorage 的工具 store2</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i store2 -S</span><br></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/store2">https://www.npmjs.com/package/store2</a></p><p>推荐一个好用的永久存储的 类 localStorage 的工具 store2</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/store/modules/app.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice, <span class="title class_">PayloadAction</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span> <span class="comment">// PayloadAction 添加类型注解需要 js中不需要</span></span><br><span class="line"><span class="keyword">import</span> store2 <span class="keyword">from</span> <span class="string">&#x27;store2&#x27;</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IState</span> &#123; <span class="comment">// js不需要</span></span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">collapsed</span>: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">initialState</span>: <span class="title class_">IState</span> = &#123; <span class="comment">// IState js不要</span></span><br><span class="line">  <span class="attr">count</span>: <span class="number">100</span>,</span><br><span class="line">  <span class="comment">// collapsed: false // 每次一样</span></span><br><span class="line">  <span class="comment">// collapsed: localStorage.getItem(&#x27;collapsed&#x27;) === &#x27;true&#x27; // 保留用户的使用习惯</span></span><br><span class="line">  <span class="attr">collapsed</span>: store2.<span class="title function_">get</span>(<span class="string">&#x27;collapsed&#x27;</span>) === <span class="string">&#x27;true&#x27;</span> <span class="comment">// 保留用户的使用习惯</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 固定写法,定义模块，无法直接被使用，需要暴露相关的内容</span></span><br><span class="line"><span class="keyword">const</span> appSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;app&#x27;</span>, <span class="comment">// 模块名称</span></span><br><span class="line">  initialState, <span class="comment">// 初始化状态</span></span><br><span class="line">  <span class="attr">reducers</span>: &#123; <span class="comment">// 修改状态的方法</span></span><br><span class="line">    addCount (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">number</span>&gt;) &#123;</span><br><span class="line">     state.<span class="property">count</span> += action.<span class="property">payload</span> </span><br><span class="line">    &#125;,</span><br><span class="line">    setCollapsed (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">boolean</span>&gt;) &#123; <span class="comment">// js不需要</span></span><br><span class="line">      <span class="comment">// 修改状态</span></span><br><span class="line">      <span class="comment">// 保存到本地</span></span><br><span class="line">      <span class="comment">// localStorage.setItem(&#x27;collapsed&#x27;, String(action.payload)) // 保留用户的使用习惯</span></span><br><span class="line">      store2.<span class="title function_">set</span>(<span class="string">&#x27;collapsed&#x27;</span>, <span class="title class_">String</span>(action.<span class="property">payload</span>))</span><br><span class="line">      state.<span class="property">collapsed</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(appSlice)</span></span><br><span class="line"><span class="comment">// appSlice &#123; reducer: &#x27;需要的状态&#x27;, actions: &#x27;改变状态函数&#x27;, caseReducers: &#x27;类似actions&#x27;, getInitialState: &#x27;获取初始化状态&#x27;, name: &#x27;模块名称&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 暴露后续组件中可以修改状态的函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; addCount, setCollapsed &#125; = appSlice.<span class="property">actions</span> <span class="comment">// appSlice.actions 实际上就是 上面模块 reducers内的函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认暴露出去 模块的reducer</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> appSlice.<span class="property">reducer</span></span><br></pre></td></tr></table></figure><h1 id="7-左侧菜单栏"><a href="#7-左侧菜单栏" class="headerlink" title="7.左侧菜单栏"></a>7.左侧菜单栏</h1><h2 id="7-1-设计左侧菜单栏的数据"><a href="#7-1-设计左侧菜单栏的数据" class="headerlink" title="7.1.设计左侧菜单栏的数据"></a>7.1.设计左侧菜单栏的数据</h2><p><a target="_blank" rel="noopener" href="https://ant-design.gitee.io/components/menu-cn/#components-menu-demo-sider-current">https://ant-design.gitee.io/components/menu-cn/#components-menu-demo-sider-current</a></p><blockquote><p>Antd 4.20以上版本直接实现 递归</p><p>antd 4.20版本以下需要手动实现</p></blockquote><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/inter.d.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ReactNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// key属性可以使用 左侧菜单的路由地址，因为它具有唯一性</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IMenuProps</span> &#123;</span><br><span class="line">  <span class="attr">label</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">key</span>: <span class="built_in">string</span></span><br><span class="line">  icon?: <span class="title class_">ReactNode</span></span><br><span class="line">  children?: <span class="title class_">IMenuProps</span>[]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/menu.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">PictureOutlined</span>,</span><br><span class="line">  <span class="title class_">ProfileOutlined</span>,</span><br><span class="line">  <span class="title class_">OrderedListOutlined</span>,</span><br><span class="line">  <span class="title class_">FilterOutlined</span>,</span><br><span class="line">  <span class="title class_">TeamOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// &#123;</span></span><br><span class="line">  <span class="comment">//   label: &#x27;轮播图管理&#x27;,</span></span><br><span class="line">  <span class="comment">//   key: &#x27;/banner&#x27;,</span></span><br><span class="line">  <span class="comment">//   icon: &lt;UploadOutlined /&gt;,</span></span><br><span class="line">  <span class="comment">//   children: [</span></span><br><span class="line">  <span class="comment">//     &#123;</span></span><br><span class="line">  <span class="comment">//       label: &#x27;首页轮播图&#x27;,</span></span><br><span class="line">  <span class="comment">//       key: &#x27;/banner/home&#x27;,</span></span><br><span class="line">  <span class="comment">//       icon: &lt;PictureOutlined /&gt;,</span></span><br><span class="line">  <span class="comment">//       children: [</span></span><br><span class="line">  <span class="comment">//         &#123;</span></span><br><span class="line">  <span class="comment">//           label: &#x27;轮播图列表&#x27;,</span></span><br><span class="line">  <span class="comment">//           key: &#x27;/banner/home/list&#x27;,</span></span><br><span class="line">  <span class="comment">//           icon: &lt;PictureOutlined /&gt;</span></span><br><span class="line">  <span class="comment">//         &#125;,</span></span><br><span class="line">  <span class="comment">//         &#123;</span></span><br><span class="line">  <span class="comment">//           label: &#x27;添加轮播图&#x27;,</span></span><br><span class="line">  <span class="comment">//           key: &#x27;/banner/home/add&#x27;,</span></span><br><span class="line">  <span class="comment">//           icon: &lt;UploadOutlined /&gt;</span></span><br><span class="line">  <span class="comment">//         &#125;</span></span><br><span class="line">  <span class="comment">//       ]</span></span><br><span class="line">  <span class="comment">//     &#125;,</span></span><br><span class="line">  <span class="comment">//     &#123;</span></span><br><span class="line">  <span class="comment">//       label: &#x27;活动页轮播图&#x27;,</span></span><br><span class="line">  <span class="comment">//       key: &#x27;/banner/active&#x27;,</span></span><br><span class="line">  <span class="comment">//       icon: &lt;PictureOutlined /&gt;,</span></span><br><span class="line">  <span class="comment">//       children: [</span></span><br><span class="line">  <span class="comment">//         &#123;</span></span><br><span class="line">  <span class="comment">//           label: &#x27;轮播图列表&#x27;,</span></span><br><span class="line">  <span class="comment">//           key: &#x27;/banner/home/list&#x27;,</span></span><br><span class="line">  <span class="comment">//           icon: &lt;PictureOutlined /&gt;</span></span><br><span class="line">  <span class="comment">//         &#125;,</span></span><br><span class="line">  <span class="comment">//         &#123;</span></span><br><span class="line">  <span class="comment">//           label: &#x27;添加轮播图&#x27;,</span></span><br><span class="line">  <span class="comment">//           key: &#x27;/banner/home/add&#x27;,</span></span><br><span class="line">  <span class="comment">//           icon: &lt;UploadOutlined /&gt;</span></span><br><span class="line">  <span class="comment">//         &#125;</span></span><br><span class="line">  <span class="comment">//       ]</span></span><br><span class="line">  <span class="comment">//     &#125;,</span></span><br><span class="line">      </span><br><span class="line">  <span class="comment">//   ]</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;轮播图管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/home&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;活动页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/active&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;添加轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/add&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;产品管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/pro&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProfileOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;产品列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/list&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">OrderedListOutlined</span> /&gt;</span></span> ,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;首页产品列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/home&#x27;</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;详情推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/detail&#x27;</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;购物车推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/cart&#x27;</span></span><br><span class="line">          &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;筛选列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/search&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">FilterOutlined</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;账户管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/account&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">TeamOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;用户列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/userlist&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;管理员列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/adminlist&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;设置&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/setting&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><h2 id="7-2-渲染左侧菜单栏"><a href="#7-2-渲染左侧菜单栏" class="headerlink" title="7.2.渲染左侧菜单栏"></a>7.2.渲染左侧菜单栏</h2><p>左侧菜单栏的头部设定logo以及后台管理系统名称</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, <span class="title class_">Image</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;@/logo.svg&#x27;</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>); </span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">color:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">logo</span> &#125; <span class="attr">width</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">preview</span>=<span class="string">&#123;</span> <span class="attr">false</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; !collapsed &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">height:</span> &#x27;<span class="attr">32px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">overflow:</span> &#x27;<span class="attr">hidden</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">lineHeight:</span> &#x27;<span class="attr">32px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span>嗨购后台管理系统<span class="tag">&lt;/<span class="name">div</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">items</span>=<span class="string">&#123;</span> <span class="attr">menus</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><h2 id="7-3-低版本处理"><a href="#7-3-低版本处理" class="headerlink" title="7.3 低版本处理"></a>7.3 低版本处理</h2><p>以上菜单项的设置在<code>antd 4.20.0</code>版本以上好使，如果在<code>4.20.0</code>版本以下，应该使用 递归组件实现</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, <span class="title class_">Image</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;@/logo.svg&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/inter&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">renderMenu</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.SubMenu</span> <span class="attr">title</span> = <span class="string">&#123;</span> <span class="attr">item.label</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125; <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            renderMenu(item.children)</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Menu.SubMenu</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.Item</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125;&gt;</span>&#123; item.label &#125;<span class="tag">&lt;/<span class="name">Menu.Item</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>); </span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">color:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">logo</span> &#125; <span class="attr">width</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">preview</span>=<span class="string">&#123;</span> <span class="attr">false</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; !collapsed &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">height:</span> &#x27;<span class="attr">32px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">overflow:</span> &#x27;<span class="attr">hidden</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">lineHeight:</span> &#x27;<span class="attr">32px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span>嗨购后台管理系统<span class="tag">&lt;/<span class="name">div</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          renderMenu(menus)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><p>优化：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// src/router/utils.tsx</span><br><span class="line"></span><br><span class="line">import &#123; Menu &#125; from &#x27;antd&#x27;;</span><br><span class="line">import &#123; IMenuProps &#125; from &#x27;./inter&#x27;;</span><br><span class="line">export const renderMenu = (menus: IMenuProps[]) =&gt; &#123;</span><br><span class="line">  return menus.map(item =&gt; &#123;</span><br><span class="line">    if (item.children) &#123;</span><br><span class="line">      return (</span><br><span class="line">        &lt;Menu.SubMenu title = &#123; item.label &#125; icon = &#123; item.icon &#125; key = &#123; item.key &#125;&gt;</span><br><span class="line">          &#123;</span><br><span class="line">            renderMenu(item.children)</span><br><span class="line">          &#125;</span><br><span class="line">        &lt;/Menu.SubMenu&gt;</span><br><span class="line">      )</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return &lt;Menu.Item key = &#123; item.key &#125; icon = &#123; item.icon &#125;&gt;&#123; item.label &#125;&lt;/Menu.Item&gt;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, <span class="title class_">Image</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;@/logo.svg&#x27;</span></span><br><span class="line"><span class="comment">// import &#123; IMenuProps &#125; from &#x27;@/router/inter&#x27;;</span></span><br><span class="line"><span class="keyword">import</span> &#123; renderMenu &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// antd 4.20.0版本以下，递归生成菜单项</span></span><br><span class="line"><span class="comment">// 建议可以把这个代码放到另一个模块中</span></span><br><span class="line"><span class="comment">// const renderMenu = (menus: IMenuProps[]) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   return menus.map(item =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     if (item.children) &#123;</span></span><br><span class="line"><span class="comment">//       return (</span></span><br><span class="line"><span class="comment">//         &lt;Menu.SubMenu title = &#123; item.label &#125; icon = &#123; item.icon &#125; key = &#123; item.key &#125;&gt;</span></span><br><span class="line"><span class="comment">//           &#123;</span></span><br><span class="line"><span class="comment">//             renderMenu(item.children)</span></span><br><span class="line"><span class="comment">//           &#125;</span></span><br><span class="line"><span class="comment">//         &lt;/Menu.SubMenu&gt;</span></span><br><span class="line"><span class="comment">//       )</span></span><br><span class="line"><span class="comment">//     &#125; else &#123;</span></span><br><span class="line"><span class="comment">//       return &lt;Menu.Item key = &#123; item.key &#125; icon = &#123; item.icon &#125;&gt;&#123; item.label &#125;&lt;/Menu.Item&gt;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>); </span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">color:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">logo</span> &#125; <span class="attr">width</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">preview</span>=<span class="string">&#123;</span> <span class="attr">false</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; !collapsed &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">height:</span> &#x27;<span class="attr">32px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">overflow:</span> &#x27;<span class="attr">hidden</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">lineHeight:</span> &#x27;<span class="attr">32px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span>嗨购后台管理系统<span class="tag">&lt;/<span class="name">div</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          renderMenu(menus)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><h2 id="7-4-菜单渲染优化"><a href="#7-4-菜单渲染优化" class="headerlink" title="7.4 菜单渲染优化"></a>7.4 菜单渲染优化</h2><p>如果左侧菜单栏数据过于庞大，每个管理项里又有很多项，需要只展开一个菜单项</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, <span class="title class_">Image</span>, <span class="title class_">MenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;@/logo.svg&#x27;</span></span><br><span class="line"><span class="comment">// import &#123; IMenuProps &#125; from &#x27;@/router/inter&#x27;;</span></span><br><span class="line"><span class="keyword">import</span> &#123; renderMenu &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// antd 4.20.0版本以下，递归生成菜单项</span></span><br><span class="line"><span class="comment">// 建议可以把这个代码放到另一个模块中</span></span><br><span class="line"><span class="comment">// const renderMenu = (menus: IMenuProps[]) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   return menus.map(item =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     if (item.children) &#123;</span></span><br><span class="line"><span class="comment">//       return (</span></span><br><span class="line"><span class="comment">//         &lt;Menu.SubMenu title = &#123; item.label &#125; icon = &#123; item.icon &#125; key = &#123; item.key &#125;&gt;</span></span><br><span class="line"><span class="comment">//           &#123;</span></span><br><span class="line"><span class="comment">//             renderMenu(item.children)</span></span><br><span class="line"><span class="comment">//           &#125;</span></span><br><span class="line"><span class="comment">//         &lt;/Menu.SubMenu&gt;</span></span><br><span class="line"><span class="comment">//       )</span></span><br><span class="line"><span class="comment">//     &#125; else &#123;</span></span><br><span class="line"><span class="comment">//       return &lt;Menu.Item key = &#123; item.key &#125; icon = &#123; item.icon &#125;&gt;&#123; item.label &#125;&lt;/Menu.Item&gt;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置只展开一个菜单项</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">rootSubmenuKeys</span>: <span class="built_in">string</span>[] = [];</span><br><span class="line">menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  item.<span class="property">children</span> &amp;&amp; rootSubmenuKeys.<span class="title function_">push</span>(item.<span class="property">key</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(rootSubmenuKeys)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>);</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 展开哪一项数据</span></span><br><span class="line">  <span class="keyword">const</span> [openKeys, setOpenKeys] = useState&lt;<span class="built_in">string</span>[]&gt;([])</span><br><span class="line">  <span class="comment">// 打开一个菜单项时，需要做判断 - SubMenu 展开/关闭的回调</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">onOpenChange</span>: <span class="title class_">MenuProps</span>[<span class="string">&#x27;onOpenChange&#x27;</span>] = <span class="function"><span class="params">keys</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 如果当前展开项是 轮播图管理，再点击 账户管理 [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;keys&#x27;</span>, keys) <span class="comment">// [&#x27;/banner&#x27;] =&gt;  [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;openKeys&#x27;</span>, openKeys) <span class="comment">// [] =&gt; [&#x27;/banner&#x27;]</span></span><br><span class="line">    <span class="comment">// 得到当前</span></span><br><span class="line">    <span class="keyword">const</span> latestOpenKey = keys.<span class="title function_">find</span>(<span class="function"><span class="params">key</span> =&gt;</span> openKeys.<span class="title function_">indexOf</span>(key) === -<span class="number">1</span>); </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;latestOpenKey&#x27;</span>, latestOpenKey) <span class="comment">// /banner ===&gt; /account</span></span><br><span class="line">    <span class="keyword">if</span> (rootSubmenuKeys.<span class="title function_">indexOf</span>(latestOpenKey!) === -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(keys);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(latestOpenKey ? [latestOpenKey] : []);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">color:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">logo</span> &#125; <span class="attr">width</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">preview</span>=<span class="string">&#123;</span> <span class="attr">false</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; !collapsed &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">height:</span> &#x27;<span class="attr">32px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">overflow:</span> &#x27;<span class="attr">hidden</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">lineHeight:</span> &#x27;<span class="attr">32px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span>嗨购后台管理系统<span class="tag">&lt;/<span class="name">div</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">openKeys</span> = <span class="string">&#123;</span> <span class="attr">openKeys</span> &#125; // <span class="attr">打开哪一个菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onOpenChange</span> = <span class="string">&#123;</span> <span class="attr">onOpenChange</span> &#125; // <span class="attr">打开某一个菜单项时需要关闭其他菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          renderMenu(menus)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><h1 id="8-定义路由"><a href="#8-定义路由" class="headerlink" title="8.定义路由"></a>8.定义路由</h1><h2 id="8-1-官方文档"><a href="#8-1-官方文档" class="headerlink" title="8.1 官方文档"></a>8.1 官方文档</h2><p><a target="_blank" rel="noopener" href="https://reactrouter.com/">https://reactrouter.com/</a></p><h2 id="8-2-创建对应的页面"><a href="#8-2-创建对应的页面" class="headerlink" title="8.2 创建对应的页面"></a>8.2 创建对应的页面</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">|-src</span><br><span class="line">|  |- ...</span><br><span class="line">|  |-views</span><br><span class="line">|    |- banner</span><br><span class="line">|    |  |- Index.tsx    #轮播图管理页面</span><br><span class="line">|    |  |- List.tsx     #首页轮播图</span><br><span class="line">|    |  |- Active.tsx   #活动页轮播图</span><br><span class="line">|	 |  |- Add.tsx		#添加轮播图</span><br><span class="line">|	 |- home</span><br><span class="line">|    |  |- Index.tsx	#系统首页</span><br><span class="line">|    |- product</span><br><span class="line">|    |  |- Index.tsx 	#产品管理</span><br><span class="line">|    |  |- Search.tsx 	#筛选列表</span><br><span class="line">|    |  |- list</span><br><span class="line">|    |  |  |- Index.tsx #产品列表</span><br><span class="line">|    |  |  |- Home.tsx  #首页产品列表</span><br><span class="line">|    |  |  |- Detail.tsx#详情推荐列表</span><br><span class="line">|    |  |  |- Cart.tsx  #购物车推荐列表</span><br><span class="line">|    |- Account</span><br><span class="line">|    |  |- Index.tsx	#账户管理</span><br><span class="line">|    |  |- UserList.tsx #用户列表</span><br><span class="line">|    |  |- AdminList.tsx#管理员列表</span><br><span class="line">|    |- setting</span><br><span class="line">|    |  |- Index.tsx    #设置页面</span><br><span class="line"> 	</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>账户管理<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/UserList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>用户列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>管理员列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/banner/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>轮播图管理<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/banner/List.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页轮播图列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/banner/Active.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>活动页轮播图<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/banner/Add.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>添加轮播图<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/home/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>系统首页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/Product/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>产品管理<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/Product/Search.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>筛选列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/Product/list/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>产品列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/Product/list/Home.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页产品列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/Product/list/Detail.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>详情推荐列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/Product/list/Cart.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>购物车推荐列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/setting/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>设置页面<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><p>有二级菜单，能想到的 就是使用 嵌套路由</p><p><a target="_blank" rel="noopener" href="https://reactrouter.com/docs/en/v6/getting-started/overview#index-routes">https://reactrouter.com/docs/en/v6/getting-started/overview#index-routes</a></p><h2 id="8-3-定义菜单路由信息"><a href="#8-3-定义菜单路由信息" class="headerlink" title="8.3 定义菜单路由信息"></a>8.3 定义菜单路由信息</h2><p>v6的路由通过 element 属性定义匹配的组件</p><p>因此menus中可以添加一个 element 属性，值就为组件的引用即可</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/inter.d.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ReactNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// key属性可以使用 左侧菜单的路由地址，因为它具有唯一性</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IMenuProps</span> &#123;</span><br><span class="line">  <span class="attr">label</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">key</span>: <span class="built_in">string</span></span><br><span class="line">  icon?: <span class="title class_">ReactNode</span></span><br><span class="line">  children?: <span class="title class_">IMenuProps</span>[]</span><br><span class="line">  <span class="attr">element</span>: <span class="title class_">ReactNode</span> <span class="comment">// 因为页面创建时 指定了多级了路由的页面，故这里设置为 必传属性</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/menu.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">PictureOutlined</span>,</span><br><span class="line">  <span class="title class_">ProfileOutlined</span>,</span><br><span class="line">  <span class="title class_">OrderedListOutlined</span>,</span><br><span class="line">  <span class="title class_">FilterOutlined</span>,</span><br><span class="line">  <span class="title class_">TeamOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/home/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Banner</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/List&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerActive</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Active&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerAdd</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Add&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Product</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductSearch</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Search&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductHomeList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductDetailList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Detail&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductCartList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Cart&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Account</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/UserList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AdminList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/AdminList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Setting</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/setting/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;轮播图管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Banner</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/home&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerList</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;活动页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/active&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerActive</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;添加轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/add&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerAdd</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;产品管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/pro&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProfileOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Product</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;产品列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/list&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">OrderedListOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;首页产品列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/home&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductHomeList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;详情推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/detail&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductDetailList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;购物车推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/cart&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductCartList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;筛选列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/search&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">FilterOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductSearch</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;账户管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/account&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">TeamOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Account</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;用户列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/userlist&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserList</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;管理员列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/adminlist&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AdminList</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;设置&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/setting&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Setting</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><h2 id="8-4-装载路由"><a href="#8-4-装载路由" class="headerlink" title="8.4.装载路由"></a>8.4.装载路由</h2><p>在根组件添加 <code>BrowserRouter</code> 或者 <code>HashRouter</code></p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@/index.less&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;@/App&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reportWebVitals <span class="keyword">from</span> <span class="string">&#x27;@/reportWebVitals&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span> <span class="comment">// +++++</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLDivElement</span></span><br><span class="line">);</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span> = <span class="string">&#123;</span> <span class="attr">store</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">BrowserRouter</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">BrowserRouter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="8-5-定义路由组件"><a href="#8-5-定义路由组件" class="headerlink" title="8.5 定义路由组件"></a>8.5 定义路由组件</h2><p>在<code>menu.tsx</code>里已经定义好了请求的路径（其实就是数据中key属性）和路径对应组件（其实就是数据中的element属性）,剩下就是定义路由组件了</p><p>组件渲染的区域 <code>AppMain</code> 组件</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/utils.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="comment">// 定义左侧菜单栏数据</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">renderMenu</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.SubMenu</span> <span class="attr">title</span> = <span class="string">&#123;</span> <span class="attr">item.label</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125; <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            renderMenu(item.children)</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Menu.SubMenu</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.Item</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125;&gt;</span>&#123; item.label &#125;<span class="tag">&lt;/<span class="name">Menu.Item</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义路由组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">renderRoute</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppMain.tsx 内容区域</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; renderRoute &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Routes</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppMainProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Content</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="keyword">const</span> arr = <span class="title function_">renderRoute</span>(menus)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;arr&#x27;</span>, arr[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppMain</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppMainProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Content</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">margin:</span> &#x27;<span class="attr">24px</span> <span class="attr">16px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">padding:</span> <span class="attr">24</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">minHeight:</span> <span class="attr">280</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* </span></span><br><span class="line"><span class="language-xml">        多个路由需要定义时，包裹在Routes选项下</span></span><br><span class="line"><span class="language-xml">      */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          renderRoute(menus)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Content</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppMain</span>;</span><br></pre></td></tr></table></figure><h2 id="8-6-二级乃至三级菜单生效"><a href="#8-6-二级乃至三级菜单生效" class="headerlink" title="8.6 二级乃至三级菜单生效"></a>8.6 二级乃至三级菜单生效</h2><p>二级菜单对应的二级路由要生效，需要给以及页面添加 <code>&lt;Outlet /&gt;</code> 标识</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Outlet</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>账户管理<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/banner/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Outlet</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>轮播图管理<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/Product/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Outlet</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>产品管理<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/Product/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Outlet</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>产品列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="8-7-手动测试路由"><a href="#8-7-手动测试路由" class="headerlink" title="8.7 手动测试路由"></a>8.7 手动测试路由</h2><p>可以在地址栏输入路径，测试是否正常</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:3000/ 					<span class="comment">#系统首页</span></span><br><span class="line"></span><br><span class="line">http://localhost:3000/banner			<span class="comment">#轮播图管理</span></span><br><span class="line">http://localhost:3000/banner/home		<span class="comment">#首页轮播图</span></span><br><span class="line">http://localhost:3000/banner/active		<span class="comment">#活动页轮播图</span></span><br><span class="line">http://localhost:3000/banner/add		<span class="comment">#添加轮播图</span></span><br><span class="line"></span><br><span class="line">http://localhost:3000/pro				<span class="comment">#产品管理</span></span><br><span class="line">http://localhost:3000/pro/search		<span class="comment">#筛选列表</span></span><br><span class="line">http://localhost:3000/pro/list			<span class="comment">#产品列表</span></span><br><span class="line">http://localhost:3000/pro/list/home		<span class="comment">#首页产品列表</span></span><br><span class="line">http://localhost:3000/pro/list/detail	<span class="comment">#详情推荐列表</span></span><br><span class="line">http://localhost:3000/pro/list/cart		<span class="comment">#购物车推荐列表</span></span><br><span class="line"></span><br><span class="line">http://localhost:3000/account			<span class="comment">#账户管理</span></span><br><span class="line">http://localhost:3000/account/userlist	<span class="comment">#用户列表</span></span><br><span class="line">http://localhost:3000/account/adminlist	<span class="comment">#管理员列表</span></span><br><span class="line"></span><br><span class="line">http://localhost:3000/settinig			<span class="comment">#设置 	</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="8-8-设置默认路由"><a href="#8-8-设置默认路由" class="headerlink" title="8.8 设置默认路由"></a>8.8 设置默认路由</h2><p>参照 <a target="_blank" rel="noopener" href="https://reactrouter.com/docs/en/v6/getting-started/overview#index-routes">https://reactrouter.com/docs/en/v6/getting-started/overview#index-routes</a> 学习默认路由</p><p>根据渲染需求，当路由包含一层或者多层子路由时，当选择父级路由时，希望能够自动跳转到某个子路由。也就是路由的重定向。</p><p>在路由表添加标记默认打开子路由</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/inter.d.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ReactNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// key属性可以使用 左侧菜单的路由地址，因为它具有唯一性</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IMenuProps</span> &#123;</span><br><span class="line">  <span class="attr">label</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">key</span>: <span class="built_in">string</span></span><br><span class="line">  icon?: <span class="title class_">ReactNode</span></span><br><span class="line">  children?: <span class="title class_">IMenuProps</span>[]</span><br><span class="line">  <span class="attr">element</span>: <span class="title class_">ReactNode</span> <span class="comment">// 因为页面创建时 指定了多级了路由的页面，故这里设置为 必传属性</span></span><br><span class="line">  index?: <span class="number">1</span> | <span class="number">0</span> <span class="comment">// 不建议使用 boolean，因为react在渲染属性时，具有boolean值的属性会有特殊的含义</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/menu.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">PictureOutlined</span>,</span><br><span class="line">  <span class="title class_">ProfileOutlined</span>,</span><br><span class="line">  <span class="title class_">OrderedListOutlined</span>,</span><br><span class="line">  <span class="title class_">FilterOutlined</span>,</span><br><span class="line">  <span class="title class_">TeamOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/home/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Banner</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/List&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerActive</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Active&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerAdd</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Add&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Product</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductSearch</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Search&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductHomeList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductDetailList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Detail&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductCartList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Cart&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Account</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/UserList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AdminList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/AdminList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Setting</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/setting/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;轮播图管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Banner</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/home&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;活动页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/active&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerActive</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;添加轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/add&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerAdd</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;产品管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/pro&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProfileOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Product</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;产品列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/list&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">OrderedListOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;首页产品列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/home&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductHomeList</span> /&gt;</span></span>,</span><br><span class="line">            <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;详情推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/detail&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductDetailList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;购物车推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/cart&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductCartList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;筛选列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/search&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">FilterOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductSearch</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;账户管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/account&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">TeamOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Account</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;用户列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/userlist&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;管理员列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/adminlist&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AdminList</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;设置&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/setting&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Setting</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><p>为了配合路由跳转组件，修改代码如下</p><p><img src="/posts/60af50c8/image-20221024164450685.png" alt="image-20221024164450685"></p><p><img src="/posts/60af50c8/image-20221024164412284.png" alt="image-20221024164412284"></p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/utils.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Navigate</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 定义左侧菜单栏数据</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">renderMenu</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.SubMenu</span> <span class="attr">title</span> = <span class="string">&#123;</span> <span class="attr">item.label</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125; <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            renderMenu(item.children)</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Menu.SubMenu</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.Item</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125;&gt;</span>&#123; item.label &#125;<span class="tag">&lt;/<span class="name">Menu.Item</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义路由组件</span></span><br><span class="line"><span class="comment">// export const renderRoute = (menus: IMenuProps[]) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   return menus.map(item =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     if (item.children) &#123;</span></span><br><span class="line"><span class="comment">//       return (</span></span><br><span class="line"><span class="comment">//         &lt;Route key = &#123; item.key &#125; path = &#123; item.key &#125; element = &#123; item.element &#125;&gt;</span></span><br><span class="line"><span class="comment">//           &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="comment">//         &lt;/Route&gt;</span></span><br><span class="line"><span class="comment">//       )</span></span><br><span class="line"><span class="comment">//     &#125; else &#123;</span></span><br><span class="line"><span class="comment">//       return (</span></span><br><span class="line"><span class="comment">//         &lt;Route key = &#123; item.key &#125; path = &#123; item.key &#125; element = &#123; item.element &#125;&gt;</span></span><br><span class="line"><span class="comment">//         &lt;/Route&gt;</span></span><br><span class="line"><span class="comment">//       )</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// 定义路由组件  ---- 设置默认路由</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">renderRoute</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!!item.<span class="property">index</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">React.Fragment</span> <span class="attr">key</span>=<span class="string">&#123;item.key&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">index</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">replace</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">              &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!!item.<span class="property">index</span>) &#123; <span class="comment">// 如果index存在</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">React.Fragment</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">index</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">replace</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:3000/banner   ===&gt; http://localhost:3000/banner/home</span><br><span class="line">http://localhost:3000/pro  ===&gt; http://localhost:3000/pro/list/home</span><br><span class="line">http://localhost:3000/account ===&gt; http://localhost:3000/account/userlist</span><br></pre></td></tr></table></figure><h2 id="8-9-设置404页面"><a href="#8-9-设置404页面" class="headerlink" title="8.9 设置404页面"></a>8.9 设置404页面</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/error/Page404.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IPage404Props</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Page404</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IPage404Props</span>&gt; = <span class="function">(<span class="params">&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>当前页面未找到<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Page404</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppMain.tsx 内容区域</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; renderRoute &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Routes</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Page404</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/error/Page404&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppMainProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Content</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="comment">// const arr = renderRoute(menus)</span></span><br><span class="line"><span class="comment">// console.log(&#x27;arr&#x27;, arr[1])</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppMain</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppMainProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Content</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">margin:</span> &#x27;<span class="attr">24px</span> <span class="attr">16px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">padding:</span> <span class="attr">24</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">minHeight:</span> <span class="attr">280</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* </span></span><br><span class="line"><span class="language-xml">        多个路由需要定义时，包裹在Routes选项下</span></span><br><span class="line"><span class="language-xml">      */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          renderRoute(menus)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">		&#123;/* </span></span><br><span class="line"><span class="language-xml">            ++++++ 404+++++</span></span><br><span class="line"><span class="language-xml">        */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;*&quot;</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Page404</span> /&gt;</span> &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Content</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppMain</span>;</span><br></pre></td></tr></table></figure><h1 id="9-切换路由"><a href="#9-切换路由" class="headerlink" title="9 切换路由"></a>9 切换路由</h1><p>上诉项目中，切换路由都是手动输入的，实际上应该点击左侧菜单栏进行路由导航。</p><p>左侧菜单的逻辑交互，前面已经生成了（openKeys 以及 onOpenChanges 实现）</p><p>现在通过点击事件来切换导航</p><h2 id="9-1-点击切换路由"><a href="#9-1-点击切换路由" class="headerlink" title="9.1 点击切换路由"></a>9.1 点击切换路由</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, <span class="title class_">Image</span>, <span class="title class_">MenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;@/logo.svg&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; renderMenu &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置只展开一个菜单项</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">rootSubmenuKeys</span>: <span class="built_in">string</span>[] = [];</span><br><span class="line">menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  item.<span class="property">children</span> &amp;&amp; rootSubmenuKeys.<span class="title function_">push</span>(item.<span class="property">key</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(rootSubmenuKeys)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>);</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 展开哪一项数据</span></span><br><span class="line">  <span class="keyword">const</span> [openKeys, setOpenKeys] = useState&lt;<span class="built_in">string</span>[]&gt;([])</span><br><span class="line">  <span class="comment">// 打开一个菜单项时，需要做判断 - SubMenu 展开/关闭的回调</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">onOpenChange</span>: <span class="title class_">MenuProps</span>[<span class="string">&#x27;onOpenChange&#x27;</span>] = <span class="function"><span class="params">keys</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 如果当前展开项是 轮播图管理，再点击 账户管理 [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;keys&#x27;</span>, keys) <span class="comment">// [&#x27;/banner&#x27;] =&gt;  [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;openKeys&#x27;</span>, openKeys) <span class="comment">// [] =&gt; [&#x27;/banner&#x27;]</span></span><br><span class="line">    <span class="comment">// 得到当前</span></span><br><span class="line">    <span class="keyword">const</span> latestOpenKey = keys.<span class="title function_">find</span>(<span class="function"><span class="params">key</span> =&gt;</span> openKeys.<span class="title function_">indexOf</span>(key) === -<span class="number">1</span>); </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;latestOpenKey&#x27;</span>, latestOpenKey) <span class="comment">// /banner ===&gt; /account</span></span><br><span class="line">    <span class="keyword">if</span> (rootSubmenuKeys.<span class="title function_">indexOf</span>(latestOpenKey!) === -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(keys);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(latestOpenKey ? [latestOpenKey] : []);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 点击切换路由 // +++++++++</span></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">changeUrl</span> = (<span class="params">&#123; key &#125;: &#123; key: <span class="built_in">string</span> &#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(key)</span><br><span class="line">    <span class="title function_">navigate</span>(key, &#123; <span class="attr">replace</span>: <span class="literal">false</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">color:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">logo</span> &#125; <span class="attr">width</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">preview</span>=<span class="string">&#123;</span> <span class="attr">false</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; !collapsed &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">height:</span> &#x27;<span class="attr">32px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">overflow:</span> &#x27;<span class="attr">hidden</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">lineHeight:</span> &#x27;<span class="attr">32px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span>嗨购后台管理系统<span class="tag">&lt;/<span class="name">div</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">openKeys</span> = <span class="string">&#123;</span> <span class="attr">openKeys</span> &#125; // <span class="attr">打开哪一个菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onOpenChange</span> = <span class="string">&#123;</span> <span class="attr">onOpenChange</span> &#125; // <span class="attr">打开某一个菜单项时需要关闭其他菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">changeUrl</span> &#125; // +++++++++</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          renderMenu(menus)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><h2 id="9-2-刷新保持左侧菜单状态"><a href="#9-2-刷新保持左侧菜单状态" class="headerlink" title="9.2 刷新保持左侧菜单状态"></a>9.2 刷新保持左侧菜单状态</h2><p>当页面刷新时，需要保证当前二级路由是展开的，且当前路由是被选中的状态</p><p>编写一个 <code>getSubMenu</code> 函数, 用来生成 <code>[&#39;pro&#39;, &#39;pro/list&#39;, &#39;pro/list/home&#39;]</code>的数组，用于展开当前的 <code>SubMenu</code> 菜单项</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/utils.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Navigate</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 定义左侧菜单栏数据</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">renderMenu</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.SubMenu</span> <span class="attr">title</span> = <span class="string">&#123;</span> <span class="attr">item.label</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125; <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            renderMenu(item.children)</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Menu.SubMenu</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.Item</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125;&gt;</span>&#123; item.label &#125;<span class="tag">&lt;/<span class="name">Menu.Item</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义路由组件</span></span><br><span class="line"><span class="comment">// export const renderRoute = (menus: IMenuProps[]) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   return menus.map(item =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     if (item.children) &#123;</span></span><br><span class="line"><span class="comment">//       return (</span></span><br><span class="line"><span class="comment">//         &lt;Route key = &#123; item.key &#125; path = &#123; item.key &#125; element = &#123; item.element &#125;&gt;</span></span><br><span class="line"><span class="comment">//           &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="comment">//         &lt;/Route&gt;</span></span><br><span class="line"><span class="comment">//       )</span></span><br><span class="line"><span class="comment">//     &#125; else &#123;</span></span><br><span class="line"><span class="comment">//       return (</span></span><br><span class="line"><span class="comment">//         &lt;Route key = &#123; item.key &#125; path = &#123; item.key &#125; element = &#123; item.element &#125;&gt;</span></span><br><span class="line"><span class="comment">//         &lt;/Route&gt;</span></span><br><span class="line"><span class="comment">//       )</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// 定义路由组件  ---- 设置默认路由</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">renderRoute</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!!item.<span class="property">index</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">React.Fragment</span> <span class="attr">key</span>=<span class="string">&#123;item.key&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">index</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">replace</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">              &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!!item.<span class="property">index</span>) &#123; <span class="comment">// 如果index存在</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">React.Fragment</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">index</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">replace</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取当前 需要展开的菜单项（可展开二级以及三级乃至更多展开项） +++++++++++</span></span><br><span class="line"><span class="comment">// pathname  /pro/list/cart </span></span><br><span class="line"><span class="comment">//  ===&gt; [&#x27;/pro&#x27;, &#x27;/pro/list&#x27;, &#x27;/pro/list/cart&#x27;]</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getSubMenu</span> = (<span class="params">pathname: <span class="built_in">string</span></span>) =&gt; &#123; </span><br><span class="line">  <span class="comment">// 1.以 / 分割 pathname.split(&#x27;/&#x27;)  //  [&#x27;&#x27;, &#x27;pro&#x27;, &#x27;list&#x27;, &#x27;cart&#x27;]</span></span><br><span class="line">  <span class="keyword">const</span> pathArray = pathname.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">slice</span>(<span class="number">1</span>) <span class="comment">// [&#x27;pro&#x27;, &#x27;list&#x27;, &#x27;cart&#x27;]</span></span><br><span class="line">  <span class="comment">// console.log(pathArray) </span></span><br><span class="line">  <span class="keyword">const</span> result = pathArray.<span class="title function_">reduce</span>(<span class="function">(<span class="params">newArr, item, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> str = newArr[index] + <span class="string">&#x27;/&#x27;</span> + item</span><br><span class="line">    newArr.<span class="title function_">push</span>(str)</span><br><span class="line">    <span class="keyword">return</span> newArr</span><br><span class="line">  &#125;, [<span class="string">&#x27;&#x27;</span>])</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;result&#x27;</span>, result)</span><br><span class="line">  <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, <span class="title class_">Image</span>, <span class="title class_">MenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;@/logo.svg&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; renderMenu, getSubMenu &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useLocation, useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置只展开一个菜单项</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">rootSubmenuKeys</span>: <span class="built_in">string</span>[] = [];</span><br><span class="line">menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  item.<span class="property">children</span> &amp;&amp; rootSubmenuKeys.<span class="title function_">push</span>(item.<span class="property">key</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>);</span><br><span class="line">  <span class="comment">// 获取当前路由的路径信息</span></span><br><span class="line">  <span class="keyword">const</span> &#123; pathname &#125; = <span class="title function_">useLocation</span>() <span class="comment">// ++++++++++</span></span><br><span class="line">  <span class="comment">// 当前选中的菜单项key数组</span></span><br><span class="line">  <span class="comment">// 初始值设置为 [pathname],刷新进入选中某一个菜单项</span></span><br><span class="line">  <span class="keyword">const</span> [selectedKeys, setSelectedKeys] = <span class="title function_">useState</span>([pathname]) <span class="comment">// ++++++++++</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// const [openKeys, setOpenKeys] = useState&lt;string[]&gt;([&#x27;/pro&#x27;, &#x27;/pro/list&#x27;])</span></span><br><span class="line">  <span class="keyword">const</span> [openKeys, setOpenKeys] = useState&lt;<span class="built_in">string</span>[]&gt;(<span class="title function_">getSubMenu</span>(pathname))  <span class="comment">// ++++++++++</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 展开哪一项数据</span></span><br><span class="line">  <span class="comment">// const [openKeys, setOpenKeys] = useState&lt;string[]&gt;([]) // -------------</span></span><br><span class="line">  <span class="comment">// 打开一个菜单项时，需要做判断 - SubMenu 展开/关闭的回调</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">onOpenChange</span>: <span class="title class_">MenuProps</span>[<span class="string">&#x27;onOpenChange&#x27;</span>] = <span class="function"><span class="params">keys</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 如果当前展开项是 轮播图管理，再点击 账户管理 [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;keys&#x27;</span>, keys) <span class="comment">// [&#x27;/banner&#x27;] =&gt;  [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;openKeys&#x27;</span>, openKeys) <span class="comment">// [] =&gt; [&#x27;/banner&#x27;]</span></span><br><span class="line">    <span class="comment">// 得到当前</span></span><br><span class="line">    <span class="keyword">const</span> latestOpenKey = keys.<span class="title function_">find</span>(<span class="function"><span class="params">key</span> =&gt;</span> openKeys.<span class="title function_">indexOf</span>(key) === -<span class="number">1</span>); </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;latestOpenKey&#x27;</span>, latestOpenKey) <span class="comment">// /banner ===&gt; /account</span></span><br><span class="line">    <span class="keyword">if</span> (rootSubmenuKeys.<span class="title function_">indexOf</span>(latestOpenKey!) === -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(keys);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(latestOpenKey ? [latestOpenKey] : []);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 点击切换路由</span></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">changeUrl</span> = (<span class="params">&#123; key &#125;: &#123; key: <span class="built_in">string</span> &#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(key)</span><br><span class="line">    <span class="title function_">navigate</span>(key, &#123; <span class="attr">replace</span>: <span class="literal">false</span> &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点击左侧菜单，切换菜单项，选中样式</span></span><br><span class="line">    <span class="title function_">setSelectedKeys</span>([key]) <span class="comment">// ++++++++++</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">color:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">logo</span> &#125; <span class="attr">width</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">preview</span>=<span class="string">&#123;</span> <span class="attr">false</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; !collapsed &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">height:</span> &#x27;<span class="attr">32px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">overflow:</span> &#x27;<span class="attr">hidden</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">lineHeight:</span> &#x27;<span class="attr">32px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span>嗨购后台管理系统<span class="tag">&lt;/<span class="name">div</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">openKeys</span> = <span class="string">&#123;</span> <span class="attr">openKeys</span> &#125; // <span class="attr">打开哪一个菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onOpenChange</span> = <span class="string">&#123;</span> <span class="attr">onOpenChange</span> &#125; // <span class="attr">打开某一个菜单项时需要关闭其他菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">changeUrl</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">selectedKeys</span> = <span class="string">&#123;</span> <span class="attr">selectedKeys</span> &#125; // ++++++++++</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          renderMenu(menus)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><h1 id="10-设置面包屑导航"><a href="#10-设置面包屑导航" class="headerlink" title="10 设置面包屑导航"></a>10 设置面包屑导航</h1><h2 id="10-1-参考文档"><a href="#10-1-参考文档" class="headerlink" title="10.1 参考文档"></a>10.1 参考文档</h2><p>通过案例项目，得知 面包屑组件应该包含在 页面的头部 <a target="_blank" rel="noopener" href="https://vvbin.cn/next/#/feat/breadcrumb/flat">https://vvbin.cn/next/#/feat/breadcrumb/flat</a></p><p>参照组件库的面包屑 <a target="_blank" rel="noopener" href="https://ant-design.gitee.io/components/breadcrumb-cn/#components-breadcrumb-demo-react-router">https://ant-design.gitee.io/components/breadcrumb-cn/#components-breadcrumb-demo-react-router</a></p><h2 id="10-2-设置面包屑导航"><a href="#10-2-设置面包屑导航" class="headerlink" title="10.2 设置面包屑导航"></a>10.2 设置面包屑导航</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">面包屑导航映射表</span></span><br><span class="line"><span class="comment">/: 系统首页</span></span><br><span class="line"><span class="comment">/banner: 轮播图管理</span></span><br><span class="line"><span class="comment">/banner/home： 首页轮播图</span></span><br><span class="line"><span class="comment">/banner/active: 活动页轮播图</span></span><br><span class="line"><span class="comment">/banner/add: 添加轮播图</span></span><br><span class="line"><span class="comment">/pro: 产品管理</span></span><br><span class="line"><span class="comment">/pro/list: 产品列表</span></span><br><span class="line"><span class="comment">/pro/list/home: 首页产品列表</span></span><br><span class="line"><span class="comment">/pro/list/detail: 详情推荐列表</span></span><br><span class="line"><span class="comment">/pro/list/cart: 购物车推荐列表</span></span><br><span class="line"><span class="comment">/pro/search: 筛选列表</span></span><br><span class="line"><span class="comment">/account: 账户管理</span></span><br><span class="line"><span class="comment">/account/userlist: 用户列表</span></span><br><span class="line"><span class="comment">/account/adminlist: 管理员列表</span></span><br><span class="line"><span class="comment">/setting: 设置</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="comment">// 如果将上述的映射表 放到一个对象中，可以通过地址栏的pathname属性 获取相应的 该对象的key值即可得到 对应的value值</span></span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppBreadcrumb.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/inter&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Breadcrumb</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useLocation, <span class="title class_">Link</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppBreadcrumbProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">breadcrumbNameMap</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getBreadcrumbData</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      breadcrumbNameMap[item.<span class="property">key</span>] = item.<span class="property">label</span></span><br><span class="line">      <span class="title function_">getBreadcrumbData</span>(item.<span class="property">children</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      breadcrumbNameMap[item.<span class="property">key</span>] = item.<span class="property">label</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getBreadcrumbData</span>(menus)</span><br><span class="line"><span class="comment">// console.log(breadcrumbNameMap)</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * /: &quot;系统首页&quot;</span></span><br><span class="line"><span class="comment">/account: &quot;账户管理&quot;</span></span><br><span class="line"><span class="comment">/account/adminlist: &quot;管理员列表&quot;</span></span><br><span class="line"><span class="comment">/account/userlist: &quot;用户列表&quot;</span></span><br><span class="line"><span class="comment">/banner: &quot;轮播图管理&quot;</span></span><br><span class="line"><span class="comment">/banner/active: &quot;活动页轮播图&quot;</span></span><br><span class="line"><span class="comment">/banner/add: &quot;添加轮播图&quot;</span></span><br><span class="line"><span class="comment">/banner/home: &quot;首页轮播图&quot;</span></span><br><span class="line"><span class="comment">/pro: &quot;产品管理&quot;</span></span><br><span class="line"><span class="comment">/pro/list: &quot;产品列表&quot;</span></span><br><span class="line"><span class="comment">/pro/list/cart: &quot;购物车推荐列表&quot;</span></span><br><span class="line"><span class="comment">/pro/list/detail: &quot;详情推荐列表&quot;</span></span><br><span class="line"><span class="comment">/pro/list/home: &quot;首页产品列表&quot;</span></span><br><span class="line"><span class="comment">/pro/search: &quot;筛选列表&quot;</span></span><br><span class="line"><span class="comment">/setting: &quot;设置&quot;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppBreadcrumb</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppBreadcrumbProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> location = <span class="title function_">useLocation</span>()</span><br><span class="line">  <span class="comment">// /pro/list/cart</span></span><br><span class="line">  <span class="keyword">const</span> pathSnippets = location.<span class="property">pathname</span>.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">filter</span>(<span class="function"><span class="params">i</span> =&gt;</span> i); <span class="comment">// [&#x27;pro&#x27;, &#x27;list&#x27;, &#x27;cart&#x27;]</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(pathSnippets)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> extraBreadcrumbItems = pathSnippets.<span class="title function_">map</span>(<span class="function">(<span class="params">_, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// url /</span></span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">`/<span class="subst">$&#123;pathSnippets.slice(<span class="number">0</span>, index + <span class="number">1</span>).join(<span class="string">&#x27;/&#x27;</span>)&#125;</span>`</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(url) <span class="comment">// /pro  /pro/list /pro/list/cart</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">Breadcrumb.Item</span> <span class="attr">key</span>=<span class="string">&#123;url&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;url&#125;</span>&gt;</span>&#123;breadcrumbNameMap[url]&#125;<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Breadcrumb.Item</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> breadcrumbItems = [</span><br><span class="line">    location.<span class="property">pathname</span> === <span class="string">&#x27;/&#x27;</span> ? <span class="literal">null</span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Breadcrumb.Item</span> <span class="attr">key</span>=<span class="string">&quot;home&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span>系统首页<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Breadcrumb.Item</span>&gt;</span></span>,</span><br><span class="line">  ].<span class="title function_">concat</span>(extraBreadcrumbItems);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &#x27;<span class="attr">100</span>%&#x27;, <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Breadcrumb</span>&gt;</span>&#123;breadcrumbItems&#125;<span class="tag">&lt;/<span class="name">Breadcrumb</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppBreadcrumb</span>;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/index.ts</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">SideBar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./SideBar&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">AppHeader</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AppHeader&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">AppMain</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AppMain&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">AppBreadcrumb</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AppBreadcrumb&#x27;</span></span><br></pre></td></tr></table></figure><p>头部组件加入了面包屑导航组件，尽可能不动原来的布局</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppHeader.tsx 头部组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">MenuFoldOutlined</span>,</span><br><span class="line">  <span class="title class_">MenuUnfoldOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppDispatch, useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setCollapsed &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/modules/app&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AppBreadcrumb</span> <span class="keyword">from</span> <span class="string">&#x27;./AppBreadcrumb&#x27;</span>;</span><br><span class="line"><span class="comment">// import &#123; useDispatch &#125; from &#x27;react-redux&#x27;;</span></span><br><span class="line"><span class="comment">// import &#123; AppDispatch &#125; from &#x27;@/store&#x27;;</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Header</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppHeaderProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppHeader</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppHeaderProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// const [collapsed, setCollapsed] = useState(false);</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// const dispatch: AppDispatch = useDispatch() // ts中添加类型注解</span></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useAppDispatch</span>() <span class="comment">// ts推荐写法</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Header</span> <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> <span class="attr">0</span>, <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;  &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* &#123;React.createElement(collapsed ? MenuUnfoldOutlined : MenuFoldOutlined, &#123;</span></span><br><span class="line"><span class="language-xml">        className: &#x27;trigger&#x27;,</span></span><br><span class="line"><span class="language-xml">        onClick: () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      &#125;)&#125; */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          collapsed ? <span class="tag">&lt;<span class="name">MenuUnfoldOutlined</span>  <span class="attr">className</span>=<span class="string">&quot;trigger&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;/&gt; : <span class="tag">&lt;<span class="name">MenuFoldOutlined</span>  <span class="attr">className</span>=<span class="string">&quot;trigger&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AppBreadcrumb</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppHeader</span>;</span><br></pre></td></tr></table></figure><p>随之而来的问题就是，当点击面包屑导航时，地址栏的路由已经发生了跳转，但是左侧菜单栏数据效果没有实时更新（左侧菜单栏组件早就创建完毕，选中和打开的选项已经做了固定， 点击面包屑没有引起左侧菜单栏组件的状态以及属性的更新，左侧菜单栏不会重新渲染）</p><p>此时可以在左侧菜单栏组件监听 路由的变化 – -useEffect</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, <span class="title class_">Image</span>, <span class="title class_">MenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;@/logo.svg&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; renderMenu, getSubMenu &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useLocation, useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置只展开一个菜单项</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">rootSubmenuKeys</span>: <span class="built_in">string</span>[] = [];</span><br><span class="line">menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  item.<span class="property">children</span> &amp;&amp; rootSubmenuKeys.<span class="title function_">push</span>(item.<span class="property">key</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>);</span><br><span class="line">  <span class="comment">// 获取当前路由的路径信息</span></span><br><span class="line">  <span class="keyword">const</span> &#123; pathname &#125; = <span class="title function_">useLocation</span>()</span><br><span class="line">  <span class="comment">// 当前选中的菜单项key数组</span></span><br><span class="line">  <span class="comment">// 初始值设置为 [pathname],刷新进入选中某一个菜单项</span></span><br><span class="line">  <span class="keyword">const</span> [selectedKeys, setSelectedKeys] = <span class="title function_">useState</span>([pathname])</span><br><span class="line"></span><br><span class="line">  <span class="comment">// const [openKeys, setOpenKeys] = useState&lt;string[]&gt;([&#x27;/pro&#x27;, &#x27;/pro/list&#x27;])</span></span><br><span class="line">  <span class="keyword">const</span> [openKeys, setOpenKeys] = useState&lt;<span class="built_in">string</span>[]&gt;(<span class="title function_">getSubMenu</span>(pathname))</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 展开哪一项数据</span></span><br><span class="line">  <span class="comment">// const [openKeys, setOpenKeys] = useState&lt;string[]&gt;([])</span></span><br><span class="line">  <span class="comment">// 打开一个菜单项时，需要做判断 - SubMenu 展开/关闭的回调</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">onOpenChange</span>: <span class="title class_">MenuProps</span>[<span class="string">&#x27;onOpenChange&#x27;</span>] = <span class="function"><span class="params">keys</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 如果当前展开项是 轮播图管理，再点击 账户管理 [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="comment">// console.log(&#x27;keys&#x27;, keys) // [&#x27;/banner&#x27;] =&gt;  [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="comment">// console.log(&#x27;openKeys&#x27;, openKeys) // [] =&gt; [&#x27;/banner&#x27;]</span></span><br><span class="line">    <span class="comment">// 得到当前</span></span><br><span class="line">    <span class="keyword">const</span> latestOpenKey = keys.<span class="title function_">find</span>(<span class="function"><span class="params">key</span> =&gt;</span> openKeys.<span class="title function_">indexOf</span>(key) === -<span class="number">1</span>); </span><br><span class="line">    <span class="comment">// console.log(&#x27;latestOpenKey&#x27;, latestOpenKey) // /banner ===&gt; /account</span></span><br><span class="line">    <span class="keyword">if</span> (rootSubmenuKeys.<span class="title function_">indexOf</span>(latestOpenKey!) === -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(keys);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(latestOpenKey ? [latestOpenKey] : []);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 点击切换路由</span></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">changeUrl</span> = (<span class="params">&#123; key &#125;: &#123; key: <span class="built_in">string</span> &#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// console.log(key)</span></span><br><span class="line">    <span class="title function_">navigate</span>(key, &#123; <span class="attr">replace</span>: <span class="literal">false</span> &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点击左侧菜单，切换菜单项，选中样式</span></span><br><span class="line">    <span class="title function_">setSelectedKeys</span>([key])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听 pathname 的变化，然后调整左侧菜单打开和选中状态 ++++++++</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setSelectedKeys</span>([pathname])</span><br><span class="line">    <span class="title function_">setOpenKeys</span>(<span class="title function_">getSubMenu</span>(pathname))</span><br><span class="line">  &#125;, [pathname])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">color:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">logo</span> &#125; <span class="attr">width</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">preview</span>=<span class="string">&#123;</span> <span class="attr">false</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; !collapsed &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">height:</span> &#x27;<span class="attr">32px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">overflow:</span> &#x27;<span class="attr">hidden</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">lineHeight:</span> &#x27;<span class="attr">32px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span>嗨购后台管理系统<span class="tag">&lt;/<span class="name">div</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">openKeys</span> = <span class="string">&#123;</span> <span class="attr">openKeys</span> &#125; // <span class="attr">打开哪一个菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onOpenChange</span> = <span class="string">&#123;</span> <span class="attr">onOpenChange</span> &#125; // <span class="attr">打开某一个菜单项时需要关闭其他菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">changeUrl</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">selectedKeys</span> = <span class="string">&#123;</span> <span class="attr">selectedKeys</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          renderMenu(menus)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><h1 id="11-快捷切换页"><a href="#11-快捷切换页" class="headerlink" title="11.快捷切换页"></a>11.快捷切换页</h1><p><img src="/posts/60af50c8/image-20221025113910072.png" alt="image-20221025113910072"></p><ul><li>系统默认路由为系统首页，所以第一个就为系统首页，且系统首页不可关闭</li><li>切换路由，判断当前页面是否已存在，如果存在，找到列表项的索引值，设置该索引值选中效果，并且页面切换至该索引值</li><li>如果当前路由对应的页面不存在，则在最后添加一项新的数据，并且设置最后一项为选中项</li></ul><h2 id="11-1-准备组件"><a href="#11-1-准备组件" class="headerlink" title="11.1 准备组件"></a>11.1 准备组件</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppTabs.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppTabsProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppTabs</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppTabsProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">backgroundColor</span>&#x27;<span class="attr">:</span> &#x27;#<span class="attr">f66</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">height</span>&#x27;<span class="attr">:</span> <span class="attr">40</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &#125; &#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppTabs</span>;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/index.ts</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">SideBar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./SideBar&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">AppHeader</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AppHeader&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">AppMain</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AppMain&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">AppBreadcrumb</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AppBreadcrumb&#x27;</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">AppTabs</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./AppTabs&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/Index.tsx 主要的布局文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>  <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppHeader</span>, <span class="title class_">AppMain</span>, <span class="title class_">AppTabs</span>, <span class="title class_">SideBar</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./components&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span> <span class="attr">id</span>=<span class="string">&#x27;admin-app&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* 左侧菜单栏 */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">SideBar</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Layout</span> <span class="attr">className</span>=<span class="string">&quot;site-layout&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 头部 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">AppHeader</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 快捷切换组件 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">AppTabs</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 内容 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">AppMain</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="11-2-处理数据"><a href="#11-2-处理数据" class="headerlink" title="11.2 处理数据"></a>11.2 处理数据</h2><p>后期 监听地址栏 从tabsArr 中提取数据</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tabsArr = [&#123;<span class="string">&quot;label&quot;</span>:<span class="string">&quot;系统首页&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;/&quot;</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;label&quot;</span>:<span class="string">&quot;首页轮播图&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;/banner/home&quot;</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;label&quot;</span>:<span class="string">&quot;活动页轮播图&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;/banner/active&quot;</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;label&quot;</span>:<span class="string">&quot;首页产品列表&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;/pro/list/home&quot;</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;label&quot;</span>:<span class="string">&quot;详情推荐列表&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;/pro/list/detail&quot;</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;label&quot;</span>:<span class="string">&quot;购物车推荐列表&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;/pro/list/cart&quot;</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;label&quot;</span>:<span class="string">&quot;筛选列表&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;/pro/search&quot;</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;label&quot;</span>:<span class="string">&quot;用户列表&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;/account/userlist&quot;</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;label&quot;</span>:<span class="string">&quot;管理员列表&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;/account/adminlist&quot;</span>&#125;,</span><br><span class="line">&#123;<span class="string">&quot;label&quot;</span>:<span class="string">&quot;设置&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;/setting&quot;</span>&#125;]</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/utils.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Navigate</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 定义左侧菜单栏数据</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">renderMenu</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.SubMenu</span> <span class="attr">title</span> = <span class="string">&#123;</span> <span class="attr">item.label</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125; <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            renderMenu(item.children)</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Menu.SubMenu</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.Item</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125;&gt;</span>&#123; item.label &#125;<span class="tag">&lt;/<span class="name">Menu.Item</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义路由组件</span></span><br><span class="line"><span class="comment">// export const renderRoute = (menus: IMenuProps[]) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   return menus.map(item =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     if (item.children) &#123;</span></span><br><span class="line"><span class="comment">//       return (</span></span><br><span class="line"><span class="comment">//         &lt;Route key = &#123; item.key &#125; path = &#123; item.key &#125; element = &#123; item.element &#125;&gt;</span></span><br><span class="line"><span class="comment">//           &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="comment">//         &lt;/Route&gt;</span></span><br><span class="line"><span class="comment">//       )</span></span><br><span class="line"><span class="comment">//     &#125; else &#123;</span></span><br><span class="line"><span class="comment">//       return (</span></span><br><span class="line"><span class="comment">//         &lt;Route key = &#123; item.key &#125; path = &#123; item.key &#125; element = &#123; item.element &#125;&gt;</span></span><br><span class="line"><span class="comment">//         &lt;/Route&gt;</span></span><br><span class="line"><span class="comment">//       )</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// 定义路由组件  ---- 设置默认路由</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">renderRoute</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!!item.<span class="property">index</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">React.Fragment</span> <span class="attr">key</span>=<span class="string">&#123;item.key&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">index</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">replace</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">              &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!!item.<span class="property">index</span>) &#123; <span class="comment">// 如果index存在</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">React.Fragment</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">index</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">replace</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取当前 需要展开的菜单项（可展开二级以及三级乃至更多展开项）</span></span><br><span class="line"><span class="comment">// pathname  /pro/list/cart </span></span><br><span class="line"><span class="comment">//  ===&gt; [&#x27;/pro&#x27;, &#x27;/pro/list&#x27;, &#x27;/pro/list/cart&#x27;]</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getSubMenu</span> = (<span class="params">pathname: <span class="built_in">string</span></span>) =&gt; &#123; </span><br><span class="line">  <span class="comment">// 1.以 / 分割 pathname.split(&#x27;/&#x27;)  //  [&#x27;&#x27;, &#x27;pro&#x27;, &#x27;list&#x27;, &#x27;cart&#x27;]</span></span><br><span class="line">  <span class="keyword">const</span> pathArray = pathname.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">slice</span>(<span class="number">1</span>) <span class="comment">// [&#x27;pro&#x27;, &#x27;list&#x27;, &#x27;cart&#x27;]</span></span><br><span class="line">  <span class="comment">// console.log(pathArray) </span></span><br><span class="line">  <span class="keyword">const</span> result = pathArray.<span class="title function_">reduce</span>(<span class="function">(<span class="params">newArr, item, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// &#x27;/pro&#x27;</span></span><br><span class="line">    <span class="comment">// &#x27;/pro/list&#x27;</span></span><br><span class="line">    <span class="comment">// &#x27;pro/list/cart&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> str = newArr[index] + <span class="string">&#x27;/&#x27;</span> + item</span><br><span class="line">    <span class="comment">// [&#x27;&#x27;, &#x27;/pro&#x27;]</span></span><br><span class="line">    <span class="comment">// [&#x27;&#x27;, &#x27;/pro&#x27;, &#x27;/pro/list&#x27;]</span></span><br><span class="line">    <span class="comment">// [&#x27;&#x27;, &#x27;/pro&#x27;, &#x27;/pro/list&#x27;, &#x27;/pro/list/cart&#x27;]</span></span><br><span class="line">    newArr.<span class="title function_">push</span>(str)</span><br><span class="line">    <span class="keyword">return</span> newArr</span><br><span class="line">  &#125;, [<span class="string">&#x27;&#x27;</span>])</span><br><span class="line">  <span class="comment">// console.log(&#x27;result&#x27;, result)</span></span><br><span class="line">  <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ITabProps</span> &#123;</span><br><span class="line">  <span class="attr">label</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">key</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 提取快捷切换页的数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">tabsArr</span>: <span class="title class_">ITabProps</span>[] = []</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getTabsData</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// const tabsArr: ITabProps[] = []</span></span><br><span class="line">  menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="title function_">getTabsData</span>(item.<span class="property">children</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      tabsArr.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">label</span>: item.<span class="property">label</span>,</span><br><span class="line">        <span class="attr">key</span>: item.<span class="property">key</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> tabsArr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="11-3-监听路由添加数据"><a href="#11-3-监听路由添加数据" class="headerlink" title="11.3 监听路由添加数据"></a>11.3 监听路由添加数据</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppTabs.tsx</span></span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getTabsData &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Tag</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useLocation &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppTabsProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tabArrs = <span class="title function_">getTabsData</span>(menus)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(tabArrs)</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * [&#123;&quot;label&quot;:&quot;系统首页&quot;,&quot;key&quot;:&quot;/&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;首页轮播图&quot;,&quot;key&quot;:&quot;/banner/home&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;活动页轮播图&quot;,&quot;key&quot;:&quot;/banner/active&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;首页产品列表&quot;,&quot;key&quot;:&quot;/pro/list/home&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;详情推荐列表&quot;,&quot;key&quot;:&quot;/pro/list/detail&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;购物车推荐列表&quot;,&quot;key&quot;:&quot;/pro/list/cart&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;筛选列表&quot;,&quot;key&quot;:&quot;/pro/search&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;用户列表&quot;,&quot;key&quot;:&quot;/account/userlist&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;管理员列表&quot;,&quot;key&quot;:&quot;/account/adminlist&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;设置&quot;,&quot;key&quot;:&quot;/setting&quot;&#125;]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppTabs</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppTabsProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 获取当前的路由信息</span></span><br><span class="line">  <span class="keyword">const</span> &#123; pathname &#125; = <span class="title function_">useLocation</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 准备快捷导航的真实的数据</span></span><br><span class="line">  <span class="keyword">const</span> [arr, setArr] = <span class="title function_">useState</span>([&#123; <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>, <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span> &#125;])</span><br><span class="line">  <span class="comment">// 当前选中项</span></span><br><span class="line">  <span class="keyword">const</span> [current, setCurrent] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听路由</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> index = arr.<span class="title function_">findIndex</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">key</span> === pathname)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (index === -<span class="number">1</span>) &#123; <span class="comment">// 相当于现在展示数据数组arr中没有当前的页面</span></span><br><span class="line">      <span class="comment">// 从原始数据中获取值</span></span><br><span class="line">      <span class="keyword">const</span> item = tabArrs.<span class="title function_">find</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">key</span> === pathname) </span><br><span class="line">      <span class="keyword">const</span> newArr = arr</span><br><span class="line">      <span class="comment">// 如果item被查询到，将查询到的数据填充到arr中</span></span><br><span class="line">      item &amp;&amp; newArr.<span class="title function_">push</span>(item) <span class="comment">// 添加数据</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 修改状态</span></span><br><span class="line">      <span class="title function_">setArr</span>(newArr)</span><br><span class="line">      <span class="title function_">setCurrent</span>(arr.<span class="property">length</span> - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 当前的数据中含有此页面，只需要改变索引值</span></span><br><span class="line">      <span class="title function_">setCurrent</span>(index)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [pathname, arr])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">backgroundColor</span>&#x27;<span class="attr">:</span> &#x27;#<span class="attr">fff</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">height</span>&#x27;<span class="attr">:</span> <span class="attr">40</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">borderTop</span>&#x27;<span class="attr">:</span> &#x27;<span class="attr">1px</span> <span class="attr">solid</span> #<span class="attr">ccc</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">borderBottom</span>&#x27;<span class="attr">:</span> &#x27;<span class="attr">1px</span> <span class="attr">solid</span> #<span class="attr">ccc</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">overflow</span>&#x27;<span class="attr">:</span> &#x27;<span class="attr">auto</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">whiteSpace</span>&#x27;<span class="attr">:</span> &#x27;<span class="attr">nowrap</span>&#x27; // <span class="attr">不换行</span> <span class="attr">滚动条</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &#125; &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        arr &amp;&amp; arr.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Tag</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">height:</span> <span class="attr">36</span>, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">lineHeight:</span> &#x27;<span class="attr">36px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">marginTop:</span> <span class="attr">2</span>, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">marginLeft:</span> <span class="attr">5</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">color:</span> <span class="attr">current</span> === <span class="string">index</span> ? &#x27;#<span class="attr">fff</span>&#x27; <span class="attr">:</span> &#x27;#<span class="attr">333</span>&#x27; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              &#125; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">color</span> = <span class="string">&#123;</span> <span class="attr">current</span> === <span class="string">index</span> ? &#x27;#<span class="attr">108ee9</span>&#x27; <span class="attr">:</span> &#x27;#<span class="attr">efefef</span>&#x27; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &gt;</span></span></span><br><span class="line"><span class="language-xml">              &#123; item.label &#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppTabs</span>;</span><br></pre></td></tr></table></figure><h2 id="11-4-点击tab页切换路由-关闭效果"><a href="#11-4-点击tab页切换路由-关闭效果" class="headerlink" title="11.4 点击tab页切换路由,关闭效果"></a>11.4 点击tab页切换路由,关闭效果</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppTabs.tsx</span></span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getTabsData &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Tag</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useLocation, useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppTabsProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tabArrs = <span class="title function_">getTabsData</span>(menus)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(tabArrs)</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * [&#123;&quot;label&quot;:&quot;系统首页&quot;,&quot;key&quot;:&quot;/&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;首页轮播图&quot;,&quot;key&quot;:&quot;/banner/home&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;活动页轮播图&quot;,&quot;key&quot;:&quot;/banner/active&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;首页产品列表&quot;,&quot;key&quot;:&quot;/pro/list/home&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;详情推荐列表&quot;,&quot;key&quot;:&quot;/pro/list/detail&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;购物车推荐列表&quot;,&quot;key&quot;:&quot;/pro/list/cart&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;筛选列表&quot;,&quot;key&quot;:&quot;/pro/search&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;用户列表&quot;,&quot;key&quot;:&quot;/account/userlist&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;管理员列表&quot;,&quot;key&quot;:&quot;/account/adminlist&quot;&#125;,</span></span><br><span class="line"><span class="comment"> &#123;&quot;label&quot;:&quot;设置&quot;,&quot;key&quot;:&quot;/setting&quot;&#125;]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppTabs</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppTabsProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 获取当前的路由信息</span></span><br><span class="line">  <span class="keyword">const</span> &#123; pathname &#125; = <span class="title function_">useLocation</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 准备快捷导航的真实的数据</span></span><br><span class="line">  <span class="keyword">const</span> [arr, setArr] = <span class="title function_">useState</span>([&#123; <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>, <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span> &#125;])</span><br><span class="line">  <span class="comment">// 当前选中项</span></span><br><span class="line">  <span class="keyword">const</span> [current, setCurrent] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听路由</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> index = arr.<span class="title function_">findIndex</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">key</span> === pathname)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (index === -<span class="number">1</span>) &#123; <span class="comment">// 相当于现在展示数据数组arr中没有当前的页面</span></span><br><span class="line">      <span class="comment">// 从原始数据中获取值</span></span><br><span class="line">      <span class="keyword">const</span> item = tabArrs.<span class="title function_">find</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">key</span> === pathname) </span><br><span class="line">      <span class="keyword">const</span> newArr = arr</span><br><span class="line">      <span class="comment">// 如果item被查询到，将查询到的数据填充到arr中</span></span><br><span class="line">      item &amp;&amp; newArr.<span class="title function_">push</span>(item) <span class="comment">// 添加数据</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 修改状态</span></span><br><span class="line">      <span class="title function_">setArr</span>(newArr)</span><br><span class="line">      <span class="title function_">setCurrent</span>(arr.<span class="property">length</span> - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 当前的数据中含有此页面，只需要改变索引值</span></span><br><span class="line">      <span class="title function_">setCurrent</span>(index)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [pathname, arr])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">backgroundColor</span>&#x27;<span class="attr">:</span> &#x27;#<span class="attr">fff</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">height</span>&#x27;<span class="attr">:</span> <span class="attr">36</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">borderTop</span>&#x27;<span class="attr">:</span> &#x27;<span class="attr">1px</span> <span class="attr">solid</span> #<span class="attr">ccc</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">borderBottom</span>&#x27;<span class="attr">:</span> &#x27;<span class="attr">1px</span> <span class="attr">solid</span> #<span class="attr">ccc</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">overflow</span>&#x27;<span class="attr">:</span> &#x27;<span class="attr">auto</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#x27;<span class="attr">whiteSpace</span>&#x27;<span class="attr">:</span> &#x27;<span class="attr">nowrap</span>&#x27; // <span class="attr">不换行</span> <span class="attr">滚动条</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &#125; &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        arr &amp;&amp; arr.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Tag</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">height:</span> <span class="attr">32</span>, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">lineHeight:</span> &#x27;<span class="attr">32px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">marginTop:</span> <span class="attr">2</span>, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">marginLeft:</span> <span class="attr">5</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">color:</span> <span class="attr">current</span> === <span class="string">index</span> ? &#x27;#<span class="attr">fff</span>&#x27; <span class="attr">:</span> &#x27;#<span class="attr">333</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">cursor:</span> &#x27;<span class="attr">pointer</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              &#125; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">color</span> = <span class="string">&#123;</span> <span class="attr">current</span> === <span class="string">index</span> ? &#x27;#<span class="attr">108ee9</span>&#x27; <span class="attr">:</span> &#x27;#<span class="attr">efefef</span>&#x27; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">onClick</span> = <span class="string">&#123;</span> () =&gt;</span> &#123;// ++++++</span></span><br><span class="line"><span class="language-xml">                navigate(item.key, &#123; replace: false &#125;)</span></span><br><span class="line"><span class="language-xml">                setCurrent(index)</span></span><br><span class="line"><span class="language-xml">              &#125;&#125;</span></span><br><span class="line"><span class="language-xml">              closable = &#123; current === index &amp;&amp; index !== 0 &#125; // ++++++</span></span><br><span class="line"><span class="language-xml">              onClose = &#123; (e) =&gt; &#123; // ++++++</span></span><br><span class="line"><span class="language-xml">                e.preventDefault()</span></span><br><span class="line"><span class="language-xml">                arr.splice(index, 1)</span></span><br><span class="line"><span class="language-xml">                setArr(arr)</span></span><br><span class="line"><span class="language-xml">                setCurrent(index - 1)</span></span><br><span class="line"><span class="language-xml">                navigate(arr[current - 1].key, &#123; replace: false &#125;)</span></span><br><span class="line"><span class="language-xml">              &#125;&#125;</span></span><br><span class="line"><span class="language-xml">            &gt;</span></span><br><span class="line"><span class="language-xml">              &#123; item.label &#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppTabs</span>;</span><br></pre></td></tr></table></figure><h1 id="12-数据请求的封装"><a href="#12-数据请求的封装" class="headerlink" title="12.数据请求的封装"></a>12.数据请求的封装</h1><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/utils/request.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; message &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios, &#123; <span class="title class_">AxiosRequestConfig</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;store2&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isDev = process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;development&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: isDev ? <span class="string">&#x27;http://121.89.205.189:3000/admin&#x27;</span> : <span class="string">&#x27;http://121.89.205.189:3000/admin&#x27;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">6000</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求拦截器封装</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 可以从本地获取用户的信息，如果用户的信息存在，提取Token,通过头信息传递给服务器</span></span><br><span class="line">  <span class="comment">// 以前给本地存储中存储多个数据，本项目存储的是一个对象 &#123; loginState: true, adminname: &#x27;&#x27;, &#x27;X-Token&#x27;: &#x27;&#x27;, role: 1, checkedKeys: []&#125;</span></span><br><span class="line">  <span class="keyword">const</span> storeUsers = store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>) <span class="comment">// 存的时候就是存的对象</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 传递token信息</span></span><br><span class="line">  config.<span class="property">headers</span>!.<span class="property">token</span> = storeUsers &amp;&amp; (storeUsers[<span class="string">&#x27;X-Token&#x27;</span>] || <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>) =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器封装</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">response: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 验证token</span></span><br><span class="line">  <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="string">&#x27;10119&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// token 无效</span></span><br><span class="line">    message.<span class="title function_">warning</span>(<span class="string">&#x27;登录失效，请重新登录&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 防止后期系统首页以及登录来回切换</span></span><br><span class="line">    store.<span class="title function_">remove</span>(<span class="string">&#x27;haigou-users&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 跳转到登录页面 --- 如果使用的是 HashRouter ,此处地址需要改为 &#x27;/#/login&#x27;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;/login&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 登录成功 放行</span></span><br><span class="line">  <span class="keyword">return</span> response</span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>) =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义各种常用的restful api的请求</span></span><br><span class="line"><span class="comment">// axios.get(&#x27;url&#x27;, &#123; params: &#123; key: value &#125; &#125;)</span></span><br><span class="line"><span class="comment">// axios.post(&#x27;url&#x27;, &#123; key: value &#125;)</span></span><br><span class="line"><span class="comment">// axios(&#123; url: &#x27;&#x27;, method: &#x27;GET&#x27;, params: &#123; key: value &#125;&#125;)</span></span><br><span class="line"><span class="comment">// axios(&#123; url: &#x27;&#x27;, method: &#x27;POST&#x27;, data: &#123; key: value &#125;&#125;)</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">request</span>(<span class="params"> config: AxiosRequestConfig </span>) &#123;</span><br><span class="line">  <span class="comment">// 接口请求 必须参数  url method  data  headers</span></span><br><span class="line">  <span class="keyword">const</span> &#123; url = <span class="string">&#x27;&#x27;</span>, method = <span class="string">&#x27;GET&#x27;</span>, data = &#123;&#125;, headers = &#123;&#125; &#125; = config</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 区分不同的数据请求 为了执行时传入的数据请求方式统一性 GEt GeT get GET</span></span><br><span class="line">  <span class="keyword">switch</span> (method.<span class="title function_">toUpperCase</span>()) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> instance.<span class="title function_">get</span>(url, &#123; <span class="attr">params</span>: data &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;POST&#x27;</span>: </span><br><span class="line">      <span class="comment">// 可能数据请求方式 表单提交  文件提交   默认json</span></span><br><span class="line">      <span class="comment">// 表单提交</span></span><br><span class="line">      <span class="keyword">if</span> (headers[<span class="string">&#x27;content-type&#x27;</span>] === <span class="string">&#x27;application/x-www-form-url-encoded&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// 转换参数  URLSearchParams  / 第三方库 qs</span></span><br><span class="line">        <span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>()</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">          p.<span class="title function_">append</span>(key, data[key])</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance.<span class="title function_">post</span>(url, p, &#123; headers &#125;)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 文件提交</span></span><br><span class="line">      <span class="keyword">if</span> (headers[<span class="string">&#x27;content-type&#x27;</span>] === <span class="string">&#x27;multipart/form-data&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> p = <span class="keyword">new</span> <span class="title class_">FormData</span>()</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">          p.<span class="title function_">append</span>(key, data[key])</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance.<span class="title function_">post</span>(url, p, &#123; headers &#125;)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 默认 application/json</span></span><br><span class="line">      <span class="keyword">return</span> instance.<span class="title function_">post</span>(url, data)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 修改数据 - 所有的数据的更新</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;PUT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> instance.<span class="title function_">put</span>(url, data)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除数据</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DELETE&#x27;</span>: </span><br><span class="line">      <span class="keyword">return</span> instance.<span class="title function_">delete</span>(url, &#123; data &#125;)  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 修改数据 - 部分的数据的更新</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;PATCH&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> instance.<span class="title function_">patch</span>(url, data)</span><br><span class="line"></span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">instance</span>(config)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>按照思维来看，此时需要请求以及渲染轮播图管理相关功能，但是查看后端接口，发现基本所有的借口都需要基于 token，那么需要首先完成登录功能</p><p>接口文档：<a target="_blank" rel="noopener" href="http://121.89.205.189:3000/admindoc/">http://121.89.205.189:3000/admindoc/</a></p><h1 id="13-构建登录页面"><a href="#13-构建登录页面" class="headerlink" title="13 构建登录页面"></a>13 构建登录页面</h1><h2 id="13-1-参考组件库组件"><a href="#13-1-参考组件库组件" class="headerlink" title="13.1 参考组件库组件"></a>13.1 参考组件库组件</h2><p><a target="_blank" rel="noopener" href="https://ant-design.gitee.io/components/form-cn/#components-form-demo-normal-login">https://ant-design.gitee.io/components/form-cn/#components-form-demo-normal-login</a></p><h2 id="13-2-构造登录接口API"><a href="#13-2-构造登录接口API" class="headerlink" title="13.2 构造登录接口API"></a>13.2 构造登录接口API</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/api/admin.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IAdminParams</span> &#123;</span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">password</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">adminLoginFn</span> (<span class="attr">params</span>: <span class="title class_">IAdminParams</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/admin/login&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="13-3-创建登录的页面"><a href="#13-3-创建登录的页面" class="headerlink" title="13.3 创建登录的页面"></a>13.3 创建登录的页面</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/login/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ILoginProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Login</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ILoginProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>登录页面<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Login</span>;</span><br></pre></td></tr></table></figure><h2 id="13-4-创建登录路由"><a href="#13-4-创建登录路由" class="headerlink" title="13.4 创建登录路由"></a>13.4 创建登录路由</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/App.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Index</span> <span class="keyword">from</span> <span class="string">&#x27;@/layout/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/login/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Routes</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// reactrouterv6版本中需要加* </span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Login</span> /&gt;</span> &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/*&quot;</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Index</span> /&gt;</span> &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p>地址栏访问 <code>http://localhost:3000/login</code> 即可看到登录页面出现，其余路由还保持和之前一致</p><h2 id="13-4-完善登录界面"><a href="#13-4-完善登录界面" class="headerlink" title="13.4 完善登录界面"></a>13.4 完善登录界面</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/login/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LockOutlined</span>, <span class="title class_">UserOutlined</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span>, <span class="title class_">Form</span>, <span class="title class_">Input</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.less&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onFinish</span> = (<span class="params">values: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Received values of form: &#x27;</span>, values);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;loginForm&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;loginBox&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>嗨购管理系统<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Form</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">name</span>=<span class="string">&quot;normal_login&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">className</span>=<span class="string">&quot;login-form&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">initialValues</span>=<span class="string">&#123;&#123;</span> // <span class="attr">表单自动填充的字段</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">adminname:</span> &#x27;<span class="attr">admin</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">password:</span> &#x27;<span class="attr">123456</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onFinish</span>=<span class="string">&#123;onFinish&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">name</span>=<span class="string">&quot;adminname&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">rules</span>=<span class="string">&#123;[&#123;</span> <span class="attr">required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请输入管理员账户</span>!&#x27; &#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Input</span> <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">UserOutlined</span> <span class="attr">className</span>=<span class="string">&quot;site-form-item-icon&quot;</span> /&gt;</span>&#125; placeholder=&quot;账户&quot; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">name</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">rules</span>=<span class="string">&#123;[&#123;</span> <span class="attr">required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请输入密码</span>!&#x27; &#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">LockOutlined</span> <span class="attr">className</span>=<span class="string">&quot;site-form-item-icon&quot;</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">              type=&quot;password&quot;</span></span><br><span class="line"><span class="language-xml">              placeholder=&quot;密码&quot;</span></span><br><span class="line"><span class="language-xml">            /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          </span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">htmlType</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">className</span>=<span class="string">&quot;login-form-button&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              登 录</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/login/style.less</span></span><br><span class="line"><span class="selector-id">#loginForm</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">background</span>: url(<span class="string">https://cas.1000phone.net/cas/images/login/bg.png</span>) no-repeat center center;</span><br><span class="line">  <span class="attribute">background-size</span>: cover;</span><br><span class="line">  <span class="selector-class">.loginBox</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">50px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="selector-class">.login-form</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-id">#loginForm</span> <span class="selector-class">.login-form-forgot</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#loginForm</span> <span class="selector-class">.ant-col-rtl</span> <span class="selector-class">.login-form-forgot</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#loginForm</span> <span class="selector-class">.login-form-button</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用状态管理器，异步操作可以在组件，也可以在状态管理器</p><h1 id="14-执行登录"><a href="#14-执行登录" class="headerlink" title="14 执行登录"></a>14 执行登录</h1><p>使用状态管理器（RTK）管理登录信息。</p><h2 id="14-1-构建模块-admins"><a href="#14-1-构建模块-admins" class="headerlink" title="14.1 构建模块 admins"></a>14.1 构建模块 admins</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/store/modules/admins.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice, <span class="title class_">PayloadAction</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;store2&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IAdminState</span> &#123;</span><br><span class="line">  <span class="attr">loginState</span>: <span class="built_in">boolean</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">token</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const initialState: IAdminState = store.get(&#x27;haigou-users&#x27;) ? &#123;</span></span><br><span class="line"><span class="comment">//   loginState: store.get(&#x27;haigou-users&#x27;)[&#x27;loginState&#x27;],</span></span><br><span class="line"><span class="comment">//   adminname: store.get(&#x27;haigou-users&#x27;)[&#x27;adminname&#x27;],</span></span><br><span class="line"><span class="comment">//   token: store.get(&#x27;haigou-users&#x27;)[&#x27;X-Token&#x27;],</span></span><br><span class="line"><span class="comment">//   role: store.get(&#x27;haigou-users&#x27;)[&#x27;role&#x27;],</span></span><br><span class="line"><span class="comment">//   checkedKeys: store.get(&#x27;haigou-users&#x27;)[&#x27;checkedKeys&#x27;]</span></span><br><span class="line"><span class="comment">// &#125; : &#123;</span></span><br><span class="line"><span class="comment">//   loginState: false,</span></span><br><span class="line"><span class="comment">//   adminname: &#x27;&#x27;,</span></span><br><span class="line"><span class="comment">//   token: &#x27;&#x27;,</span></span><br><span class="line"><span class="comment">//   role: 0,</span></span><br><span class="line"><span class="comment">//   checkedKeys: []</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">initialState</span>: <span class="title class_">IAdminState</span> =  &#123;</span><br><span class="line">  <span class="attr">loginState</span>: store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>) ? store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>)[<span class="string">&#x27;loginState&#x27;</span>] : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">adminname</span>: store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>) ? store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>)[<span class="string">&#x27;adminname&#x27;</span>] : <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">token</span>: store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>) ? store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>)[<span class="string">&#x27;X-Token&#x27;</span>] : <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">role</span>: store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>) ? store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>)[<span class="string">&#x27;role&#x27;</span>] : <span class="number">0</span>,</span><br><span class="line">  <span class="attr">checkedKeys</span>: store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>) ? store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>)[<span class="string">&#x27;checkedKeys&#x27;</span>] : []</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">const</span> adminSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;admins&#x27;</span>,</span><br><span class="line">  initialState,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    changeLoginState (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">boolean</span>&gt;) &#123;</span><br><span class="line">      state.<span class="property">loginState</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;,</span><br><span class="line">    changeAdminName (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">string</span>&gt;) &#123;</span><br><span class="line">      state.<span class="property">adminname</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;,</span><br><span class="line">    changeToken (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">string</span>&gt;) &#123;</span><br><span class="line">      state.<span class="property">token</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;,</span><br><span class="line">    changeRole (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">number</span>&gt;) &#123;</span><br><span class="line">      state.<span class="property">role</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;,</span><br><span class="line">    changecheckedKeys (state, <span class="attr">action</span>: <span class="title class_">PayloadAction</span>&lt;<span class="built_in">any</span>[]&gt;) &#123;</span><br><span class="line">      state.<span class="property">checkedKeys</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123;</span><br><span class="line">  changeLoginState,</span><br><span class="line">  changeAdminName,</span><br><span class="line">  changeToken,</span><br><span class="line">  changeRole,</span><br><span class="line">  changecheckedKeys</span><br><span class="line">&#125; = adminSlice.<span class="property">actions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> adminSlice.<span class="property">reducer</span></span><br></pre></td></tr></table></figure><h2 id="14-2-装载模块"><a href="#14-2-装载模块" class="headerlink" title="14.2 装载模块"></a>14.2 装载模块</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/store/index.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> appReducer <span class="keyword">from</span> <span class="string">&#x27;./modules/app&#x27;</span></span><br><span class="line"><span class="keyword">import</span> adminReducer <span class="keyword">from</span> <span class="string">&#x27;./modules/admins&#x27;</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123; <span class="comment">// 整合模块</span></span><br><span class="line">    <span class="attr">app</span>: appReducer,</span><br><span class="line">    <span class="attr">admins</span>: adminReducer</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// redux store  store.getState  store.subscribe  store.dispatch</span></span><br><span class="line"><span class="comment">// 定义State和dispatch类型  从 store 本身推断出 `RootState` 和 `AppDispatch` 类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">RootState</span> = <span class="title class_">ReturnType</span>&lt;<span class="keyword">typeof</span> store.<span class="property">getState</span>&gt; <span class="comment">// js 不需要</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">AppDispatch</span> = <span class="keyword">typeof</span> store.<span class="property">dispatch</span> <span class="comment">// js 不需要</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure><h2 id="14-3-登录实现"><a href="#14-3-登录实现" class="headerlink" title="14.3 登录实现"></a>14.3 登录实现</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/login/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IAdminParams</span>, adminLoginFn &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LockOutlined</span>, <span class="title class_">UserOutlined</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span>, <span class="title class_">Form</span>, <span class="title class_">Input</span>, message &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;store2&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.less&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppDispatch &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; changeAdminName, changecheckedKeys, changeLoginState, changeRole, changeToken &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/modules/admins&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useAppDispatch</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onFinish</span> = (<span class="params">values: IAdminParams</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">adminLoginFn</span>(values).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="keyword">switch</span> (res.<span class="property">data</span>.<span class="property">code</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;10003&#x27;</span>:</span><br><span class="line">          message.<span class="title function_">error</span>(<span class="string">&#x27;密码错误&#x27;</span>)</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;10005&#x27;</span>:</span><br><span class="line">          message.<span class="title function_">error</span>(<span class="string">&#x27;没有该账户，请联系超管&#x27;</span>)</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">          message.<span class="title function_">success</span>(<span class="string">&#x27;登录成功&#x27;</span>)</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 存信息到本地以及状态管理器</span></span><br><span class="line">          <span class="keyword">const</span> result = res.<span class="property">data</span>.<span class="property">data</span></span><br><span class="line">          <span class="keyword">const</span> haigouUsers = &#123;</span><br><span class="line">            <span class="attr">loginState</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="string">&#x27;X-Token&#x27;</span>: result.<span class="property">token</span>,</span><br><span class="line">            <span class="attr">adminname</span>: result.<span class="property">adminname</span>,</span><br><span class="line">            <span class="attr">role</span>: result.<span class="property">role</span>,</span><br><span class="line">            <span class="attr">checkedKeys</span>: result.<span class="property">checkedkeys</span></span><br><span class="line">          &#125;</span><br><span class="line">          store.<span class="title function_">set</span>(<span class="string">&#x27;haigou-users&#x27;</span>, haigouUsers)</span><br><span class="line"></span><br><span class="line">          <span class="title function_">dispatch</span>(<span class="title function_">changeLoginState</span>(<span class="literal">true</span>))</span><br><span class="line">          <span class="title function_">dispatch</span>(<span class="title function_">changeAdminName</span>(result.<span class="property">adminname</span>))</span><br><span class="line">          <span class="title function_">dispatch</span>(<span class="title function_">changeToken</span>(result.<span class="property">token</span>))</span><br><span class="line">          <span class="title function_">dispatch</span>(<span class="title function_">changeRole</span>(result.<span class="property">role</span>))</span><br><span class="line">          <span class="title function_">dispatch</span>(<span class="title function_">changecheckedKeys</span>(result.<span class="property">checkedkeys</span>))</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 跳转到系统首页</span></span><br><span class="line">          <span class="title function_">navigate</span>(<span class="string">&#x27;/&#x27;</span>, &#123; <span class="attr">replace</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;loginForm&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;loginBox&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>嗨购管理系统<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Form</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">name</span>=<span class="string">&quot;normal_login&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">className</span>=<span class="string">&quot;login-form&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">initialValues</span>=<span class="string">&#123;&#123;</span> // <span class="attr">表单自动填充的字段</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">adminname:</span> &#x27;<span class="attr">admin</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">password:</span> &#x27;<span class="attr">123456</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onFinish</span>=<span class="string">&#123;onFinish&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">name</span>=<span class="string">&quot;adminname&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">rules</span>=<span class="string">&#123;[&#123;</span> <span class="attr">required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请输入管理员账户</span>!&#x27; &#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Input</span> <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">UserOutlined</span> <span class="attr">className</span>=<span class="string">&quot;site-form-item-icon&quot;</span> /&gt;</span>&#125; placeholder=&quot;账户&quot; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">name</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">rules</span>=<span class="string">&#123;[&#123;</span> <span class="attr">required:</span> <span class="attr">true</span>, <span class="attr">message:</span> &#x27;<span class="attr">请输入密码</span>!&#x27; &#125;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">LockOutlined</span> <span class="attr">className</span>=<span class="string">&quot;site-form-item-icon&quot;</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">              type=&quot;password&quot;</span></span><br><span class="line"><span class="language-xml">              placeholder=&quot;密码&quot;</span></span><br><span class="line"><span class="language-xml">            /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          </span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">htmlType</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">className</span>=<span class="string">&quot;login-form-button&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              登 录</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h1 id="15-前端登录验证"><a href="#15-前端登录验证" class="headerlink" title="15.前端登录验证"></a>15.前端登录验证</h1><p>当前路由在登录页面，判断用户的登录状态，如果登录，则跳转到系统的首页，如果未登录，显示登录页面</p><p>当前路由在非登录页面，判断用户的登录状态，如果登录，则显示非登录页面，如果未登录，跳转到登录页面</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/App.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Index</span> <span class="keyword">from</span> <span class="string">&#x27;@/layout/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/login/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Routes</span>, <span class="title class_">Route</span>, <span class="title class_">Navigate</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;./store/hook&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> loginState = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">admins</span>.<span class="property">loginState</span>)</span><br><span class="line">  <span class="comment">// reactrouterv6版本中需要加* </span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">loginState</span> ? &lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>/&gt;</span> : <span class="tag">&lt;<span class="name">Login</span> /&gt;</span> &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/*&quot;</span> <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">loginState</span> ? &lt;<span class="attr">Index</span> /&gt;</span> : <span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span> /&gt;</span> &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h1 id="16-后端token校验"><a href="#16-后端token校验" class="headerlink" title="16 .后端token校验"></a>16 .后端token校验</h1><p>封装axios时已经实现 — 响应拦截器</p><p>后台管理系统都需要请求数据，而请求数据 都需要添加token字段</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/utils/request.ts</span></span><br><span class="line">....</span><br><span class="line"><span class="comment">// 请求拦截器封装</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 可以从本地获取用户的信息，如果用户的信息存在，提取Token,通过头信息传递给服务器</span></span><br><span class="line">  <span class="comment">// 以前给本地存储中存储多个数据，本项目存储的是一个对象 &#123; loginState: true, adminname: &#x27;&#x27;, &#x27;X-Token&#x27;: &#x27;&#x27;, role: 1, checkedKeys: []&#125;</span></span><br><span class="line">  <span class="keyword">const</span> storeUsers = store.<span class="title function_">get</span>(<span class="string">&#x27;haigou-users&#x27;</span>) <span class="comment">// 存的时候就是存的对象</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 传递token信息</span></span><br><span class="line">  config.<span class="property">headers</span>!.<span class="property">token</span> = storeUsers &amp;&amp; (storeUsers[<span class="string">&#x27;X-Token&#x27;</span>] || <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>) =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器封装</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">response: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 验证token</span></span><br><span class="line">  <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="string">&#x27;10119&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// token 无效</span></span><br><span class="line">    message.<span class="title function_">warning</span>(<span class="string">&#x27;登录失效，请重新登录&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 防止后期系统首页以及登录来回切换</span></span><br><span class="line">    store.<span class="title function_">remove</span>(<span class="string">&#x27;haigou-users&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 跳转到登录页面 --- 如果使用的是 HashRouter ,此处地址需要改为 &#x27;/#/login&#x27;</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;/login&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 登录成功 放行</span></span><br><span class="line">  <span class="keyword">return</span> response</span><br><span class="line">&#125;, <span class="function">(<span class="params">error</span>) =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error))</span><br><span class="line">....</span><br></pre></td></tr></table></figure><h1 id="17-退出登录"><a href="#17-退出登录" class="headerlink" title="17.退出登录"></a>17.退出登录</h1><h2 id="17-1-实现退出登录"><a href="#17-1-实现退出登录" class="headerlink" title="17.1 实现退出登录"></a>17.1 实现退出登录</h2><p><a target="_blank" rel="noopener" href="https://ant-design.gitee.io/components/dropdown-cn/#components-dropdown-demo-trigger">https://ant-design.gitee.io/components/dropdown-cn/#components-dropdown-demo-trigger</a></p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppHeader.tsx 头部组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">MenuFoldOutlined</span>,</span><br><span class="line">  <span class="title class_">MenuUnfoldOutlined</span>,</span><br><span class="line">  <span class="title class_">DownOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Dropdown</span>, <span class="title class_">Space</span>, <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppDispatch, useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setCollapsed &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/modules/app&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AppBreadcrumb</span> <span class="keyword">from</span> <span class="string">&#x27;./AppBreadcrumb&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;store2&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; changeLoginState &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/modules/admins&#x27;</span>;</span><br><span class="line"><span class="comment">// import &#123; useDispatch &#125; from &#x27;react-redux&#x27;;</span></span><br><span class="line"><span class="comment">// import &#123; AppDispatch &#125; from &#x27;@/store&#x27;;</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Header</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppHeaderProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppHeader</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppHeaderProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// const [collapsed, setCollapsed] = useState(false);</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// const dispatch: AppDispatch = useDispatch() // ts中添加类型注解</span></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useAppDispatch</span>() <span class="comment">// ts推荐写法</span></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line">  <span class="keyword">const</span> menu = (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">onClick</span>=<span class="string">&#123;</span> (&#123;<span class="attr">key</span>&#125;) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        console.log(key)</span></span><br><span class="line"><span class="language-xml">        if (key === &#x27;/setting&#x27;) &#123;</span></span><br><span class="line"><span class="language-xml">          navigate(key)</span></span><br><span class="line"><span class="language-xml">        &#125; else if (key === &#x27;logout&#x27;)&#123;</span></span><br><span class="line"><span class="language-xml">          store.remove(&#x27;haigou-users&#x27;)</span></span><br><span class="line"><span class="language-xml">          dispatch(changeLoginState(false))</span></span><br><span class="line"><span class="language-xml">          navigate(&#x27;/login&#x27;)</span></span><br><span class="line"><span class="language-xml">        &#125; else &#123;</span></span><br><span class="line"><span class="language-xml">          // 其余选项</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      items=&#123;[</span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          label: &#x27;设置&#x27;,</span></span><br><span class="line"><span class="language-xml">          key: &#x27;/setting&#x27;,</span></span><br><span class="line"><span class="language-xml">        &#125;,</span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          type: &#x27;divider&#x27;,</span></span><br><span class="line"><span class="language-xml">        &#125;,</span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          label: &#x27;退出&#x27;,</span></span><br><span class="line"><span class="language-xml">          key: &#x27;logout&#x27;,</span></span><br><span class="line"><span class="language-xml">        &#125;,</span></span><br><span class="line"><span class="language-xml">      ]&#125;</span></span><br><span class="line"><span class="language-xml">    /&gt;</span></span><br><span class="line">  );</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> adminname = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">admins</span>.<span class="property">adminname</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Header</span> <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> <span class="attr">0</span>, <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;  &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* &#123;React.createElement(collapsed ? MenuUnfoldOutlined : MenuFoldOutlined, &#123;</span></span><br><span class="line"><span class="language-xml">        className: &#x27;trigger&#x27;,</span></span><br><span class="line"><span class="language-xml">        onClick: () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      &#125;)&#125; */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          collapsed ? <span class="tag">&lt;<span class="name">MenuUnfoldOutlined</span>  <span class="attr">className</span>=<span class="string">&quot;trigger&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;/&gt; : <span class="tag">&lt;<span class="name">MenuFoldOutlined</span>  <span class="attr">className</span>=<span class="string">&quot;trigger&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AppBreadcrumb</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">position:</span> &#x27;<span class="attr">absolute</span>&#x27;, <span class="attr">right:</span> &#x27;<span class="attr">16px</span>&#x27;  &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Dropdown</span> <span class="attr">overlay</span>=<span class="string">&#123;menu&#125;</span> <span class="attr">trigger</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">click</span>&#x27;]&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              &#123; adminname &#125;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">DownOutlined</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Dropdown</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppHeader</span>;</span><br></pre></td></tr></table></figure><h2 id="17-2-保留退出时的页面"><a href="#17-2-保留退出时的页面" class="headerlink" title="17.2 保留退出时的页面"></a>17.2 保留退出时的页面</h2><p>先获取退出登陆时 路由的地址</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppHeader.tsx 头部组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">MenuFoldOutlined</span>,</span><br><span class="line">  <span class="title class_">MenuUnfoldOutlined</span>,</span><br><span class="line">  <span class="title class_">DownOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Dropdown</span>, <span class="title class_">Space</span>, <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppDispatch, useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setCollapsed &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/modules/app&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AppBreadcrumb</span> <span class="keyword">from</span> <span class="string">&#x27;./AppBreadcrumb&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useLocation, useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;store2&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; changeLoginState &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/modules/admins&#x27;</span>;</span><br><span class="line"><span class="comment">// import &#123; useDispatch &#125; from &#x27;react-redux&#x27;;</span></span><br><span class="line"><span class="comment">// import &#123; AppDispatch &#125; from &#x27;@/store&#x27;;</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Header</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppHeaderProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppHeader</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppHeaderProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// const [collapsed, setCollapsed] = useState(false);</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// const dispatch: AppDispatch = useDispatch() // ts中添加类型注解</span></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useAppDispatch</span>() <span class="comment">// ts推荐写法</span></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line">  <span class="keyword">const</span> &#123; pathname &#125; = <span class="title function_">useLocation</span>() <span class="comment">// 当前页面地址 // +++++++++</span></span><br><span class="line">  <span class="keyword">const</span> menu = (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">onClick</span>=<span class="string">&#123;</span> (&#123;<span class="attr">key</span>&#125;) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        console.log(key)</span></span><br><span class="line"><span class="language-xml">        if (key === &#x27;/setting&#x27;) &#123;</span></span><br><span class="line"><span class="language-xml">          navigate(key)</span></span><br><span class="line"><span class="language-xml">        &#125; else if (key === &#x27;logout&#x27;)&#123;</span></span><br><span class="line"><span class="language-xml">          store.remove(&#x27;haigou-users&#x27;)</span></span><br><span class="line"><span class="language-xml">          dispatch(changeLoginState(false))</span></span><br><span class="line"><span class="language-xml">          navigate(&#x27;/login?r=&#x27; + pathname) // +++++++++</span></span><br><span class="line"><span class="language-xml">        &#125; else &#123;</span></span><br><span class="line"><span class="language-xml">          // 其余选项</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      items=&#123;[</span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          label: &#x27;设置&#x27;,</span></span><br><span class="line"><span class="language-xml">          key: &#x27;/setting&#x27;,</span></span><br><span class="line"><span class="language-xml">        &#125;,</span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          type: &#x27;divider&#x27;,</span></span><br><span class="line"><span class="language-xml">        &#125;,</span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          label: &#x27;退出&#x27;,</span></span><br><span class="line"><span class="language-xml">          key: &#x27;logout&#x27;,</span></span><br><span class="line"><span class="language-xml">        &#125;,</span></span><br><span class="line"><span class="language-xml">      ]&#125;</span></span><br><span class="line"><span class="language-xml">    /&gt;</span></span><br><span class="line">  );</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> adminname = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">admins</span>.<span class="property">adminname</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Header</span> <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> <span class="attr">0</span>, <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;  &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* &#123;React.createElement(collapsed ? MenuUnfoldOutlined : MenuFoldOutlined, &#123;</span></span><br><span class="line"><span class="language-xml">        className: &#x27;trigger&#x27;,</span></span><br><span class="line"><span class="language-xml">        onClick: () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      &#125;)&#125; */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          collapsed ? <span class="tag">&lt;<span class="name">MenuUnfoldOutlined</span>  <span class="attr">className</span>=<span class="string">&quot;trigger&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;/&gt; : <span class="tag">&lt;<span class="name">MenuFoldOutlined</span>  <span class="attr">className</span>=<span class="string">&quot;trigger&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            dispatch(setCollapsed(!collapsed))</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AppBreadcrumb</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">position:</span> &#x27;<span class="attr">absolute</span>&#x27;, <span class="attr">right:</span> &#x27;<span class="attr">16px</span>&#x27;  &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Dropdown</span> <span class="attr">overlay</span>=<span class="string">&#123;menu&#125;</span> <span class="attr">trigger</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">click</span>&#x27;]&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              &#123; adminname &#125;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">DownOutlined</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Dropdown</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppHeader</span>;</span><br></pre></td></tr></table></figure><p>正常考虑问题思路是，在登陆时，登录成功之后 判断有没有退出时的记录地址，然后跳转</p><p>但实际上程序运行的思路是，放你登录成功之后，已经修改了登录状态，状态的改变引起视图的二次渲染，所以真正决定跳转地址的是App.tsx组件</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/App.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Index</span> <span class="keyword">from</span> <span class="string">&#x27;@/layout/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/login/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Routes</span>, <span class="title class_">Route</span>, <span class="title class_">Navigate</span>, useSearchParams &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;./store/hook&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">App</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> loginState = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">admins</span>.<span class="property">loginState</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [params] = <span class="title function_">useSearchParams</span>() <span class="comment">// /login?r=/banner/home</span></span><br><span class="line">  <span class="keyword">const</span> url = params.<span class="title function_">get</span>(<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> <span class="built_in">string</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(url) <span class="comment">// /banner/home</span></span><br><span class="line">  <span class="comment">// reactrouterv6版本中需要加* </span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">loginState</span> ? &lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&#123;</span>  <span class="attr">url</span> ? <span class="attr">url</span> <span class="attr">:</span> &#x27;/&#x27; &#125;/&gt;</span> : <span class="tag">&lt;<span class="name">Login</span> /&gt;</span> &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/*&quot;</span> <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">loginState</span> ? &lt;<span class="attr">Index</span> /&gt;</span> : <span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span> /&gt;</span> &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h1 id="18-隐藏子菜单"><a href="#18-隐藏子菜单" class="headerlink" title="18.隐藏子菜单"></a>18.隐藏子菜单</h1><p>设置路由已经放到头部，左侧菜单栏不需要显示设置选项了</p><p>给router&#x2F;menu.tsx中不需要出现的 添加 hidden</p><p>给添加轮播图以及设置选项添加 hidden 属性</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/inter.d.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ReactNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// key属性可以使用 左侧菜单的路由地址，因为它具有唯一性</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IMenuProps</span> &#123;</span><br><span class="line">  <span class="attr">label</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">key</span>: <span class="built_in">string</span></span><br><span class="line">  icon?: <span class="title class_">ReactNode</span></span><br><span class="line">  children?: <span class="title class_">IMenuProps</span>[]</span><br><span class="line">  <span class="attr">element</span>: <span class="title class_">ReactNode</span> <span class="comment">// 因为页面创建时 指定了多级了路由的页面，故这里设置为 必传属性</span></span><br><span class="line">  index?: <span class="number">1</span> | <span class="number">0</span> <span class="comment">// 不建议使用 boolean，因为react在渲染属性时，具有boolean值的属性会有特殊的含义</span></span><br><span class="line">  hidden?: <span class="number">1</span> | <span class="number">0</span> <span class="comment">// ++++++++</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/menu.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">PictureOutlined</span>,</span><br><span class="line">  <span class="title class_">ProfileOutlined</span>,</span><br><span class="line">  <span class="title class_">OrderedListOutlined</span>,</span><br><span class="line">  <span class="title class_">FilterOutlined</span>,</span><br><span class="line">  <span class="title class_">TeamOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/home/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Banner</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/List&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerActive</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Active&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerAdd</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Add&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Product</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductSearch</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Search&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductHomeList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductDetailList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Detail&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductCartList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Cart&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Account</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/UserList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AdminList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/AdminList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Setting</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/setting/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;轮播图管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Banner</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/home&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;活动页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/active&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerActive</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;添加轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/add&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerAdd</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">hidden</span>: <span class="number">1</span> <span class="comment">// +++++++</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;产品管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/pro&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProfileOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Product</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;产品列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/list&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">OrderedListOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;首页产品列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/home&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductHomeList</span> /&gt;</span></span>,</span><br><span class="line">            <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;详情推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/detail&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductDetailList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;购物车推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/cart&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductCartList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;筛选列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/search&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">FilterOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductSearch</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;账户管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/account&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">TeamOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Account</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;用户列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/userlist&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;管理员列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/adminlist&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AdminList</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;设置&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/setting&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Setting</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="number">1</span>  ++++++</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><p>渲染左侧菜单栏数据时，可以过滤数据，将有<code>hidden: 1</code>子菜单删除掉</p><p><strong>4.20.0以前写法</strong></p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/utils.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Navigate</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 定义左侧菜单栏数据</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">renderMenu</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123; <span class="comment">// ++++++++</span></span><br><span class="line">      <span class="keyword">return</span> item.<span class="property">hidden</span> ? <span class="literal">null</span> : (<span class="language-xml"><span class="tag">&lt;<span class="name">Menu.SubMenu</span> <span class="attr">title</span> = <span class="string">&#123;</span> <span class="attr">item.label</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125; <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        renderMenu(item.children)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Menu.SubMenu</span>&gt;</span></span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;<span class="comment">// ++++++++</span></span><br><span class="line">      <span class="keyword">return</span> item.<span class="property">hidden</span>  ?  <span class="literal">null</span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.Item</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">icon</span> = <span class="string">&#123;</span> <span class="attr">item.icon</span> &#125;&gt;</span>&#123; item.label &#125;<span class="tag">&lt;/<span class="name">Menu.Item</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义路由组件  ---- 设置默认路由</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">renderRoute</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> menus.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!!item.<span class="property">index</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">React.Fragment</span> <span class="attr">key</span>=<span class="string">&#123;item.key&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">index</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">replace</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">              &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123; renderRoute(item.children) &#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!!item.<span class="property">index</span>) &#123; <span class="comment">// 如果index存在</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">React.Fragment</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">index</span> <span class="attr">element</span> = <span class="string">&#123;</span> &lt;<span class="attr">Navigate</span> <span class="attr">to</span>=<span class="string">&#123;item.key&#125;</span> <span class="attr">replace</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">React.Fragment</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">path</span> = <span class="string">&#123;</span> <span class="attr">item.key</span> &#125; <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">item.element</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取当前 需要展开的菜单项（可展开二级以及三级乃至更多展开项）</span></span><br><span class="line"><span class="comment">// pathname  /pro/list/cart </span></span><br><span class="line"><span class="comment">//  ===&gt; [&#x27;/pro&#x27;, &#x27;/pro/list&#x27;, &#x27;/pro/list/cart&#x27;]</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getSubMenu</span> = (<span class="params">pathname: <span class="built_in">string</span></span>) =&gt; &#123; </span><br><span class="line">  <span class="comment">// 1.以 / 分割 pathname.split(&#x27;/&#x27;)  //  [&#x27;&#x27;, &#x27;pro&#x27;, &#x27;list&#x27;, &#x27;cart&#x27;]</span></span><br><span class="line">  <span class="keyword">const</span> pathArray = pathname.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">slice</span>(<span class="number">1</span>) <span class="comment">// [&#x27;pro&#x27;, &#x27;list&#x27;, &#x27;cart&#x27;]</span></span><br><span class="line">  <span class="comment">// console.log(pathArray) </span></span><br><span class="line">  <span class="keyword">const</span> result = pathArray.<span class="title function_">reduce</span>(<span class="function">(<span class="params">newArr, item, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// &#x27;/pro&#x27;</span></span><br><span class="line">    <span class="comment">// &#x27;/pro/list&#x27;</span></span><br><span class="line">    <span class="comment">// &#x27;pro/list/cart&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> str = newArr[index] + <span class="string">&#x27;/&#x27;</span> + item</span><br><span class="line">    <span class="comment">// [&#x27;&#x27;, &#x27;/pro&#x27;]</span></span><br><span class="line">    <span class="comment">// [&#x27;&#x27;, &#x27;/pro&#x27;, &#x27;/pro/list&#x27;]</span></span><br><span class="line">    <span class="comment">// [&#x27;&#x27;, &#x27;/pro&#x27;, &#x27;/pro/list&#x27;, &#x27;/pro/list/cart&#x27;]</span></span><br><span class="line">    newArr.<span class="title function_">push</span>(str)</span><br><span class="line">    <span class="keyword">return</span> newArr</span><br><span class="line">  &#125;, [<span class="string">&#x27;&#x27;</span>])</span><br><span class="line">  <span class="comment">// console.log(&#x27;result&#x27;, result)</span></span><br><span class="line">  <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ITabProps</span> &#123;</span><br><span class="line">  <span class="attr">label</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">key</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 提取快捷切换页的数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">tabsArr</span>: <span class="title class_">ITabProps</span>[] = []</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getTabsData</span> = (<span class="params">menus: IMenuProps[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// const tabsArr: ITabProps[] = []</span></span><br><span class="line">  menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="title function_">getTabsData</span>(item.<span class="property">children</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      tabsArr.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">label</span>: item.<span class="property">label</span>,</span><br><span class="line">        <span class="attr">key</span>: item.<span class="property">key</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> tabsArr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4.20.0以上写法</strong></p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, <span class="title class_">Image</span>, <span class="title class_">MenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;@/logo.svg&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getSubMenu &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useLocation, useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置只展开一个菜单项</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">rootSubmenuKeys</span>: <span class="built_in">string</span>[] = [];</span><br><span class="line">menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  item.<span class="property">children</span> &amp;&amp; rootSubmenuKeys.<span class="title function_">push</span>(item.<span class="property">key</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>);</span><br><span class="line">  <span class="comment">// 获取当前路由的路径信息</span></span><br><span class="line">  <span class="keyword">const</span> &#123; pathname &#125; = <span class="title function_">useLocation</span>()</span><br><span class="line">  <span class="comment">// 当前选中的菜单项key数组</span></span><br><span class="line">  <span class="comment">// 初始值设置为 [pathname],刷新进入选中某一个菜单项</span></span><br><span class="line">  <span class="keyword">const</span> [selectedKeys, setSelectedKeys] = <span class="title function_">useState</span>([pathname])</span><br><span class="line"></span><br><span class="line">  <span class="comment">// const [openKeys, setOpenKeys] = useState&lt;string[]&gt;([&#x27;/pro&#x27;, &#x27;/pro/list&#x27;])</span></span><br><span class="line">  <span class="keyword">const</span> [openKeys, setOpenKeys] = useState&lt;<span class="built_in">string</span>[]&gt;(<span class="title function_">getSubMenu</span>(pathname))</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 展开哪一项数据</span></span><br><span class="line">  <span class="comment">// const [openKeys, setOpenKeys] = useState&lt;string[]&gt;([])</span></span><br><span class="line">  <span class="comment">// 打开一个菜单项时，需要做判断 - SubMenu 展开/关闭的回调</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">onOpenChange</span>: <span class="title class_">MenuProps</span>[<span class="string">&#x27;onOpenChange&#x27;</span>] = <span class="function"><span class="params">keys</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 如果当前展开项是 轮播图管理，再点击 账户管理 [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="comment">// console.log(&#x27;keys&#x27;, keys) // [&#x27;/banner&#x27;] =&gt;  [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="comment">// console.log(&#x27;openKeys&#x27;, openKeys) // [] =&gt; [&#x27;/banner&#x27;]</span></span><br><span class="line">    <span class="comment">// 得到当前</span></span><br><span class="line">    <span class="keyword">const</span> latestOpenKey = keys.<span class="title function_">find</span>(<span class="function"><span class="params">key</span> =&gt;</span> openKeys.<span class="title function_">indexOf</span>(key) === -<span class="number">1</span>); </span><br><span class="line">    <span class="comment">// console.log(&#x27;latestOpenKey&#x27;, latestOpenKey) // /banner ===&gt; /account</span></span><br><span class="line">    <span class="keyword">if</span> (rootSubmenuKeys.<span class="title function_">indexOf</span>(latestOpenKey!) === -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(keys);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(latestOpenKey ? [latestOpenKey] : []);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 点击切换路由</span></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">changeUrl</span> = (<span class="params">&#123; key &#125;: &#123; key: <span class="built_in">string</span> &#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// console.log(key)</span></span><br><span class="line">    <span class="title function_">navigate</span>(key, &#123; <span class="attr">replace</span>: <span class="literal">false</span> &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点击左侧菜单，切换菜单项，选中样式</span></span><br><span class="line">    <span class="title function_">setSelectedKeys</span>([key])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听 pathname 的变化，然后调整左侧菜单打开和选中状态</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setSelectedKeys</span>([pathname])</span><br><span class="line">    <span class="title function_">setOpenKeys</span>(<span class="title function_">getSubMenu</span>(pathname))</span><br><span class="line">  &#125;, [pathname])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">color:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">logo</span> &#125; <span class="attr">width</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">preview</span>=<span class="string">&#123;</span> <span class="attr">false</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; !collapsed &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">height:</span> &#x27;<span class="attr">32px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">overflow:</span> &#x27;<span class="attr">hidden</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">lineHeight:</span> &#x27;<span class="attr">32px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span>嗨购后台管理系统<span class="tag">&lt;/<span class="name">div</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">openKeys</span> = <span class="string">&#123;</span> <span class="attr">openKeys</span> &#125; // <span class="attr">打开哪一个菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onOpenChange</span> = <span class="string">&#123;</span> <span class="attr">onOpenChange</span> &#125; // <span class="attr">打开某一个菜单项时需要关闭其他菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">changeUrl</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">selectedKeys</span> = <span class="string">&#123;</span> <span class="attr">selectedKeys</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">items</span> = <span class="string">&#123;</span> <span class="attr">menus</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><p>隐藏子菜单使用 hidden 属性，如果使用的不是hidden属性，那么需要自行过滤数据</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getData</span> (<span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[]) &#123; <span class="comment">// ++++++++++</span></span><br><span class="line">	<span class="keyword">const</span> <span class="attr">items</span>:<span class="title class_">IMenuProps</span>[] = []</span><br><span class="line">    menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">       <span class="keyword">if</span> (!item.<span class="property">hidden</span>) &#123;</span><br><span class="line">         items.<span class="title function_">push</span>(&#123;...item&#125;) <span class="comment">// 只提取二级菜单项中的第一层级</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (!item.<span class="property">hidden</span>) &#123;</span><br><span class="line">         items.<span class="title function_">push</span>(&#123;...item&#125;) <span class="comment">// 一级菜单提取出来</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    items.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123; <span class="comment">// 因为上面只提取了第一层级的数据</span></span><br><span class="line">     <span class="keyword">if</span>(item.<span class="property">children</span>) &#123;</span><br><span class="line">       <span class="keyword">let</span> a = <span class="title function_">getData</span>(item.<span class="property">children</span>)</span><br><span class="line">       item.<span class="property">children</span> = a</span><br><span class="line">     &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> items</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="19-管理员管理"><a href="#19-管理员管理" class="headerlink" title="19. 管理员管理"></a>19. 管理员管理</h1><h2 id="19-1-设计接口"><a href="#19-1-设计接口" class="headerlink" title="19.1.设计接口"></a>19.1.设计接口</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/api/admin.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IAdminParams</span> &#123;</span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">password</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IAdminAddParams</span> &#123;</span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">token</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">adminLoginFn</span> (<span class="attr">params</span>: <span class="title class_">IAdminParams</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/admin/login&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getAdminList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/admin/list&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getAdminDetail</span> (<span class="attr">params</span>: &#123; <span class="attr">adminname</span>: <span class="built_in">string</span> &#125;) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/admin/detail&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">addAdmin</span> (<span class="attr">params</span>: <span class="title class_">IAdminAddParams</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/admin/add&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: params,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">deleteAdmin</span> (<span class="attr">params</span>: &#123; <span class="attr">adminid</span>: <span class="built_in">string</span> &#125;) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/admin/delete&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">updateAdmin</span> (<span class="attr">params</span>: <span class="title class_">IAdminAddParams</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/admin/update&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="19-2-展示管理员列表"><a href="#19-2-展示管理员列表" class="headerlink" title="19.2.展示管理员列表"></a>19.2.展示管理员列表</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getAdminList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span>&gt;</span>添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="19-3-优化表格滚动"><a href="#19-3-优化表格滚动" class="headerlink" title="19.3 优化表格滚动"></a>19.3 优化表格滚动</h2><p>如果屏幕比较小，默认展示的都是10条数据，就容易超出固定容器大小，此时可以通过 限制表格的滚动属性解决问题</p><p>第三方hooks库 <a target="_blank" rel="noopener" href="https://ahooks.js.org/zh-CN/">https://ahooks.js.org/zh-CN/</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i ahooks -S</span><br></pre></td></tr></table></figure><blockquote><p>？？？？ ahooks的useSize获取到的是 undefined</p></blockquote><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getAdminList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [height] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span>&gt;</span>添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">        scroll = &#123;&#123; y: height - 330 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="19-4-优化表格的分页器"><a href="#19-4-优化表格的分页器" class="headerlink" title="19.4 优化表格的分页器"></a>19.4 优化表格的分页器</h2><p><strong>优化数据表格</strong>（分页器优化 - 序号-分页之后需要要连贯）</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getAdminList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 分页设置 // +++++++</span></span><br><span class="line">  <span class="keyword">const</span> [current, setCurrent] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">const</span> [pageSize, setPageSize] = <span class="title function_">useState</span>(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [height] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123; <span class="comment">// +++++++</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (current - 1) * pageSize + index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span>&gt;</span>添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">        scroll = &#123;&#123; y: height - 330 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        pagination = &#123;&#123; // +++++++</span></span><br><span class="line"><span class="language-xml">          position: [&#x27;bottomRight&#x27;],</span></span><br><span class="line"><span class="language-xml">          current: current,</span></span><br><span class="line"><span class="language-xml">          pageSize: pageSize,</span></span><br><span class="line"><span class="language-xml">          showSizeChanger: true,</span></span><br><span class="line"><span class="language-xml">          pageSizeOptions: [5, 10, 50, 200],</span></span><br><span class="line"><span class="language-xml">          showQuickJumper: true,</span></span><br><span class="line"><span class="language-xml">          showTotal: (total) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return (<span class="tag">&lt;<span class="name">span</span>&gt;</span>共有&#123;total&#125;条数据<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">          &#125;,</span></span><br><span class="line"><span class="language-xml">          onChange: (page, pageSize) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            setCurrent(page)</span></span><br><span class="line"><span class="language-xml">            setPageSize(pageSize)</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="19-5-添加中文包"><a href="#19-5-添加中文包" class="headerlink" title="19.5 添加中文包"></a>19.5 添加中文包</h2><p>由于 antd 组件的默认文案是英文，所以需要修改为中文</p><p><img src="/posts/60af50c8/image-20221026163808513.png" alt="image-20221026163808513"></p><p><a target="_blank" rel="noopener" href="https://ant-design.gitee.io/docs/react/getting-started-cn">https://ant-design.gitee.io/docs/react/getting-started-cn</a></p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@/index.less&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;@/App&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> reportWebVitals <span class="keyword">from</span> <span class="string">&#x27;@/reportWebVitals&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ConfigProvider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>; <span class="comment">// ++++++++</span></span><br><span class="line"><span class="comment">// 由于 antd 组件的默认文案是英文，所以需要修改为中文</span></span><br><span class="line"><span class="keyword">import</span> zhCN <span class="keyword">from</span> <span class="string">&#x27;antd/es/locale/zh_CN&#x27;</span>;<span class="comment">// ++++++++</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLDivElement</span></span><br><span class="line">);</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span> = <span class="string">&#123;</span> <span class="attr">store</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">BrowserRouter</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; /*++++++++++*/&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ConfigProvider</span> <span class="attr">locale</span>=<span class="string">&#123;zhCN&#125;</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ConfigProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">BrowserRouter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="19-6-抽离分页器"><a href="#19-6-抽离分页器" class="headerlink" title="19.6 抽离分页器"></a>19.6 抽离分页器</h2><p>可以抽离，但不是必须</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/hooks/usePagination.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">JSXElementConstructor</span>, <span class="title class_">ReactElement</span>, <span class="title class_">ReactFragment</span>, <span class="title class_">ReactPortal</span>, <span class="title class_">SetStateAction</span>, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">usePagination</span>(<span class="params">config: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> &#123; position, showSizeChanger, pageSizeOptions, showQuickJumper &#125; =  config</span><br><span class="line">  <span class="keyword">const</span> [current, setCurrent] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">const</span> [pageSize, setPageSize] = <span class="title function_">useState</span>(<span class="number">10</span>)</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onChange</span> = (<span class="params">page: SetStateAction&lt;<span class="built_in">number</span>&gt;, pageSize: SetStateAction&lt;<span class="built_in">number</span>&gt;</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCurrent</span>(page)</span><br><span class="line">    <span class="title function_">setPageSize</span>(pageSize)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">showTotal</span> =  (<span class="params">total: <span class="built_in">string</span> | <span class="built_in">number</span> | <span class="built_in">boolean</span> | ReactElement&lt;<span class="built_in">any</span>, <span class="built_in">string</span> | JSXElementConstructor&lt;<span class="built_in">any</span>&gt;&gt; | ReactFragment | ReactPortal | <span class="literal">null</span> | <span class="literal">undefined</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>共有&#123;total&#125;条数据<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    position,</span><br><span class="line">    current,</span><br><span class="line">    pageSize,</span><br><span class="line">    showSizeChanger,</span><br><span class="line">    pageSizeOptions,</span><br><span class="line">    showQuickJumper,</span><br><span class="line">    showTotal,</span><br><span class="line">    onChange</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getAdminList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [height] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize + index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span>&gt;</span>添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">        scroll = &#123;&#123; y: height - 330 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        pagination = &#123; config &#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="19-7删除管理员"><a href="#19-7删除管理员" class="headerlink" title="19.7删除管理员"></a>19.7删除管理员</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span>, <span class="title class_">Popconfirm</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; deleteAdmin, getAdminList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [height] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize + index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">           &#123;/* +++++++++++++ */&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Popconfirm</span> <span class="attr">title</span>=<span class="string">&quot;确定删除吗?&quot;</span> <span class="attr">onConfirm</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              deleteAdmin(&#123; adminid: record.adminid&#125;).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                // 删除完毕重新获取数据</span></span><br><span class="line"><span class="language-xml">                getAdminListData()</span></span><br><span class="line"><span class="language-xml">              &#125;)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125; onOpenChange=&#123;() =&gt; console.log(&#x27;open change&#x27;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span>&gt;</span>添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">        scroll = &#123;&#123; y: height - 330 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        pagination = &#123; config &#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="19-8-如何批量删除管理员数据"><a href="#19-8-如何批量删除管理员数据" class="headerlink" title="19.8 如何批量删除管理员数据"></a>19.8 如何批量删除管理员数据</h2><p><a target="_blank" rel="noopener" href="https://ant-design.gitee.io/components/table-cn/#components-table-demo-row-selection-custom">https://ant-design.gitee.io/components/table-cn/#components-table-demo-row-selection-custom</a></p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span>, <span class="title class_">Popconfirm</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">TableRowSelection</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table/interface&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; deleteAdmin, getAdminList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [height] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize + index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Popconfirm</span> <span class="attr">title</span>=<span class="string">&quot;确定删除吗?&quot;</span> <span class="attr">onConfirm</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              deleteAdmin(&#123; adminid: record.adminid&#125;).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                // 删除完毕重新获取数据</span></span><br><span class="line"><span class="language-xml">                getAdminListData()</span></span><br><span class="line"><span class="language-xml">              &#125;)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125; onOpenChange=&#123;() =&gt; console.log(&#x27;open change&#x27;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义选择 selectedRowKeys 批量删除的数据</span></span><br><span class="line">  <span class="keyword">const</span> [selectedRowKeys, setSelectedRowKeys] = useState&lt;<span class="title class_">React</span>.<span class="property">Key</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onSelectChange</span> = (<span class="params">newSelectedRowKeys: React.Key[]</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;selectedRowKeys changed: &#x27;</span>, newSelectedRowKeys);</span><br><span class="line">    <span class="title function_">setSelectedRowKeys</span>(newSelectedRowKeys);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">rowSelection</span>: <span class="title class_">TableRowSelection</span>&lt;<span class="title class_">DataType</span>&gt; = &#123;</span><br><span class="line">    selectedRowKeys,</span><br><span class="line">    <span class="attr">onChange</span>: onSelectChange,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> flag = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> selectedRowKeys.<span class="property">length</span> &gt; <span class="number">0</span></span><br><span class="line">  &#125;, [selectedRowKeys])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span>&gt;</span>添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; flag &amp;&amp; <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123; // ++++++++++</span></span><br><span class="line"><span class="language-xml">          // 思考： 还用气泡弹出框？ 自行选择删除的方案</span></span><br><span class="line"><span class="language-xml">          // 接口没有提供批量删除，只能使用单个删除解决</span></span><br><span class="line"><span class="language-xml">          // 每个删除都是基于 Promise， 综合考虑 Promise.all</span></span><br><span class="line"><span class="language-xml">          const arr: any = []</span></span><br><span class="line"><span class="language-xml">          selectedRowKeys.forEach((item: any) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            arr.push(deleteAdmin(&#123; adminid: item&#125;))</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">          Promise.all(arr).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            getAdminListData()</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;批量删除<span class="tag">&lt;/<span class="name">Button</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">        scroll = &#123;&#123; y: height - 330 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        pagination = &#123; config &#125;</span></span><br><span class="line"><span class="language-xml">        rowSelection=&#123;rowSelection&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="19-9-添加管理员"><a href="#19-9-添加管理员" class="headerlink" title="19.9.添加管理员"></a>19.9.添加管理员</h2><h3 id="19-9-1-设置添加管理员的抽屉效果（无树形控件）"><a href="#19-9-1-设置添加管理员的抽屉效果（无树形控件）" class="headerlink" title="19.9.1 设置添加管理员的抽屉效果（无树形控件）"></a>19.9.1 设置添加管理员的抽屉效果（无树形控件）</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span>, <span class="title class_">Popconfirm</span>, <span class="title class_">Drawer</span>, <span class="title class_">Input</span>, <span class="title class_">Select</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">TableRowSelection</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table/interface&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; deleteAdmin, getAdminList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">66</span>)</span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize + index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Popconfirm</span> <span class="attr">title</span>=<span class="string">&quot;确定删除吗?&quot;</span> <span class="attr">onConfirm</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              deleteAdmin(&#123; adminid: record.adminid&#125;).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                // 删除完毕重新获取数据</span></span><br><span class="line"><span class="language-xml">                getAdminListData()</span></span><br><span class="line"><span class="language-xml">              &#125;)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125; onOpenChange=&#123;() =&gt; console.log(&#x27;open change&#x27;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义选择 selectedRowKeys 批量删除的数据</span></span><br><span class="line">  <span class="keyword">const</span> [selectedRowKeys, setSelectedRowKeys] = useState&lt;<span class="title class_">React</span>.<span class="property">Key</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onSelectChange</span> = (<span class="params">newSelectedRowKeys: React.Key[]</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;selectedRowKeys changed: &#x27;</span>, newSelectedRowKeys);</span><br><span class="line">    <span class="title function_">setSelectedRowKeys</span>(newSelectedRowKeys);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">rowSelection</span>: <span class="title class_">TableRowSelection</span>&lt;<span class="title class_">DataType</span>&gt; = &#123;</span><br><span class="line">    selectedRowKeys,</span><br><span class="line">    <span class="attr">onChange</span>: onSelectChange,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> flag = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> selectedRowKeys.<span class="property">length</span> &gt; <span class="number">0</span></span><br><span class="line">  &#125;, [selectedRowKeys])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 抽屉效果 用来添加管理员</span></span><br><span class="line">  <span class="keyword">const</span> [open, setOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> setOpen(true) &#125;&gt;添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; flag &amp;&amp; <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          // 思考： 还用气泡弹出框？ 自行选择删除的方案</span></span><br><span class="line"><span class="language-xml">          // 接口没有提供批量删除，只能使用单个删除解决</span></span><br><span class="line"><span class="language-xml">          // 每个删除都是基于 Promise， 综合考虑 Promise.all</span></span><br><span class="line"><span class="language-xml">          const arr: any = []</span></span><br><span class="line"><span class="language-xml">          selectedRowKeys.forEach((item: any) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            arr.push(deleteAdmin(&#123; adminid: item&#125;))</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">          Promise.all(arr).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            getAdminListData()</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;批量删除<span class="tag">&lt;/<span class="name">Button</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">        scroll = &#123;&#123; y: height - 330 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        pagination = &#123; config &#125;</span></span><br><span class="line"><span class="language-xml">        rowSelection=&#123;rowSelection&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Drawer</span> <span class="attr">title</span>=<span class="string">&quot;添加管理员&quot;</span> <span class="attr">placement</span>=<span class="string">&quot;right&quot;</span> <span class="attr">onClose</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        setOpen(false)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125; open=&#123;open&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Space</span> <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;账户名&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;密码&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Select</span> <span class="attr">defaultValue</span>=<span class="string">&#123;</span> <span class="attr">1</span> &#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;2&#125;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          选择该管理员的权限：</span></span><br><span class="line"><span class="language-xml">          </span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Drawer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h3 id="19-9-2-修改菜单数据-添加了keyid字段"><a href="#19-9-2-修改菜单数据-添加了keyid字段" class="headerlink" title="19.9.2 修改菜单数据 添加了keyid字段"></a>19.9.2 修改菜单数据 添加了keyid字段</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/inter.d.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ReactNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// key属性可以使用 左侧菜单的路由地址，因为它具有唯一性</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IMenuProps</span> &#123;</span><br><span class="line">  <span class="attr">label</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">key</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">keyid</span>: <span class="built_in">string</span></span><br><span class="line">  icon?: <span class="title class_">ReactNode</span></span><br><span class="line">  children?: <span class="title class_">IMenuProps</span>[]</span><br><span class="line">  <span class="attr">element</span>: <span class="title class_">ReactNode</span> <span class="comment">// 因为页面创建时 指定了多级了路由的页面，故这里设置为 必传属性</span></span><br><span class="line">  index?: <span class="number">1</span> | <span class="number">0</span> <span class="comment">// 不建议使用 boolean，因为react在渲染属性时，具有boolean值的属性会有特殊的含义</span></span><br><span class="line">  hidden?: <span class="number">1</span> | <span class="number">0</span> <span class="comment">// 宁用 hidden 为 真 不用 show 为假</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/menu.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">PictureOutlined</span>,</span><br><span class="line">  <span class="title class_">ProfileOutlined</span>,</span><br><span class="line">  <span class="title class_">OrderedListOutlined</span>,</span><br><span class="line">  <span class="title class_">FilterOutlined</span>,</span><br><span class="line">  <span class="title class_">TeamOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/home/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Banner</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/List&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerActive</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Active&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerAdd</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Add&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Product</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductSearch</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Search&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductHomeList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductDetailList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Detail&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductCartList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Cart&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Account</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/UserList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AdminList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/AdminList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Setting</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/setting/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-0&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;轮播图管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-1&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Banner</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/home&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;活动页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/active&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerActive</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;添加轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/add&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerAdd</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">hidden</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;产品管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/pro&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-2&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProfileOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Product</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;产品列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/list&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">OrderedListOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;首页产品列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/home&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-0&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductHomeList</span> /&gt;</span></span>,</span><br><span class="line">            <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;详情推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/detail&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-1&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductDetailList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;购物车推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/cart&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-2&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductCartList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;筛选列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/search&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">FilterOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductSearch</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;账户管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/account&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-3&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">TeamOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Account</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;用户列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/userlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;管理员列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/adminlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AdminList</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;设置&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/setting&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-4&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Setting</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><h3 id="19-9-3-添加管理员时选择该管理员权限"><a href="#19-9-3-添加管理员时选择该管理员权限" class="headerlink" title="19.9.3 添加管理员时选择该管理员权限"></a>19.9.3 添加管理员时选择该管理员权限</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/utils.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">DataNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/tree&#x27;</span>;</span><br><span class="line"><span class="comment">// .....</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getTreeData</span> (<span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[]) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">arr</span>: <span class="title class_">DataNode</span>[] = []</span><br><span class="line">  menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">obj</span>: <span class="title class_">DataNode</span> = &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      obj = &#123;</span><br><span class="line">        <span class="attr">key</span>: item.<span class="property">keyid</span>,</span><br><span class="line">        <span class="attr">title</span>: item.<span class="property">label</span>,</span><br><span class="line">        <span class="attr">children</span>: <span class="title function_">getTreeData</span>(item.<span class="property">children</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      obj = &#123;</span><br><span class="line">        <span class="attr">key</span>: item.<span class="property">keyid</span>,</span><br><span class="line">        <span class="attr">title</span>: item.<span class="property">label</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    arr.<span class="title function_">push</span>(obj)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span>, <span class="title class_">Popconfirm</span>, <span class="title class_">Drawer</span>, <span class="title class_">Input</span>, <span class="title class_">Select</span>, <span class="title class_">Tree</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">TableRowSelection</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table/interface&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">DataNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/tree&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; addAdmin, deleteAdmin, getAdminList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getTreeData &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 树形控件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">treeData</span>: <span class="title class_">DataNode</span>[] = <span class="title function_">getTreeData</span>(menus)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">66</span>)</span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize + index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Popconfirm</span> <span class="attr">title</span>=<span class="string">&quot;确定删除吗?&quot;</span> <span class="attr">onConfirm</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              deleteAdmin(&#123; adminid: record.adminid&#125;).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                // 删除完毕重新获取数据</span></span><br><span class="line"><span class="language-xml">                getAdminListData()</span></span><br><span class="line"><span class="language-xml">              &#125;)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125; onOpenChange=&#123;() =&gt; console.log(&#x27;open change&#x27;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义选择 selectedRowKeys 批量删除的数据</span></span><br><span class="line">  <span class="keyword">const</span> [selectedRowKeys, setSelectedRowKeys] = useState&lt;<span class="title class_">React</span>.<span class="property">Key</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onSelectChange</span> = (<span class="params">newSelectedRowKeys: React.Key[]</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;selectedRowKeys changed: &#x27;</span>, newSelectedRowKeys);</span><br><span class="line">    <span class="title function_">setSelectedRowKeys</span>(newSelectedRowKeys);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">rowSelection</span>: <span class="title class_">TableRowSelection</span>&lt;<span class="title class_">DataType</span>&gt; = &#123;</span><br><span class="line">    selectedRowKeys,</span><br><span class="line">    <span class="attr">onChange</span>: onSelectChange,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> flag = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> selectedRowKeys.<span class="property">length</span> &gt; <span class="number">0</span></span><br><span class="line">  &#125;, [selectedRowKeys])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 抽屉效果 用来添加管理员</span></span><br><span class="line">  <span class="keyword">const</span> [adminname, setAdminname] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [password, setPassword] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [role, setRole] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">const</span> [open, setOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="comment">// 树形控件</span></span><br><span class="line">  <span class="keyword">const</span> [checkedKeys, setcheckedKeys] = <span class="title function_">useState</span>([<span class="string">&#x27;0-0&#x27;</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onAdd</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">result</span>: <span class="built_in">any</span> = &#123;</span><br><span class="line">      adminname, password, role, checkedKeys</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> setOpen(true) &#125;&gt;添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; flag &amp;&amp; <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          // 思考： 还用气泡弹出框？ 自行选择删除的方案</span></span><br><span class="line"><span class="language-xml">          // 接口没有提供批量删除，只能使用单个删除解决</span></span><br><span class="line"><span class="language-xml">          // 每个删除都是基于 Promise， 综合考虑 Promise.all</span></span><br><span class="line"><span class="language-xml">          const arr: any = []</span></span><br><span class="line"><span class="language-xml">          selectedRowKeys.forEach((item: any) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            arr.push(deleteAdmin(&#123; adminid: item&#125;))</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">          Promise.all(arr).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            getAdminListData()</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;批量删除<span class="tag">&lt;/<span class="name">Button</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">        scroll = &#123;&#123; y: height - 330 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        pagination = &#123; config &#125;</span></span><br><span class="line"><span class="language-xml">        rowSelection=&#123;rowSelection&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Drawer</span> <span class="attr">title</span>=<span class="string">&quot;添加管理员&quot;</span> <span class="attr">placement</span>=<span class="string">&quot;right&quot;</span> <span class="attr">onClose</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        setOpen(false)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125; open=&#123;open&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Space</span> <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;账户名&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">adminname</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setAdminname(e.target.value) &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;密码&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">password</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setPassword(e.target.value) &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Select</span> <span class="attr">defaultValue</span>=<span class="string">&#123;</span> <span class="attr">1</span> &#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;&#125;&#125; <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">role</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> (<span class="attr">value</span>) =&gt;</span> setRole(value)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;2&#125;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          选择该管理员的权限：</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Tree</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkable</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkedKeys</span> = <span class="string">&#123;</span> <span class="attr">checkedKeys</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onCheck</span> = <span class="string">&#123;</span> (<span class="attr">checkedKeys:</span> <span class="attr">any</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              setcheckedKeys(checkedKeys)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">            treeData=&#123; treeData &#125;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">onAdd</span> &#125;&gt;</span>添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Drawer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h3 id="19-9-4-添加管理员"><a href="#19-9-4-添加管理员" class="headerlink" title="19.9.4 添加管理员"></a>19.9.4 添加管理员</h3><p>添加完毕一定要记得重置（表单，权限）</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span>, <span class="title class_">Popconfirm</span>, <span class="title class_">Drawer</span>, <span class="title class_">Input</span>, <span class="title class_">Select</span>, <span class="title class_">Tree</span>, message &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">TableRowSelection</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table/interface&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">DataNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/tree&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; addAdmin, deleteAdmin, getAdminList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getTreeData &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 树形控件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">treeData</span>: <span class="title class_">DataNode</span>[] = <span class="title function_">getTreeData</span>(menus)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="comment">// console.log(66)</span></span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// console.log(res.data)</span></span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize + index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Popconfirm</span> <span class="attr">title</span>=<span class="string">&quot;确定删除吗?&quot;</span> <span class="attr">onConfirm</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              deleteAdmin(&#123; adminid: record.adminid&#125;).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                // 删除完毕重新获取数据</span></span><br><span class="line"><span class="language-xml">                getAdminListData()</span></span><br><span class="line"><span class="language-xml">              &#125;)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125; onOpenChange=&#123;() =&gt; console.log(&#x27;open change&#x27;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义选择 selectedRowKeys 批量删除的数据</span></span><br><span class="line">  <span class="keyword">const</span> [selectedRowKeys, setSelectedRowKeys] = useState&lt;<span class="title class_">React</span>.<span class="property">Key</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onSelectChange</span> = (<span class="params">newSelectedRowKeys: React.Key[]</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;selectedRowKeys changed: &#x27;</span>, newSelectedRowKeys);</span><br><span class="line">    <span class="title function_">setSelectedRowKeys</span>(newSelectedRowKeys);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">rowSelection</span>: <span class="title class_">TableRowSelection</span>&lt;<span class="title class_">DataType</span>&gt; = &#123;</span><br><span class="line">    selectedRowKeys,</span><br><span class="line">    <span class="attr">onChange</span>: onSelectChange,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> flag = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> selectedRowKeys.<span class="property">length</span> &gt; <span class="number">0</span></span><br><span class="line">  &#125;, [selectedRowKeys])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 抽屉效果 用来添加管理员</span></span><br><span class="line">  <span class="keyword">const</span> [open, setOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> [adminname, setAdminname] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [password, setPassword] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [role, setRole] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="comment">// 树形控件</span></span><br><span class="line">  <span class="keyword">const</span> [checkedKeys, setcheckedKeys] = <span class="title function_">useState</span>([<span class="string">&#x27;0-0&#x27;</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onAdd</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">result</span>: <span class="built_in">any</span> = &#123;</span><br><span class="line">      adminname, password, role, checkedKeys</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">addAdmin</span>(result).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">code</span> === <span class="string">&#x27;10004&#x27;</span>) &#123;</span><br><span class="line">        message.<span class="title function_">warning</span>(<span class="string">&#x27;该管理员账户已存在&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">code</span> === <span class="string">&#x27;10008&#x27;</span>) &#123;</span><br><span class="line">        message.<span class="title function_">warning</span>(<span class="string">&#x27;账户名不符合规则&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        message.<span class="title function_">success</span>(<span class="string">&#x27;添加成功&#x27;</span>)</span><br><span class="line">        <span class="title function_">getAdminListData</span>()</span><br><span class="line">        <span class="title function_">setAdminname</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="title function_">setPassword</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="title function_">setRole</span>(<span class="number">1</span>)</span><br><span class="line">        <span class="title function_">setcheckedKeys</span>([<span class="string">&#x27;0-0&#x27;</span>])</span><br><span class="line">        <span class="title function_">setOpen</span>(<span class="literal">false</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// console.log(result)</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dis = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> adminname === <span class="string">&#x27;&#x27;</span> || password === <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;, [adminname, password])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> setOpen(true) &#125;&gt;添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; flag &amp;&amp; <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          // 思考： 还用气泡弹出框？ 自行选择删除的方案</span></span><br><span class="line"><span class="language-xml">          // 接口没有提供批量删除，只能使用单个删除解决</span></span><br><span class="line"><span class="language-xml">          // 每个删除都是基于 Promise， 综合考虑 Promise.all</span></span><br><span class="line"><span class="language-xml">          const arr: any = []</span></span><br><span class="line"><span class="language-xml">          selectedRowKeys.forEach((item: any) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            arr.push(deleteAdmin(&#123; adminid: item&#125;))</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">          Promise.all(arr).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            getAdminListData()</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;批量删除<span class="tag">&lt;/<span class="name">Button</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">        scroll = &#123;&#123; y: height - 330 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        pagination = &#123; config &#125;</span></span><br><span class="line"><span class="language-xml">        rowSelection=&#123;rowSelection&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Drawer</span> <span class="attr">title</span>=<span class="string">&quot;添加管理员&quot;</span> <span class="attr">placement</span>=<span class="string">&quot;right&quot;</span> <span class="attr">onClose</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        setOpen(false)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125; open=&#123;open&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Space</span> <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;账户名&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">adminname</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setAdminname(e.target.value) &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;密码&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">password</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setPassword(e.target.value) &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Select</span> <span class="attr">defaultValue</span>=<span class="string">&#123;</span> <span class="attr">1</span> &#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;&#125;&#125; <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">role</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> (<span class="attr">value</span>) =&gt;</span> setRole(value)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;2&#125;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          选择该管理员的权限：</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Tree</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkable</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkedKeys</span> = <span class="string">&#123;</span> <span class="attr">checkedKeys</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onCheck</span> = <span class="string">&#123;</span> (<span class="attr">checkedKeys:</span> <span class="attr">any</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              setcheckedKeys(checkedKeys)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">            treeData=&#123; treeData &#125;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">onAdd</span> &#125; <span class="attr">disabled</span> = <span class="string">&#123;</span> <span class="attr">dis</span> &#125;&gt;</span>添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Drawer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="19-10管理员修改"><a href="#19-10管理员修改" class="headerlink" title="19.10管理员修改"></a>19.10管理员修改</h2><p>修改不重新生成新的页面，还在这个页面，使用模态框实现</p><p>可以使用之前的数据字段 —- 需要注意 树形控件的字段 为 checkedKeys 而不是 checkedkeys</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span>, <span class="title class_">Popconfirm</span>, <span class="title class_">Drawer</span>, <span class="title class_">Input</span>, <span class="title class_">Select</span>, <span class="title class_">Tree</span>, message, <span class="title class_">Modal</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">TableRowSelection</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table/interface&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">DataNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/tree&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; addAdmin, deleteAdmin, getAdminList, updateAdmin &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getTreeData &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 树形控件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">treeData</span>: <span class="title class_">DataNode</span>[] = <span class="title function_">getTreeData</span>(menus)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="comment">// console.log(66)</span></span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize + index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125; onClick = &#123;() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              // 给表单填充数据</span></span><br><span class="line"><span class="language-xml">              setAdminname(record.adminname)</span></span><br><span class="line"><span class="language-xml">              setRole(record.role)</span></span><br><span class="line"><span class="language-xml">              setCheckedkeys(record.checkedKeys)</span></span><br><span class="line"><span class="language-xml">              // 弹出框显示</span></span><br><span class="line"><span class="language-xml">              setIsModalOpen(true)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Popconfirm</span> <span class="attr">title</span>=<span class="string">&quot;确定删除吗?&quot;</span> <span class="attr">onConfirm</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              deleteAdmin(&#123; adminid: record.adminid&#125;).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                // 删除完毕重新获取数据</span></span><br><span class="line"><span class="language-xml">                getAdminListData()</span></span><br><span class="line"><span class="language-xml">              &#125;)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125; onOpenChange=&#123;() =&gt; console.log(&#x27;open change&#x27;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义选择 selectedRowKeys 批量删除的数据</span></span><br><span class="line">  <span class="keyword">const</span> [selectedRowKeys, setSelectedRowKeys] = useState&lt;<span class="title class_">React</span>.<span class="property">Key</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onSelectChange</span> = (<span class="params">newSelectedRowKeys: React.Key[]</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;selectedRowKeys changed: &#x27;</span>, newSelectedRowKeys);</span><br><span class="line">    <span class="title function_">setSelectedRowKeys</span>(newSelectedRowKeys);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">rowSelection</span>: <span class="title class_">TableRowSelection</span>&lt;<span class="title class_">DataType</span>&gt; = &#123;</span><br><span class="line">    selectedRowKeys,</span><br><span class="line">    <span class="attr">onChange</span>: onSelectChange,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> flag = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> selectedRowKeys.<span class="property">length</span> &gt; <span class="number">0</span></span><br><span class="line">  &#125;, [selectedRowKeys])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 抽屉效果 用来添加管理员</span></span><br><span class="line">  <span class="keyword">const</span> [open, setOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> [adminname, setAdminname] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [password, setPassword] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [role, setRole] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="comment">// 树形控件</span></span><br><span class="line">  <span class="keyword">const</span> [checkedKeys, setCheckedkeys] = <span class="title function_">useState</span>([<span class="string">&#x27;0-0&#x27;</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onAdd</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">result</span>: <span class="built_in">any</span> = &#123;</span><br><span class="line">      adminname, password, role, <span class="attr">checkedKeys</span>: checkedKeys</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">addAdmin</span>(result).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">code</span> === <span class="string">&#x27;10004&#x27;</span>) &#123;</span><br><span class="line">        message.<span class="title function_">warning</span>(<span class="string">&#x27;该管理员账户已存在&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">code</span> === <span class="string">&#x27;10008&#x27;</span>) &#123;</span><br><span class="line">        message.<span class="title function_">warning</span>(<span class="string">&#x27;账户名不符合规则&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        message.<span class="title function_">success</span>(<span class="string">&#x27;添加成功&#x27;</span>)</span><br><span class="line">        <span class="title function_">getAdminListData</span>()</span><br><span class="line">        <span class="title function_">setAdminname</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="title function_">setPassword</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="title function_">setRole</span>(<span class="number">1</span>)</span><br><span class="line">        <span class="title function_">setCheckedkeys</span>([<span class="string">&#x27;0-0&#x27;</span>])</span><br><span class="line">        <span class="title function_">setOpen</span>(<span class="literal">false</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dis = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> adminname === <span class="string">&#x27;&#x27;</span> || password === <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;, [adminname, password])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 编辑</span></span><br><span class="line">  <span class="keyword">const</span> [isModalOpen, setIsModalOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);  </span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onUpdate</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">result</span>: <span class="built_in">any</span> = &#123;</span><br><span class="line">      adminname, role, checkedKeys</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">updateAdmin</span>(result).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setIsModalOpen</span>(<span class="literal">false</span>)</span><br><span class="line">      <span class="title function_">setAdminname</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">      <span class="title function_">setRole</span>(<span class="number">1</span>)</span><br><span class="line">      <span class="title function_">setCheckedkeys</span>([<span class="string">&#x27;0-0&#x27;</span>])</span><br><span class="line">      <span class="title function_">getAdminListData</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> setOpen(true) &#125;&gt;添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; flag &amp;&amp; <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          // 思考： 还用气泡弹出框？ 自行选择删除的方案</span></span><br><span class="line"><span class="language-xml">          // 接口没有提供批量删除，只能使用单个删除解决</span></span><br><span class="line"><span class="language-xml">          // 每个删除都是基于 Promise， 综合考虑 Promise.all</span></span><br><span class="line"><span class="language-xml">          const arr: any = []</span></span><br><span class="line"><span class="language-xml">          selectedRowKeys.forEach((item: any) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            arr.push(deleteAdmin(&#123; adminid: item&#125;))</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">          Promise.all(arr).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            getAdminListData()</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;批量删除<span class="tag">&lt;/<span class="name">Button</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">        scroll = &#123;&#123; y: height - 330 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        pagination = &#123; config &#125;</span></span><br><span class="line"><span class="language-xml">        rowSelection=&#123;rowSelection&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Drawer</span> <span class="attr">title</span>=<span class="string">&quot;添加管理员&quot;</span> <span class="attr">placement</span>=<span class="string">&quot;right&quot;</span> <span class="attr">onClose</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        getAdminListData()</span></span><br><span class="line"><span class="language-xml">        setAdminname(&#x27;&#x27;)</span></span><br><span class="line"><span class="language-xml">        setPassword(&#x27;&#x27;)</span></span><br><span class="line"><span class="language-xml">        setRole(1)</span></span><br><span class="line"><span class="language-xml">        setCheckedkeys([&#x27;0-0&#x27;])</span></span><br><span class="line"><span class="language-xml">        setOpen(false)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125; open=&#123;open&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Space</span> <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;账户名&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">adminname</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setAdminname(e.target.value) &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;密码&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">password</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setPassword(e.target.value) &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Select</span> <span class="attr">defaultValue</span>=<span class="string">&#123;</span> <span class="attr">1</span> &#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;&#125;&#125; <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">role</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> (<span class="attr">value</span>) =&gt;</span> setRole(value)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;2&#125;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          选择该管理员的权限：</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Tree</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkable</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkedKeys</span> = <span class="string">&#123;</span> <span class="attr">checkedKeys</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onCheck</span> = <span class="string">&#123;</span> (<span class="attr">checkedKeys:</span> <span class="attr">any</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              setCheckedkeys(checkedKeys)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">            treeData=&#123; treeData &#125;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">onAdd</span> &#125; <span class="attr">disabled</span> = <span class="string">&#123;</span> <span class="attr">dis</span> &#125;&gt;</span>添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Drawer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Modal</span> <span class="attr">title</span>=<span class="string">&quot;修改管理员&quot;</span> <span class="attr">footer</span>=<span class="string">&#123;null&#125;</span> <span class="attr">open</span>=<span class="string">&#123;isModalOpen&#125;</span> <span class="attr">onOk</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;&#125;&#125; onCancel=&#123; () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">        setAdminname(&#x27;&#x27;)</span></span><br><span class="line"><span class="language-xml">        setRole(1)</span></span><br><span class="line"><span class="language-xml">        setCheckedkeys([&#x27;0-0&#x27;])</span></span><br><span class="line"><span class="language-xml">        setIsModalOpen(false)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Space</span> <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">disabled</span> <span class="attr">placeholder</span>=<span class="string">&#x27;账户名&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">adminname</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setAdminname(e.target.value) &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Select</span> <span class="attr">defaultValue</span>=<span class="string">&#123;</span> <span class="attr">1</span> &#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;&#125;&#125; <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">role</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> (<span class="attr">value</span>) =&gt;</span> setRole(value)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;2&#125;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          选择该管理员的权限：</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Tree</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkable</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkedKeys</span> = <span class="string">&#123;</span> <span class="attr">checkedKeys</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onCheck</span> = <span class="string">&#123;</span> (<span class="attr">checkedKeys:</span> <span class="attr">any</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              setCheckedkeys(checkedKeys)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">            treeData=&#123; treeData &#125;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">onUpdate</span> &#125; &gt;</span>修改管理员权限<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Modal</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h1 id="20-系统首页数据统计"><a href="#20-系统首页数据统计" class="headerlink" title="20 系统首页数据统计"></a>20 系统首页数据统计</h1><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/api/home.ts</span></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getUserTotalNum</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/statistic/user&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getShopTotalNum</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/statistic/product&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/home/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CalculatorOutlined</span>, <span class="title class_">UsergroupDeleteOutlined</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Statistic</span>, <span class="title class_">Col</span>, <span class="title class_">Row</span>, &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getShopTotalNum, getUserTotalNum &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/home&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [ userNum, setUserNum ] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">const</span> [ proNum, setProNum ] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getUserTotalNum</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="title function_">setUserNum</span>(res.<span class="property">data</span>.<span class="property">data</span>))</span><br><span class="line">    <span class="title function_">getShopTotalNum</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="title function_">setProNum</span>(res.<span class="property">data</span>.<span class="property">data</span>))</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Row</span> <span class="attr">gutter</span>=<span class="string">&#123;16&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Col</span> <span class="attr">span</span>=<span class="string">&#123;3&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Statistic</span> <span class="attr">title</span>=<span class="string">&quot;商品总数量&quot;</span> <span class="attr">value</span>=<span class="string">&#123;proNum&#125;</span> <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">CalculatorOutlined</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Col</span> <span class="attr">span</span>=<span class="string">&#123;3&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Statistic</span> <span class="attr">title</span>=<span class="string">&quot;用户总数量&quot;</span> <span class="attr">value</span>=<span class="string">&#123;userNum&#125;</span> <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">UsergroupDeleteOutlined</span> /&gt;</span>&#125;  /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h1 id="21-左侧菜单栏的权限"><a href="#21-左侧菜单栏的权限" class="headerlink" title="21 左侧菜单栏的权限"></a>21 左侧菜单栏的权限</h1><h2 id="21-1-思路"><a href="#21-1-思路" class="headerlink" title="21.1 思路"></a>21.1 思路</h2><ul><li>当用户登录的时候，可以获取到该用户的 <code>checkedKeys</code> 数据</li><li>使用这个数据从 <code>router/menu.tsx</code>中提取匹配的数据，</li><li>生成左侧菜单栏组件（目前是直接渲染<code>router/menu.tsx</code>）</li></ul><h2 id="21-2-算法过程"><a href="#21-2-算法过程" class="headerlink" title="21.2 算法过程"></a>21.2 算法过程</h2><p><img src="/posts/60af50c8/image-20221027151803006.png" alt="image-20221027151803006"></p><p>从一个数组<code>[&#39;0-0&#39;, &#39;0-1-0&#39;, &#39;0-2-0-0&#39;, &#39;0-2-0-1&#39;, &#39;0-3-2&#39;]</code>触发，筛选 <code>router/menu.tsx</code>，获取到满足条件的数据</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/menu.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">PictureOutlined</span>,</span><br><span class="line">  <span class="title class_">ProfileOutlined</span>,</span><br><span class="line">  <span class="title class_">OrderedListOutlined</span>,</span><br><span class="line">  <span class="title class_">FilterOutlined</span>,</span><br><span class="line">  <span class="title class_">TeamOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/home/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Banner</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/List&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerActive</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Active&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerAdd</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Add&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Product</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductSearch</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Search&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductHomeList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductDetailList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Detail&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductCartList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Cart&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Account</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/UserList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AdminList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/AdminList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Setting</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/setting/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-0&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;轮播图管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-1&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Banner</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/home&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;产品管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/pro&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-2&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProfileOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Product</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;产品列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/list&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">OrderedListOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;首页产品列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/home&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-0&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductHomeList</span> /&gt;</span></span>,</span><br><span class="line">            <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;详情推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/detail&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-1&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductDetailList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">         </span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">     </span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;账户管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/account&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-3&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">TeamOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Account</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;管理员列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/adminlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AdminList</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><h2 id="21-3-算法实现"><a href="#21-3-算法实现" class="headerlink" title="21.3 算法实现"></a>21.3 算法实现</h2><p>算法1：</p><ul><li>从[‘0-0’, ‘0-1-0’, ‘0-2-0-0’, ‘0-2-0-1’, ‘0-3-2’] 到</li><li>[‘0-0’, ‘0-1’, ‘0-1-0’, ‘0-2’, ‘0-2-0’, ‘0-2-0-0’, ‘0-2-0-1’, ‘0-3’, ‘0-3-2’]</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// [&#x27;0-0&#x27;, &#x27;0-1-0&#x27;, &#x27;0-2-0-0&#x27;, &#x27;0-2-0-1&#x27;, &#x27;0-3-2&#x27;] </span></span><br><span class="line"><span class="comment">// [&#x27;0-0&#x27;, &#x27;0-1&#x27;, &#x27;0-1-0&#x27;,  &#x27;0-2&#x27;, &#x27;0-2-0&#x27;, &#x27;0-2-0-0&#x27;, &#x27;0-2-0-1&#x27;, &#x27;0-3&#x27;, &#x27;0-3-2&#x27;]</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;0-0&#x27;</span>,<span class="string">&#x27;0-1-0&#x27;</span>,<span class="string">&#x27;0-2-0-0&#x27;</span>,<span class="string">&#x27;0-2-0-1&#x27;</span>,<span class="string">&#x27;0-3-2&#x27;</span>, <span class="string">&#x27;0-4-0-0-2&#x27;</span>, <span class="string">&#x27;0-5-1-2-0-1&#x27;</span>]</span><br><span class="line"><span class="comment">// 0-0</span></span><br><span class="line"><span class="comment">// 0-1 0-1-0</span></span><br><span class="line"><span class="comment">// 0-2 0-2-0 0-2-0-0</span></span><br><span class="line"><span class="comment">// 0-2 0-2-0 0-2-0-1</span></span><br><span class="line"><span class="comment">// 0-3 0-3-2</span></span><br><span class="line"><span class="comment">// 0-4 0-4-0 0-4-0-0  0-4-0-0-2</span></span><br><span class="line"><span class="comment">// 0-5 0-5-1 0-5-1-2  0-5-1-2-0  0-5-1-2-0-1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// let brr = []</span></span><br><span class="line"><span class="comment">// for(let i = 0; i &lt; arr.length; i++)&#123;</span></span><br><span class="line"><span class="comment">//   for(let j = 0; j &lt; arr[i].length; j += 2)&#123;</span></span><br><span class="line"><span class="comment">//     brr.push(arr[i].substring(0, j + 3))</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(new Set(brr)); </span></span><br><span class="line"><span class="keyword">let</span> brr = <span class="keyword">new</span> <span class="title class_">Set</span>()</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++)&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; arr[i].<span class="property">length</span>; j += <span class="number">2</span>)&#123;</span><br><span class="line">    brr.<span class="title function_">add</span>(arr[i].<span class="title function_">substring</span>(<span class="number">0</span>, j + <span class="number">3</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(brr); </span><br></pre></td></tr></table></figure><p>算法2：</p><p>[‘0-0’, ‘0-1’, ‘0-1-0’, ‘0-2’, ‘0-2-0’, ‘0-2-0-0’, ‘0-2-0-1’, ‘0-3’, ‘0-3-2’] 提取数据</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/utils.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Navigate</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">DataNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/tree&#x27;</span>;</span><br><span class="line"><span class="comment">// .......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getCheckedKeysArr</span> (<span class="attr">arr</span>: <span class="built_in">string</span>[]) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">brr</span>: <span class="title class_">Set</span>&lt;<span class="built_in">string</span>&gt; = <span class="keyword">new</span> <span class="title class_">Set</span>()</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; arr[i].<span class="property">length</span>; j += <span class="number">2</span>)&#123;</span><br><span class="line">      brr.<span class="title function_">add</span>(arr[i].<span class="title function_">substring</span>(<span class="number">0</span>, j + <span class="number">3</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> [...brr]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// menus 原始数据  </span></span><br><span class="line"><span class="comment">// checkedKeys转换后的数据 [&#x27;0-0&#x27;, &#x27;0-1&#x27;, &#x27;0-1-0&#x27;,  &#x27;0-2&#x27;, &#x27;0-2-0&#x27;, &#x27;0-2-0-0&#x27;, &#x27;0-2-0-1&#x27;, &#x27;0-3&#x27;, &#x27;0-3-2&#x27;]</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getPermissionMenu</span> (<span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[], <span class="attr">checkedKeys</span>: <span class="built_in">string</span>[]) &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">arr</span>: <span class="title class_">IMenuProps</span>[] = []</span><br><span class="line">  <span class="comment">// 处理第一级数据</span></span><br><span class="line">  checkedKeys.<span class="title function_">forEach</span>(<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">    menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (item.<span class="property">keyid</span> === value) &#123; <span class="comment">// 这项数据又</span></span><br><span class="line">        arr.<span class="title function_">push</span>(&#123;...item&#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 处理子数据</span></span><br><span class="line">  arr.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> newArr = <span class="title function_">getPermissionMenu</span>(item.<span class="property">children</span>, checkedKeys)</span><br><span class="line">      item.<span class="property">children</span> = newArr</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此时提示 ts配置中target 需要更改为 ‘es2015’</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tsconfig.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es2015&quot;</span><span class="punctuation">,</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="21-4-生成动态的左侧菜单项"><a href="#21-4-生成动态的左侧菜单项" class="headerlink" title="21.4 生成动态的左侧菜单项"></a>21.4 生成动态的左侧菜单项</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/SideBar.tsx 左侧菜单栏</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, <span class="title class_">Image</span>, <span class="title class_">MenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">&#x27;@/logo.svg&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getCheckedKeysArr, getPermissionMenu, getSubMenu &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useLocation, useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISideBarProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sider</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置只展开一个菜单项</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">rootSubmenuKeys</span>: <span class="built_in">string</span>[] = [];</span><br><span class="line">menus.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  item.<span class="property">children</span> &amp;&amp; rootSubmenuKeys.<span class="title function_">push</span>(item.<span class="property">key</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SideBar</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">ISideBarProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> collapsed = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">app</span>.<span class="property">collapsed</span>);</span><br><span class="line">  <span class="comment">// 获取当前路由的路径信息</span></span><br><span class="line">  <span class="keyword">const</span> &#123; pathname &#125; = <span class="title function_">useLocation</span>()</span><br><span class="line">  <span class="comment">// 当前选中的菜单项key数组</span></span><br><span class="line">  <span class="comment">// 初始值设置为 [pathname],刷新进入选中某一个菜单项</span></span><br><span class="line">  <span class="keyword">const</span> [selectedKeys, setSelectedKeys] = <span class="title function_">useState</span>([pathname])</span><br><span class="line"></span><br><span class="line">  <span class="comment">// const [openKeys, setOpenKeys] = useState&lt;string[]&gt;([&#x27;/pro&#x27;, &#x27;/pro/list&#x27;])</span></span><br><span class="line">  <span class="keyword">const</span> [openKeys, setOpenKeys] = useState&lt;<span class="built_in">string</span>[]&gt;(<span class="title function_">getSubMenu</span>(pathname))</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 展开哪一项数据</span></span><br><span class="line">  <span class="comment">// const [openKeys, setOpenKeys] = useState&lt;string[]&gt;([])</span></span><br><span class="line">  <span class="comment">// 打开一个菜单项时，需要做判断 - SubMenu 展开/关闭的回调</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">onOpenChange</span>: <span class="title class_">MenuProps</span>[<span class="string">&#x27;onOpenChange&#x27;</span>] = <span class="function"><span class="params">keys</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 如果当前展开项是 轮播图管理，再点击 账户管理 [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="comment">// console.log(&#x27;keys&#x27;, keys) // [&#x27;/banner&#x27;] =&gt;  [&#x27;/banner&#x27;, &#x27;/account&#x27;]</span></span><br><span class="line">    <span class="comment">// console.log(&#x27;openKeys&#x27;, openKeys) // [] =&gt; [&#x27;/banner&#x27;]</span></span><br><span class="line">    <span class="comment">// 得到当前</span></span><br><span class="line">    <span class="keyword">const</span> latestOpenKey = keys.<span class="title function_">find</span>(<span class="function"><span class="params">key</span> =&gt;</span> openKeys.<span class="title function_">indexOf</span>(key) === -<span class="number">1</span>); </span><br><span class="line">    <span class="comment">// console.log(&#x27;latestOpenKey&#x27;, latestOpenKey) // /banner ===&gt; /account</span></span><br><span class="line">    <span class="keyword">if</span> (rootSubmenuKeys.<span class="title function_">indexOf</span>(latestOpenKey!) === -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(keys);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">setOpenKeys</span>(latestOpenKey ? [latestOpenKey] : []);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 点击切换路由</span></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">changeUrl</span> = (<span class="params">&#123; key &#125;: &#123; key: <span class="built_in">string</span> &#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// console.log(key)</span></span><br><span class="line">    <span class="title function_">navigate</span>(key, &#123; <span class="attr">replace</span>: <span class="literal">false</span> &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点击左侧菜单，切换菜单项，选中样式</span></span><br><span class="line">    <span class="title function_">setSelectedKeys</span>([key])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听 pathname 的变化，然后调整左侧菜单打开和选中状态</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setSelectedKeys</span>([pathname])</span><br><span class="line">    <span class="title function_">setOpenKeys</span>(<span class="title function_">getSubMenu</span>(pathname))</span><br><span class="line">  &#125;, [pathname])</span><br><span class="line"></span><br><span class="line">  <span class="comment">// admin账户所有的权限均课件  其余权限是动态的</span></span><br><span class="line">  <span class="keyword">const</span> adminname = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">admins</span>.<span class="property">adminname</span>);</span><br><span class="line">  <span class="keyword">const</span> checkedKeys = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">admins</span>.<span class="property">checkedKeys</span>);</span><br><span class="line">  <span class="comment">// console.log(&#x27;checkedKeys&#x27;, checkedKeys)</span></span><br><span class="line">  <span class="keyword">let</span> newMenus = menus</span><br><span class="line">  <span class="keyword">if</span> (checkedKeys.<span class="property">length</span> === <span class="number">0</span> &amp;&amp; adminname === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">    newMenus = menus</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> newCheckedKeys = <span class="title function_">getCheckedKeysArr</span>(checkedKeys)</span><br><span class="line">    newMenus = <span class="title function_">getPermissionMenu</span>(menus, newCheckedKeys)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">color:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">logo</span> &#125; <span class="attr">width</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;28px&quot;</span> <span class="attr">preview</span>=<span class="string">&#123;</span> <span class="attr">false</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Image</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; !collapsed &amp;&amp; <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">height:</span> &#x27;<span class="attr">32px</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">overflow:</span> &#x27;<span class="attr">hidden</span>&#x27;, </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">lineHeight:</span> &#x27;<span class="attr">32px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;&gt;</span>嗨购后台管理系统<span class="tag">&lt;/<span class="name">div</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">1</span>&#x27;]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">openKeys</span> = <span class="string">&#123;</span> <span class="attr">openKeys</span> &#125; // <span class="attr">打开哪一个菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onOpenChange</span> = <span class="string">&#123;</span> <span class="attr">onOpenChange</span> &#125; // <span class="attr">打开某一个菜单项时需要关闭其他菜单项</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">changeUrl</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">selectedKeys</span> = <span class="string">&#123;</span> <span class="attr">selectedKeys</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">items</span> = <span class="string">&#123;</span> <span class="attr">newMenus</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">SideBar</span>;</span><br></pre></td></tr></table></figure><blockquote><p>有的公司在登录之后，会直接返回类似<code>router/menus.tsx</code>的数据</p></blockquote><h1 id="22、页面权限"><a href="#22、页面权限" class="headerlink" title="22、页面权限"></a>22、页面权限</h1><p>也称之为路由权限</p><p>一个有权限访问页面A的人，把整个链接地址发给了没有权限访问的另外一个人</p><p>根据数据库中存储的字段，提取当前用户需要的 menus 的数据</p><p>如果用户访问的当前路由在 总路由中但是不在当前用户的路由中，显示无权限页面，否则显示404页面</p><blockquote><p>核心思想：</p><ul><li><p>当前路由在不在权限路由 - 生成路由时使用 当前权限路由 （getPermissionMenu）</p></li><li><p>当前的路由在不在所有的路由</p></li></ul></blockquote><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/utils.tsx</span></span><br><span class="line"><span class="comment">// ....</span></span><br><span class="line"><span class="comment">// 判断当前请求的地址是不是在路由系统中</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">isContainMenus</span> (<span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[], <span class="attr">pathname</span>: <span class="built_in">string</span>) &#123; <span class="comment">// ++++++++++</span></span><br><span class="line">  <span class="keyword">let</span> bool = menus.<span class="title function_">some</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">children</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (item.<span class="property">key</span> === pathname) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> item.<span class="property">children</span>.<span class="title function_">some</span>(<span class="function"><span class="params">it</span> =&gt;</span> it.<span class="property">key</span> === pathname)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> item.<span class="property">key</span> === pathname</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> bool</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/layout/components/AppMain.tsx 内容区域</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getCheckedKeysArr, getPermissionMenu, isContainMenus, renderRoute &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Routes</span>, <span class="title class_">Route</span>, useLocation &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Page404</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/error/Page404&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAppMainProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Content</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"><span class="comment">// const arr = renderRoute(menus)</span></span><br><span class="line"><span class="comment">// console.log(&#x27;arr&#x27;, arr[1])</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppMain</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAppMainProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// admin账户所有的权限均可见  其余权限是动态的</span></span><br><span class="line">  <span class="keyword">const</span> adminname = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">admins</span>.<span class="property">adminname</span>);</span><br><span class="line">  <span class="keyword">const</span> checkedKeys = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">admins</span>.<span class="property">checkedKeys</span>);</span><br><span class="line">  <span class="comment">// console.log(&#x27;checkedKeys&#x27;, checkedKeys)</span></span><br><span class="line">  <span class="keyword">let</span> newMenus = menus</span><br><span class="line">  <span class="keyword">if</span> (checkedKeys.<span class="property">length</span> === <span class="number">0</span> &amp;&amp; adminname === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">    newMenus = menus</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> newCheckedKeys = <span class="title function_">getCheckedKeysArr</span>(checkedKeys)</span><br><span class="line">    newMenus = <span class="title function_">getPermissionMenu</span>(menus, newCheckedKeys)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; pathname &#125; = <span class="title function_">useLocation</span>()</span><br><span class="line">  <span class="keyword">const</span> flag = <span class="title function_">isContainMenus</span>(menus, pathname)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Content</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">className</span>=<span class="string">&quot;site-layout-background&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">id</span> = <span class="string">&#x27;test&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">margin:</span> &#x27;<span class="attr">24px</span> <span class="attr">16px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">padding:</span> <span class="attr">24</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">minHeight:</span> <span class="attr">280</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* </span></span><br><span class="line"><span class="language-xml">        多个路由需要定义时，包裹在Routes选项下</span></span><br><span class="line"><span class="language-xml">      */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          renderRoute(newMenus)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">        &#123;/* </span></span><br><span class="line"><span class="language-xml">            ++++++ 404+++++</span></span><br><span class="line"><span class="language-xml">        */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;*&quot;</span> <span class="attr">element</span> = <span class="string">&#123;</span> <span class="attr">flag</span> ? &lt;<span class="attr">div</span>&gt;</span>无权限<span class="tag">&lt;/<span class="name">div</span>&gt;</span> : <span class="tag">&lt;<span class="name">Page404</span> /&gt;</span> &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Content</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AppMain</span>;</span><br></pre></td></tr></table></figure><h1 id="23、按钮权限"><a href="#23、按钮权限" class="headerlink" title="23、按钮权限"></a>23、按钮权限</h1><p>超级管理员才可以批量删除</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/account/AdminList.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Tag</span>, <span class="title class_">Popconfirm</span>, <span class="title class_">Drawer</span>, <span class="title class_">Input</span>, <span class="title class_">Select</span>, <span class="title class_">Tree</span>, message, <span class="title class_">Modal</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">EditOutlined</span>,</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ColumnsType</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">TableRowSelection</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/table/interface&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">DataNode</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/es/tree&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; addAdmin, deleteAdmin, getAdminList, updateAdmin &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/admin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;@/router/menu&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getTreeData &#125; <span class="keyword">from</span> <span class="string">&#x27;@/router/utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/hook&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">adminid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">adminname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">role</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">checkedKeys</span>: <span class="built_in">any</span>[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 树形控件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">treeData</span>: <span class="title class_">DataNode</span>[] = <span class="title function_">getTreeData</span>(menus)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> [adminList, setAdminList] = useState&lt;<span class="title class_">DataType</span>[]&gt;([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getAdminListData</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 获取列表数据</span></span><br><span class="line">    <span class="comment">// console.log(66)</span></span><br><span class="line">    <span class="title function_">getAdminList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setAdminList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getAdminListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">columns</span>: <span class="title class_">ColumnsType</span>&lt;<span class="title class_">DataType</span>&gt; = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;序号&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize + index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;账户&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;adminname&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;角色&#x27;</span>,</span><br><span class="line">      <span class="attr">dataIndex</span>: <span class="string">&#x27;role&#x27;</span>,</span><br><span class="line">      <span class="attr">render</span>: <span class="function">(<span class="params">text</span>) =&gt;</span> &#123; <span class="comment">// 第一个参数即为 role </span></span><br><span class="line">        <span class="keyword">return</span> text === <span class="number">2</span> ? <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span> <span class="attr">color</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">Tag</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Tag</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// render: (_, &#123; role &#125;) =&gt; &#123; // 第一个参数即为 role 字段的值 第二个参数是当前对象</span></span><br><span class="line">      <span class="comment">//   return role === 2 ? &lt;Tag color=&quot;cyan&quot;&gt;超级管理员&lt;/Tag&gt; : &lt;Tag&gt;管理员&lt;/Tag&gt;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;操作&#x27;</span>,</span><br><span class="line">      render (_, record, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;ghost&#x27;</span>  <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">EditOutlined</span> /&gt;</span>&#125; onClick = &#123;() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              // 给表单填充数据</span></span><br><span class="line"><span class="language-xml">              setAdminname(record.adminname)</span></span><br><span class="line"><span class="language-xml">              setRole(record.role)</span></span><br><span class="line"><span class="language-xml">              setCheckedkeys(record.checkedKeys)</span></span><br><span class="line"><span class="language-xml">              // 弹出框显示</span></span><br><span class="line"><span class="language-xml">              setIsModalOpen(true)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Popconfirm</span> <span class="attr">title</span>=<span class="string">&quot;确定删除吗?&quot;</span> <span class="attr">onConfirm</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              deleteAdmin(&#123; adminid: record.adminid&#125;).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                // 删除完毕重新获取数据</span></span><br><span class="line"><span class="language-xml">                getAdminListData()</span></span><br><span class="line"><span class="language-xml">              &#125;)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125; onOpenChange=&#123;() =&gt; console.log(&#x27;open change&#x27;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 自定义选择 selectedRowKeys 批量删除的数据</span></span><br><span class="line">  <span class="keyword">const</span> [selectedRowKeys, setSelectedRowKeys] = useState&lt;<span class="title class_">React</span>.<span class="property">Key</span>[]&gt;([]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onSelectChange</span> = (<span class="params">newSelectedRowKeys: React.Key[]</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;selectedRowKeys changed: &#x27;</span>, newSelectedRowKeys);</span><br><span class="line">    <span class="title function_">setSelectedRowKeys</span>(newSelectedRowKeys);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">rowSelection</span>: <span class="title class_">TableRowSelection</span>&lt;<span class="title class_">DataType</span>&gt; = &#123;</span><br><span class="line">    selectedRowKeys,</span><br><span class="line">    <span class="attr">onChange</span>: onSelectChange,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> flag = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> selectedRowKeys.<span class="property">length</span> &gt; <span class="number">0</span></span><br><span class="line">  &#125;, [selectedRowKeys])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 抽屉效果 用来添加管理员</span></span><br><span class="line">  <span class="keyword">const</span> [open, setOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> [adminname, setAdminname] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [password, setPassword] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [role, setRole] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="comment">// 树形控件</span></span><br><span class="line">  <span class="keyword">const</span> [checkedKeys, setCheckedkeys] = <span class="title function_">useState</span>([<span class="string">&#x27;0-0&#x27;</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onAdd</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">result</span>: <span class="built_in">any</span> = &#123;</span><br><span class="line">      adminname, password, role, <span class="attr">checkedKeys</span>: checkedKeys</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">addAdmin</span>(result).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">code</span> === <span class="string">&#x27;10004&#x27;</span>) &#123;</span><br><span class="line">        message.<span class="title function_">warning</span>(<span class="string">&#x27;该管理员账户已存在&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">code</span> === <span class="string">&#x27;10008&#x27;</span>) &#123;</span><br><span class="line">        message.<span class="title function_">warning</span>(<span class="string">&#x27;账户名不符合规则&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        message.<span class="title function_">success</span>(<span class="string">&#x27;添加成功&#x27;</span>)</span><br><span class="line">        <span class="title function_">getAdminListData</span>()</span><br><span class="line">        <span class="title function_">setAdminname</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="title function_">setPassword</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="title function_">setRole</span>(<span class="number">1</span>)</span><br><span class="line">        <span class="title function_">setCheckedkeys</span>([<span class="string">&#x27;0-0&#x27;</span>])</span><br><span class="line">        <span class="title function_">setOpen</span>(<span class="literal">false</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dis = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> adminname === <span class="string">&#x27;&#x27;</span> || password === <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;, [adminname, password])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 编辑</span></span><br><span class="line">  <span class="keyword">const</span> [isModalOpen, setIsModalOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);  </span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onUpdate</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">result</span>: <span class="built_in">any</span> = &#123;</span><br><span class="line">      adminname, role, checkedKeys</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">updateAdmin</span>(result).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setIsModalOpen</span>(<span class="literal">false</span>)</span><br><span class="line">      <span class="title function_">setAdminname</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">      <span class="title function_">setRole</span>(<span class="number">1</span>)</span><br><span class="line">      <span class="title function_">setCheckedkeys</span>([<span class="string">&#x27;0-0&#x27;</span>])</span><br><span class="line">      <span class="title function_">getAdminListData</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> deleteRole = <span class="title function_">useAppSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">admins</span>.<span class="property">role</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27; &#125;&#125; <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> setOpen(true) &#125;&gt;添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; flag &amp;&amp; <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          if (deleteRole &lt; 2) &#123;</span></span><br><span class="line"><span class="language-xml">            message.warn(&#x27;暂无权限&#x27;)</span></span><br><span class="line"><span class="language-xml">            return</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">          // 思考： 还用气泡弹出框？ 自行选择删除的方案</span></span><br><span class="line"><span class="language-xml">          // 接口没有提供批量删除，只能使用单个删除解决</span></span><br><span class="line"><span class="language-xml">          // 每个删除都是基于 Promise， 综合考虑 Promise.all</span></span><br><span class="line"><span class="language-xml">          const arr: any = []</span></span><br><span class="line"><span class="language-xml">          selectedRowKeys.forEach((item: any) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            arr.push(deleteAdmin(&#123; adminid: item&#125;))</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">          Promise.all(arr).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            getAdminListData()</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;批量删除<span class="tag">&lt;/<span class="name">Button</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">columns</span>=<span class="string">&#123;</span> <span class="attr">columns</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">adminList</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">rowKey</span> = <span class="string">&quot;adminid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span> = <span class="string">&#123;</span> (<span class="attr">record</span>) =&gt;</span> record.adminid &#125;</span></span><br><span class="line"><span class="language-xml">        scroll = &#123;&#123; y: height - 330 &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        pagination = &#123; config &#125;</span></span><br><span class="line"><span class="language-xml">        rowSelection=&#123;rowSelection&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;<span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Drawer</span> <span class="attr">title</span>=<span class="string">&quot;添加管理员&quot;</span> <span class="attr">placement</span>=<span class="string">&quot;right&quot;</span> <span class="attr">onClose</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        getAdminListData()</span></span><br><span class="line"><span class="language-xml">        setAdminname(&#x27;&#x27;)</span></span><br><span class="line"><span class="language-xml">        setPassword(&#x27;&#x27;)</span></span><br><span class="line"><span class="language-xml">        setRole(1)</span></span><br><span class="line"><span class="language-xml">        setCheckedkeys([&#x27;0-0&#x27;])</span></span><br><span class="line"><span class="language-xml">        setOpen(false)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125; open=&#123;open&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Space</span> <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;账户名&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">adminname</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setAdminname(e.target.value) &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;密码&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">password</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setPassword(e.target.value) &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Select</span> <span class="attr">defaultValue</span>=<span class="string">&#123;</span> <span class="attr">1</span> &#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;&#125;&#125; <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">role</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> (<span class="attr">value</span>) =&gt;</span> setRole(value)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;2&#125;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          选择该管理员的权限：</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Tree</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkable</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkedKeys</span> = <span class="string">&#123;</span> <span class="attr">checkedKeys</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onCheck</span> = <span class="string">&#123;</span> (<span class="attr">checkedKeys:</span> <span class="attr">any</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              setCheckedkeys(checkedKeys)</span></span><br><span class="line"><span class="language-xml">              console.log(&#x27;666&#x27;, checkedKeys)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">            treeData=&#123; treeData &#125;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">onAdd</span> &#125; <span class="attr">disabled</span> = <span class="string">&#123;</span> <span class="attr">dis</span> &#125;&gt;</span>添加管理员<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Drawer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Modal</span> <span class="attr">title</span>=<span class="string">&quot;修改管理员&quot;</span> <span class="attr">footer</span>=<span class="string">&#123;null&#125;</span> <span class="attr">open</span>=<span class="string">&#123;isModalOpen&#125;</span> <span class="attr">onOk</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;&#125;&#125; onCancel=&#123; () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">         setAdminname(&#x27;&#x27;)</span></span><br><span class="line"><span class="language-xml">         setRole(1)</span></span><br><span class="line"><span class="language-xml">         setCheckedkeys([&#x27;0-0&#x27;])</span></span><br><span class="line"><span class="language-xml">        setIsModalOpen(false)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Space</span> <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">disabled</span> <span class="attr">placeholder</span>=<span class="string">&#x27;账户名&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">adminname</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setAdminname(e.target.value) &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Select</span> <span class="attr">defaultValue</span>=<span class="string">&#123;</span> <span class="attr">1</span> &#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;&#125;&#125; <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">role</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> (<span class="attr">value</span>) =&gt;</span> setRole(value)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&#123;2&#125;</span>&gt;</span>超级管理员<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          选择该管理员的权限：</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Tree</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkable</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checkedKeys</span> = <span class="string">&#123;</span> <span class="attr">checkedKeys</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onCheck</span> = <span class="string">&#123;</span> (<span class="attr">checkedKeys:</span> <span class="attr">any</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              setCheckedkeys(checkedKeys)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">            treeData=&#123; treeData &#125;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">onUpdate</span> &#125; &gt;</span>修改管理员权限<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Modal</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><p><img src="/posts/60af50c8/image-20221027171749565.png" alt="image-20221027171749565"></p><blockquote><p>单点登录</p></blockquote><h1 id="24、轮播图管理"><a href="#24、轮播图管理" class="headerlink" title="24、轮播图管理"></a>24、轮播图管理</h1><h2 id="24-1-封装接口"><a href="#24-1-封装接口" class="headerlink" title="24.1 封装接口"></a>24.1 封装接口</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/api/banner.ts</span></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&quot;../utils/request&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IBannerParams</span> &#123;</span><br><span class="line">  <span class="attr">img</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">alt</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">link</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getBannerList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/banner/list&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">addBanner</span> (<span class="attr">params</span>: <span class="title class_">IBannerParams</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/banner/add&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">deleteBanner</span> (<span class="attr">params</span>: &#123; <span class="attr">bannerid</span>: <span class="built_in">string</span>&#125;) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/banner/delete&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="24-2-轮播图页面渲染"><a href="#24-2-轮播图页面渲染" class="headerlink" title="24.2 轮播图页面渲染"></a>24.2 轮播图页面渲染</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/banner/List.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; getBannerList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/banner&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>,useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Image</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line">   <span class="comment">// 分页设置</span></span><br><span class="line">   <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [list, setList] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getBannerListData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">getBannerList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getBannerListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        navigate(&#x27;/banner/add&#x27;)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;添加轮播图<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span>=<span class="string">&quot;bannerid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span> = <span class="string">&#123;</span> <span class="attr">list</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">scroll</span> = <span class="string">&#123;&#123;</span> <span class="attr">y:</span> <span class="attr">height</span> <span class="attr">-</span> <span class="attr">330</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">pagination</span> = <span class="string">&#123;</span> <span class="attr">config</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;序号&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> (<span class="attr">_</span> ,<span class="attr">record</span>, <span class="attr">index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;图片&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;img&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> <span class="attr">text</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">text</span>&#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">80</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;alt&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;alt&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;link&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;link&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="24-3-删除轮播图"><a href="#24-3-删除轮播图" class="headerlink" title="24.3 删除轮播图"></a>24.3 删除轮播图</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/banner/List.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; deleteBanner, getBannerList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/banner&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>,useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Image</span>, <span class="title class_">Popconfirm</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">bannerid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">alt</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">link</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">flag</span>: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line">   <span class="comment">// 分页设置</span></span><br><span class="line">   <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [list, setList] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getBannerListData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">getBannerList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getBannerListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        navigate(&#x27;/banner/add&#x27;)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;添加轮播图<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span>=<span class="string">&quot;bannerid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span> = <span class="string">&#123;</span> <span class="attr">list</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">scroll</span> = <span class="string">&#123;&#123;</span> <span class="attr">y:</span> <span class="attr">height</span> <span class="attr">-</span> <span class="attr">330</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">pagination</span> = <span class="string">&#123;</span> <span class="attr">config</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;序号&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> (<span class="attr">_</span> ,<span class="attr">record</span>, <span class="attr">index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;图片&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;img&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> <span class="attr">text</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">text</span>&#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">80</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;alt&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;alt&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;link&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;link&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">_</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Popconfirm</span> <span class="attr">title</span>=<span class="string">&quot;确定删除吗?&quot;</span> <span class="attr">onConfirm</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              deleteBanner(&#123; bannerid: record.bannerid&#125;).then(() =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                // 删除完毕重新获取数据</span></span><br><span class="line"><span class="language-xml">                getBannerListData()</span></span><br><span class="line"><span class="language-xml">              &#125;)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125; onOpenChange=&#123;() =&gt; console.log(&#x27;open change&#x27;)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="23-4-添加轮播图"><a href="#23-4-添加轮播图" class="headerlink" title="23.4 添加轮播图"></a>23.4 添加轮播图</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/banner/Add.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; addBanner &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/banner&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Image</span>, <span class="title class_">Input</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useState, useRef, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [link, setLink] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [alt, setAlt] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [img, setImg] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> file = useRef&lt;<span class="built_in">any</span>&gt;()</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onChange</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// console.log(file.current.input .files)</span></span><br><span class="line">    <span class="keyword">const</span> fileInfo = file.<span class="property">current</span>.<span class="property">input</span>.<span class="property">files</span>[<span class="number">0</span>]</span><br><span class="line">    <span class="comment">// 利用文件API FileReader 对象 生成图片base64地址</span></span><br><span class="line">    <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>()</span><br><span class="line">    reader.<span class="title function_">readAsDataURL</span>(fileInfo)</span><br><span class="line">    reader.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// this.result 的结果即为 读取之后的值</span></span><br><span class="line">      <span class="title function_">setImg</span>(<span class="variable language_">this</span>.<span class="property">result</span> <span class="keyword">as</span> <span class="built_in">string</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> flag = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> link === <span class="string">&#x27;&#x27;</span> || alt === <span class="string">&#x27;&#x27;</span> || img === <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;, [link, alt, img])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onAdd</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">addBanner</span>(&#123;</span><br><span class="line">      link, alt, img</span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">navigate</span>(-<span class="number">1</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">300</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;link&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;link&#125;</span> <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setLink(e.target.value)&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;alt&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;alt&#125;</span> <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setAlt(e.target.value)&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">file</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">onChange</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;图片地址&#x27;</span> <span class="attr">value</span> = <span class="string">&#123;img&#125;</span> <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">e</span> =&gt;</span> setImg(e.target.value)&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span>=<span class="string">&#123;img&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">disabled</span> = <span class="string">&#123;</span> <span class="attr">flag</span> &#125; <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">onAdd</span> &#125;&gt;</span>添加<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h1 id="25-产品管理"><a href="#25-产品管理" class="headerlink" title="25.产品管理"></a>25.产品管理</h1><h2 id="25-1-封装接口"><a href="#25-1-封装接口" class="headerlink" title="25.1 封装接口"></a>25.1 封装接口</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/api/pro.ts</span></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&quot;../utils/request&quot;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ISearchParams</span> &#123;</span><br><span class="line">  <span class="attr">category</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">search</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 首页产品列表</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getProList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pro/list&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 筛选列表数据</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getSearchProList</span> (<span class="attr">params</span>: <span class="title class_">ISearchParams</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pro/searchPro&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: params</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 获取商品分类</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getCategoryList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pro/getCategory&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 商品推荐列表</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getDetailRecommendList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pro/showdata&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;isrecommend&#x27;</span>,</span><br><span class="line">      <span class="attr">flag</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 购物车推荐列表</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getCartRecommendList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pro/showdata&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;isrecommend&#x27;</span>,</span><br><span class="line">      <span class="attr">flag</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 修改推荐</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">updateRecommend</span> (<span class="attr">params</span>: &#123; <span class="attr">proid</span>: <span class="built_in">string</span>, <span class="attr">flag</span>: <span class="built_in">boolean</span> &#125;) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pro/updateFlag&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      ...params,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;isrecommend&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改秒杀</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">updateSeckill</span> (<span class="attr">params</span>: &#123; <span class="attr">proid</span>: <span class="built_in">string</span>, <span class="attr">flag</span>: <span class="built_in">boolean</span> &#125;) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pro/updateFlag&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      ...params,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;isseckill&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="25-2-首页产品列表"><a href="#25-2-首页产品列表" class="headerlink" title="25.2  首页产品列表"></a>25.2 首页产品列表</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/product/list/Home.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>,useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Image</span>, <span class="title class_">Switch</span>  &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getProList, updateRecommend, updateSeckill &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/pro&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">banners</span>: <span class="built_in">string</span>[]</span><br><span class="line">  <span class="attr">brand</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">category</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">discount</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">img1</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img2</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img3</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img4</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">isrecommend</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">issale</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">isseckill</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">originprice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">proid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">proname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">sales</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">stock</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [list, setList] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getProListData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">getProList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getProListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>添加商品<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span>=<span class="string">&quot;proid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span> = <span class="string">&#123;</span> <span class="attr">list</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">scroll</span> = <span class="string">&#123;&#123;</span> <span class="attr">y:</span> <span class="attr">height</span> <span class="attr">-</span> <span class="attr">330</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">pagination</span> = <span class="string">&#123;</span> <span class="attr">config</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;序号&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> (<span class="attr">_</span> ,<span class="attr">record</span>, <span class="attr">index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize +index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;图片&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;img1&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> <span class="attr">text</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">text</span>&#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">80</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;商品名称&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;proname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;商品价格&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;originprice&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;是否秒杀&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;isseckill&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">defaultChecked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1&#125;</span>  <span class="attr">onChange</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                console.log(text)</span></span><br><span class="line"><span class="language-xml">                updateSeckill(&#123; proid: record.proid, flag: text === 0&#125;).then(() =&gt; getProListData())</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;是否推荐&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;isrecommend&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">defaultChecked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1&#125;</span>  <span class="attr">onChange</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                updateRecommend(&#123; proid: record.proid , flag: text === 0&#125;).then(() =&gt; getProListData())</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">_</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="25-3-详情推荐数据"><a href="#25-3-详情推荐数据" class="headerlink" title="25.3 详情推荐数据"></a>25.3 详情推荐数据</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/product/list/Detail.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>,useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Image</span>, <span class="title class_">Switch</span>  &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getDetailRecommendList, updateRecommend, updateSeckill &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/pro&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">banners</span>: <span class="built_in">string</span>[]</span><br><span class="line">  <span class="attr">brand</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">category</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">discount</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">img1</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img2</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img3</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img4</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">isrecommend</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">issale</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">isseckill</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">originprice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">proid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">proname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">sales</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">stock</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [list, setList] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getProListData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">getDetailRecommendList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getProListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>添加商品<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span>=<span class="string">&quot;proid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span> = <span class="string">&#123;</span> <span class="attr">list</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">scroll</span> = <span class="string">&#123;&#123;</span> <span class="attr">y:</span> <span class="attr">height</span> <span class="attr">-</span> <span class="attr">330</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">pagination</span> = <span class="string">&#123;</span> <span class="attr">config</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;序号&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> (<span class="attr">_</span> ,<span class="attr">record</span>, <span class="attr">index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize +index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;图片&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;img1&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> <span class="attr">text</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">text</span>&#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">80</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;商品名称&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;proname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;商品价格&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;originprice&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;是否推荐&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;isrecommend&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">defaultChecked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1&#125;</span>  <span class="attr">onChange</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                updateRecommend(&#123; proid: record.proid , flag: text === 0&#125;).then(() =&gt; getProListData())</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">_</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="25-4-购物车推荐数据"><a href="#25-4-购物车推荐数据" class="headerlink" title="25.4 购物车推荐数据"></a>25.4 购物车推荐数据</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/product/list/Cart.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>,useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Image</span>, <span class="title class_">Switch</span>  &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getDetailRecommendList, updateRecommend, updateSeckill &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/pro&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">banners</span>: <span class="built_in">string</span>[]</span><br><span class="line">  <span class="attr">brand</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">category</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">discount</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">img1</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img2</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img3</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img4</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">isrecommend</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">issale</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">isseckill</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">originprice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">proid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">proname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">sales</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">stock</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [list, setList] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getProListData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">getDetailRecommendList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getProListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>添加商品<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span>=<span class="string">&quot;proid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span> = <span class="string">&#123;</span> <span class="attr">list</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">scroll</span> = <span class="string">&#123;&#123;</span> <span class="attr">y:</span> <span class="attr">height</span> <span class="attr">-</span> <span class="attr">330</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">pagination</span> = <span class="string">&#123;</span> <span class="attr">config</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;序号&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> (<span class="attr">_</span> ,<span class="attr">record</span>, <span class="attr">index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize +index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;图片&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;img1&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> <span class="attr">text</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">text</span>&#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">80</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;商品名称&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;proname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;商品价格&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;originprice&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;是否推荐&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;isrecommend&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">defaultChecked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1&#125;</span>  <span class="attr">onChange</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                updateRecommend(&#123; proid: record.proid , flag: text === 0&#125;).then(() =&gt; getProListData())</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">_</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h2 id="25-5-筛选列表"><a href="#25-5-筛选列表" class="headerlink" title="25.5 筛选列表"></a>25.5 筛选列表</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/product/Search.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>,useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Image</span>, <span class="title class_">Switch</span>, <span class="title class_">Select</span>, <span class="title class_">Input</span>  &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getCategoryList, getProList, updateRecommend, updateSeckill, getSearchProList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/pro&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">banners</span>: <span class="built_in">string</span>[]</span><br><span class="line">  <span class="attr">brand</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">category</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">discount</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">img1</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img2</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img3</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img4</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">isrecommend</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">issale</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">isseckill</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">originprice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">proid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">proname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">sales</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">stock</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [list, setList] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getProListData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">getProList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getProListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [categoryList, setCategoryList] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="keyword">const</span> [category, setCategory] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [search, setSearch] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getCategoryList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="title function_">setCategoryList</span>(res.<span class="property">data</span>.<span class="property">data</span>))</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Select</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">category</span> &#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">100</span> &#125;&#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">value</span> =&gt;</span> setCategory(value)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>全部<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            categoryList &amp;&amp; categoryList.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Select.Option</span> <span class="attr">key</span> = <span class="string">&#123;index&#125;</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">item</span> &#125;&gt;</span>&#123; item &#125;<span class="tag">&lt;/<span class="name">Select.Option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              )</span></span><br><span class="line"><span class="language-xml">            &#125;)</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Input</span> <span class="attr">placeholder</span>=<span class="string">&#x27;请输入搜索关键词&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">search</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> (<span class="attr">e</span>) =&gt;</span> setSearch(e.target.value)&#125;&gt;<span class="tag">&lt;/<span class="name">Input</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          getSearchProList(&#123; category, search&#125;).then(res =&gt; setList(res.data.data))</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;搜索<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span>=<span class="string">&quot;proid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span> = <span class="string">&#123;</span> <span class="attr">list</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">scroll</span> = <span class="string">&#123;&#123;</span> <span class="attr">y:</span> <span class="attr">height</span> <span class="attr">-</span> <span class="attr">330</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">pagination</span> = <span class="string">&#123;</span> <span class="attr">config</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;序号&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> (<span class="attr">_</span> ,<span class="attr">record</span>, <span class="attr">index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize +index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;图片&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;img1&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> <span class="attr">text</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">text</span>&#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">80</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;商品名称&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;proname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;商品价格&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;originprice&quot;</span> <span class="attr">sorter</span>=<span class="string">&#123;(a:</span> <span class="attr">DataType</span>,<span class="attr">b:</span> <span class="attr">DataType</span>) =&gt;</span> a.originprice - b.originprice&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;是否秒杀&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;isseckill&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">defaultChecked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1&#125;</span>  <span class="attr">onChange</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                console.log(text)</span></span><br><span class="line"><span class="language-xml">                updateSeckill(&#123; proid: record.proid, flag: text === 0&#125;).then(() =&gt; getProListData())</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;是否推荐&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;isrecommend&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">defaultChecked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1&#125;</span>  <span class="attr">onChange</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                updateRecommend(&#123; proid: record.proid , flag: text === 0&#125;).then(() =&gt; getProListData())</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">_</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><h1 id="26-数据可视化"><a href="#26-数据可视化" class="headerlink" title="26.数据可视化"></a>26.数据可视化</h1><p>方案：</p><p>echarts: <a target="_blank" rel="noopener" href="https://echarts.apache.org/zh/index.html">https://echarts.apache.org/zh/index.html</a></p><blockquote><p>ts中使用 echarts ： <a target="_blank" rel="noopener" href="https://echarts.apache.org/handbook/zh/basics/import#%E5%9C%A8-typescript-%E4%B8%AD%E6%8C%89%E9%9C%80%E5%BC%95%E5%85%A5">https://echarts.apache.org/handbook/zh/basics/import#%E5%9C%A8-typescript-%E4%B8%AD%E6%8C%89%E9%9C%80%E5%BC%95%E5%85%A5</a></p></blockquote><p>highCharts:<a target="_blank" rel="noopener" href="https://www.highcharts.com.cn/">https://www.highcharts.com.cn/</a></p><p>Antv: <a target="_blank" rel="noopener" href="https://antv.gitee.io/zh/">https://antv.gitee.io/zh/</a></p><pre><code>g2:https://antv-g2.gitee.io/zh/

g2plot:https://g2plot.antv.vision/zh/

react中使用g2:https://charts.ant.design/zh-CN
</code></pre><p>D3:视频地址：链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1SVS36TjtcR27Rqj_HURDZA">https://pan.baidu.com/s/1SVS36TjtcR27Rqj_HURDZA</a> 密码: p9ur</p><h2 id="1-echarts"><a href="#1-echarts" class="headerlink" title="1.echarts"></a>1.echarts</h2><p>添加页面以及配置路由</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/data/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Outlet</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IDataProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Data</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IDataProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>数据可视化<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Data</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/data/ECharts.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IEChartsProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ECharts</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IEChartsProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>ECharts<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ECharts</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/data/HighCharts.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IHighChartsProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HighCharts</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IHighChartsProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>HighCharts<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HighCharts</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/data/Antv.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAntvProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Antv</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAntvProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>Antv<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Antv</span>;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/menu.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">PictureOutlined</span>,</span><br><span class="line">  <span class="title class_">ProfileOutlined</span>,</span><br><span class="line">  <span class="title class_">OrderedListOutlined</span>,</span><br><span class="line">  <span class="title class_">FilterOutlined</span>,</span><br><span class="line">  <span class="title class_">TeamOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/home/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Banner</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/List&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerActive</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Active&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerAdd</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Add&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Product</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductSearch</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Search&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductHomeList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductDetailList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Detail&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductCartList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Cart&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Account</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/UserList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AdminList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/AdminList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Setting</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/setting/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Data</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ECharts</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/ECharts&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HighCharts</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/HighCharts&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Antv</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/Antv&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-0&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;轮播图管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-1&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="comment">// redirect: &#x27;/banner/home&#x27;,</span></span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Banner</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/home&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;活动页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/active&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerActive</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;添加轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/add&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerAdd</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">hidden</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;产品管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/pro&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-2&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProfileOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Product</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;产品列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/list&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">OrderedListOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;首页产品列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/home&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-0&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductHomeList</span> /&gt;</span></span>,</span><br><span class="line">            <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;详情推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/detail&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-1&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductDetailList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;购物车推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/cart&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-2&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductCartList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;筛选列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/search&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">FilterOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductSearch</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;账户管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/account&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-3&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">TeamOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Account</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;用户列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/userlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;管理员列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/adminlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AdminList</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;设置&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/setting&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-4&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Setting</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;数据可视化&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/data&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-5&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Data</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;ECharts&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/echarts&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ECharts</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;HighCharts&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/highcharts&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HighCharts</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;antv&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/antv&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Antv</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install echarts --save</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/api/data.ts</span></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;./../utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getData</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/data/simpleData&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>处理数据</p><p>自适应</p></blockquote><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/data/ECharts.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Col</span>, <span class="title class_">Row</span>, <span class="title class_">Button</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> echarts <span class="keyword">from</span> <span class="string">&#x27;echarts&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getData &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/data&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IEChartsProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ECharts</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IEChartsProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [data, setData] = useState&lt;<span class="built_in">any</span>[]&gt;([])</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getData</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setData</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> serverCharts = echarts.<span class="title function_">init</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;serverCharts&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLDivElement</span>);</span><br><span class="line">    serverCharts.<span class="title function_">setOption</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: &#123;</span><br><span class="line">        <span class="attr">text</span>: <span class="string">&#x27;折线图示例&#x27;</span>,</span><br><span class="line">        <span class="attr">left</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">legend</span>: &#123;</span><br><span class="line">        <span class="attr">data</span>: [<span class="string">&#x27;销量&#x27;</span>, <span class="string">&#x27;销量1&#x27;</span>],</span><br><span class="line">        <span class="attr">bottom</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">left</span>: <span class="string">&#x27;center&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">toolbox</span>: &#123;</span><br><span class="line">        <span class="attr">feature</span>: &#123;</span><br><span class="line">          <span class="attr">dataZoom</span>: &#123;</span><br><span class="line">            <span class="attr">yAxisIndex</span>: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">restore</span>: &#123;&#125;,</span><br><span class="line">          <span class="attr">saveAsImage</span>: &#123;&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">right</span>: <span class="number">200</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">xAxis</span>: &#123;</span><br><span class="line">        <span class="attr">data</span>: data.<span class="title function_">map</span>(<span class="function">(<span class="params">item:<span class="built_in">any</span></span>) =&gt;</span> item.<span class="property">x</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">yAxis</span>: &#123;&#125;,</span><br><span class="line">      <span class="attr">series</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;销量&#x27;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;line&#x27;</span>, <span class="comment">// 折线图</span></span><br><span class="line">          <span class="attr">data</span>: data.<span class="title function_">map</span>(<span class="function">(<span class="params">item:<span class="built_in">any</span></span>) =&gt;</span> item.<span class="property">val</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>,<span class="function">() =&gt;</span> &#123; </span><br><span class="line">      serverCharts &amp;&amp; serverCharts.<span class="title function_">resize</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [data])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> barCharts = echarts.<span class="title function_">init</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;barCharts&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLDivElement</span>);</span><br><span class="line">    barCharts.<span class="title function_">setOption</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: &#123;</span><br><span class="line">        <span class="attr">text</span>: <span class="string">&#x27;柱状图示例&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">tooltip</span>: &#123;&#125;,</span><br><span class="line">      <span class="attr">xAxis</span>: &#123;</span><br><span class="line">        <span class="attr">data</span>: [<span class="string">&#x27;衬衫&#x27;</span>, <span class="string">&#x27;羊毛衫&#x27;</span>, <span class="string">&#x27;雪纺衫&#x27;</span>, <span class="string">&#x27;裤子&#x27;</span>, <span class="string">&#x27;高跟鞋&#x27;</span>, <span class="string">&#x27;袜子&#x27;</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">yAxis</span>: &#123;&#125;,</span><br><span class="line">      <span class="attr">series</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;销量&#x27;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;bar&#x27;</span>, <span class="comment">// 柱状图</span></span><br><span class="line">          <span class="attr">data</span>: [<span class="number">5</span>, <span class="number">20</span>, <span class="number">36</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">20</span>]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>,<span class="function">() =&gt;</span> &#123; </span><br><span class="line">      barCharts &amp;&amp; barCharts.<span class="title function_">resize</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> lineCharts = echarts.<span class="title function_">init</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;lineCharts&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLDivElement</span>);</span><br><span class="line">    lineCharts.<span class="title function_">setOption</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: &#123;</span><br><span class="line">        <span class="attr">text</span>: <span class="string">&#x27;折线图示例&#x27;</span>,</span><br><span class="line">        <span class="attr">left</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">legend</span>: &#123;</span><br><span class="line">        <span class="attr">data</span>: [<span class="string">&#x27;销量&#x27;</span>, <span class="string">&#x27;销量1&#x27;</span>],</span><br><span class="line">        <span class="attr">bottom</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">left</span>: <span class="string">&#x27;center&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">toolbox</span>: &#123;</span><br><span class="line">        <span class="attr">feature</span>: &#123;</span><br><span class="line">          <span class="attr">dataZoom</span>: &#123;</span><br><span class="line">            <span class="attr">yAxisIndex</span>: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">restore</span>: &#123;&#125;,</span><br><span class="line">          <span class="attr">saveAsImage</span>: &#123;&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">right</span>: <span class="number">200</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">xAxis</span>: &#123;</span><br><span class="line">        <span class="attr">data</span>: [<span class="string">&#x27;衬衫&#x27;</span>, <span class="string">&#x27;羊毛衫&#x27;</span>, <span class="string">&#x27;雪纺衫&#x27;</span>, <span class="string">&#x27;裤子&#x27;</span>, <span class="string">&#x27;高跟鞋&#x27;</span>, <span class="string">&#x27;袜子&#x27;</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">yAxis</span>: &#123;&#125;,</span><br><span class="line">      <span class="attr">series</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;销量&#x27;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;line&#x27;</span>, <span class="comment">// 折线图</span></span><br><span class="line">          <span class="attr">data</span>: [<span class="number">5</span>, <span class="number">20</span>, <span class="number">36</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">20</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;销量1&#x27;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;line&#x27;</span>, <span class="comment">// 折线图</span></span><br><span class="line">          <span class="attr">data</span>: [<span class="number">15</span>, <span class="number">200</span>, <span class="number">316</span>, <span class="number">210</span>, <span class="number">410</span>, <span class="number">300</span>]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>,<span class="function">() =&gt;</span> &#123; </span><br><span class="line">      lineCharts &amp;&amp; lineCharts.<span class="title function_">resize</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> randomCharts = echarts.<span class="title function_">init</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;randomCharts&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLDivElement</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> base = +<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">1988</span>, <span class="number">9</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">let</span> oneDay = <span class="number">24</span> * <span class="number">3600</span> * <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">let</span> data = [[base, <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">300</span>]];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="number">20000</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>((base += oneDay));</span><br><span class="line">      data.<span class="title function_">push</span>([+now, <span class="title class_">Math</span>.<span class="title function_">round</span>((<span class="title class_">Math</span>.<span class="title function_">random</span>() - <span class="number">0.5</span>) * <span class="number">20</span> + data[i - <span class="number">1</span>][<span class="number">1</span>])]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    randomCharts.<span class="title function_">setOption</span>(&#123;</span><br><span class="line">      <span class="attr">tooltip</span>: &#123;</span><br><span class="line">        <span class="attr">trigger</span>: <span class="string">&#x27;axis&#x27;</span>,</span><br><span class="line">        <span class="attr">position</span>: <span class="keyword">function</span> (<span class="params">pt: <span class="built_in">any</span>[]</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> [pt[<span class="number">0</span>], <span class="string">&#x27;10%&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">title</span>: &#123;</span><br><span class="line">        <span class="attr">left</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">        <span class="attr">text</span>: <span class="string">&#x27;Large Ara Chart&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">toolbox</span>: &#123;</span><br><span class="line">        <span class="attr">feature</span>: &#123;</span><br><span class="line">          <span class="attr">dataZoom</span>: &#123;</span><br><span class="line">            <span class="attr">yAxisIndex</span>: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">restore</span>: &#123;&#125;,</span><br><span class="line">          <span class="attr">saveAsImage</span>: &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">xAxis</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;time&#x27;</span>,</span><br><span class="line">        <span class="attr">boundaryGap</span>: <span class="literal">false</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">yAxis</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;value&#x27;</span>,</span><br><span class="line">        <span class="attr">boundaryGap</span>: [<span class="number">0</span>, <span class="string">&#x27;100%&#x27;</span>]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">dataZoom</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;inside&#x27;</span>,</span><br><span class="line">          <span class="attr">start</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">end</span>: <span class="number">20</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">start</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">end</span>: <span class="number">20</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">series</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;Fake Data&#x27;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;line&#x27;</span>,</span><br><span class="line">          <span class="attr">smooth</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">symbol</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">          <span class="attr">areaStyle</span>: &#123;&#125;,</span><br><span class="line">          <span class="attr">data</span>: data</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>,<span class="function">() =&gt;</span> &#123; </span><br><span class="line">      randomCharts &amp;&amp; randomCharts.<span class="title function_">resize</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">changeData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setData</span>([</span><br><span class="line">      &#123;<span class="attr">x</span>: <span class="string">&#x27;星期一&#x27;</span>, <span class="attr">val</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">500</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">x</span>: <span class="string">&#x27;星期二&#x27;</span>, <span class="attr">val</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">350</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">x</span>: <span class="string">&#x27;星期三&#x27;</span>, <span class="attr">val</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">150</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">x</span>: <span class="string">&#x27;星期四&#x27;</span>, <span class="attr">val</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">650</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">x</span>: <span class="string">&#x27;星期五&#x27;</span>, <span class="attr">val</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">50</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">x</span>: <span class="string">&#x27;星期六&#x27;</span>, <span class="attr">val</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">850</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">x</span>: <span class="string">&#x27;星期日&#x27;</span>, <span class="attr">val</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">150</span>&#125;</span><br><span class="line">    ])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>ECharts<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">changeData</span> &#125;&gt;</span>改变数据data<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Row</span> <span class="attr">gutter</span>=<span class="string">&#123;15&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Col</span> <span class="attr">span</span>=<span class="string">&#123;12&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>柱状图<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;barCharts&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;, <span class="attr">height:</span> <span class="attr">300</span> &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Col</span> <span class="attr">span</span>=<span class="string">&#123;12&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>折线图<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;lineCharts&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;, <span class="attr">height:300</span>  &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Row</span> <span class="attr">gutter</span>=<span class="string">&#123;15&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Col</span> <span class="attr">span</span>=<span class="string">&#123;12&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>随意图形<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;randomCharts&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;, <span class="attr">height:</span> <span class="attr">300</span> &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Col</span> <span class="attr">span</span>=<span class="string">&#123;12&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span>服务器数据<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;serverCharts&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;, <span class="attr">height:</span> <span class="attr">300</span> &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Col</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Row</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ECharts</span>;</span><br></pre></td></tr></table></figure><h2 id="2-Highcharts"><a href="#2-Highcharts" class="headerlink" title="2.Highcharts"></a>2.Highcharts</h2><p>vue: <a target="_blank" rel="noopener" href="https://www.highcharts.com.cn/docs/highcharts-vue">https://www.highcharts.com.cn/docs/highcharts-vue</a></p><p>react: <a target="_blank" rel="noopener" href="https://www.highcharts.com.cn/docs/highcharts-react">https://www.highcharts.com.cn/docs/highcharts-react</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install highcharts highcharts-react-official -S</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/data/HighCharts.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">Highcharts</span> <span class="keyword">from</span> <span class="string">&#x27;highcharts&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HighchartsReact</span> <span class="keyword">from</span> <span class="string">&#x27;highcharts-react-official&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">HighchartsReact</span>)</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IHighChartsProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HighCharts</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IHighChartsProps</span>&gt; = <span class="function">(<span class="params">props: HighchartsReact.Props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [option, setOption] = useState&lt;<span class="built_in">any</span>&gt;(&#123;</span><br><span class="line">		<span class="attr">title</span>: &#123;</span><br><span class="line">				<span class="attr">text</span>: <span class="string">&#x27;2010 ~ 2016 年太阳能行业就业人员发展情况&#x27;</span></span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="attr">subtitle</span>: &#123;</span><br><span class="line">				<span class="attr">text</span>: <span class="string">&#x27;数据来源：thesolarfoundation.com&#x27;</span></span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="attr">yAxis</span>: &#123;</span><br><span class="line">				<span class="attr">title</span>: &#123;</span><br><span class="line">						<span class="attr">text</span>: <span class="string">&#x27;就业人数&#x27;</span></span><br><span class="line">				&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="attr">legend</span>: &#123;</span><br><span class="line">				<span class="attr">layout</span>: <span class="string">&#x27;vertical&#x27;</span>,</span><br><span class="line">				<span class="attr">align</span>: <span class="string">&#x27;right&#x27;</span>,</span><br><span class="line">				<span class="attr">verticalAlign</span>: <span class="string">&#x27;middle&#x27;</span></span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="attr">plotOptions</span>: &#123;</span><br><span class="line">				<span class="attr">series</span>: &#123;</span><br><span class="line">						<span class="attr">label</span>: &#123;</span><br><span class="line">								<span class="attr">connectorAllowed</span>: <span class="literal">false</span></span><br><span class="line">						&#125;,</span><br><span class="line">						<span class="attr">pointStart</span>: <span class="number">2010</span></span><br><span class="line">				&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="attr">series</span>: [&#123;</span><br><span class="line">				<span class="attr">name</span>: <span class="string">&#x27;安装，实施人员&#x27;</span>,</span><br><span class="line">				<span class="attr">data</span>: [<span class="number">43934</span>, <span class="number">52503</span>, <span class="number">57177</span>, <span class="number">69658</span>, <span class="number">97031</span>, <span class="number">119931</span>, <span class="number">137133</span>, <span class="number">154175</span>]</span><br><span class="line">		&#125;, &#123;</span><br><span class="line">				<span class="attr">name</span>: <span class="string">&#x27;工人&#x27;</span>,</span><br><span class="line">				<span class="attr">data</span>: [<span class="number">24916</span>, <span class="number">24064</span>, <span class="number">29742</span>, <span class="number">29851</span>, <span class="number">32490</span>, <span class="number">30282</span>, <span class="number">38121</span>, <span class="number">40434</span>]</span><br><span class="line">		&#125;, &#123;</span><br><span class="line">				<span class="attr">name</span>: <span class="string">&#x27;销售&#x27;</span>,</span><br><span class="line">				<span class="attr">data</span>: [<span class="number">11744</span>, <span class="number">17722</span>, <span class="number">16005</span>, <span class="number">19771</span>, <span class="number">20185</span>, <span class="number">24377</span>, <span class="number">32147</span>, <span class="number">39387</span>]</span><br><span class="line">		&#125;, &#123;</span><br><span class="line">				<span class="attr">name</span>: <span class="string">&#x27;项目开发&#x27;</span>,</span><br><span class="line">				<span class="attr">data</span>: [<span class="literal">null</span>, <span class="literal">null</span>, <span class="number">7988</span>, <span class="number">12169</span>, <span class="number">15112</span>, <span class="number">22452</span>, <span class="number">34400</span>, <span class="number">34227</span>]</span><br><span class="line">		&#125;, &#123;</span><br><span class="line">				<span class="attr">name</span>: <span class="string">&#x27;其他&#x27;</span>,</span><br><span class="line">				<span class="attr">data</span>: [<span class="number">12908</span>, <span class="number">5948</span>, <span class="number">8105</span>, <span class="number">11248</span>, <span class="number">8989</span>, <span class="number">11816</span>, <span class="number">18274</span>, <span class="number">18111</span>]</span><br><span class="line">		&#125;],</span><br><span class="line">		<span class="attr">responsive</span>: &#123;</span><br><span class="line">				<span class="attr">rules</span>: [&#123;</span><br><span class="line">						<span class="attr">condition</span>: &#123;</span><br><span class="line">								<span class="attr">maxWidth</span>: <span class="number">500</span></span><br><span class="line">						&#125;,</span><br><span class="line">						<span class="attr">chartOptions</span>: &#123;</span><br><span class="line">								<span class="attr">legend</span>: &#123;</span><br><span class="line">										<span class="attr">layout</span>: <span class="string">&#x27;horizontal&#x27;</span>,</span><br><span class="line">										<span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">										<span class="attr">verticalAlign</span>: <span class="string">&#x27;bottom&#x27;</span></span><br><span class="line">								&#125;</span><br><span class="line">						&#125;</span><br><span class="line">				&#125;]</span><br><span class="line">		&#125;</span><br><span class="line">&#125;)</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>,<span class="function">() =&gt;</span> &#123; </span><br><span class="line">      <span class="title function_">setOption</span>(&#123;</span><br><span class="line">        <span class="attr">title</span>: &#123;</span><br><span class="line">            <span class="attr">text</span>: <span class="string">&#x27;2010 ~ 2016 年太阳能行业就业人员发展情况&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">subtitle</span>: &#123;</span><br><span class="line">            <span class="attr">text</span>: <span class="string">&#x27;数据来源：thesolarfoundation.com&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">yAxis</span>: &#123;</span><br><span class="line">            <span class="attr">title</span>: &#123;</span><br><span class="line">                <span class="attr">text</span>: <span class="string">&#x27;就业人数&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">legend</span>: &#123;</span><br><span class="line">            <span class="attr">layout</span>: <span class="string">&#x27;vertical&#x27;</span>,</span><br><span class="line">            <span class="attr">align</span>: <span class="string">&#x27;right&#x27;</span>,</span><br><span class="line">            <span class="attr">verticalAlign</span>: <span class="string">&#x27;middle&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">plotOptions</span>: &#123;</span><br><span class="line">            <span class="attr">series</span>: &#123;</span><br><span class="line">                <span class="attr">label</span>: &#123;</span><br><span class="line">                    <span class="attr">connectorAllowed</span>: <span class="literal">false</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">pointStart</span>: <span class="number">2010</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">series</span>: [&#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;安装，实施人员&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: [<span class="number">43934</span>, <span class="number">52503</span>, <span class="number">57177</span>, <span class="number">69658</span>, <span class="number">97031</span>, <span class="number">119931</span>, <span class="number">137133</span>, <span class="number">154175</span>]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;工人&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: [<span class="number">24916</span>, <span class="number">24064</span>, <span class="number">29742</span>, <span class="number">29851</span>, <span class="number">32490</span>, <span class="number">30282</span>, <span class="number">38121</span>, <span class="number">40434</span>]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;销售&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: [<span class="number">11744</span>, <span class="number">17722</span>, <span class="number">16005</span>, <span class="number">19771</span>, <span class="number">20185</span>, <span class="number">24377</span>, <span class="number">32147</span>, <span class="number">39387</span>]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;项目开发&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: [<span class="literal">null</span>, <span class="literal">null</span>, <span class="number">7988</span>, <span class="number">12169</span>, <span class="number">15112</span>, <span class="number">22452</span>, <span class="number">34400</span>, <span class="number">34227</span>]</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;其他&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: [<span class="number">12908</span>, <span class="number">5948</span>, <span class="number">8105</span>, <span class="number">11248</span>, <span class="number">8989</span>, <span class="number">11816</span>, <span class="number">18274</span>, <span class="number">18111</span>]</span><br><span class="line">        &#125;],</span><br><span class="line">        <span class="attr">responsive</span>: &#123;</span><br><span class="line">            <span class="attr">rules</span>: [&#123;</span><br><span class="line">                <span class="attr">condition</span>: &#123;</span><br><span class="line">                    <span class="attr">maxWidth</span>: <span class="number">500</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">chartOptions</span>: &#123;</span><br><span class="line">                    <span class="attr">legend</span>: &#123;</span><br><span class="line">                        <span class="attr">layout</span>: <span class="string">&#x27;horizontal&#x27;</span>,</span><br><span class="line">                        <span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">                        <span class="attr">verticalAlign</span>: <span class="string">&#x27;bottom&#x27;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>HighCharts<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">HighchartsReact</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">highcharts</span>=<span class="string">&#123;Highcharts&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">options</span>=<span class="string">&#123;option&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#123;<span class="attr">...props</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">HighCharts</span>;</span><br></pre></td></tr></table></figure><h2 id="3-antv-g2"><a href="#3-antv-g2" class="headerlink" title="3.antv - g2"></a>3.antv - g2</h2><p><a target="_blank" rel="noopener" href="https://antv-g2.gitee.io/zh">https://antv-g2.gitee.io/zh</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i @antv/g2 -S</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/data/G2.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Chart</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@antv/g2&#x27;</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IAntvProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Antv</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IAntvProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> data = [</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;未知&#x27;</span>, <span class="attr">value</span>: <span class="number">654</span>, <span class="attr">percent</span>: <span class="number">0.02</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;17 岁以下&#x27;</span>, <span class="attr">value</span>: <span class="number">654</span>, <span class="attr">percent</span>: <span class="number">0.02</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;18-24 岁&#x27;</span>, <span class="attr">value</span>: <span class="number">4400</span>, <span class="attr">percent</span>: <span class="number">0.2</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;25-29 岁&#x27;</span>, <span class="attr">value</span>: <span class="number">5300</span>, <span class="attr">percent</span>: <span class="number">0.24</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;30-39 岁&#x27;</span>, <span class="attr">value</span>: <span class="number">6200</span>, <span class="attr">percent</span>: <span class="number">0.28</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;40-49 岁&#x27;</span>, <span class="attr">value</span>: <span class="number">3300</span>, <span class="attr">percent</span>: <span class="number">0.14</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">&#x27;50 岁以上&#x27;</span>, <span class="attr">value</span>: <span class="number">1500</span>, <span class="attr">percent</span>: <span class="number">0.06</span> &#125;,</span><br><span class="line">    ];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> chart = <span class="keyword">new</span> <span class="title class_">Chart</span>(&#123;</span><br><span class="line">      <span class="attr">container</span>: <span class="string">&#x27;antv&#x27;</span>,</span><br><span class="line">      <span class="attr">autoFit</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">height</span>: <span class="number">500</span>,</span><br><span class="line">      <span class="attr">padding</span>: [<span class="number">50</span>, <span class="number">20</span>, <span class="number">50</span>, <span class="number">20</span>],</span><br><span class="line">    &#125;);</span><br><span class="line">    chart.<span class="title function_">data</span>(data);</span><br><span class="line">    chart.<span class="title function_">scale</span>(<span class="string">&#x27;value&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">alias</span>: <span class="string">&#x27;销售额(万)&#x27;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    chart.<span class="title function_">axis</span>(<span class="string">&#x27;type&#x27;</span>, &#123;</span><br><span class="line">      <span class="attr">tickLine</span>: &#123;</span><br><span class="line">        <span class="attr">alignTick</span>: <span class="literal">false</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    chart.<span class="title function_">axis</span>(<span class="string">&#x27;value&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line">    </span><br><span class="line">    chart.<span class="title function_">tooltip</span>(&#123;</span><br><span class="line">      <span class="attr">showMarkers</span>: <span class="literal">false</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    chart.<span class="title function_">interval</span>().<span class="title function_">position</span>(<span class="string">&#x27;type*value&#x27;</span>);</span><br><span class="line">    chart.<span class="title function_">interaction</span>(<span class="string">&#x27;element-active&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 添加文本标注</span></span><br><span class="line">    data.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      chart</span><br><span class="line">        .<span class="title function_">annotation</span>()</span><br><span class="line">        .<span class="title function_">text</span>(&#123;</span><br><span class="line">          <span class="attr">position</span>: [item.<span class="property">type</span>, item.<span class="property">value</span>],</span><br><span class="line">          <span class="attr">content</span>: item.<span class="property">value</span>,</span><br><span class="line">          <span class="attr">style</span>: &#123;</span><br><span class="line">            <span class="attr">textAlign</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">offsetY</span>: -<span class="number">30</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">text</span>(&#123;</span><br><span class="line">          <span class="attr">position</span>: [item.<span class="property">type</span>, item.<span class="property">value</span>],</span><br><span class="line">          <span class="attr">content</span>: (item.<span class="property">percent</span> * <span class="number">100</span>).<span class="title function_">toFixed</span>(<span class="number">0</span>) + <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">          <span class="attr">style</span>: &#123;</span><br><span class="line">            <span class="attr">textAlign</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">offsetY</span>: -<span class="number">12</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    chart.<span class="title function_">render</span>();</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Antv<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;antv&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">800</span>, <span class="attr">height:</span> <span class="attr">600</span>, <span class="attr">backgroundColor:</span> &#x27;#<span class="attr">efefef</span>&#x27; &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Antv</span>;</span><br></pre></td></tr></table></figure><h1 id="27-编辑器"><a href="#27-编辑器" class="headerlink" title="27.编辑器"></a>27.编辑器</h1><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/menu.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">PictureOutlined</span>,</span><br><span class="line">  <span class="title class_">ProfileOutlined</span>,</span><br><span class="line">  <span class="title class_">OrderedListOutlined</span>,</span><br><span class="line">  <span class="title class_">FilterOutlined</span>,</span><br><span class="line">  <span class="title class_">TeamOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/home/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Banner</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/List&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerActive</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Active&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerAdd</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Add&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Product</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductSearch</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Search&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductHomeList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductDetailList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Detail&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductCartList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Cart&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Account</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/UserList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AdminList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/AdminList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Setting</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/setting/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Data</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ECharts</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/ECharts&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HighCharts</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/HighCharts&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Antv</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/Antv&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Editor</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/editor/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Braft</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;@/views/editor/Braft&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">MarkDown</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;@/views/editor/MarkDown&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-0&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;轮播图管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-1&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="comment">// redirect: &#x27;/banner/home&#x27;,</span></span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Banner</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/home&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;活动页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/active&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerActive</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;添加轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/add&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerAdd</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">hidden</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;产品管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/pro&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-2&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProfileOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Product</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;产品列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/list&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">OrderedListOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;首页产品列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/home&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-0&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductHomeList</span> /&gt;</span></span>,</span><br><span class="line">            <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;详情推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/detail&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-1&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductDetailList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;购物车推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/cart&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-2&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductCartList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;筛选列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/search&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">FilterOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductSearch</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;账户管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/account&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-3&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">TeamOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Account</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;用户列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/userlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;管理员列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/adminlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AdminList</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;设置&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/setting&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-4&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Setting</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;数据可视化&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/data&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-5&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Data</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;ECharts&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/echarts&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ECharts</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;HighCharts&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/highcharts&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HighCharts</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;antv&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/antv&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Antv</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;编辑器&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/editor&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-6&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Editor</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;富文本编辑器&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/editor/braft&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-6-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Braft</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;MarkDown&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/editor/md&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">MarkDown</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><h2 id="1-富文本编辑器"><a href="#1-富文本编辑器" class="headerlink" title="1.富文本编辑器"></a>1.富文本编辑器</h2><p>react版本： <a target="_blank" rel="noopener" href="https://braft.margox.cn/demos/basic">https://braft.margox.cn/demos/basic</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i braft-editor -S</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/editor/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Outlet</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IEditorProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Editor</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IEditorProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>编辑器<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Editor</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/editor/Braft.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;braft-editor/dist/index.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BraftEditor</span> <span class="keyword">from</span> <span class="string">&#x27;braft-editor&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">BraftProps</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">Braft</span> = (<span class="params">&#123;&#125;: BraftProps</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [editorState, setEditorState] = useState&lt;<span class="built_in">any</span>&gt;(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [html, setHTML] = useState&lt;<span class="built_in">any</span>&gt;(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleChange</span> = (<span class="params">editorState: <span class="built_in">any</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setEditorState</span>(editorState)</span><br><span class="line">    <span class="title function_">setHTML</span>(editorState.<span class="title function_">toHTML</span>())</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>富文本编辑器<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">BraftEditor</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;editorState&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;handleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        预览</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">dangerouslySetInnerHTML</span>=<span class="string">&#123;&#123;</span> <span class="attr">__html:</span> <span class="attr">html</span> &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="2-markDown编辑器"><a href="#2-markDown编辑器" class="headerlink" title="2.markDown编辑器"></a>2.markDown编辑器</h2><p>阅读器：<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/react-markdown">https://www.npmjs.com/package/react-markdown</a></p><p>编辑器：<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/react-markdown-editor-lite">https://www.npmjs.com/package/react-markdown-editor-lite</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i react-markdown react-markdown-editor-lite -S</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/editor/MarkDown.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactMarkdown</span> <span class="keyword">from</span> <span class="string">&#x27;react-markdown&#x27;</span> <span class="comment">// 阅读器</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MdEditor</span> <span class="keyword">from</span> <span class="string">&#x27;react-markdown-editor-lite&#x27;</span>; <span class="comment">// 编辑器</span></span><br><span class="line"><span class="comment">// import style manually</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;react-markdown-editor-lite/lib/index.css&#x27;</span>; <span class="comment">// 样式</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">MarkDownProps</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">MarkDown</span> = (<span class="params">&#123;&#125;:MarkDownProps</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [content, setContent] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>MarkDown编辑器<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MdEditor</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> &#x27;<span class="attr">500px</span>&#x27; &#125;&#125; <span class="attr">renderHTML</span>=<span class="string">&#123;text</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        </span></span><br><span class="line"><span class="language-xml">        return <span class="tag">&lt;<span class="name">ReactMarkdown</span>&gt;</span>&#123; text &#125;<span class="tag">&lt;/<span class="name">ReactMarkdown</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#125;&#125; onChange=&#123; ( &#123; html, text &#125;: &#123; html: any; text: any&#125;) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">        setContent(html)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">dangerouslySetInnerHTML</span>=<span class="string">&#123;&#123;</span> <span class="attr">__html:</span> <span class="attr">content</span> &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="28-导入以及导出"><a href="#28-导入以及导出" class="headerlink" title="28.导入以及导出"></a>28.导入以及导出</h1><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/excel/Index.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Outlet</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IIndexProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Index</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IIndexProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Outlet</span>&gt;</span><span class="tag">&lt;/<span class="name">Outlet</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/excel/Import.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IImportProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Import</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IImportProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>导入数据<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Import</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/excel/Export.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IExportProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Export</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IExportProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>导出数据<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Export</span>;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/menu.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">PictureOutlined</span>,</span><br><span class="line">  <span class="title class_">ProfileOutlined</span>,</span><br><span class="line">  <span class="title class_">OrderedListOutlined</span>,</span><br><span class="line">  <span class="title class_">FilterOutlined</span>,</span><br><span class="line">  <span class="title class_">TeamOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/home/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Banner</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/List&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerActive</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Active&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerAdd</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Add&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Product</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductSearch</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Search&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductHomeList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductDetailList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Detail&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductCartList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Cart&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Account</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/UserList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AdminList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/AdminList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Setting</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/setting/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Data</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ECharts</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/ECharts&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HighCharts</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/HighCharts&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Antv</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/Antv&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Editor</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/editor/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Braft</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;@/views/editor/Braft&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">MarkDown</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;@/views/editor/MarkDown&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Excel</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/excel/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Import</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/excel/Import&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Export</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/excel/Export&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-0&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;轮播图管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-1&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="comment">// redirect: &#x27;/banner/home&#x27;,</span></span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Banner</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/home&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;活动页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/active&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerActive</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;添加轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/add&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerAdd</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">hidden</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;产品管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/pro&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-2&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProfileOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Product</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;产品列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/list&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">OrderedListOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;首页产品列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/home&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-0&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductHomeList</span> /&gt;</span></span>,</span><br><span class="line">            <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;详情推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/detail&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-1&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductDetailList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;购物车推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/cart&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-2&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductCartList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;筛选列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/search&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">FilterOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductSearch</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;账户管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/account&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-3&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">TeamOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Account</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;用户列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/userlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;管理员列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/adminlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AdminList</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;设置&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/setting&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-4&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Setting</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;数据可视化&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/data&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-5&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Data</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;ECharts&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/echarts&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ECharts</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;HighCharts&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/highcharts&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HighCharts</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;antv&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/antv&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Antv</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;编辑器&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/editor&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-6&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Editor</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;富文本编辑器&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/editor/braft&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-6-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Braft</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;MarkDown&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/editor/md&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">MarkDown</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;导入以及导出&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/excel&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-7&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Excel</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;导入&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/excel/import&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-7-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Import</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;导出&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/excel/export&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-7-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Export</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><h2 id="1-导出"><a href="#1-导出" class="headerlink" title="1.导出"></a>1.导出</h2><blockquote><p>cnpm i js-export-excel -S</p><p><code>src/views/excel/test.d.ts</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">declare module &#x27;js-export-excel&#x27;</span><br></pre></td></tr></table></figure><p>本案例导出产品筛选列表的数据</p></blockquote><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/excel/Export.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="variable constant_">FC</span>,useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Table</span>, <span class="title class_">Space</span>, <span class="title class_">Button</span>, <span class="title class_">Image</span>, <span class="title class_">Switch</span>  &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">DeleteOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> usePagination <span class="keyword">from</span> <span class="string">&#x27;@/hooks/usePagination&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getProList, updateRecommend, updateSeckill &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/pro&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ExportJsonExcel</span> <span class="keyword">from</span> <span class="string">&#x27;js-export-excel&#x27;</span> </span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IExportProps</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">banners</span>: <span class="built_in">string</span>[]</span><br><span class="line">  <span class="attr">brand</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">category</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">desc</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">discount</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">img1</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img2</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img3</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img4</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">isrecommend</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">issale</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">isseckill</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">originprice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">proid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">proname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">sales</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">stock</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Export</span>:<span class="variable constant_">FC</span>&lt;<span class="title class_">IExportProps</span>&gt; = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [height, setHeight] = <span class="title function_">useState</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>) <span class="comment">// 计算body的高度</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">setHeight</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">offsetHeight</span>)</span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="comment">// 分页设置</span></span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">usePagination</span>(&#123;</span><br><span class="line">    <span class="attr">position</span>: [<span class="string">&#x27;bottomLeft&#x27;</span>],</span><br><span class="line">    <span class="attr">showSizeChanger</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">pageSizeOptions</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>], </span><br><span class="line">    <span class="attr">showQuickJumper</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [list, setList] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">getProListData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">getProList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="title function_">setList</span>(res.<span class="property">data</span>.<span class="property">data</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getProListData</span>()</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Space</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">direction</span>=<span class="string">&#x27;vertical&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&#x27;primary&#x27;</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;// ++++++++</span></span><br><span class="line"><span class="language-xml">          let option: &#123;</span></span><br><span class="line"><span class="language-xml">            fileName: string</span></span><br><span class="line"><span class="language-xml">            datas: &#123;</span></span><br><span class="line"><span class="language-xml">              sheetData: DataType[],</span></span><br><span class="line"><span class="language-xml">              sheetName: string,</span></span><br><span class="line"><span class="language-xml">              sheetFilter: string[],</span></span><br><span class="line"><span class="language-xml">              sheetHeader: string[],</span></span><br><span class="line"><span class="language-xml">              columnWidths: number[]</span></span><br><span class="line"><span class="language-xml">            &#125;[]</span></span><br><span class="line"><span class="language-xml">          &#125;;</span></span><br><span class="line"><span class="language-xml">          option = &#123;</span></span><br><span class="line"><span class="language-xml">            fileName: &quot;产品列表&quot;, // 导出的文件的名称</span></span><br><span class="line"><span class="language-xml">            datas: [</span></span><br><span class="line"><span class="language-xml">              &#123;</span></span><br><span class="line"><span class="language-xml">                sheetData: list, // 表格数据</span></span><br><span class="line"><span class="language-xml">                sheetName: &quot;产品列表1&quot;, // excel表格中表格的名字</span></span><br><span class="line"><span class="language-xml">                sheetFilter: [&quot;proname&quot;, &quot;img1&quot;,  &quot;category&quot;], // 需要导出的数据的字段</span></span><br><span class="line"><span class="language-xml">                sheetHeader: [&quot;产品名称&quot;, &quot;图片&quot;, &quot;分类&quot;], // 表头的值</span></span><br><span class="line"><span class="language-xml">                columnWidths: [20, 20],</span></span><br><span class="line"><span class="language-xml">              &#125;,</span></span><br><span class="line"><span class="language-xml">              &#123;</span></span><br><span class="line"><span class="language-xml">                sheetData: list, // 表格数据</span></span><br><span class="line"><span class="language-xml">                sheetName: &quot;产品列表2&quot;, // excel表格中表格的名字</span></span><br><span class="line"><span class="language-xml">                sheetFilter: [&quot;proname&quot;, &quot;img1&quot;,  &quot;category&quot;, &#x27;originprice&#x27;], // 需要导出的数据的字段</span></span><br><span class="line"><span class="language-xml">                sheetHeader: [&quot;产品名称&quot;, &quot;图片&quot;, &quot;分类&quot;, &#x27;价格&#x27;], // 表头的值</span></span><br><span class="line"><span class="language-xml">                columnWidths: [20, 20],</span></span><br><span class="line"><span class="language-xml">              &#125;,</span></span><br><span class="line"><span class="language-xml">            ]</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">          </span></span><br><span class="line"><span class="language-xml">          var toExcel = new ExportJsonExcel(option); //new</span></span><br><span class="line"><span class="language-xml">          toExcel.saveExcel(); //保存</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;导出数据<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rowKey</span>=<span class="string">&quot;proid&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dataSource</span> = <span class="string">&#123;</span> <span class="attr">list</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">scroll</span> = <span class="string">&#123;&#123;</span> <span class="attr">y:</span> <span class="attr">height</span> <span class="attr">-</span> <span class="attr">330</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">pagination</span> = <span class="string">&#123;</span> <span class="attr">config</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;序号&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> (<span class="attr">_</span> ,<span class="attr">record</span>, <span class="attr">index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; (config.current - 1) * config.pageSize +index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;图片&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;img1&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> <span class="attr">text</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">text</span>&#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">80</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;商品名称&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;proname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;商品价格&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;originprice&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;是否秒杀&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;isseckill&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">defaultChecked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1&#125;</span>  <span class="attr">onChange</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                console.log(text)</span></span><br><span class="line"><span class="language-xml">                updateSeckill(&#123; proid: record.proid, flag: text === 0&#125;).then(() =&gt; getProListData())</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;是否推荐&quot;</span> <span class="attr">dataIndex</span>=<span class="string">&quot;isrecommend&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">defaultChecked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1&#125;</span>  <span class="attr">onChange</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                updateRecommend(&#123; proid: record.proid , flag: text === 0&#125;).then(() =&gt; getProListData())</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125; /&gt;</span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span> <span class="attr">title</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">_</span>, <span class="attr">record:</span> <span class="attr">DataType</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">danger</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;</span>&lt;<span class="attr">DeleteOutlined</span> /&gt;</span>&#125;&gt;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Export</span>;</span><br></pre></td></tr></table></figure><blockquote><p>以上方案为纯前端的导出，实际上还有其余的导出方法，比如通过接口实现，前端可以通过a的href属性实现</p></blockquote><h2 id="2-导入"><a href="#2-导入" class="headerlink" title="2.导入"></a>2.导入</h2><p>数据在 <code>src/views/excel/pro.xlsx</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install xlsx</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/excel/Import.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span>, <span class="title class_">Table</span>, <span class="title class_">Switch</span>, <span class="title class_">Image</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="variable constant_">XLSX</span> <span class="keyword">from</span> <span class="string">&#x27;xlsx&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">ImportProps</span> = &#123;&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">DataType</span> &#123;</span><br><span class="line">  <span class="attr">proid</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">proname</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">img1</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">originprice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">discount</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">sales</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">stock</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">category</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">brand</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="attr">issale</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">isrecommend</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="attr">isseckill</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Import</span> (<span class="attr">props</span>: <span class="title class_">ImportProps</span>)  &#123;</span><br><span class="line">  <span class="keyword">const</span> [proList, setProList] = <span class="title function_">useState</span>([])</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">importExcel</span> = (<span class="params"></span>) =&gt; &#123; <span class="comment">// 导入数据</span></span><br><span class="line">    <span class="keyword">const</span> file = (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;fileRef&#x27;</span>) <span class="keyword">as</span> <span class="title class_">HTMLInputElement</span>).<span class="property">files</span>![<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>()</span><br><span class="line">    reader.<span class="title function_">readAsBinaryString</span>(file!) <span class="comment">// 转成 二进制格式</span></span><br><span class="line">    reader.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> workbook = <span class="variable constant_">XLSX</span>.<span class="title function_">read</span>(<span class="variable language_">this</span>.<span class="property">result</span>, &#123; <span class="attr">type</span>: <span class="string">&#x27;binary&#x27;</span> &#125;);</span><br><span class="line">      <span class="keyword">const</span> t = workbook.<span class="property">Sheets</span>[<span class="string">&#x27;list&#x27;</span>] <span class="comment">// 拿到表格数据</span></span><br><span class="line">      <span class="comment">// console.log(t)</span></span><br><span class="line">      <span class="keyword">const</span> <span class="attr">r</span>: <span class="built_in">any</span> = <span class="variable constant_">XLSX</span>.<span class="property">utils</span>.<span class="title function_">sheet_to_json</span>(t) <span class="comment">// 转换成json格式</span></span><br><span class="line">      <span class="comment">// console.log(r)</span></span><br><span class="line">      <span class="title function_">setProList</span>(r)</span><br><span class="line">      <span class="comment">// 将r的数据上传至服务器</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; // 触发文件选择器</span></span><br><span class="line"><span class="language-xml">        (document.getElementById(&#x27;fileRef&#x27;) as HTMLInputElement).click()</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;导入数据<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">hidden</span> <span class="attr">id</span> = <span class="string">&#x27;fileRef&#x27;</span> <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">importExcel</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table</span> <span class="attr">dataSource</span>=<span class="string">&#123;</span> <span class="attr">proList</span> &#125;  <span class="attr">rowKey</span> = <span class="string">&quot;proid&quot;</span> <span class="attr">scroll</span>=<span class="string">&#123;&#123;</span> <span class="attr">y:</span> <span class="attr">600</span>&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;序号&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">render</span>=<span class="string">&#123;(text,</span> <span class="attr">record</span>, <span class="attr">index</span>) =&gt;</span> &#123; return <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123; index + 1 &#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;产品分类&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;category&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;产品品牌&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;brand&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;产品名称&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;proname&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span><span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;图片&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;img1&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>) =&gt;</span> &#123;return <span class="tag">&lt;<span class="name">Image</span> <span class="attr">src</span>=<span class="string">&#123;text&#125;</span> <span class="attr">width</span>=<span class="string">&#123;80&#125;</span> <span class="attr">height</span>=<span class="string">&#123;80&#125;</span> /&gt;</span> &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;产品价格&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;originprice&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">sorter</span>=<span class="string">&#123;(a:</span> <span class="attr">DataType</span>, <span class="attr">b:</span> <span class="attr">DataType</span>) =&gt;</span> a.originprice - b.originprice&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;产品折扣&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;discount&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">sorter</span>=<span class="string">&#123;(a:</span> <span class="attr">DataType</span>, <span class="attr">b:</span> <span class="attr">DataType</span>) =&gt;</span> a.discount - b.discount&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;产品销量&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;sales&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">sorter</span>=<span class="string">&#123;(a:</span> <span class="attr">DataType</span>, <span class="attr">b:</span> <span class="attr">DataType</span>) =&gt;</span> a.sales - b.sales&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;产品库存&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;stock&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">sorter</span>=<span class="string">&#123;(a:</span> <span class="attr">DataType</span>, <span class="attr">b:</span> <span class="attr">DataType</span>) =&gt;</span> a.stock - b.stock&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;是否上架&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;issale&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>) =&gt;</span> &#123;return <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">checked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1</span> &#125; /&gt;</span> &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;是否推荐&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;isrecommend&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>) =&gt;</span> &#123;return <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">checked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1</span> &#125; /&gt;</span> &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Table.Column</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;是否秒杀&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dataIndex</span>=<span class="string">&quot;isseckill&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">render</span>=<span class="string">&#123;</span> (<span class="attr">text</span>) =&gt;</span> &#123;return <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">checked</span> = <span class="string">&#123;</span> <span class="attr">text</span> === <span class="string">1</span> &#125; /&gt;</span> &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">Table.Column</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        </span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果在nodejs环境中,通过接口实现</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xlsx = <span class="built_in">require</span>(<span class="string">&#x27;node-xlsx&#x27;</span>).<span class="property">default</span>;</span><br><span class="line"><span class="comment">// 导入excel表格的数据</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/uploadPro&#x27;</span>, <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> originData = xlsx.<span class="title function_">parse</span>(<span class="string">`<span class="subst">$&#123;__dirname&#125;</span>/pro.xlsx`</span>);</span><br><span class="line">  <span class="keyword">const</span> firstData = originData[<span class="number">0</span>].<span class="property">data</span></span><br><span class="line">  <span class="keyword">const</span> arr = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; firstData.<span class="property">length</span>; i++) &#123; </span><br><span class="line">    <span class="keyword">if</span> (i !== <span class="number">0</span>) &#123;</span><br><span class="line">      arr.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">proid</span>: <span class="string">&#x27;pro_&#x27;</span>+ uuid.<span class="title function_">v4</span>(),</span><br><span class="line">        <span class="attr">category</span>: firstData[i][<span class="number">0</span>],</span><br><span class="line">        <span class="attr">brand</span>: firstData[i][<span class="number">1</span>],</span><br><span class="line">        <span class="attr">proname</span>: firstData[i][<span class="number">2</span>],</span><br><span class="line">        <span class="attr">banners</span>: firstData[i][<span class="number">3</span>],</span><br><span class="line">        <span class="attr">originprice</span>: firstData[i][<span class="number">4</span>],</span><br><span class="line">        <span class="attr">sales</span>: firstData[i][<span class="number">5</span>],</span><br><span class="line">        <span class="attr">stock</span>: firstData[i][<span class="number">6</span>],</span><br><span class="line">        <span class="attr">desc</span>: firstData[i][<span class="number">7</span>],</span><br><span class="line">        <span class="attr">issale</span>: firstData[i][<span class="number">8</span>],</span><br><span class="line">        <span class="attr">isrecommend</span>: firstData[i][<span class="number">9</span>],</span><br><span class="line">        <span class="attr">discount</span>: firstData[i][<span class="number">10</span>],</span><br><span class="line">        <span class="attr">isseckill</span>: firstData[i][<span class="number">11</span>],</span><br><span class="line">        <span class="attr">img1</span>: firstData[i][<span class="number">12</span>],</span><br><span class="line">        <span class="attr">img2</span>: firstData[i][<span class="number">13</span>],</span><br><span class="line">        <span class="attr">img3</span>: firstData[i][<span class="number">14</span>],</span><br><span class="line">        <span class="attr">img4</span>: firstData[i][<span class="number">15</span>],</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 拿到 arr 的数据，先清空 产品的表格数据，然后再插入</span></span><br><span class="line">  mysql.<span class="title function_">delete</span>(<span class="title class_">Product</span>, &#123;&#125;, <span class="number">1</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 不要忘记写1，因为1 代表的是删除多条数据</span></span><br><span class="line">    <span class="comment">// 所有的数据已删除完成</span></span><br><span class="line">    <span class="comment">// 插入数据</span></span><br><span class="line">    mysql.<span class="title function_">insert</span>(<span class="title class_">Product</span>, arr).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 重定向到 商品的管理的页面路由</span></span><br><span class="line">      res.<span class="title function_">send</span>(<span class="string">&#x27;导入数据成功&#x27;</span>) <span class="comment">// 相当于浏览器自动跳转到了 /pro 的路由</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></blockquote><h1 id="29-地图"><a href="#29-地图" class="headerlink" title="29.地图"></a>29.地图</h1><p><a target="_blank" rel="noopener" href="https://huiyan.baidu.com/github/react-bmapgl/#/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8">https://huiyan.baidu.com/github/react-bmapgl/#/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8</a></p><p><a target="_blank" rel="noopener" href="https://lbsyun.baidu.com/">https://lbsyun.baidu.com/</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// src/views/map/Baidu.tsx</span><br><span class="line">import React, &#123; FC, useEffect &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">interface IBaiduProps &#123;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const Baidu:FC&lt;IBaiduProps&gt; = () =&gt; &#123;</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    var map = new window.BMapGL.Map(&quot;container&quot;);</span><br><span class="line">    map.centerAndZoom(new window.BMapGL.Point(116.404, 39.915), 11);</span><br><span class="line"></span><br><span class="line">    var p1 = new window.BMapGL.Point(116.301934,39.977552);</span><br><span class="line">    var p2 = new window.BMapGL.Point(116.508328,39.919141);</span><br><span class="line"></span><br><span class="line">    var driving = new window.BMapGL.DrivingRoute(map, &#123;renderOptions:&#123;map: map, autoViewport: true&#125;&#125;);</span><br><span class="line">    driving.search(p1, p2);</span><br><span class="line">  &#125;, [])</span><br><span class="line">  return (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;div id=&quot;container&quot; style=&#123; &#123;</span><br><span class="line">        width: &#x27;100%&#x27;, height: 500</span><br><span class="line">      &#125;&#125;&gt;&lt;/div&gt;</span><br><span class="line">      &lt;div id=&#x27;result&#x27;&gt;根据起点和终点经纬度驾车导航路线&lt;/div&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default Baidu;</span><br></pre></td></tr></table></figure><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/menu.tsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">IMenuProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./inter&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">HomeOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">PictureOutlined</span>,</span><br><span class="line">  <span class="title class_">ProfileOutlined</span>,</span><br><span class="line">  <span class="title class_">OrderedListOutlined</span>,</span><br><span class="line">  <span class="title class_">FilterOutlined</span>,</span><br><span class="line">  <span class="title class_">TeamOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">SettingOutlined</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/home/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Banner</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/List&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerActive</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Active&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">BannerAdd</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/banner/Add&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Product</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductSearch</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/Search&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductHomeList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductDetailList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Detail&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ProductCartList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/product/list/Cart&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Account</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/UserList&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AdminList</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/account/AdminList&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Setting</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/setting/Index&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Data</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ECharts</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/ECharts&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">HighCharts</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/HighCharts&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Antv</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/data/Antv&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Editor</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/editor/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Braft</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;@/views/editor/Braft&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">MarkDown</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;@/views/editor/MarkDown&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Excel</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/excel/Index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Import</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/excel/Import&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Export</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/excel/Export&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Baidu</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/Map/Baidu&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenuProps</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;系统首页&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-0&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HomeOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;轮播图管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/banner&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-1&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="comment">// redirect: &#x27;/banner/home&#x27;,</span></span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Banner</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;首页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/home&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;活动页轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/active&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">PictureOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerActive</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;添加轮播图&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/banner/add&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-1-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UploadOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">BannerAdd</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">hidden</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;产品管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/pro&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-2&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProfileOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Product</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;产品列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/list&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">OrderedListOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;首页产品列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/home&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-0&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductHomeList</span> /&gt;</span></span>,</span><br><span class="line">            <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;详情推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/detail&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-1&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductDetailList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">label</span>: <span class="string">&#x27;购物车推荐列表&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/pro/list/cart&#x27;</span>,</span><br><span class="line">            <span class="attr">keyid</span>: <span class="string">&#x27;0-2-0-2&#x27;</span>,</span><br><span class="line">            <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductCartList</span> /&gt;</span></span></span><br><span class="line">          &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;筛选列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/pro/search&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-2-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">FilterOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ProductSearch</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;账户管理&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/account&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-3&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">TeamOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Account</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;用户列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/userlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserList</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;管理员列表&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/account/adminlist&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-3-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">UserOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">AdminList</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;设置&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/setting&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-4&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Setting</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">hidden</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;数据可视化&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/data&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-5&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Data</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;ECharts&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/echarts&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">ECharts</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;HighCharts&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/highcharts&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">HighCharts</span> /&gt;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;antv&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/data/antv&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Antv</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;编辑器&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/editor&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-6&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Editor</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;富文本编辑器&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/editor/braft&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-6-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Braft</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;MarkDown&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/editor/md&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-5-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">MarkDown</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;导入以及导出&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/excel&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-7&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Excel</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;导入&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/excel/import&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-7-0&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Import</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">index</span>: <span class="number">1</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;导出&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/excel/export&#x27;</span>,</span><br><span class="line">        <span class="attr">keyid</span>: <span class="string">&#x27;0-7-1&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">        <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Export</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;百度地图&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/map&#x27;</span>,</span><br><span class="line">    <span class="attr">keyid</span>: <span class="string">&#x27;0-8&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">SettingOutlined</span> /&gt;</span></span>,</span><br><span class="line">    <span class="attr">element</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">Baidu</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/views/map/map.d.ts.</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Window</span> &#123;</span><br><span class="line">  <span class="title class_">BMapGL</span>: <span class="built_in">any</span></span><br><span class="line">  <span class="attr">BMAP_STATUS_SUCCESS</span>: <span class="built_in">any</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// public/index.html</span><br><span class="line"> <span class="tag">&lt;<span class="name">title</span>&gt;</span>React App<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//api.map.baidu.com/api?type=webgl&amp;v=1.0&amp;ak=tvN3aLzFzvthpM9OwvsxmrSjD9dsdlbd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="30-项目打包发布"><a href="#30-项目打包发布" class="headerlink" title="30.项目打包发布"></a>30.项目打包发布</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/daxunshuo/article/details/102976306?spm=1001.2014.3001.5501">https://blog.csdn.net/daxunshuo/article/details/102976306?spm=1001.2014.3001.5501</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm run build</span><br><span class="line"><span class="comment"># 估计需要一点时间请耐心等待</span></span><br></pre></td></tr></table></figure><blockquote><p>打包完毕项目 build 文件夹即为 项目打包出来的文件，只需要把build文件夹上传至服务器，一般情况下，都需要修改build文件夹的名字</p><p>如果打开 build&#x2F;index.html 文件，发现 css js 文件的引入使用的都是绝对路径</p></blockquote><p>如果服务器只部署这一个项目，那么可以把 build文件夹的内容替换了 服务器的静态资源文件 — 绝对路径</p><p>如果服务器部署多个项目，那么可以把修改过后的 build的文件夹上传到 服务器的静态资源文件 — 项目路径</p><blockquote><p>如何打包项目时使用相对路径</p><p><code>package.json</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;homepage&quot;: &#x27;.&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p><a target="_blank" rel="noopener" href="http://121.89.205.189:2207/">http://121.89.205.189:2207/</a></p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="https://angelxyj.github.io">许小墨</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接:</span> <span class="post-copyright-info"><a href="https://angelxyj.github.io/posts/60af50c8.html">https://angelxyj.github.io/posts/60af50c8.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://angelxyj.github.io" target="_blank">许小墨のBlog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/%E5%89%8D%E7%AB%AF/">前端</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/%E6%A1%86%E6%9E%B6/">框架</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/React/">React</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/React%E9%87%8D%E5%88%B6%E7%89%88/">React重制版</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/react-products/">react-products</a></div><div class="post_share"><div class="social-share" data-image="/img/7.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>感谢支持！</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat.png" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/66450fce.html" title="react基础"><img class="cover" src="/img/11.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">react基础</div></div></a></div><div class="next-post pull-right"><a href="/posts/c22d7424.html" title="react-mobile"><img class="cover" src="/img/16.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">react-mobile</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/57ee22ab.html" title="next.js"><img class="cover" src="/img/3.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-18</div><div class="title">next.js</div></div></a></div><div><a href="/posts/c22d7424.html" title="react-mobile"><img class="cover" src="/img/16.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-18</div><div class="title">react-mobile</div></div></a></div><div><a href="/posts/e639fe97.html" title="git-note"><img class="cover" src="/img/jujingyi.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-01</div><div class="title">git-note</div></div></a></div><div><a href="/posts/4ce86b9.html" title="小程序登录"><img class="cover" src="/img/6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-01</div><div class="title">小程序登录</div></div></a></div><div><a href="/posts/b76d08a1.html" title="小程序笔记"><img class="cover" src="/img/7.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-01</div><div class="title">小程序笔记</div></div></a></div><div><a href="/posts/66450fce.html" title="react基础"><img class="cover" src="/img/11.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-18</div><div class="title">react基础</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div><div class="comment-switch"><span class="first-comment">Waline</span><span id="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/touxiang.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">许小墨</div><div class="author-info__description">全栈攻城狮的基本素养</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">198</div></a><a href="/%E6%A0%87%E7%AD%BE/"><div class="headline">标签</div><div class="length-num">183</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">42</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Angelxyj"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Angelxyj" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1440023258@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#react-pc"><span class="toc-number">1.</span> <span class="toc-text">react-pc</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.</span> <span class="toc-text">1.创建项目</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E6%94%B9%E9%80%A0%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-number">3.</span> <span class="toc-text">2.改造目录结构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85%E4%B8%80%E4%BA%9B%E5%BF%85%E9%A1%BB%E7%9A%84%E6%A8%A1%E5%9D%97"><span class="toc-number">4.</span> <span class="toc-text">3.安装一些必须的模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E9%85%8D%E7%BD%AE%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 配置预处理器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-1-%E9%85%8D%E7%BD%AE%E5%88%AB%E5%90%8D"><span class="toc-number">4.1.1.</span> <span class="toc-text">3.1.1 配置别名@</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2%E5%AE%89%E8%A3%85%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">4.2.</span> <span class="toc-text">3.2安装状态管理器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E8%B7%AF%E7%94%B1"><span class="toc-number">4.3.</span> <span class="toc-text">3.3 路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81"><span class="toc-number">4.4.</span> <span class="toc-text">3.4 数据验证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82"><span class="toc-number">4.5.</span> <span class="toc-text">3.5数据请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6ui%E5%BA%93"><span class="toc-number">4.6.</span> <span class="toc-text">3.6ui库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-1-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%A2%98"><span class="toc-number">4.6.1.</span> <span class="toc-text">3.6.1 自定义主题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-7%E5%85%B6%E4%BB%96%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B7%A5%E5%85%B7%E5%8C%85"><span class="toc-number">4.7.</span> <span class="toc-text">3.7其他第三方工具包</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%88%9B%E5%BB%BA%E4%B8%BB%E5%B8%83%E5%B1%80%E6%96%87%E4%BB%B6"><span class="toc-number">5.</span> <span class="toc-text">4.创建主布局文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E6%8B%86%E5%88%86%E4%B8%BB%E7%95%8C%E9%9D%A2"><span class="toc-number">6.</span> <span class="toc-text">5.拆分主界面</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E4%BD%BF%E7%94%A8rtk%E6%9D%A5%E7%AE%A1%E7%90%86%E7%8A%B6%E6%80%81"><span class="toc-number">7.</span> <span class="toc-text">6.使用rtk来管理状态</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E5%AE%9A%E4%B9%89State%E5%92%8CDispatch%E7%B1%BB%E5%9E%8B"><span class="toc-number">7.1.</span> <span class="toc-text">6.1 定义State和Dispatch类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E5%AE%9A%E4%B9%89-Hooks-%E7%B1%BB%E5%9E%8B"><span class="toc-number">7.2.</span> <span class="toc-text">6.2 定义 Hooks 类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%B8%AD%E4%BD%BF%E7%94%A8"><span class="toc-number">7.3.</span> <span class="toc-text">6.3 应用程序中使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-%E6%95%B4%E5%90%88reducer"><span class="toc-number">7.4.</span> <span class="toc-text">6.4 整合reducer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">7.5.</span> <span class="toc-text">6.5 入口文件配置状态管理器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6-%E5%B7%A6%E4%BE%A7%E8%8F%9C%E5%8D%95%E6%A0%8F%E4%BD%BF%E7%94%A8%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">7.6.</span> <span class="toc-text">6.6 左侧菜单栏使用状态管理器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-7-%E5%A4%B4%E9%83%A8%E7%BB%84%E4%BB%B6%E4%BD%BF%E7%94%A8%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">7.7.</span> <span class="toc-text">6.7 头部组件使用状态管理器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-8%E4%BF%9D%E7%95%99%E7%94%A8%E6%88%B7%E4%B9%A0%E6%83%AF-%E5%8F%AF%E9%80%89"><span class="toc-number">7.8.</span> <span class="toc-text">6.8保留用户习惯-可选</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-9-%E6%B0%B8%E4%B9%85%E5%AD%98%E5%82%A8%E7%9A%84-%E7%B1%BB-localStorage-%E7%9A%84%E5%B7%A5%E5%85%B7-store2"><span class="toc-number">7.9.</span> <span class="toc-text">6.9 永久存储的 类 localStorage 的工具 store2</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%B7%A6%E4%BE%A7%E8%8F%9C%E5%8D%95%E6%A0%8F"><span class="toc-number">8.</span> <span class="toc-text">7.左侧菜单栏</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E8%AE%BE%E8%AE%A1%E5%B7%A6%E4%BE%A7%E8%8F%9C%E5%8D%95%E6%A0%8F%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">8.1.</span> <span class="toc-text">7.1.设计左侧菜单栏的数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E6%B8%B2%E6%9F%93%E5%B7%A6%E4%BE%A7%E8%8F%9C%E5%8D%95%E6%A0%8F"><span class="toc-number">8.2.</span> <span class="toc-text">7.2.渲染左侧菜单栏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E4%BD%8E%E7%89%88%E6%9C%AC%E5%A4%84%E7%90%86"><span class="toc-number">8.3.</span> <span class="toc-text">7.3 低版本处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-%E8%8F%9C%E5%8D%95%E6%B8%B2%E6%9F%93%E4%BC%98%E5%8C%96"><span class="toc-number">8.4.</span> <span class="toc-text">7.4 菜单渲染优化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E5%AE%9A%E4%B9%89%E8%B7%AF%E7%94%B1"><span class="toc-number">9.</span> <span class="toc-text">8.定义路由</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3"><span class="toc-number">9.1.</span> <span class="toc-text">8.1 官方文档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-%E5%88%9B%E5%BB%BA%E5%AF%B9%E5%BA%94%E7%9A%84%E9%A1%B5%E9%9D%A2"><span class="toc-number">9.2.</span> <span class="toc-text">8.2 创建对应的页面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF"><span class="toc-number">9.3.</span> <span class="toc-text">8.3 定义菜单路由信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-4-%E8%A3%85%E8%BD%BD%E8%B7%AF%E7%94%B1"><span class="toc-number">9.4.</span> <span class="toc-text">8.4.装载路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-5-%E5%AE%9A%E4%B9%89%E8%B7%AF%E7%94%B1%E7%BB%84%E4%BB%B6"><span class="toc-number">9.5.</span> <span class="toc-text">8.5 定义路由组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-6-%E4%BA%8C%E7%BA%A7%E4%B9%83%E8%87%B3%E4%B8%89%E7%BA%A7%E8%8F%9C%E5%8D%95%E7%94%9F%E6%95%88"><span class="toc-number">9.6.</span> <span class="toc-text">8.6 二级乃至三级菜单生效</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-7-%E6%89%8B%E5%8A%A8%E6%B5%8B%E8%AF%95%E8%B7%AF%E7%94%B1"><span class="toc-number">9.7.</span> <span class="toc-text">8.7 手动测试路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-8-%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E8%B7%AF%E7%94%B1"><span class="toc-number">9.8.</span> <span class="toc-text">8.8 设置默认路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-9-%E8%AE%BE%E7%BD%AE404%E9%A1%B5%E9%9D%A2"><span class="toc-number">9.9.</span> <span class="toc-text">8.9 设置404页面</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E5%88%87%E6%8D%A2%E8%B7%AF%E7%94%B1"><span class="toc-number">10.</span> <span class="toc-text">9 切换路由</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-%E7%82%B9%E5%87%BB%E5%88%87%E6%8D%A2%E8%B7%AF%E7%94%B1"><span class="toc-number">10.1.</span> <span class="toc-text">9.1 点击切换路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-%E5%88%B7%E6%96%B0%E4%BF%9D%E6%8C%81%E5%B7%A6%E4%BE%A7%E8%8F%9C%E5%8D%95%E7%8A%B6%E6%80%81"><span class="toc-number">10.2.</span> <span class="toc-text">9.2 刷新保持左侧菜单状态</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-%E8%AE%BE%E7%BD%AE%E9%9D%A2%E5%8C%85%E5%B1%91%E5%AF%BC%E8%88%AA"><span class="toc-number">11.</span> <span class="toc-text">10 设置面包屑导航</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="toc-number">11.1.</span> <span class="toc-text">10.1 参考文档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-%E8%AE%BE%E7%BD%AE%E9%9D%A2%E5%8C%85%E5%B1%91%E5%AF%BC%E8%88%AA"><span class="toc-number">11.2.</span> <span class="toc-text">10.2 设置面包屑导航</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-%E5%BF%AB%E6%8D%B7%E5%88%87%E6%8D%A2%E9%A1%B5"><span class="toc-number">12.</span> <span class="toc-text">11.快捷切换页</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1-%E5%87%86%E5%A4%87%E7%BB%84%E4%BB%B6"><span class="toc-number">12.1.</span> <span class="toc-text">11.1 准备组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE"><span class="toc-number">12.2.</span> <span class="toc-text">11.2 处理数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-3-%E7%9B%91%E5%90%AC%E8%B7%AF%E7%94%B1%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="toc-number">12.3.</span> <span class="toc-text">11.3 监听路由添加数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-4-%E7%82%B9%E5%87%BBtab%E9%A1%B5%E5%88%87%E6%8D%A2%E8%B7%AF%E7%94%B1-%E5%85%B3%E9%97%AD%E6%95%88%E6%9E%9C"><span class="toc-number">12.4.</span> <span class="toc-text">11.4 点击tab页切换路由,关闭效果</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-number">13.</span> <span class="toc-text">12.数据请求的封装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#13-%E6%9E%84%E5%BB%BA%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2"><span class="toc-number">14.</span> <span class="toc-text">13 构建登录页面</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#13-1-%E5%8F%82%E8%80%83%E7%BB%84%E4%BB%B6%E5%BA%93%E7%BB%84%E4%BB%B6"><span class="toc-number">14.1.</span> <span class="toc-text">13.1 参考组件库组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-2-%E6%9E%84%E9%80%A0%E7%99%BB%E5%BD%95%E6%8E%A5%E5%8F%A3API"><span class="toc-number">14.2.</span> <span class="toc-text">13.2 构造登录接口API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-3-%E5%88%9B%E5%BB%BA%E7%99%BB%E5%BD%95%E7%9A%84%E9%A1%B5%E9%9D%A2"><span class="toc-number">14.3.</span> <span class="toc-text">13.3 创建登录的页面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-4-%E5%88%9B%E5%BB%BA%E7%99%BB%E5%BD%95%E8%B7%AF%E7%94%B1"><span class="toc-number">14.4.</span> <span class="toc-text">13.4 创建登录路由</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-4-%E5%AE%8C%E5%96%84%E7%99%BB%E5%BD%95%E7%95%8C%E9%9D%A2"><span class="toc-number">14.5.</span> <span class="toc-text">13.4 完善登录界面</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#14-%E6%89%A7%E8%A1%8C%E7%99%BB%E5%BD%95"><span class="toc-number">15.</span> <span class="toc-text">14 执行登录</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#14-1-%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9D%97-admins"><span class="toc-number">15.1.</span> <span class="toc-text">14.1 构建模块 admins</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-2-%E8%A3%85%E8%BD%BD%E6%A8%A1%E5%9D%97"><span class="toc-number">15.2.</span> <span class="toc-text">14.2 装载模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-3-%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">15.3.</span> <span class="toc-text">14.3 登录实现</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#15-%E5%89%8D%E7%AB%AF%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81"><span class="toc-number">16.</span> <span class="toc-text">15.前端登录验证</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#16-%E5%90%8E%E7%AB%AFtoken%E6%A0%A1%E9%AA%8C"><span class="toc-number">17.</span> <span class="toc-text">16 .后端token校验</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#17-%E9%80%80%E5%87%BA%E7%99%BB%E5%BD%95"><span class="toc-number">18.</span> <span class="toc-text">17.退出登录</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#17-1-%E5%AE%9E%E7%8E%B0%E9%80%80%E5%87%BA%E7%99%BB%E5%BD%95"><span class="toc-number">18.1.</span> <span class="toc-text">17.1 实现退出登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-2-%E4%BF%9D%E7%95%99%E9%80%80%E5%87%BA%E6%97%B6%E7%9A%84%E9%A1%B5%E9%9D%A2"><span class="toc-number">18.2.</span> <span class="toc-text">17.2 保留退出时的页面</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#18-%E9%9A%90%E8%97%8F%E5%AD%90%E8%8F%9C%E5%8D%95"><span class="toc-number">19.</span> <span class="toc-text">18.隐藏子菜单</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#19-%E7%AE%A1%E7%90%86%E5%91%98%E7%AE%A1%E7%90%86"><span class="toc-number">20.</span> <span class="toc-text">19. 管理员管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#19-1-%E8%AE%BE%E8%AE%A1%E6%8E%A5%E5%8F%A3"><span class="toc-number">20.1.</span> <span class="toc-text">19.1.设计接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-2-%E5%B1%95%E7%A4%BA%E7%AE%A1%E7%90%86%E5%91%98%E5%88%97%E8%A1%A8"><span class="toc-number">20.2.</span> <span class="toc-text">19.2.展示管理员列表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-3-%E4%BC%98%E5%8C%96%E8%A1%A8%E6%A0%BC%E6%BB%9A%E5%8A%A8"><span class="toc-number">20.3.</span> <span class="toc-text">19.3 优化表格滚动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-4-%E4%BC%98%E5%8C%96%E8%A1%A8%E6%A0%BC%E7%9A%84%E5%88%86%E9%A1%B5%E5%99%A8"><span class="toc-number">20.4.</span> <span class="toc-text">19.4 优化表格的分页器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-5-%E6%B7%BB%E5%8A%A0%E4%B8%AD%E6%96%87%E5%8C%85"><span class="toc-number">20.5.</span> <span class="toc-text">19.5 添加中文包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-6-%E6%8A%BD%E7%A6%BB%E5%88%86%E9%A1%B5%E5%99%A8"><span class="toc-number">20.6.</span> <span class="toc-text">19.6 抽离分页器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-7%E5%88%A0%E9%99%A4%E7%AE%A1%E7%90%86%E5%91%98"><span class="toc-number">20.7.</span> <span class="toc-text">19.7删除管理员</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-8-%E5%A6%82%E4%BD%95%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4%E7%AE%A1%E7%90%86%E5%91%98%E6%95%B0%E6%8D%AE"><span class="toc-number">20.8.</span> <span class="toc-text">19.8 如何批量删除管理员数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-9-%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98"><span class="toc-number">20.9.</span> <span class="toc-text">19.9.添加管理员</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#19-9-1-%E8%AE%BE%E7%BD%AE%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E7%9A%84%E6%8A%BD%E5%B1%89%E6%95%88%E6%9E%9C%EF%BC%88%E6%97%A0%E6%A0%91%E5%BD%A2%E6%8E%A7%E4%BB%B6%EF%BC%89"><span class="toc-number">20.9.1.</span> <span class="toc-text">19.9.1 设置添加管理员的抽屉效果（无树形控件）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-9-2-%E4%BF%AE%E6%94%B9%E8%8F%9C%E5%8D%95%E6%95%B0%E6%8D%AE-%E6%B7%BB%E5%8A%A0%E4%BA%86keyid%E5%AD%97%E6%AE%B5"><span class="toc-number">20.9.2.</span> <span class="toc-text">19.9.2 修改菜单数据 添加了keyid字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-9-3-%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E6%97%B6%E9%80%89%E6%8B%A9%E8%AF%A5%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90"><span class="toc-number">20.9.3.</span> <span class="toc-text">19.9.3 添加管理员时选择该管理员权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-9-4-%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98"><span class="toc-number">20.9.4.</span> <span class="toc-text">19.9.4 添加管理员</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-10%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%AE%E6%94%B9"><span class="toc-number">20.10.</span> <span class="toc-text">19.10管理员修改</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#20-%E7%B3%BB%E7%BB%9F%E9%A6%96%E9%A1%B5%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1"><span class="toc-number">21.</span> <span class="toc-text">20 系统首页数据统计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#21-%E5%B7%A6%E4%BE%A7%E8%8F%9C%E5%8D%95%E6%A0%8F%E7%9A%84%E6%9D%83%E9%99%90"><span class="toc-number">22.</span> <span class="toc-text">21 左侧菜单栏的权限</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#21-1-%E6%80%9D%E8%B7%AF"><span class="toc-number">22.1.</span> <span class="toc-text">21.1 思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-2-%E7%AE%97%E6%B3%95%E8%BF%87%E7%A8%8B"><span class="toc-number">22.2.</span> <span class="toc-text">21.2 算法过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-3-%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">22.3.</span> <span class="toc-text">21.3 算法实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-4-%E7%94%9F%E6%88%90%E5%8A%A8%E6%80%81%E7%9A%84%E5%B7%A6%E4%BE%A7%E8%8F%9C%E5%8D%95%E9%A1%B9"><span class="toc-number">22.4.</span> <span class="toc-text">21.4 生成动态的左侧菜单项</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#22%E3%80%81%E9%A1%B5%E9%9D%A2%E6%9D%83%E9%99%90"><span class="toc-number">23.</span> <span class="toc-text">22、页面权限</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#23%E3%80%81%E6%8C%89%E9%92%AE%E6%9D%83%E9%99%90"><span class="toc-number">24.</span> <span class="toc-text">23、按钮权限</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#24%E3%80%81%E8%BD%AE%E6%92%AD%E5%9B%BE%E7%AE%A1%E7%90%86"><span class="toc-number">25.</span> <span class="toc-text">24、轮播图管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#24-1-%E5%B0%81%E8%A3%85%E6%8E%A5%E5%8F%A3"><span class="toc-number">25.1.</span> <span class="toc-text">24.1 封装接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-2-%E8%BD%AE%E6%92%AD%E5%9B%BE%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93"><span class="toc-number">25.2.</span> <span class="toc-text">24.2 轮播图页面渲染</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-3-%E5%88%A0%E9%99%A4%E8%BD%AE%E6%92%AD%E5%9B%BE"><span class="toc-number">25.3.</span> <span class="toc-text">24.3 删除轮播图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-4-%E6%B7%BB%E5%8A%A0%E8%BD%AE%E6%92%AD%E5%9B%BE"><span class="toc-number">25.4.</span> <span class="toc-text">23.4 添加轮播图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#25-%E4%BA%A7%E5%93%81%E7%AE%A1%E7%90%86"><span class="toc-number">26.</span> <span class="toc-text">25.产品管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#25-1-%E5%B0%81%E8%A3%85%E6%8E%A5%E5%8F%A3"><span class="toc-number">26.1.</span> <span class="toc-text">25.1 封装接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-2-%E9%A6%96%E9%A1%B5%E4%BA%A7%E5%93%81%E5%88%97%E8%A1%A8"><span class="toc-number">26.2.</span> <span class="toc-text">25.2 首页产品列表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-3-%E8%AF%A6%E6%83%85%E6%8E%A8%E8%8D%90%E6%95%B0%E6%8D%AE"><span class="toc-number">26.3.</span> <span class="toc-text">25.3 详情推荐数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-4-%E8%B4%AD%E7%89%A9%E8%BD%A6%E6%8E%A8%E8%8D%90%E6%95%B0%E6%8D%AE"><span class="toc-number">26.4.</span> <span class="toc-text">25.4 购物车推荐数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-5-%E7%AD%9B%E9%80%89%E5%88%97%E8%A1%A8"><span class="toc-number">26.5.</span> <span class="toc-text">25.5 筛选列表</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#26-%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">27.</span> <span class="toc-text">26.数据可视化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-echarts"><span class="toc-number">27.1.</span> <span class="toc-text">1.echarts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Highcharts"><span class="toc-number">27.2.</span> <span class="toc-text">2.Highcharts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-antv-g2"><span class="toc-number">27.3.</span> <span class="toc-text">3.antv - g2</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#27-%E7%BC%96%E8%BE%91%E5%99%A8"><span class="toc-number">28.</span> <span class="toc-text">27.编辑器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8"><span class="toc-number">28.1.</span> <span class="toc-text">1.富文本编辑器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-markDown%E7%BC%96%E8%BE%91%E5%99%A8"><span class="toc-number">28.2.</span> <span class="toc-text">2.markDown编辑器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#28-%E5%AF%BC%E5%85%A5%E4%BB%A5%E5%8F%8A%E5%AF%BC%E5%87%BA"><span class="toc-number">29.</span> <span class="toc-text">28.导入以及导出</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AF%BC%E5%87%BA"><span class="toc-number">29.1.</span> <span class="toc-text">1.导出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AF%BC%E5%85%A5"><span class="toc-number">29.2.</span> <span class="toc-text">2.导入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#29-%E5%9C%B0%E5%9B%BE"><span class="toc-number">30.</span> <span class="toc-text">29.地图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#30-%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85%E5%8F%91%E5%B8%83"><span class="toc-number">31.</span> <span class="toc-text">30.项目打包发布</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/3d9e6dac.html" title="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia"><img src="/img/14.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia"></a><div class="content"><a class="title" href="/posts/3d9e6dac.html" title="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia">004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia</a><time datetime="2024-06-12T21:53:42.000Z" title="发表于 2024-06-12 21:53:42">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4f9a63a7.html" title="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？"><img src="/img/18.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？"></a><div class="content"><a class="title" href="/posts/4f9a63a7.html" title="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？">003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？</a><time datetime="2024-06-12T21:45:44.000Z" title="发表于 2024-06-12 21:45:44">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dda8b3d8.html" title="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分"><img src="/img/jujingyi.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分"></a><div class="content"><a class="title" href="/posts/dda8b3d8.html" title="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分">002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分</a><time datetime="2024-06-12T21:35:34.000Z" title="发表于 2024-06-12 21:35:34">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1faddbca.html" title="001_组件化开发原理，鸿蒙组件化实现思路"><img src="/img/1.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="001_组件化开发原理，鸿蒙组件化实现思路"></a><div class="content"><a class="title" href="/posts/1faddbca.html" title="001_组件化开发原理，鸿蒙组件化实现思路">001_组件化开发原理，鸿蒙组件化实现思路</a><time datetime="2024-06-12T21:28:54.000Z" title="发表于 2024-06-12 21:28:54">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/6d6b0b0f.html" title="019_Gauge"><img src="/img/9.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="019_Gauge"></a><div class="content"><a class="title" href="/posts/6d6b0b0f.html" title="019_Gauge">019_Gauge</a><time datetime="2024-06-12T21:24:14.000Z" title="发表于 2024-06-12 21:24:14">2024-06-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2024 By 许小墨</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_60306931/category_12251529.html">blog</a>!<br><span>备案号：xxxxxx</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach(((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,a="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent,i=mermaid.render(r,a);var m;"string"==typeof i?(m=i,d.insertAdjacentHTML("afterend",m)):i.then((({svg:e})=>{d.insertAdjacentHTML("afterend",e)}))}))},n=()=>{window.loadMermaid?t():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(t)};btf.addGlobalFn("themeChange",t,"mermaid"),window.pjax?n():document.addEventListener("DOMContentLoaded",n)})()</script><script>(()=>{let n=window.walineFn||null;const e=n=>{const e=n(Object.assign({el:"#waline-wrap",serverURL:"https://xuxiaomo-waline-i53b26l6n-xuxiaomo-xyj.vercel.app/",pageview:!1,dark:'html[data-theme="dark"]',path:window.location.pathname,comment:!1},null));btf.addGlobalFn("pjax",(()=>{e.destroy()}),"destroyWaline")},t=async()=>{if(n)e(n);else{await getCSS("https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css");const{init:t}=await import("https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js");n=t||Waline.init,e(n),window.walineFn=n}};btf.loadComment(document.getElementById("waline-wrap"),t)})()</script><script>(()=>{const t=function(){this.page.url="https://angelxyj.github.io/posts/60af50c8.html",this.page.identifier="/posts/60af50c8.html",this.page.title="react-pc"},e=()=>{window.DISQUS&&window.DISQUS.reset({reload:!0,config:t})};btf.addGlobalFn("themeChange",e,"disqus");const i=()=>{if(window.DISQUS)e();else{const t=document.createElement("script");t.src="https://xuxiaomo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),document.head.appendChild(t)}};window.loadOtherComment=i})()</script></div><script>window.addEventListener("load",(()=>{const e=e=>{let t="";if(e.length)for(let a=0;a<e.length;a++){t+="<div class='aside-list-item'>";{const n="src";t+=`<a href='${e[a].url}' class='thumbnail'><img ${n}='${e[a].avatar}' alt='${e[a].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[a].url}' title='${e[a].content}'>${e[a].content}</a>\n        <div class='name'><span>${e[a].nick} / </span><time datetime="${e[a].date}">${btf.diffDate(e[a].date,!0)}</time></div>\n        </div></div>`}else t+="没有评论";let a=document.querySelector("#card-newest-comments .aside-list");a&&(a.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(a)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("waline-newest-comments");t?e(JSON.parse(t)):(async()=>{try{const t=await fetch("https://xuxiaomo-waline-i53b26l6n-xuxiaomo-xyj.vercel.app/api/comment?type=recent&count=6",{method:"GET"}),a=(await t.json()).data.map((e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[图片]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[链接]")).replace(/<pre><code>.*?<\/pre>/gi,"[代码]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.objectId,date:e.time||e.insertedAt};var t}));saveToLocal.set("waline-newest-comments",JSON.stringify(a),10/1440),e(a)}catch(e){console.error(e),document.querySelector("#card-newest-comments .aside-list").textContent="无法获取评论，请确认相关配置是否正确"}})()}};t(),document.addEventListener("pjax:complete",t)}))</script><div class="aplayer no-destroy" data-id="8760365089" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-autoplay="false"></div><script defer src="/live2d-widget/autoload.js"></script><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="true" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script src="//code.tidio.co/fpezrlnx14lzqj1yzhyigw0j3rkhtyzv.js" async></script><script>(()=>{{let i=!1;const d=()=>{window.tidioChatApi.hide(),i=!1},o=()=>{window.tidioChatApi.open(),window.tidioChatApi.show(),i=!0},t=()=>{window.tidioChatApi.hide(),window.tidioChatApi.on("close",d)};window.tidioChatApi?window.tidioChatApi.on("ready",t):document.addEventListener("tidioChat-ready",t),window.chatBtnFn=()=>{window.tidioChatApi&&(i?d():o())}}})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(btf.removeGlobalFnEvent("pjax"),btf.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div><div class="app-refresh" id="app-refresh" style="position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease"><div class="app-refresh-wrap" style="display:flex;color:#fff;height:100%;align-items:center;justify-content:center"><label>✨ 糖果屋上新啦！ 👉</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color:#fff;text-decoration:underline;cursor:pointer">🍭查看新品🍬</span></a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"✨ 糖果屋上新啦！ 👉",backgroundColor:t,duration:5e5,pos:e,actionText:"🍭查看新品🍬",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script></div></body></html>