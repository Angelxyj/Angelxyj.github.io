<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>37-React综合案例 | 许小墨のBlog</title><meta name="author" content="许小墨,1440023258@qq.com"><meta name="copyright" content="许小墨"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="React综合案例 一、概要1、开发背景因公司某项目的业务数据管理需要，公司决定安排开发人员组成项目小组，为该项目开发一个后台管理系统，实现该项目日常业务数据的展示和维护。 【切勿直接写增删改查】  通用功能 登录   数据的展示 列表 图 ……   数据添加 正常表格添加数据 …..    开发背景需要体现：  为什么开发项目 开发项目能解决什么问题 比较核心的技术栈及功能实现  2、技术栈使用"><meta property="og:type" content="article"><meta property="og:title" content="37-React综合案例"><meta property="og:url" content="https://angelxyj.github.io/posts/1c915f8b.html"><meta property="og:site_name" content="许小墨のBlog"><meta property="og:description" content="React综合案例 一、概要1、开发背景因公司某项目的业务数据管理需要，公司决定安排开发人员组成项目小组，为该项目开发一个后台管理系统，实现该项目日常业务数据的展示和维护。 【切勿直接写增删改查】  通用功能 登录   数据的展示 列表 图 ……   数据添加 正常表格添加数据 …..    开发背景需要体现：  为什么开发项目 开发项目能解决什么问题 比较核心的技术栈及功能实现  2、技术栈使用"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://angelxyj.github.io/img/jujingyi.jpg"><meta property="article:published_time" content="2023-06-16T11:47:34.000Z"><meta property="article:modified_time" content="2024-10-01T16:38:42.587Z"><meta property="article:author" content="许小墨"><meta property="article:tag" content="前端"><meta property="article:tag" content="框架"><meta property="article:tag" content="React"><meta property="article:tag" content="React杂记"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://angelxyj.github.io/img/jujingyi.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://angelxyj.github.io/posts/1c915f8b.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/favicon-16x16.png"><link rel="mask-icon" href="/img/siteicon/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"找不到您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!0},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: 许小墨",link:"链接: ",source:"来源: 许小墨のBlog",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体中文",cht_to_chs:"你已切换为简体中文",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!0,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!0},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"37-React综合案例",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-10-01 16:38:42"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)})),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{const e=document.getElementById("loading-box"),d=document.body,o=()=>{d.style.overflow="",e.classList.add("loaded")},t=()=>{d.style.overflow="hidden",e.classList.remove("loaded")};t(),window.addEventListener("load",(()=>{o()})),document.addEventListener("pjax:send",(()=>{t()})),document.addEventListener("pjax:complete",(()=>{o()}))})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/touxiang.webp" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">198</div></a><a href="/%E6%A0%87%E7%AD%BE/"><div class="headline">标签</div><div class="length-num">183</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">42</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>电影</span></a></li><li><a class="site-page child" href="/poems/"><i class="fa-fw fas fa-book"></i> <span>文学鉴赏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-compass"></i> <span>关于</span></a></li><li><a class="site-page child" href="/sponsor/"><i class="fa-fw fas fa-thumbs-up"></i> <span>打赏</span></a></li><li><a class="site-page child" href="/resume/"><i class="fa-fw fas fa-book"></i> <span>简历</span></a></li><li><a class="site-page child" href="/TodoList"><i class="fa-fw fab fa-internet-explorer"></i> <span>计划</span></a></li><li><a class="site-page child" href="/ChatGPT/"><i class="fa-fw fas fa-fan"></i> <span>GPT</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('/img/jujingyi.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="许小墨のBlog"><span class="site-name">许小墨のBlog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>电影</span></a></li><li><a class="site-page child" href="/poems/"><i class="fa-fw fas fa-book"></i> <span>文学鉴赏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-compass"></i> <span>关于</span></a></li><li><a class="site-page child" href="/sponsor/"><i class="fa-fw fas fa-thumbs-up"></i> <span>打赏</span></a></li><li><a class="site-page child" href="/resume/"><i class="fa-fw fas fa-book"></i> <span>简历</span></a></li><li><a class="site-page child" href="/TodoList"><i class="fa-fw fab fa-internet-explorer"></i> <span>计划</span></a></li><li><a class="site-page child" href="/ChatGPT/"><i class="fa-fw fas fa-fan"></i> <span>GPT</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">37-React综合案例</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-16T11:47:34.000Z" title="发表于 2023-06-16 11:47:34">2023-06-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-01T16:38:42.587Z" title="更新于 2024-10-01 16:38:42">2024-10-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/">前端开发</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/">框架开发</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/React/">React</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/React/React%E6%9D%82%E8%AE%B0/">React杂记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>41分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="37-React综合案例"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>React综合案例</p><h1 id="一、概要"><a href="#一、概要" class="headerlink" title="一、概要"></a>一、概要</h1><h2 id="1、开发背景"><a href="#1、开发背景" class="headerlink" title="1、开发背景"></a>1、开发背景</h2><p>因公司某项目的业务数据管理需要，公司决定安排开发人员组成项目小组，为该项目开发一个后台管理系统，实现该项目日常业务数据的展示和维护。 【<strong>切勿直接写增删改查</strong>】</p><ul><li>通用功能<ul><li>登录</li></ul></li><li>数据的展示<ul><li>列表</li><li>图</li><li>……</li></ul></li><li>数据添加<ul><li>正常表格添加数据</li><li>…..</li></ul></li></ul><p>开发背景需要体现：</p><ul><li>为什么开发项目</li><li>开发项目能解决什么问题</li><li>比较核心的技术栈及功能实现</li></ul><h2 id="2、技术栈"><a href="#2、技术栈" class="headerlink" title="2、技术栈"></a>2、技术栈</h2><p>使用react框架来完成本次项目的实现，采用前后端分离式开发，使用前端技术有如下一些：</p><ul><li>react：主框架</li><li>react-router-dom：路由包</li><li>redux：大规模状态管理库</li><li>react-redux：给redux做强化</li><li>styled-components ：css-in-js技术的实现</li><li>antd：前端组件库（ant design、antd mobile）</li><li>axios：网络请求库</li><li>……</li></ul><p>后端技术有：</p><ul><li>PHP&#x2F;JAVA&#x2F;Go&#x2F;Python&#x2F;NodeJS：后端语言</li><li>MySQL：数据库软件 (关系型数据库)</li><li>Redis：数据库软件 (非关系型数据库)</li><li>Laravel(php)：后端框架 Spring(JAVA)</li><li>……</li></ul><h2 id="3、开发环境"><a href="#3、开发环境" class="headerlink" title="3、开发环境"></a>3、开发环境</h2><p>开发环境：Windows</p><p>开发工具：vscode + jsx插件</p><p>开发调试工具：chrome浏览器</p><p>开发运行环境：node环境&gt;&#x3D; v14</p><p>上线环境为：nginx + git</p><h2 id="4、效果预览"><a href="#4、效果预览" class="headerlink" title="4、效果预览"></a>4、效果预览</h2><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2021/11/9b9973f4eb782bdab2fb6eab57540b41eeda91bb.jpeg?sign=4777e7843f40b2d3e4f11a24d2b1a948&t=618a45a3"></p><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2021/05/2295c123cdb63ece9b72f15b1b93e5fc12a7417f.png?sign=6d3e6fdcb0c34d77a4a12f57afb61fb2&t=60af80a6"></p><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2022/01/fceb3885059891edd94906524a4a88cc2d6d0d4d.png?sign=921bf01b9054a0d98812b93bc6d15060&t=61e0d812"></p><h2 id="5、项目初始化"><a href="#5、项目初始化" class="headerlink" title="5、项目初始化"></a>5、项目初始化</h2><p>a. 首先找个位置创建一下react项目，命令如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app backend</span><br></pre></td></tr></table></figure><p>b. 创建好项目后，<strong>进入项目目录</strong>先安装常规要使用的三方包，命令如下：</p><ul><li>注意: 在项目中引入第三方包时,有些包是开发环境的依赖, 安装方式 npm i 包名 –save-dev 或者 npm i 包名-D</li><li>注意: 在项目中引入第三方包时,有些包是生产环境的依赖, 安装方式 npm i 包名 或者 npm i 包名 –save</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">npm i -S axios redux react-redux  styled-components react-router-dom@5.3.3 </span><br><span class="line">// 默认生产环境依赖包安装,上线时,会打包这些文件到生产环境包</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">axios：网络请求库</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">redux：状态管理</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">react-redux：redux功能增强的包</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">styled-components：css-in-js热门库</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">react-router-dom：路由包</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm i -D customize-cra react-app-rewired http-proxy-middleware</span><br><span class="line">// 开发环境安装的依赖,上线打包的时候,不会打包这些文件的</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">customize-cra react-app-rewired：默认情况下，我们是没有对于react项目的配置权的。使用了react-app-rewired之后，我们就可以获取到react项目中对于webpack的配置权。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">http-proxy-middleware：代理中间件，在vue中默认写好代理配置即可，在react中需要先安装三方的包，才能写代理配置。</span></span><br></pre></td></tr></table></figure><p>c. 清理创建好的项目中不需要的文件及文件夹</p><blockquote><ul><li>删除<code>public</code>目录下的不需要的内容</li><li>删除<code>src</code>目录下的不需要的内容</li></ul></blockquote><p>d. 给项目引入路由模式 <code>BrowserRouter</code> 历史模式路由</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 项目入口文件（编译入口）</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span> <span class="keyword">as</span> <span class="title class_">Router</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span>,</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>e. 在<strong>当前项目根目录下</strong>面创建一个名称为<code>config-overrides.js</code>文件，对webpack进行配置（该配置方式不是对react内置配置进行直接修改，而是通过三方的包实现配置覆盖）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置信息可以参考：https://www.npmjs.com/package/customize-cra</span></span><br><span class="line"><span class="comment">// 修改react脚手架中的默认的webpack的配置, 在该文件中 添加额外的配置,覆盖掉node_nodules中webpack的默认配置,达到修改项目webpack的目的</span></span><br><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">    override,</span><br><span class="line">    addDecoratorsLegacy,</span><br><span class="line">    disableEsLint,</span><br><span class="line">    addBundleVisualizer,</span><br><span class="line">    addWebpackAlias,</span><br><span class="line">    adjustWorkbox,</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">&quot;customize-cra&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);\</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">override</span>(</span><br><span class="line">    <span class="comment">// 在webpack中禁用eslint</span></span><br><span class="line">    <span class="title function_">disableEsLint</span>(),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加webpack别名</span></span><br><span class="line">    <span class="title function_">addWebpackAlias</span>(&#123;</span><br><span class="line">        <span class="comment">// 添加路径对@符号的支持</span></span><br><span class="line">        [<span class="string">&quot;@&quot;</span>]: path.<span class="title function_">resolve</span>(<span class="string">&quot;./src&quot;</span>),</span><br><span class="line">    &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>f. 修改<code>package.json</code>中的脚本命令为如下：</p><p>如上修改完webpack配置,需要修改package.json中的一些脚本命令配置,这样如上修改的配置才能生效. 将react-scripts 替换成 react-app-rewired</p><blockquote><p>参考来源：<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/react-app-rewired">https://www.npmjs.com/package/react-app-rewired</a></p></blockquote><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2020/11/d83ef02592b20151676a3161480e71ed60386109.png?sign=367d15c590345effbd1fcaa0aff6af91&t=5fa2e5f7"></p><p>g. <strong>在<code>src</code>目录下创建一个名称为<code>setupProxy.js</code>文件</strong>，提前为后续接口设置反向代理（<strong>如果需要的话</strong>）</p><blockquote><p>与vue一样，代理操作仅限于本地开发环境，上线就失效了。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; createProxyMiddleware &#125; = <span class="built_in">require</span>(<span class="string">&#x27;http-proxy-middleware&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span>(<span class="params">app</span>) &#123;</span><br><span class="line">    app.<span class="title function_">use</span>(</span><br><span class="line">        <span class="title function_">createProxyMiddleware</span>(<span class="string">&#x27;/api&#x27;</span>, &#123; </span><br><span class="line">            <span class="attr">target</span>: <span class="string">&#x27;https://api.i-lynn.cn/college&#x27;</span>,</span><br><span class="line">            <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">pathRewrite</span>: &#123; <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span> &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>i. 建立src&#x2F;下相关的目录，划分好目录结构（模块化，可以暂时不去建立）</p><ul><li>assets：存放静态资源的目录，后续可以放图片、css、js等文件</li><li>components：封装组件存储的位置</li><li>config：存放配置文件的目录</li><li>hoc：存放高阶组件的文件</li><li>router：存放路由文件</li><li>services：存放封装一些文件（比如，axios封装）</li><li>store：redux相关的目录</li><li>views：视图组件存放目录</li></ul><p>完毕后，初始化仓库，同步本地与线上仓库。</p><h2 id="6、远程仓库的创建与同步"><a href="#6、远程仓库的创建与同步" class="headerlink" title="6、远程仓库的创建与同步"></a>6、远程仓库的创建与同步</h2><p>远程仓库的选择：</p><ul><li>github</li><li>gitlab</li><li>gitee</li></ul><p>①在登录gitee后，在右上角选择新建仓库</p><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2021/11/ba787b8570a96ba7dbec1234a4f9c729f6b319fa.png?sign=640372c42e0242cd4fe5ffdf2bca6b77&t=618b84f6"></p><p>②在新建仓库界面根据需要填写或选择一些信息，以下为例</p><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2021/11/4d7d2ade6f515f916a66f8b38ce29f16484aed46.png?sign=f10027c9a9a1c00f9763fa73435dd0f2&t=618b85c1"></p><p>③将操作选择到SSH上，后续需要基于SSH进行对Gitee操作</p><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2021/11/a4b74634a3a6901ec42dac2ed5e0f1d7a4fc5ad2.png?sign=998ac99b5425484dd5a55dabb8d6ee75&t=618b86cf"></p><p>④默认情况下，无论Windows还是Mac，都不支持使用SSH免密登录，需要产生免密登录的<strong>公私钥</strong>，然后再在gitee上进行配置后才可以使用免密鉴权（其它远程仓库平台操作一致）</p><blockquote><p>公私玥，也就是公钥+私钥，是非对称加密算法的密钥体现。</p><p>密码学中主要有两种加密算法类型：对称加密、非对称加密。</p></blockquote><p>a. 生成公私钥对</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2021/11/f239d74a2277e58d84a1328dbe136e41668fbf5f.png?sign=ddbbf950cb0c2f9188504fef4f9c5010&t=618b8a2c"></p><blockquote><p>Mac系统的公私玥在以下路径下：<del>&#x2F;.ssh&#x2F; 【</del>，当前用户的家目录】</p></blockquote><p>b. 进入gitee的个人设置页面，将生成的公钥输入到远程仓库平台</p><p>地址如下：<a target="_blank" rel="noopener" href="https://gitee.com/profile/account_information">https://gitee.com/profile/account_information</a></p><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2021/11/a932c423e0202ae7340953a5e5b3477268b0f203.png?sign=07d7c5c3c97420219d402dd6384513e6&t=618b8bd9"></p><p>至此，免密操作已经配置完成！</p><p>c. 企业开发正常不会在master分支下开发（该分支是稳定代码的分支），开发的时候一般会有开发分支，例如开发可以在dev分支下开发（后续多半为模块名作为分支或姓名作为分支名），开发好后确认没有问题再往master分支合并</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git branch dev</span><br><span class="line">git checkout dev</span><br><span class="line">git push -u origin dev</span><br></pre></td></tr></table></figure><p>建议：</p><ul><li>git操作的相关命令请提高熟练度</li><li>熟悉git的可视化工具，下载地址：<a target="_blank" rel="noopener" href="https://tortoisegit.org/download/">https://tortoisegit.org/download/</a></li></ul><h2 id="7、antd组件库"><a href="#7、antd组件库" class="headerlink" title="7、antd组件库"></a>7、antd组件库</h2><p>官网：<a target="_blank" rel="noopener" href="https://ant.design/">https://ant.design/</a></p><blockquote><p>面向企业级应用研发的 UI 设计语言与前端技术实现。</p></blockquote><p><strong>推荐使用 npm 或 yarn 的方式进行开发</strong>，不仅可在开发环境轻松调试，也可放心地在生产环境打包部署使用，享受整个生态圈和工具链带来的诸多好处。</p><p>如果你的电脑是使用npm进行项目包管理，请在项目中执行以下命令以在项目中安装ant design：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install antd --save</span><br></pre></td></tr></table></figure><p>若使用的是yarn管理，则请运行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add antd</span><br></pre></td></tr></table></figure><p>在<strong>项目入口文件index.js 中</strong>引入antd的样式文件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;antd/dist/antd.css&#x27;</span>; </span><br><span class="line"><span class="comment">// or &#x27;antd/dist/antd.less&#x27;</span></span><br></pre></td></tr></table></figure><p>后续需要使用antd组件时，根据对应页面的引导使用即可。</p><h1 id="二、登录开发"><a href="#二、登录开发" class="headerlink" title="二、登录开发"></a>二、登录开发</h1><h2 id="1、创建空组件"><a href="#1、创建空组件" class="headerlink" title="1、创建空组件"></a>1、创建空组件</h2><p>首先创建登录功能需要用的组件，该功能需要用到2个表单，为了便于维护，建议将俩个表单单独形成组件，加上一个大页面包裹，一共需要三个组件。</p><ul><li>大组件：views&#x2F;login&#x2F;Index.jsx<ul><li>普通登录组件：views&#x2F;login&#x2F;NormalLogin.jsx</li><li>短信登录组件：views&#x2F;login&#x2F;MobileLogin.jsx</li></ul></li></ul><p>为了有初步的预览效果，可以在组件中适当写一些内容填充使用。</p><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2021/05/f7b470db6f5f1e76054cc19b8365525a6f4b1760.png?sign=dbff97ce44a594106174bfba009b9182&t=60b0624e"></p><h2 id="2、组件封装（重点）"><a href="#2、组件封装（重点）" class="headerlink" title="2、组件封装（重点）"></a>2、组件封装（重点）</h2><p>目前已知需要封装俩个组件：</p><ul><li>loading组件<ul><li>封装的目的：antd自带的Spin组件虽然可以实现加载中，但是其位置不居中，在显示上很不友好，为了让路由懒加载能够有很好的用户体验，建议封装Loading组件</li></ul></li><li>验证码组件<ul><li>验证码在项目中一般会重复的使用，为了降低代码重复率，建议封装</li></ul></li></ul><p>封装的组件都放在components目录下：</p><ul><li>src&#x2F;components&#x2F;Loading.jsx</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 组件：Loading.jsx</span></span><br><span class="line"><span class="comment"> * 作用：封装用于复用的加载中提示组件</span></span><br><span class="line"><span class="comment"> * 注意点：</span></span><br><span class="line"><span class="comment"> *      对于封装的组件要注意其良好的通用性及可以执行。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Spin</span> &#125; <span class="keyword">from</span> <span class="string">&quot;antd&quot;</span></span><br><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">&#x27;styled-components&#x27;</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Loading</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">        <span class="attr">tip</span>: <span class="string">&quot;加载中...&quot;</span>,</span><br><span class="line">        <span class="attr">spinning</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">Main</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Spin</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">spinning</span>=<span class="string">&#123;this.props.spinning&#125;</span> <span class="attr">tip</span>=<span class="string">&#123;this.props.tip&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Main</span>&gt;</span></span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 编写样式，让其居中，在设置高度100%的时候需要注意也同时设置其父级元素高度也为100%</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Main</span> = styled.<span class="property">div</span><span class="string">`</span></span><br><span class="line"><span class="string">    display: flex;</span></span><br><span class="line"><span class="string">    justify-content: center;</span></span><br><span class="line"><span class="string">    align-items: center;</span></span><br><span class="line"><span class="string">    height: 100%;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Loading</span>;</span><br></pre></td></tr></table></figure><ul><li>src&#x2F;components&#x2F;Captcha.jsx</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 组件：Captcha</span></span><br><span class="line"><span class="comment"> * 作用：产生图形验证码</span></span><br><span class="line"><span class="comment"> * 验证码的工作流程：</span></span><br><span class="line"><span class="comment"> *      a. 后端生成验证码（有诸多格式：图片、url、base64等），随后将验证码验证结果存入到缓存中</span></span><br><span class="line"><span class="comment"> *      b. 客户端发起请求，能够取到验证码图片及一个与验证码验证结果相关联的key值</span></span><br><span class="line"><span class="comment"> *      c. 图片需要页面上展示，key值需要存储在前端中（最合理的是存储在组件state中）</span></span><br><span class="line"><span class="comment"> *      d. 用户输入验证码</span></span><br><span class="line"><span class="comment"> *      e. 将用户输入的验证码值与key值一起发送给服务器</span></span><br><span class="line"><span class="comment"> *      f. 服务器将验证码的值与key值与缓存中的数据进行比较，一致则返回成功，否则失败</span></span><br><span class="line"><span class="comment"> *      g. 如果成功，则前端允许用户继续下一步操作；否则前端提示用户并且刷新验证码</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 细节：</span></span><br><span class="line"><span class="comment"> *      细节1：点击刷新问题</span></span><br><span class="line"><span class="comment"> *      细节2：key存在哪</span></span><br><span class="line"><span class="comment"> *              可能存在部分场景，在同一个组件显示中两次及以上次数需要使用Captcha，容易导致后加载的验证码的key值覆盖之前的验证码的key值,可以考虑将key存到各自使用Captcha的父组件中,因为父组件肯定是不相同的.</span></span><br><span class="line"><span class="comment"> *      细节3：验证码如何做到场景通用（尺寸）</span></span><br><span class="line"><span class="comment"> *      </span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 切记 父需要传递一个方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>,&#123;useState,useEffect,useImperativeHandle,forwardRef&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;../service/index&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">forwardRef</span>(<span class="keyword">function</span> <span class="title function_">Captcha</span>(<span class="params">props,ref</span>) &#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">let</span> [captcha,setCaptcha]=<span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>)<span class="comment">//用户输入的用于核对的验证码</span></span><br><span class="line">    <span class="keyword">let</span> [img,setImg]=<span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>) <span class="comment">//图片验证码</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">getCode</span>=(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">        axios.<span class="title function_">get</span>(<span class="string">&quot;/captcha/api/math&quot;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">            props.<span class="title function_">setKey</span>(res.<span class="property">data</span>.<span class="property">key</span>);  <span class="comment">//子组件调用父组件的方法，目的是让密码登录组件拿到key </span></span><br><span class="line">            <span class="title function_">setImg</span>(res.<span class="property">data</span>.<span class="property">img</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">//请求图片验证码</span></span><br><span class="line">       <span class="title function_">getCode</span>()</span><br><span class="line">    &#125;,[])</span><br><span class="line">    <span class="title function_">useImperativeHandle</span>(ref,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            getCode  <span class="comment">//暴露这个方法给父组件调用，目的是，父组件登录失败的时候，调用这个方法可以重新生成验证码</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line"></span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;img&#125;</span> <span class="attr">width</span>=<span class="string">&quot;130&quot;</span> <span class="attr">height</span>=<span class="string">&quot;30&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;getCode&#125;</span> /&gt;</span></span></span><br><span class="line"></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3、登录页布局"><a href="#3、登录页布局" class="headerlink" title="3、登录页布局"></a>3、登录页布局</h2><p>编辑组件：src&#x2F;views&#x2F;login&#x2F;Index.jsx</p><p>ant组件：<a target="_blank" rel="noopener" href="https://ant.design/components/tabs-cn/">https://ant.design/components/tabs-cn/</a></p><p>设计思路：使用tab选项卡的方式实现<code>常规登录</code>和<code>短信登录</code>的切换</p><p>组件：</p><ul><li>Card组件：<a target="_blank" rel="noopener" href="https://ant.design/components/card-cn/">https://ant.design/components/card-cn/</a></li><li>Tabs组件：<a target="_blank" rel="noopener" href="https://ant.design/components/tabs-cn/">https://ant.design/components/tabs-cn/</a></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Tabs</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NormalLogin</span> <span class="keyword">from</span> <span class="string">&#x27;../../components/PasswordLogin&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./login.css&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MobileLogin</span> <span class="keyword">from</span> <span class="string">&#x27;../../components/Mobile&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Login</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onChange</span> = (<span class="params">key</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(key);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> items = [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">      <span class="attr">label</span>: <span class="string">`密码登录`</span>,</span><br><span class="line">      <span class="attr">children</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">NormalLogin</span>&gt;</span><span class="tag">&lt;/<span class="name">NormalLogin</span>&gt;</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">key</span>: <span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">      <span class="attr">label</span>: <span class="string">`短信登录`</span>,</span><br><span class="line">      <span class="attr">children</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">MobileLogin</span>&gt;</span><span class="tag">&lt;/<span class="name">MobileLogin</span>&gt;</span></span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">  ];</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;login&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Tabs</span> <span class="attr">defaultActiveKey</span>=<span class="string">&quot;1&quot;</span> <span class="attr">items</span>=<span class="string">&#123;items&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;onChange&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4、路由规划"><a href="#4、路由规划" class="headerlink" title="4、路由规划"></a>4、路由规划</h2><p>路由文件：router&#x2F;index.js</p><blockquote><p>在React中的路由懒加载：</p><ul><li><p>需要导入react包中的俩个成员</p><ul><li>lazy，它是一个方法，负责去import对应的组件的</li><li>Suspense：它是一个组件，负责去应用组件以及可以制定懒加载时需要的提示组件</li></ul></li><li><p>注意: 使用路由规则前,先去项目入口文件index.js 文件中定义路由模式,(BrowserRouter or HashRouter )</p><p>需要包裹根组件App.jsx</p></li></ul></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 项目路由文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; lazy, <span class="title class_">Suspense</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Route</span>, <span class="title class_">Redirect</span>, <span class="title class_">Switch</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="comment">// 导入loading组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Loading</span> <span class="keyword">from</span> <span class="string">&quot;@/components/Loading&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用lazy导入需要的组件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Login</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/views/login/Index&quot;</span>));</span><br><span class="line"><span class="comment">// .....</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 编写路由规则</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Routes</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">Loading</span> /&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Switch</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Login&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Redirect</span> <span class="attr">from</span>=<span class="string">&quot;/&quot;</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Switch</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出路由规则</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Routes</span>;</span><br></pre></td></tr></table></figure><p>在写好路由规则文件后，需要在App.jsx组件中应用所有的路由规则：</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="comment">// 导入路由</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Routes</span> <span class="keyword">from</span> <span class="string">&quot;@/router/index&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">Routes</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="5、功能实现"><a href="#5、功能实现" class="headerlink" title="5、功能实现"></a>5、功能实现</h2><h3 id="5-1、常规登录"><a href="#5-1、常规登录" class="headerlink" title="5.1、常规登录"></a>5.1、常规登录</h3><p>步骤：</p><ul><li>排版出用户登录的表单</li><li>用户输入并且提交后端验证<ul><li><p>url地址封装（首次）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> prefix = <span class="string">&#x27;https://reactapi.iynn.cn/&#x27;</span>; <span class="comment">// 公共域名地址</span></span><br><span class="line"><span class="keyword">const</span> url = &#123;</span><br><span class="line">    <span class="comment">// 用户名密码登录接口</span></span><br><span class="line">    <span class="attr">pwdlogin</span>: prefix + <span class="string">&#x27;api/common/auth/login&#x27;</span>,</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> url</span><br></pre></td></tr></table></figure></li><li><p>axios的封装（首次）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="comment">// axios 设置请求拦截器和响应拦截器</span></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 在请求拦截器中,我们一般可以处理参数,请求头信息,一般用来设置请求头token</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">Authorization</span> = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;jwt&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Authorization</span>) &#123;</span><br><span class="line">        config.<span class="property">headers</span>.<span class="property">Authorization</span> = <span class="title class_">Authorization</span></span><br><span class="line">        <span class="comment">// config.headers[&#x27;Authorization&#x27;] = Authorization</span></span><br><span class="line">        <span class="comment">// config.headers.common[&#x27;Authorization&#x27;] = Authorization</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// 一般用于处理响应数据,使用场景可以用来存储token,有时后台的接口设计登录成功后返回的token是有时</span></span><br><span class="line"><span class="comment">//假如 2小时token有效, 后续接口中,只要调用任意一个接口,都会重新返回token,这样事件就顺延2小时,,所有每次token 都需要存</span></span><br><span class="line">     <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">context</span> &amp;&amp; res.<span class="property">data</span>.<span class="property">context</span>.<span class="property">jwt</span>) &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;jwt&#x27;</span>, res.<span class="property">data</span>.<span class="property">context</span>.<span class="property">jwt</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用来存储用户菜单(根据用户角色返回的首页左侧菜单)</span></span><br><span class="line">    <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">context</span> &amp;&amp; res.<span class="property">data</span>.<span class="property">context</span>.<span class="property">acl</span>) &#123;</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;acl&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(res.<span class="property">data</span>.<span class="property">context</span>.<span class="property">acl</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> axios</span><br></pre></td></tr></table></figure></li><li><p>发送请求</p></li></ul></li></ul><p>组件：</p><ul><li><p>Form组件：<a target="_blank" rel="noopener" href="https://ant.design/components/form-cn/">https://ant.design/components/form-cn/</a></p></li><li><p>Icon组件：<a target="_blank" rel="noopener" href="https://ant.design/components/icon-cn/">https://ant.design/components/icon-cn/</a></p></li><li><p>Space组件：<a target="_blank" rel="noopener" href="https://ant.design/components/space-cn/">https://ant.design/components/space-cn/</a></p></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LockOutlined</span>, <span class="title class_">UserOutlined</span>,<span class="title class_">KeyOutlined</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span>,  <span class="title class_">Form</span>, <span class="title class_">Input</span>,<span class="title class_">Space</span>,message &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Captcha</span> <span class="keyword">from</span> <span class="string">&#x27;../../components/Captcha&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useState,useRef&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom/cjs/react-router-dom.min&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;@/services/index&#x27;</span>  <span class="comment">//封装后的axios</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> [key,setKey]=<span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>)   <span class="comment">//登录时候需要的key值   setKey 要被子组件调用，把key值传过来</span></span><br><span class="line">  <span class="keyword">const</span> history=<span class="title function_">useHistory</span>();</span><br><span class="line">  <span class="keyword">const</span> captchaRef=<span class="title function_">useRef</span>() <span class="comment">//标识Captcha组件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onFinish</span> = (<span class="params">values</span>) =&gt; &#123;</span><br><span class="line">    values.<span class="property">key</span>=key;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Received values of form: &#x27;</span>, values);</span><br><span class="line">    axios.<span class="title function_">post</span>(<span class="string">&quot;/common/auth/login&quot;</span>,values).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">errNo</span>===<span class="number">0</span>)&#123;</span><br><span class="line">           </span><br><span class="line">          message.<span class="title function_">success</span>(res.<span class="property">data</span>.<span class="property">message</span>,<span class="number">1</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            history.<span class="title function_">push</span>(<span class="string">&quot;/dashboard&quot;</span>)<span class="comment">//登录成功后跳转到首页</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">          message.<span class="title function_">error</span>(res.<span class="property">data</span>.<span class="property">errText</span>,<span class="number">1</span>)</span><br><span class="line">            <span class="comment">//登录失败重新获取验证码   获取验证的方法在子组件里 方法getImg</span></span><br><span class="line">            captchaRef.<span class="property">current</span>.<span class="title function_">getImg</span>();  <span class="comment">//父组件调用子组件的方法</span></span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Form</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">name</span>=<span class="string">&quot;normal_login&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">className</span>=<span class="string">&quot;login-form&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">onFinish</span>=<span class="string">&#123;onFinish&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;username&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rules</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">required:</span> <span class="attr">true</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">message:</span> &#x27;<span class="attr">Please</span> <span class="attr">input</span> <span class="attr">your</span> <span class="attr">Username</span>!&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        ]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Input</span> <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">UserOutlined</span> <span class="attr">className</span>=<span class="string">&quot;site-form-item-icon&quot;</span> /&gt;</span>&#125; placeholder=&quot;Username&quot; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rules</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">required:</span> <span class="attr">true</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">message:</span> &#x27;<span class="attr">Please</span> <span class="attr">input</span> <span class="attr">your</span> <span class="attr">Password</span>!&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        ]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">LockOutlined</span> <span class="attr">className</span>=<span class="string">&quot;site-form-item-icon&quot;</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">          type=&quot;password&quot;</span></span><br><span class="line"><span class="language-xml">          placeholder=&quot;Password&quot;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;captcha&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rules</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">required:</span> <span class="attr">true</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">message:</span> &#x27;<span class="attr">Please</span> <span class="attr">input</span> <span class="attr">your</span> <span class="attr">captcha</span>!&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        ]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 间距组件，可以把组件放置一行，并拉开适当的间距 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Input</span> <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">KeyOutlined</span> /&gt;</span>&#125; placeholder=&quot;验证码&quot; /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Captcha</span> <span class="attr">setKey</span>=<span class="string">&#123;setKey&#125;</span> <span class="attr">ref</span>=<span class="string">&#123;captchaRef&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Captcha</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">htmlType</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">className</span>=<span class="string">&quot;login-form-button&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          登录</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    </span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h3 id="5-2、短信登录"><a href="#5-2、短信登录" class="headerlink" title="5.2、短信登录"></a>5.2、短信登录</h3><p>步骤：</p><ul><li>页面的布局</li><li>倒计时</li><li>短信发送</li><li>获取表单信息提交去验证登录</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LockOutlined</span>, <span class="title class_">UserOutlined</span>, <span class="title class_">KeyOutlined</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span>, <span class="title class_">Form</span>, <span class="title class_">Input</span>, <span class="title class_">Space</span>, message &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Captcha</span> <span class="keyword">from</span> <span class="string">&#x27;../../components/Captcha&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useState, useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom/cjs/react-router-dom.min&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;@/services/index&#x27;</span>  <span class="comment">//封装后的axios</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> [key, setKey] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>)   <span class="comment">//登录时候需要的key值   setKey 要被子组件调用，把key值传过来</span></span><br><span class="line">  <span class="keyword">let</span> [time,setTime]=<span class="title function_">useState</span>(<span class="number">5</span>); <span class="comment">//倒计时的时间</span></span><br><span class="line">  <span class="keyword">let</span>  [requestId,setRequestId]=<span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);  <span class="comment">//存储requestId 用于手机短信登录</span></span><br><span class="line">  <span class="keyword">let</span> [disabled,setDisabled]=<span class="title function_">useState</span>(<span class="literal">false</span>); <span class="comment">//发送验证码按钮是否可用 false是可用 true是不可用状态</span></span><br><span class="line">  <span class="keyword">const</span> history = <span class="title function_">useHistory</span>();</span><br><span class="line">  <span class="keyword">const</span> formRef = <span class="title function_">useRef</span>(); <span class="comment">//标识表单</span></span><br><span class="line">  <span class="keyword">const</span> captchaRef = <span class="title function_">useRef</span>() <span class="comment">//标识Captcha组件</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onFinish</span> = (<span class="params">values</span>) =&gt; &#123;</span><br><span class="line">    values.<span class="property">key</span> = key;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Received values of form: &#x27;</span>, values);</span><br><span class="line">      <span class="comment">//axios post  /api/common/auth/mobile  requestid mobile code </span></span><br><span class="line">      <span class="keyword">if</span>(values.<span class="property">code</span>===<span class="string">&quot;2303&quot;</span> &amp;&amp; values.<span class="property">mobile</span>===<span class="string">&quot;15677888888&quot;</span> &amp;&amp; requestId===<span class="number">1234</span> )&#123;</span><br><span class="line">        message.<span class="title function_">success</span>(<span class="string">&quot;登录成功&quot;</span>,<span class="number">1</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">          history.<span class="title function_">push</span>(<span class="string">&quot;/dashboard&quot;</span>)<span class="comment">//登录成功后跳转到首页</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">send</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">//1表单验证 </span></span><br><span class="line">    <span class="comment">//  formRef.current.validateFields([&#x27;mobile&#x27;,&#x27;captcha&#x27;]).then((res)=&gt;&#123;</span></span><br><span class="line">    <span class="comment">//   //只要这个then回调执行，就说明发送验证码前已经输入了手机号验证码了</span></span><br><span class="line">    <span class="comment">//     //2图形验证码验证</span></span><br><span class="line">    <span class="comment">//     axios.post(&quot;/common/captcha/verify&quot;,&#123;key,captcha:res.captcha&#125;).then((res1)=&gt;&#123;</span></span><br><span class="line">    <span class="comment">//       if(res1.data.errNo===0)&#123;</span></span><br><span class="line">    <span class="comment">//          //3短信验证</span></span><br><span class="line">    <span class="comment">//         axios.post(&quot;/common/sms/send&quot;,&#123;token:res1.data.context.token,mobile:res.mobile,type:0&#125;).then((res2)=&gt;&#123;</span></span><br><span class="line">    <span class="comment">//           message.info(&quot;短信下发成功&quot;)</span></span><br><span class="line">    <span class="comment">//         &#125;)</span></span><br><span class="line">    <span class="comment">//       &#125;</span></span><br><span class="line">    <span class="comment">//       else&#123;</span></span><br><span class="line">    <span class="comment">//         captchaRef.current.getImg();  //验证码失败刷新验证码</span></span><br><span class="line">    <span class="comment">//         message.error(res1.data.errText,1)</span></span><br><span class="line">    <span class="comment">//       &#125;</span></span><br><span class="line">    <span class="comment">//     &#125;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//  &#125;).catch((error)=&gt;&#123;</span></span><br><span class="line">    <span class="comment">//      console.log(&quot;验证失败了,有可能手机号或密码忘输入了&quot;,error)</span></span><br><span class="line">    <span class="comment">//  &#125;)</span></span><br><span class="line">    <span class="keyword">let</span> result = &#123;&#125;  <span class="comment">//存储表单验证的结果</span></span><br><span class="line">    formRef.<span class="property">current</span>.<span class="title function_">validateFields</span>([<span class="string">&#x27;mobile&#x27;</span>, <span class="string">&#x27;captcha&#x27;</span>])</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;  <span class="comment">//表单验证</span></span><br><span class="line">        result = res;</span><br><span class="line">        <span class="keyword">return</span> axios.<span class="title function_">post</span>(<span class="string">&quot;/common/captcha/verify&quot;</span>, &#123; key, <span class="attr">captcha</span>: res.<span class="property">captcha</span> &#125;) <span class="comment">//验证码验证</span></span><br><span class="line">      &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res1</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res1.<span class="property">data</span>.<span class="property">errNo</span> === <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> axios.<span class="title function_">post</span>(<span class="string">&quot;/common/sms/send&quot;</span>, &#123; <span class="attr">token</span>: res1.<span class="property">data</span>.<span class="property">context</span>.<span class="property">token</span>, <span class="attr">mobile</span>: result.<span class="property">mobile</span>, <span class="attr">type</span>: <span class="number">0</span> &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">          captchaRef.<span class="property">current</span>.<span class="title function_">getImg</span>();</span><br><span class="line">          message.<span class="title function_">error</span>(res1.<span class="property">data</span>.<span class="property">errText</span>, <span class="number">1</span>)</span><br><span class="line">          <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&quot;error&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;).<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">          message.<span class="title function_">info</span>(<span class="string">&quot;短信下发成功&quot;</span>)</span><br><span class="line">          <span class="title function_">setRequestId</span>(<span class="number">1234</span>) <span class="comment">//因为手机短信接口不能用，模拟的一个requestid</span></span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;send&quot;</span>);</span><br><span class="line">         <span class="title function_">setDisabled</span>(<span class="literal">true</span>)  <span class="comment">//按钮变为不可用</span></span><br><span class="line">        <span class="comment">// 倒计时</span></span><br><span class="line">         <span class="title function_">cutDown</span>();</span><br><span class="line">      &#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error)</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> timer =<span class="literal">null</span>;  <span class="comment">//倒计时的计数器</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">cutDown</span>=(<span class="params"></span>)=&gt;&#123; <span class="comment">//倒计时 </span></span><br><span class="line">      <span class="keyword">if</span>(time===<span class="number">0</span>)&#123;</span><br><span class="line">         <span class="title function_">setTime</span>(<span class="number">5</span>);  <span class="comment">//时间设置为5秒</span></span><br><span class="line">         <span class="title function_">setDisabled</span>(<span class="literal">false</span>); <span class="comment">//按钮可以用</span></span><br><span class="line">         <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        time--;</span><br><span class="line">        <span class="title function_">setTime</span>(time);</span><br><span class="line">        timer=<span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">cutDown</span>();</span><br><span class="line">        &#125;,<span class="number">1000</span>)</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Form</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">ref</span>=<span class="string">&#123;formRef&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">name</span>=<span class="string">&quot;mobile_login&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">className</span>=<span class="string">&quot;login-form&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">onFinish</span>=<span class="string">&#123;onFinish&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;mobile&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rules</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">required:</span> <span class="attr">true</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">pattern:</span> /^<span class="attr">1</span>[<span class="attr">3-9</span>]\<span class="attr">d</span>&#123;<span class="attr">9</span>&#125;$/,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">message:</span> &#x27;<span class="attr">请输入你的手机号</span>!&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        ]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Input</span> <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">UserOutlined</span> <span class="attr">className</span>=<span class="string">&quot;site-form-item-icon&quot;</span> /&gt;</span>&#125; placeholder=&quot;手机号&quot; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;captcha&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rules</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">required:</span> <span class="attr">true</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">message:</span> &#x27;<span class="attr">Please</span> <span class="attr">input</span> <span class="attr">your</span> <span class="attr">captcha</span>!&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        ]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 间距组件，可以把组件放置一行，并拉开适当的间距 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">KeyOutlined</span> /&gt;</span>&#125; placeholder=&quot;验证码&quot; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Captcha</span> <span class="attr">setKey</span>=<span class="string">&#123;setKey&#125;</span> <span class="attr">ref</span>=<span class="string">&#123;captchaRef&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Captcha</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Form.Item</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;code&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">rules</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">required:</span> <span class="attr">true</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">message:</span> &#x27;<span class="attr">请输入手机验证码</span>!&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        ]&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 间距组件，可以把组件放置一行，并拉开适当的间距 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Input</span> <span class="attr">prefix</span>=<span class="string">&#123;</span>&lt;<span class="attr">KeyOutlined</span> /&gt;</span>&#125; placeholder=&quot;验证码&quot; /&gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Button</span> <span class="attr">disabled</span>=<span class="string">&#123;disabled&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;send&#125;</span>&gt;</span>&#123;time===5?&#x27;发送验证码&#x27;:time+&#x27;秒之后再发送&#x27;&#125;<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Space</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">htmlType</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">className</span>=<span class="string">&quot;login-form-button&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          登录</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Form.Item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h3 id="5-3存储token和导航菜单到store"><a href="#5-3存储token和导航菜单到store" class="headerlink" title="5.3存储token和导航菜单到store"></a>5.3存储token和导航菜单到store</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//这个切片存储用户的token和用户拥有的角色对应的菜单</span><br><span class="line"></span><br><span class="line">import  &#123;createSlice&#125; from &#x27;@reduxjs/toolkit&#x27;</span><br><span class="line"></span><br><span class="line">const userSlice=createSlice(&#123;</span><br><span class="line">    name:&#x27;user&#x27;,</span><br><span class="line">    initialState:&#123;  // 初始状态</span><br><span class="line">        token:&#x27;&#x27;,  //令牌</span><br><span class="line">        menus:[]   //权限菜单</span><br><span class="line">    &#125;,</span><br><span class="line">    reducers:&#123;</span><br><span class="line">        saveToken(state,&#123;payload&#125;)&#123;  //保存令牌</span><br><span class="line">            state.token=payload</span><br><span class="line">        &#125;,</span><br><span class="line">        saveMenu(state,&#123;payload&#125;)&#123;  //保存导航菜单</span><br><span class="line">            state.menus=payload</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">export const &#123;saveToken,saveMenu&#125; = userSlice.actions;  //导出方法给组件使用</span><br><span class="line">export default  userSlice.reducer;</span><br></pre></td></tr></table></figure><p>建立仓库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import &#123;configureStore&#125; from &#x27;@reduxjs/toolkit&#x27;</span><br><span class="line">import userReducer from &#x27;./userSlice&#x27;  //拿到userSlice的reducer</span><br><span class="line">const store = configureStore(&#123;  //创建一个仓库</span><br><span class="line">    reducer:&#123;</span><br><span class="line">        user:userReducer</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">export default store;</span><br></pre></td></tr></table></figure><p>提供给所有组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import &#123;Provider&#125; from &#x27;react-redux&#x27;</span><br><span class="line">import store from &#x27;./store/index&#x27;</span><br><span class="line"></span><br><span class="line">  &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">  &lt;Router&gt;</span><br><span class="line">    &lt;App /&gt;</span><br><span class="line">  &lt;/Router&gt;</span><br><span class="line">  &lt;/Provider&gt;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>NormalLogin.jsx</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">axios.post(&quot;/common/auth/login&quot;,values).then((res)=&gt;&#123;</span><br><span class="line">       if(res.data.errNo===0)&#123;</span><br><span class="line">          //存储token和menu到store里</span><br><span class="line">           dispatch(saveToken(res.data.context.jwt))</span><br><span class="line">           dispatch(saveMenu(res.data.context.acl))</span><br><span class="line">          ....</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>仓库数据持久化</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">npm  i redux-persist -S</span><br><span class="line">import &#123; persistStore, persistReducer &#125; from &quot;redux-persist&quot;;</span><br><span class="line">import storage from &quot;redux-persist/lib/storage&quot;; </span><br><span class="line"></span><br><span class="line">const persistConfig = &#123;  //持久化的配置对象</span><br><span class="line">    //数据存储</span><br><span class="line">    key: &quot;persist&quot;,               //自定义</span><br><span class="line">    storage</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const reducers = combineReducers(&#123;  //所有的reducer合并为一个</span><br><span class="line">    user:userReducer</span><br><span class="line">  &#125;);</span><br><span class="line">  //持久化reducer</span><br><span class="line">  const persistedReducer = persistReducer(persistConfig, reducers);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">const store = configureStore(&#123;  //创建一个仓库</span><br><span class="line">    reducer:persistReducer,</span><br><span class="line">     middleware:getDefaultMiddleware =&gt; getDefaultMiddleware(&#123;  //解决动作无法序列化的问题</span><br><span class="line">        //关闭redux序列化检测</span><br><span class="line">        serializableCheck:false</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">//持久化store</span><br><span class="line">export const persistor = persistStore(store);</span><br><span class="line"></span><br><span class="line">export default store;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>index.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import store, &#123; persistor &#125; from &#x27;./store/index&#x27;</span><br><span class="line">import &#123; PersistGate &#125; from &#x27;redux-persist/integration/react&#x27;</span><br><span class="line">&lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">    &lt;PersistGate loading=&#123;null&#125; persistor=&#123;persistor&#125;&gt;</span><br><span class="line">    &lt;Router&gt;</span><br><span class="line">      &lt;App /&gt;</span><br><span class="line">    &lt;/Router&gt;</span><br><span class="line">  &lt;/PersistGate&gt;</span><br></pre></td></tr></table></figure><h1 id="三、后台开发"><a href="#三、后台开发" class="headerlink" title="三、后台开发"></a>三、后台开发</h1><h2 id="1、后台首页"><a href="#1、后台首页" class="headerlink" title="1、后台首页"></a>1、后台首页</h2><h3 id="1-1、组件及路由规则创建"><a href="#1-1、组件及路由规则创建" class="headerlink" title="1.1、组件及路由规则创建"></a>1.1、组件及路由规则创建</h3><ul><li>Dashboard组件：负责展示后台的基本结构（布局组件）由其决定后台的基本架子</li><li>内容组件：<ul><li>欢迎页</li><li>用户列表</li><li>用户添加</li><li>用户编辑</li><li>…..</li></ul></li></ul><blockquote><p>在后台项目中，路由100%会用到相同开始的情况，例如：</p><ul><li>&#x2F;dashboard&#x2F;welcome</li><li>&#x2F;dashboard&#x2F;users&#x2F;index</li><li>&#x2F;dashboard&#x2F;users&#x2F;add</li><li>…</li></ul><p>因此这里会用到嵌套路由。</p></blockquote><p>HomeRoutes.jsx</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import React,&#123;Suspense,lazy&#125; from &#x27;react&#x27;</span><br><span class="line">import &#123;Route,Switch,Redirect&#125; from &#x27;react-router-dom&#x27;</span><br><span class="line">import Loding from &#x27;../../components/Loding&#x27;;</span><br><span class="line"></span><br><span class="line">const Welcome=lazy(()=&gt;import(&#x27;../welcome/Welcome&#x27;));</span><br><span class="line">const UserList=lazy(()=&gt;import(&quot;../user/UserList&quot;));</span><br><span class="line">const FilmList=lazy(()=&gt;import(&#x27;../film/FilmList&#x27;));</span><br><span class="line">const Cinema=lazy(()=&gt;import(&#x27;../cinema/Cinema&#x27;))</span><br><span class="line">export default function HomeRoutes() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;Suspense fallback=&#123;&lt;Loding /&gt;&#125;&gt;</span><br><span class="line">        &lt;Switch&gt;</span><br><span class="line">            &lt;Route path=&quot;/dashboard/welcome&quot; component=&#123;Welcome&#125;&gt;&lt;/Route&gt;</span><br><span class="line">            &lt;Route path=&#x27;/dashboard/user/index&#x27; component=&#123;UserList&#125; /&gt;</span><br><span class="line">            &lt;Route path=&#x27;/dashboard/film/index&#x27; component=&#123;FilmList&#125; /&gt;</span><br><span class="line">            &lt;Route path=&#x27;/dashboard/cinema/index&#x27; component=&#123;Cinema&#125; /&gt;</span><br><span class="line">        &lt;/Switch&gt;</span><br><span class="line">      &lt;/Suspense&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-2、后台首页布局"><a href="#1-2、后台首页布局" class="headerlink" title="1.2、后台首页布局"></a>1.2、后台首页布局</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>,&#123;useEffect&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">MenuUnfoldOutlined</span>,</span><br><span class="line">  <span class="title class_">MenuFoldOutlined</span>,</span><br><span class="line">  <span class="title class_">UploadOutlined</span>,</span><br><span class="line">  <span class="title class_">UserOutlined</span>,</span><br><span class="line">  <span class="title class_">VideoCameraOutlined</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@ant-design/icons&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useLocation&#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./layout.css&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span>, <span class="title class_">Layout</span>, <span class="title class_">Menu</span>, theme &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Link</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Routes</span> <span class="keyword">from</span> <span class="string">&#x27;../ruotes/Routes&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Header</span>, <span class="title class_">Sider</span>, <span class="title class_">Content</span> &#125; = <span class="title class_">Layout</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [collapsed, setCollapsed] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="attr">token</span>: &#123; colorBgContainer &#125;,</span><br><span class="line">  &#125; = theme.<span class="title function_">useToken</span>();</span><br><span class="line">  <span class="keyword">let</span> loc=<span class="title function_">useLocation</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Sider</span> <span class="attr">trigger</span>=<span class="string">&#123;null&#125;</span> <span class="attr">collapsible</span> <span class="attr">collapsed</span>=<span class="string">&#123;collapsed&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;demo-logo-vertical&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Menu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">defaultSelectedKeys</span>=<span class="string">&#123;[loc.pathname]&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">items</span>=<span class="string">&#123;[</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">key:</span> &#x27;<span class="attr">1</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">icon:</span> &lt;<span class="attr">UserOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">              label: <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/dashboard/welcome&quot;</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">Link</span>&gt;</span>,</span></span><br><span class="line"><span class="language-xml">            &#125;,</span></span><br><span class="line"><span class="language-xml">            &#123;</span></span><br><span class="line"><span class="language-xml">              key: &#x27;2&#x27;,</span></span><br><span class="line"><span class="language-xml">              icon: <span class="tag">&lt;<span class="name">VideoCameraOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">              label: &#x27;用户管理&#x27;,</span></span><br><span class="line"><span class="language-xml">              children:[</span></span><br><span class="line"><span class="language-xml">                &#123;</span></span><br><span class="line"><span class="language-xml">                  key:&#x27;21&#x27;,</span></span><br><span class="line"><span class="language-xml">                  label:<span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/dashboard/user/index&quot;</span>&gt;</span>用户列表<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#125;</span></span><br><span class="line"><span class="language-xml">              ]</span></span><br><span class="line"><span class="language-xml">            &#125;,</span></span><br><span class="line"><span class="language-xml">            &#123;</span></span><br><span class="line"><span class="language-xml">              key: &#x27;3&#x27;,</span></span><br><span class="line"><span class="language-xml">              icon: <span class="tag">&lt;<span class="name">VideoCameraOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">              label: &#x27;电影管理&#x27;,</span></span><br><span class="line"><span class="language-xml">              children:[</span></span><br><span class="line"><span class="language-xml">                &#123;</span></span><br><span class="line"><span class="language-xml">                  key:&#x27;31&#x27;,</span></span><br><span class="line"><span class="language-xml">                  label:<span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/dashboard/film/index&quot;</span>&gt;</span>电影列表<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#125;</span></span><br><span class="line"><span class="language-xml">              ]</span></span><br><span class="line"><span class="language-xml">            &#125;,</span></span><br><span class="line"><span class="language-xml">            &#123;</span></span><br><span class="line"><span class="language-xml">              key: &#x27;4&#x27;,</span></span><br><span class="line"><span class="language-xml">              icon: <span class="tag">&lt;<span class="name">VideoCameraOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">              label: &#x27;影院管理&#x27;,</span></span><br><span class="line"><span class="language-xml">              children:[</span></span><br><span class="line"><span class="language-xml">                &#123;sho</span></span><br><span class="line"><span class="language-xml">                  key:&#x27;41&#x27;,</span></span><br><span class="line"><span class="language-xml">                  label:<span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/dashboard/cinema/index&quot;</span>&gt;</span>影院列表<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#125;</span></span><br><span class="line"><span class="language-xml">              ]</span></span><br><span class="line"><span class="language-xml">            &#125;,</span></span><br><span class="line"><span class="language-xml">            &#123;</span></span><br><span class="line"><span class="language-xml">              key: &#x27;5&#x27;,</span></span><br><span class="line"><span class="language-xml">              icon: <span class="tag">&lt;<span class="name">VideoCameraOutlined</span> /&gt;</span>,</span></span><br><span class="line"><span class="language-xml">              label: &#x27;院校管理&#x27;,</span></span><br><span class="line"><span class="language-xml">              children:[</span></span><br><span class="line"><span class="language-xml">                &#123;</span></span><br><span class="line"><span class="language-xml">                  key:&#x27;51&#x27;,</span></span><br><span class="line"><span class="language-xml">                  label:<span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/dashboard/college/index&quot;</span>&gt;</span>院校列表<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#125;</span></span><br><span class="line"><span class="language-xml">              ]</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">          ]&#125;</span></span><br><span class="line"><span class="language-xml">        /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Sider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Header</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">padding:</span> <span class="attr">0</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">background:</span> <span class="attr">colorBgContainer</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">icon</span>=<span class="string">&#123;collapsed</span> ? &lt;<span class="attr">MenuUnfoldOutlined</span> /&gt;</span> : <span class="tag">&lt;<span class="name">MenuFoldOutlined</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">            onClick=&#123;() =&gt; setCollapsed(!collapsed)&#125;</span></span><br><span class="line"><span class="language-xml">            style=&#123;&#123;</span></span><br><span class="line"><span class="language-xml">              fontSize: &#x27;16px&#x27;,</span></span><br><span class="line"><span class="language-xml">              width: 64,</span></span><br><span class="line"><span class="language-xml">              height: 64,</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Content</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">margin:</span> &#x27;<span class="attr">24px</span> <span class="attr">16px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">padding:</span> <span class="attr">24</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">minHeight:</span> <span class="attr">280</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">background:</span> <span class="attr">colorBgContainer</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Routes</span>&gt;</span><span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Content</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Home</span>;</span><br></pre></td></tr></table></figure><p>此时应该得到如下效果：</p><p><img src="https://storage.lynnn.cn/assets/markdown/91147/pictures/2022/01/0d66622a9be1861bad156d3666d7cccd799d2f85.png?sign=6eb477cb2d202bc886b47892979fcbfb&t=61e520dc"></p><h3 id="1-3、顶部信息展示"><a href="#1-3、顶部信息展示" class="headerlink" title="1.3、顶部信息展示"></a>1.3、顶部信息展示</h3><p>步骤：</p><ul><li>如何统一提供jwt</li><li>发送ajax，获取数据并且展示</li></ul><p>a. 获取数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">const</span> [accountInfo,setAccountInfo ]=<span class="title function_">useState</span>(&#123;&#125;); <span class="comment">//管理员的信息  </span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">()=&gt;</span>&#123;  <span class="comment">//获取管理员的信息</span></span><br><span class="line">      axios.<span class="title function_">get</span>(<span class="string">&quot;/common/auth/adminInfo&quot;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">          <span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">errNo</span>===<span class="number">0</span>)&#123;</span><br><span class="line">              <span class="title function_">setAccountInfo</span>(res.<span class="property">data</span>.<span class="property">accountInfo</span>)</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;,[])</span><br></pre></td></tr></table></figure><p>b. 展示数据</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;&#123;accountInfo.<span class="property">username</span>+<span class="string">&quot;/&quot;</span>+accountInfo.<span class="property">role</span>&#125;&lt;/span&gt;</span><br></pre></td></tr></table></figure><h3 id="1-4、注销登录功能"><a href="#1-4、注销登录功能" class="headerlink" title="1.4、注销登录功能"></a>1.4、注销登录功能</h3><p>步骤：</p><ul><li>清除jwt</li><li>跳转到登录页面</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">handleOk</span>=(<span class="params"></span>)=&gt;&#123; <span class="comment">//退出系统的时候要执行的函数</span></span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&quot;acl&quot;</span>)</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">saveToken</span>(<span class="string">&quot;&quot;</span>))</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">saveMenu</span>([]));</span><br><span class="line">    <span class="comment">//清除token acl 复位store里的数据 跳到登录页面  关闭对话框 跳转到登录页面</span></span><br><span class="line">    <span class="title function_">setIsModalOpen</span>(<span class="literal">false</span>) <span class="comment">//关闭对话框</span></span><br><span class="line">    props.<span class="property">history</span>.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="1-5、动态菜单生成"><a href="#1-5、动态菜单生成" class="headerlink" title="1.5、动态菜单生成"></a>1.5、动态菜单生成</h3><ol><li>不同的用户,对应不同的角色(role_id) ; 而不同的角色对应有不同的操作菜单. 将对应的菜单展示在左侧菜单栏</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">const</span> mapMenus=navMenus.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>)=&gt;</span>&#123;</span><br><span class="line">   <span class="comment">//判断是否有子菜单</span></span><br><span class="line">   <span class="keyword">if</span>(item.<span class="property">children</span>.<span class="property">length</span>&gt;<span class="number">0</span>)&#123;  <span class="comment">// 有子菜单</span></span><br><span class="line">         <span class="keyword">return</span> <span class="title function_">getItem</span>(item.<span class="property">auth_path</span>,item.<span class="property">auth_name</span>,<span class="literal">null</span>,</span><br><span class="line">             item.<span class="property">children</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">subItem</span>)=&gt;</span>&#123;</span><br><span class="line">               <span class="keyword">if</span>(subItem.<span class="property">is_nav</span>===<span class="number">1</span>)&#123;</span><br><span class="line">                 <span class="keyword">return</span> <span class="title function_">getItem</span>(subItem.<span class="property">auth_path</span>,<span class="language-xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;subItem.auth_path&#125;</span>&gt;</span>&#123;subItem.auth_name&#125;<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span>)</span><br><span class="line">               &#125;</span><br><span class="line">                </span><br><span class="line">             &#125;)</span><br><span class="line">           )</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span>&#123;  <span class="comment">//没有子菜单项目</span></span><br><span class="line">       <span class="keyword">return</span> <span class="title function_">getItem</span>(item.<span class="property">auth_path</span>,<span class="language-xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;item.auth_path&#125;</span>&gt;</span>&#123;item.auth_name&#125;<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br><span class="line"> <span class="title function_">setItems</span>(mapMenus)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="1-6、防止翻墙"><a href="#1-6、防止翻墙" class="headerlink" title="1.6、防止翻墙"></a>1.6、防止翻墙</h3><p>01: 当用户未登录访问登录后的页面的时候,让其跳转到登录页</p><p>02: 因为dashboard为首页的基础组件,所有直接在dashboard组件中进行判断就可以啦.</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="title function_">get</span>(<span class="string">&quot;/common/auth/jwtPreCheck&quot;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">     <span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">errNo</span>===<span class="number">0</span>)&#123;  <span class="comment">//预检通过，说明用户是通过登录进入的这个页面</span></span><br><span class="line">          <span class="title function_">setItems</span>(mapMenus)</span><br><span class="line">        axios.<span class="title function_">get</span>(<span class="string">&quot;/common/auth/adminInfo&quot;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(res.<span class="property">data</span>.<span class="property">errNo</span>===<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="title function_">setAccountInfo</span>(res.<span class="property">data</span>.<span class="property">accountInfo</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">else</span>&#123;  <span class="comment">//用户没有通过登录进入的这个页面</span></span><br><span class="line">        props.<span class="property">history</span>.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">     &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><p>03: 在dashboard组件中,进行渲染判断,根据登录状态 islogined 判断是否为登录状态, 登录则渲染该组件,否则不渲染该组件 (渲染空组件)</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">const</span> [isLogin,setIsLogin]=<span class="title function_">useState</span>(<span class="literal">false</span>); <span class="comment">//设置登录状态，false表示没有登录 true登录成功了</span></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&quot;/common/auth/jwtPreCheck&quot;</span>).<span class="title function_">then</span>(<span class="params">(res)=&gt;&#123;</span></span><br><span class="line"><span class="params">       <span class="keyword">if</span>(res.data.errNo===<span class="number">0</span>)&#123;  //预检通过，说明用户是通过登录进入的这个页面</span></span><br><span class="line"><span class="params">            setItems(mapMenus)  //设置导航菜单</span></span><br><span class="line"><span class="params">            setIsLogin(<span class="literal">true</span>)  //设置登录状态为登录完成</span></span><br><span class="line"><span class="params">          axios.get(<span class="string">&quot;/common/auth/adminInfo&quot;</span>).then((res)=&gt;&#123;  //登录成功后获取管理员的信息</span></span><br><span class="line"><span class="params">              <span class="keyword">if</span>(res.data.errNo===<span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="params">                  setAccountInfo(res.data.accountInfo)</span></span><br><span class="line"><span class="params">              &#125;</span></span><br><span class="line"><span class="params">          &#125;)</span></span><br><span class="line"><span class="params">       &#125;</span></span><br><span class="line"><span class="params">       <span class="keyword">else</span>&#123;  //用户没有通过登录进入的这个页面</span></span><br><span class="line"><span class="params">          props.history.push(<span class="string">&quot;/login&quot;</span>)</span></span><br><span class="line"><span class="params">       &#125;</span></span><br><span class="line"><span class="params">    &#125;</span>)</span><br><span class="line">   &#123;isLogin &amp;&amp; <span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span>&gt;</span><span class="tag">&lt;/<span class="name">Layout</span>&gt;</span></span>&#125;</span><br></pre></td></tr></table></figure><h2 id="2、首页图表展示页面"><a href="#2、首页图表展示页面" class="headerlink" title="2、首页图表展示页面"></a>2、首页图表展示页面</h2><h3 id="2-1获取统计数据"><a href="#2-1获取统计数据" class="headerlink" title="2.1获取统计数据"></a>2.1获取统计数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import React,&#123;useEffect,useState&#125; from &#x27;react&#x27;</span><br><span class="line">import axios from &#x27;@/services/index&#x27;</span><br><span class="line">import Pie from &#x27;../../../components/Pie&#x27;</span><br><span class="line">export default function ShowEcharts() &#123;</span><br><span class="line">  const [gender,setGender]=useState([])   //统计数据，按性别分类的数组</span><br><span class="line">  const [area,setArea]=useState([])   //统计数据，按地区分类的数组</span><br><span class="line">  const [accessFrom,setAccessFrom]=useState([])  //统计数据，按访问来源分类的数组</span><br><span class="line">  useEffect(()=&gt;&#123;</span><br><span class="line">    axios.get(&quot;/users/statistics/getData&quot;).then((res)=&gt;&#123;  //获取数据对三个进行赋值</span><br><span class="line">       setGender(res.data.data.gender)</span><br><span class="line">       setArea(res.data.data.area)</span><br><span class="line">       setAccessFrom(res.data.data.accessFrom)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,[])</span><br><span class="line">  return (</span><br><span class="line">    &lt;div style=&#123;&#123;display:&quot;flex&quot;&#125;&#125;&gt;</span><br><span class="line">      &#123;</span><br><span class="line">        area.length&gt;0 &amp;&amp; &lt;Pie id=&quot;area&quot; data=&#123;area&#125; title=&quot;千锋学生分布&quot;&gt;&lt;/Pie&gt;</span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        gender.length&gt;0 &amp;&amp; &lt;Pie id=&quot;gender&quot; data=&#123;gender&#125; title=&quot;千锋男女比例&quot;&gt;&lt;/Pie&gt;</span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        accessFrom.length&gt;0 &amp;&amp; &lt;Pie id=&quot;accessfrom&quot; data=&#123;accessFrom&#125; title=&quot;千锋学生来源&quot;&gt;&lt;/Pie&gt;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-2绘制饼形图"><a href="#2-2绘制饼形图" class="headerlink" title="2.2绘制饼形图"></a>2.2绘制饼形图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import React,&#123;useEffect&#125; from &#x27;react&#x27;</span><br><span class="line">import * as echarts from &#x27;echarts&#x27;</span><br><span class="line">export default function Pie(props) &#123;</span><br><span class="line">    console.log(props.data)</span><br><span class="line">    useEffect(()=&gt;&#123;</span><br><span class="line">        var myChart = echarts.init(document.getElementById(props.id));</span><br><span class="line">        let options =&#123;</span><br><span class="line">            title: &#123;</span><br><span class="line">                text: props.title,</span><br><span class="line">                subtext: &quot;&quot;,</span><br><span class="line">                x: &quot;center&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            tooltip: &#123;</span><br><span class="line">                trigger: &quot;item&quot;,</span><br><span class="line">                formatter: &quot;&#123;a&#125; &lt;br/&gt;&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            legend: &#123;</span><br><span class="line">                orient: &quot;vertical&quot;,</span><br><span class="line">                x: &quot;left&quot;,</span><br><span class="line">                data:[]</span><br><span class="line">            &#125;,</span><br><span class="line">           </span><br><span class="line">            series: [</span><br><span class="line">                &#123;</span><br><span class="line">                    name: &quot;访问来源&quot;,</span><br><span class="line">                    type: &quot;pie&quot;,</span><br><span class="line">                    radius: &quot;55%&quot;,</span><br><span class="line">                    center: [&quot;50%&quot;, &quot;60%&quot;],</span><br><span class="line">                    data: props.data.map(item=&gt;(&#123;name:item.name,value:item.value&#125;))</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">     </span><br><span class="line">          // 使用刚指定的配置项和数据显示图表。</span><br><span class="line">          myChart.setOption(options);</span><br><span class="line">  </span><br><span class="line">    &#125;,[])</span><br><span class="line">  return (</span><br><span class="line">    &lt;div id=&#123;props.id&#125; style=&#123;&#123;width:&#x27;100%&#x27;,height:&#x27;300px&#x27;&#125;&#125;&gt;Pie&lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3、用户模块"><a href="#3、用户模块" class="headerlink" title="3、用户模块"></a>3、用户模块</h2><h3 id="3-1用户列表"><a href="#3-1用户列表" class="headerlink" title="3.1用户列表"></a>3.1用户列表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useEffect, useState,useRef &#125; from &#x27;react&#x27;</span><br><span class="line">import axios from &#x27;@/services/index&#x27;</span><br><span class="line">import &#123; Table, Tag,Space,Button,Pagination &#125; from &#x27;antd&#x27;</span><br><span class="line">import &quot;./user.css&quot;</span><br><span class="line">import AddEdit from &#x27;../../components/AddEdit&#x27;</span><br><span class="line">export default function UserList() &#123;</span><br><span class="line">  let [userList, setUserList] = useState([]) // 存储的是用户的列表</span><br><span class="line">  let [page, setPage] = useState(1) //当前页面</span><br><span class="line">  let [total, setTotal] = useState(0) //总的记录个数</span><br><span class="line">  const [visible,setVisible]=useState(false) //设置对话框不可见</span><br><span class="line">  const [title,setTitle]=useState(&quot;&quot;) //设置对话框的标题</span><br><span class="line">  const editRef=useRef() ;//标识添加和编辑的对话框</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    getList();</span><br><span class="line">  &#125;, [])</span><br><span class="line">  const getList = (page = 1) =&gt; &#123;  //获取用户的列表   后端分页</span><br><span class="line">    axios.get(&quot;/users?page=&quot; + page).then((res) =&gt; &#123;</span><br><span class="line">      setUserList(res.data.paginate.data)</span><br><span class="line">      setPage(res.data.paginate.current_page)</span><br><span class="line">      setTotal(res.data.paginate.total)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  const columns = [&#123; //表格组件的列</span><br><span class="line">    title: &quot;序号&quot;,</span><br><span class="line">    dataIndex: &#x27;id&#x27;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;用户名&quot;,</span><br><span class="line">    dataIndex: &quot;username&quot;,</span><br><span class="line">    key: &quot;username&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;手机号&quot;,</span><br><span class="line">    dataIndex: &quot;mobile&quot;,</span><br><span class="line">    key: &quot;mobile&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;邮箱&quot;,</span><br><span class="line">    dataIndex: &quot;email&quot;,</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;性别&quot;,</span><br><span class="line">    //  dataIndex:&#x27;gender&#x27;,</span><br><span class="line">    render(text, record) &#123;  //当前项目的数据  record 当前行的数据</span><br><span class="line">      //  console.log(text,record)  //dataIndex存在时候，text就是当前列的数据 如果dataIndex不存在 ，同record 也是当前行的数据</span><br><span class="line">      if (record.gender === &quot;1&quot;) &#123;</span><br><span class="line">        return &lt;Tag color=&#x27;green&#x27;&gt;男&lt;/Tag&gt;</span><br><span class="line">      &#125;</span><br><span class="line">      else if (record.gender === &quot;2&quot;) &#123;</span><br><span class="line">        return &lt;Tag color=&#x27;red&#x27;&gt;女&lt;/Tag&gt;</span><br><span class="line">      &#125;</span><br><span class="line">      else &#123;</span><br><span class="line">        return &lt;Tag color=&#x27;red&#x27;&gt;保密&lt;/Tag&gt;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;状态&quot;,</span><br><span class="line">    //  dataIndex:&#x27;gender&#x27;,</span><br><span class="line">    render(text, record) &#123;  //当前项目的数据  record 当前行的数据</span><br><span class="line">      //  console.log(text,record)  //dataIndex存在时候，text就是当前列的数据 如果dataIndex不存在 ，同record 也是当前行的数据</span><br><span class="line">      if (record.status === &quot;1&quot;) &#123;</span><br><span class="line">        return &lt;Tag color=&#x27;green&#x27;&gt;启用&lt;/Tag&gt;</span><br><span class="line">      &#125;</span><br><span class="line">      else &#123;</span><br><span class="line">        return &lt;Tag color=&#x27;red&#x27;&gt;禁用&lt;/Tag&gt;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    title: &quot;操作&quot;,</span><br><span class="line">    //  dataIndex:&#x27;gender&#x27;,</span><br><span class="line">    render(text, record) &#123;  //当前项目的数据  record 当前行的数据</span><br><span class="line">      //  console.log(text,record)  //dataIndex存在时候，text就是当前列的数据 如果dataIndex不存在 ，同record 也是当前行的数据</span><br><span class="line">        return &lt;Space&gt;&lt;Button type=&#x27;primary&#x27; onClick=&#123;()=&gt;edit(record)&#125;&gt;编辑&lt;/Button&gt;</span><br><span class="line">        &lt;Button type=&#x27;primary&#x27;&gt;删除&lt;/Button&gt;&lt;/Space&gt;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  ]</span><br><span class="line">  const edit=(record)=&gt;&#123;  //弹出编辑框，进入编辑状态</span><br><span class="line">       setVisibleTitle(&#x27;编辑&#x27;)</span><br><span class="line">       editRef.current.setUser(&#123;...record&#125;)  //调用子组件的方法放置编辑的内容</span><br><span class="line">  &#125;</span><br><span class="line">  const setVisibleTitle=(title)=&gt;&#123; //设置对话框显示隐藏并设置标题</span><br><span class="line">       setTitle(title);</span><br><span class="line">       setVisible(!visible);</span><br><span class="line">  &#125;</span><br><span class="line">  const titleContent=()=&gt;&#123; //表头的内容</span><br><span class="line">     return &lt;div className=&quot;userlist&quot;&gt;</span><br><span class="line">              &lt;h3&gt;用户列表&lt;/h3&gt;</span><br><span class="line">              &lt;Button type=&quot;primary&quot; onClick=&#123;()=&gt;setVisibleTitle(&#x27;添加&#x27;)&#125;&gt;添加&lt;/Button&gt;</span><br><span class="line">     &lt;/div&gt;</span><br><span class="line">  &#125;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Table title=&#123;()=&gt;titleContent()&#125; bordered dataSource=&#123;userList&#125; columns=&#123;columns&#125; rowKey=&#123;(item) =&gt; item.id&#125;</span><br><span class="line">       pagination=&#123;&#123;defaultCurrent:page,total:total,onChange:getList&#125;&#125; /&gt;</span><br><span class="line">      &#123;/* &lt;Pagination defaultCurrent=&#123;page&#125; total=&#123;total&#125; onChange=&#123;getList&#125;  /&gt; */&#125;</span><br><span class="line">      &lt;AddEdit visible=&#123;visible&#125; title=&#123;title&#125; ref=&#123;editRef&#125; setVisibleTitle=&#123;setVisibleTitle&#125; </span><br><span class="line">      getList=&#123;getList&#125; page=&#123;page&#125; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-2用户添加编辑"><a href="#3-2用户添加编辑" class="headerlink" title="3.2用户添加编辑"></a>3.2用户添加编辑</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">import React,&#123;useState,forwardRef,useImperativeHandle&#125; from &#x27;react&#x27;</span><br><span class="line">import &#123;Input,Radio,Modal&#125; from &#x27;antd&#x27;</span><br><span class="line">import axios from &#x27;@/services/index&#x27;</span><br><span class="line">export default forwardRef(function AddEdit(props,ref) &#123;</span><br><span class="line">   let [user,setUser]=useState(&#123;</span><br><span class="line">     username:&quot;&quot;,</span><br><span class="line">     password:&quot;&quot;,</span><br><span class="line">     gender:&#x27;&#x27;,</span><br><span class="line">     email:&quot;&quot;,</span><br><span class="line">     mobile:&quot;&quot;</span><br><span class="line">   &#125;)</span><br><span class="line">   //父组件调用子组件的setUser方法就可以把当前行的编辑数据传递过来了</span><br><span class="line">   useImperativeHandle(ref,()=&gt;&#123;  //暴露setUser方法给父组件使用</span><br><span class="line">    return &#123;</span><br><span class="line">        setUser</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;)</span><br><span class="line">   const input=(e)=&gt;&#123;</span><br><span class="line">      user[e.target.name]=e.target.value;</span><br><span class="line">      setUser(&#123;...user&#125;)</span><br><span class="line">   &#125;</span><br><span class="line">   const handleOk=()=&gt;&#123;</span><br><span class="line">      //处理添加和修改完成的操作</span><br><span class="line">      if(props.title===&quot;添加&quot;)&#123;</span><br><span class="line">        user.mobile=Number(user.mobile)  //转为和提交的类型一致</span><br><span class="line">        user.gender=Number(user.gender)</span><br><span class="line">        //注意添加的时候，手机号，邮箱都不能重复</span><br><span class="line">         axios.post(&quot;/users/add&quot;,user).then((res)=&gt;&#123;</span><br><span class="line">            props.getList(1)</span><br><span class="line">         &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      else &#123;</span><br><span class="line">         axios.put(&quot;/users/&quot;+user.id,user).then((res)=&gt;&#123;</span><br><span class="line">              //修改完数据要刷新列表</span><br><span class="line">              props.getList(props.page)</span><br><span class="line"></span><br><span class="line">         &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      close();</span><br><span class="line">   &#125;</span><br><span class="line">   const close=()=&gt;&#123;</span><br><span class="line"></span><br><span class="line">    //关闭对话框 //复位数据</span><br><span class="line">    setUser(&#123;</span><br><span class="line">        username:&quot;&quot;,</span><br><span class="line">        gender:&#x27;&#x27;,</span><br><span class="line">        email:&quot;&quot;,</span><br><span class="line">        mobile:&quot;&quot;</span><br><span class="line">      &#125;)</span><br><span class="line">    //子组件调用父组件的方法关闭对话框</span><br><span class="line">     props.setVisibleTitle(&quot;&quot;);</span><br><span class="line">   &#125;</span><br><span class="line">  return (</span><br><span class="line">    &lt;Modal title=&#123;props.title&#125; open=&#123;props.visible&#125; onOk=&#123;handleOk&#125; onCancel=&#123;close&#125;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;Input name=&quot;username&quot; value=&#123;user.username&#125; onChange=&#123;input&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;Input name=&quot;password&quot; value=&#123;user.password&#125; onChange=&#123;input&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;Input name=&quot;email&quot; value=&#123;user.email&#125; onChange=&#123;input&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">           &lt;Radio.Group name=&quot;gender&quot; value=&#123;user.gender&#125; onChange=&#123;input&#125;&gt;</span><br><span class="line">                &lt;Radio value=&quot;1&quot;&gt;男&lt;/Radio&gt;</span><br><span class="line">                &lt;Radio value=&quot;2&quot;&gt;女&lt;/Radio&gt;</span><br><span class="line">                &lt;Radio value=&quot;3&quot;&gt;保密&lt;/Radio&gt;</span><br><span class="line">           &lt;/Radio.Group&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;Input name=&quot;mobile&quot; value=&#123;user.mobile&#125; onChange=&#123;input&#125; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/Modal&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4、影院管理"><a href="#4、影院管理" class="headerlink" title="4、影院管理"></a>4、影院管理</h2><h3 id="4-1影院列表"><a href="#4-1影院列表" class="headerlink" title="4.1影院列表"></a>4.1影院列表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">    import React, &#123; useEffect, useState &#125; from &#x27;react&#x27;</span><br><span class="line">import axios from &#x27;@/services/index&#x27;</span><br><span class="line">import &quot;./cinema.css&quot;</span><br><span class="line">export default function Cinema() &#123;</span><br><span class="line">  let [points, setPoints] = useState([]) //存储30家影院的地址和坐标信息</span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    if (points.length === 0) &#123;  //数组是空的，发请求获取电影院的信息</span><br><span class="line">      axios.get(&quot;/cinemas/infos/loca&quot;).then((res) =&gt; &#123;</span><br><span class="line">        if (res.data.errNo === 0) &#123;</span><br><span class="line">          setPoints(res.data.paginate.slice(0, 30))</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123; //已经获取了电影院的数据</span><br><span class="line">      //百度地图的实例</span><br><span class="line">      var map = new window.BMapGL.Map(&quot;container&quot;);</span><br><span class="line">      // 创建点坐标 </span><br><span class="line">      points.forEach((item) =&gt; &#123;</span><br><span class="line">        let jd = Number(item.gpsaddress.split(&quot;,&quot;)[0])</span><br><span class="line">        let wd = Number(item.gpsaddress.split(&quot;,&quot;)[1])</span><br><span class="line">        console.log(jd, wd)</span><br><span class="line">        var point = new window.BMapGL.Point(jd, wd);  // 创建点坐标 </span><br><span class="line">        map.centerAndZoom(point, 12);    // 初始化地图，设置中心点坐标和地图级别</span><br><span class="line">        var marker = new window.BMapGL.Marker(point);        // 创建标注   </span><br><span class="line">        //建议一个信息窗口</span><br><span class="line">        var opts = &#123;</span><br><span class="line">          width: 250,     // 信息窗口宽度</span><br><span class="line">          height: 50,    // 信息窗口高度</span><br><span class="line">          title: &quot;当前位置:&quot;  // 信息窗口标题</span><br><span class="line">      &#125;</span><br><span class="line">      var infoWindow = new window.BMapGL.InfoWindow(item.address, opts);  // 创建信息窗口对象</span><br><span class="line">        marker.addEventListener(&quot;click&quot;,()=&gt;&#123;  //点击marker进行事件响应</span><br><span class="line">          //打开信息窗口</span><br><span class="line">          map.openInfoWindow(infoWindow, point); </span><br><span class="line">        &#125;)</span><br><span class="line">        map.addOverlay(marker);                     // 将标注添加到地图中</span><br><span class="line">      &#125;)</span><br><span class="line">      map.enableScrollWheelZoom(true) //开启鼠标滚轮缩放</span><br><span class="line">      // map.setHeading(64.5);   //设置地图旋转角度</span><br><span class="line">      // map.setTilt(73);       //设置地图的倾斜角度</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;, [points])</span><br><span class="line">  return (</span><br><span class="line">    &lt;div id=&quot;container&quot; className=&#x27;container&#x27;&gt;Cinema &#123;points.length&#125;&lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="https://angelxyj.github.io">许小墨</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接:</span> <span class="post-copyright-info"><a href="https://angelxyj.github.io/posts/1c915f8b.html">https://angelxyj.github.io/posts/1c915f8b.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://angelxyj.github.io" target="_blank">许小墨のBlog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/%E5%89%8D%E7%AB%AF/">前端</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/%E6%A1%86%E6%9E%B6/">框架</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/React/">React</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/React%E6%9D%82%E8%AE%B0/">React杂记</a></div><div class="post_share"><div class="social-share" data-image="/img/jujingyi.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>感谢支持！</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat.png" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/c138c5a6.html" title="36-React杂记(react18-hooks)"><img class="cover" src="/img/timg.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">36-React杂记(react18-hooks)</div></div></a></div><div class="next-post pull-right"><a href="/posts/66450fce.html" title="react基础"><img class="cover" src="/img/11.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">react基础</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/57ee22ab.html" title="next.js"><img class="cover" src="/img/3.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-18</div><div class="title">next.js</div></div></a></div><div><a href="/posts/60af50c8.html" title="react-pc"><img class="cover" src="/img/7.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-18</div><div class="title">react-pc</div></div></a></div><div><a href="/posts/c22d7424.html" title="react-mobile"><img class="cover" src="/img/16.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-18</div><div class="title">react-mobile</div></div></a></div><div><a href="/posts/ec7bb17e.html" title="23-React杂记（一）"><img class="cover" src="/img/1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-01</div><div class="title">23-React杂记（一）</div></div></a></div><div><a href="/posts/b9b463e6.html" title="24-React杂记（二）"><img class="cover" src="/img/7.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-01</div><div class="title">24-React杂记（二）</div></div></a></div><div><a href="/posts/e382a474.html" title="25-React杂记（三）"><img class="cover" src="/img/12.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-01</div><div class="title">25-React杂记（三）</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div><div class="comment-switch"><span class="first-comment">Waline</span><span id="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/touxiang.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">许小墨</div><div class="author-info__description">全栈攻城狮的基本素养</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">198</div></a><a href="/%E6%A0%87%E7%AD%BE/"><div class="headline">标签</div><div class="length-num">183</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">42</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Angelxyj"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Angelxyj" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1440023258@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%A6%82%E8%A6%81"><span class="toc-number">1.</span> <span class="toc-text">一、概要</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%BC%80%E5%8F%91%E8%83%8C%E6%99%AF"><span class="toc-number">1.1.</span> <span class="toc-text">1、开发背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E6%8A%80%E6%9C%AF%E6%A0%88"><span class="toc-number">1.2.</span> <span class="toc-text">2、技术栈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">1.3.</span> <span class="toc-text">3、开发环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E6%95%88%E6%9E%9C%E9%A2%84%E8%A7%88"><span class="toc-number">1.4.</span> <span class="toc-text">4、效果预览</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">1.5.</span> <span class="toc-text">5、项目初始化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E7%9A%84%E5%88%9B%E5%BB%BA%E4%B8%8E%E5%90%8C%E6%AD%A5"><span class="toc-number">1.6.</span> <span class="toc-text">6、远程仓库的创建与同步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81antd%E7%BB%84%E4%BB%B6%E5%BA%93"><span class="toc-number">1.7.</span> <span class="toc-text">7、antd组件库</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%99%BB%E5%BD%95%E5%BC%80%E5%8F%91"><span class="toc-number">2.</span> <span class="toc-text">二、登录开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA%E7%A9%BA%E7%BB%84%E4%BB%B6"><span class="toc-number">2.1.</span> <span class="toc-text">1、创建空组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E7%BB%84%E4%BB%B6%E5%B0%81%E8%A3%85%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">2、组件封装（重点）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E7%99%BB%E5%BD%95%E9%A1%B5%E5%B8%83%E5%B1%80"><span class="toc-number">2.3.</span> <span class="toc-text">3、登录页布局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E8%B7%AF%E7%94%B1%E8%A7%84%E5%88%92"><span class="toc-number">2.4.</span> <span class="toc-text">4、路由规划</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.5.</span> <span class="toc-text">5、功能实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1%E3%80%81%E5%B8%B8%E8%A7%84%E7%99%BB%E5%BD%95"><span class="toc-number">2.5.1.</span> <span class="toc-text">5.1、常规登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2%E3%80%81%E7%9F%AD%E4%BF%A1%E7%99%BB%E5%BD%95"><span class="toc-number">2.5.2.</span> <span class="toc-text">5.2、短信登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3%E5%AD%98%E5%82%A8token%E5%92%8C%E5%AF%BC%E8%88%AA%E8%8F%9C%E5%8D%95%E5%88%B0store"><span class="toc-number">2.5.3.</span> <span class="toc-text">5.3存储token和导航菜单到store</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91"><span class="toc-number">3.</span> <span class="toc-text">三、后台开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%90%8E%E5%8F%B0%E9%A6%96%E9%A1%B5"><span class="toc-number">3.1.</span> <span class="toc-text">1、后台首页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1%E3%80%81%E7%BB%84%E4%BB%B6%E5%8F%8A%E8%B7%AF%E7%94%B1%E8%A7%84%E5%88%99%E5%88%9B%E5%BB%BA"><span class="toc-number">3.1.1.</span> <span class="toc-text">1.1、组件及路由规则创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2%E3%80%81%E5%90%8E%E5%8F%B0%E9%A6%96%E9%A1%B5%E5%B8%83%E5%B1%80"><span class="toc-number">3.1.2.</span> <span class="toc-text">1.2、后台首页布局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3%E3%80%81%E9%A1%B6%E9%83%A8%E4%BF%A1%E6%81%AF%E5%B1%95%E7%A4%BA"><span class="toc-number">3.1.3.</span> <span class="toc-text">1.3、顶部信息展示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4%E3%80%81%E6%B3%A8%E9%94%80%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD"><span class="toc-number">3.1.4.</span> <span class="toc-text">1.4、注销登录功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5%E3%80%81%E5%8A%A8%E6%80%81%E8%8F%9C%E5%8D%95%E7%94%9F%E6%88%90"><span class="toc-number">3.1.5.</span> <span class="toc-text">1.5、动态菜单生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6%E3%80%81%E9%98%B2%E6%AD%A2%E7%BF%BB%E5%A2%99"><span class="toc-number">3.1.6.</span> <span class="toc-text">1.6、防止翻墙</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E9%A6%96%E9%A1%B5%E5%9B%BE%E8%A1%A8%E5%B1%95%E7%A4%BA%E9%A1%B5%E9%9D%A2"><span class="toc-number">3.2.</span> <span class="toc-text">2、首页图表展示页面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1%E8%8E%B7%E5%8F%96%E7%BB%9F%E8%AE%A1%E6%95%B0%E6%8D%AE"><span class="toc-number">3.2.1.</span> <span class="toc-text">2.1获取统计数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2%E7%BB%98%E5%88%B6%E9%A5%BC%E5%BD%A2%E5%9B%BE"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.2绘制饼形图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E7%94%A8%E6%88%B7%E6%A8%A1%E5%9D%97"><span class="toc-number">3.3.</span> <span class="toc-text">3、用户模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1%E7%94%A8%E6%88%B7%E5%88%97%E8%A1%A8"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.1用户列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E7%BC%96%E8%BE%91"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.2用户添加编辑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E5%BD%B1%E9%99%A2%E7%AE%A1%E7%90%86"><span class="toc-number">3.4.</span> <span class="toc-text">4、影院管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1%E5%BD%B1%E9%99%A2%E5%88%97%E8%A1%A8"><span class="toc-number">3.4.1.</span> <span class="toc-text">4.1影院列表</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/3d9e6dac.html" title="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia"><img src="/img/14.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia"></a><div class="content"><a class="title" href="/posts/3d9e6dac.html" title="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia">004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia</a><time datetime="2024-06-12T21:53:42.000Z" title="发表于 2024-06-12 21:53:42">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4f9a63a7.html" title="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？"><img src="/img/18.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？"></a><div class="content"><a class="title" href="/posts/4f9a63a7.html" title="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？">003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？</a><time datetime="2024-06-12T21:45:44.000Z" title="发表于 2024-06-12 21:45:44">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dda8b3d8.html" title="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分"><img src="/img/jujingyi.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分"></a><div class="content"><a class="title" href="/posts/dda8b3d8.html" title="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分">002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分</a><time datetime="2024-06-12T21:35:34.000Z" title="发表于 2024-06-12 21:35:34">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1faddbca.html" title="001_组件化开发原理，鸿蒙组件化实现思路"><img src="/img/1.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="001_组件化开发原理，鸿蒙组件化实现思路"></a><div class="content"><a class="title" href="/posts/1faddbca.html" title="001_组件化开发原理，鸿蒙组件化实现思路">001_组件化开发原理，鸿蒙组件化实现思路</a><time datetime="2024-06-12T21:28:54.000Z" title="发表于 2024-06-12 21:28:54">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/6d6b0b0f.html" title="019_Gauge"><img src="/img/9.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="019_Gauge"></a><div class="content"><a class="title" href="/posts/6d6b0b0f.html" title="019_Gauge">019_Gauge</a><time datetime="2024-06-12T21:24:14.000Z" title="发表于 2024-06-12 21:24:14">2024-06-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2024 By 许小墨</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_60306931/category_12251529.html">blog</a>!<br><span>备案号：xxxxxx</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach(((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,a="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent,i=mermaid.render(r,a);var m;"string"==typeof i?(m=i,d.insertAdjacentHTML("afterend",m)):i.then((({svg:e})=>{d.insertAdjacentHTML("afterend",e)}))}))},n=()=>{window.loadMermaid?t():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(t)};btf.addGlobalFn("themeChange",t,"mermaid"),window.pjax?n():document.addEventListener("DOMContentLoaded",n)})()</script><script>(()=>{let n=window.walineFn||null;const e=n=>{const e=n(Object.assign({el:"#waline-wrap",serverURL:"https://xuxiaomo-waline-i53b26l6n-xuxiaomo-xyj.vercel.app/",pageview:!1,dark:'html[data-theme="dark"]',path:window.location.pathname,comment:!1},null));btf.addGlobalFn("pjax",(()=>{e.destroy()}),"destroyWaline")},t=async()=>{if(n)e(n);else{await getCSS("https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css");const{init:t}=await import("https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js");n=t||Waline.init,e(n),window.walineFn=n}};btf.loadComment(document.getElementById("waline-wrap"),t)})()</script><script>(()=>{const t=function(){this.page.url="https://angelxyj.github.io/posts/1c915f8b.html",this.page.identifier="/posts/1c915f8b.html",this.page.title="37-React综合案例"},e=()=>{window.DISQUS&&window.DISQUS.reset({reload:!0,config:t})};btf.addGlobalFn("themeChange",e,"disqus");const i=()=>{if(window.DISQUS)e();else{const t=document.createElement("script");t.src="https://xuxiaomo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),document.head.appendChild(t)}};window.loadOtherComment=i})()</script></div><script>window.addEventListener("load",(()=>{const e=e=>{let t="";if(e.length)for(let a=0;a<e.length;a++){t+="<div class='aside-list-item'>";{const n="src";t+=`<a href='${e[a].url}' class='thumbnail'><img ${n}='${e[a].avatar}' alt='${e[a].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[a].url}' title='${e[a].content}'>${e[a].content}</a>\n        <div class='name'><span>${e[a].nick} / </span><time datetime="${e[a].date}">${btf.diffDate(e[a].date,!0)}</time></div>\n        </div></div>`}else t+="没有评论";let a=document.querySelector("#card-newest-comments .aside-list");a&&(a.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(a)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("waline-newest-comments");t?e(JSON.parse(t)):(async()=>{try{const t=await fetch("https://xuxiaomo-waline-i53b26l6n-xuxiaomo-xyj.vercel.app/api/comment?type=recent&count=6",{method:"GET"}),a=(await t.json()).data.map((e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[图片]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[链接]")).replace(/<pre><code>.*?<\/pre>/gi,"[代码]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.objectId,date:e.time||e.insertedAt};var t}));saveToLocal.set("waline-newest-comments",JSON.stringify(a),10/1440),e(a)}catch(e){console.error(e),document.querySelector("#card-newest-comments .aside-list").textContent="无法获取评论，请确认相关配置是否正确"}})()}};t(),document.addEventListener("pjax:complete",t)}))</script><div class="aplayer no-destroy" data-id="8760365089" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-autoplay="false"></div><script defer src="/live2d-widget/autoload.js"></script><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="true" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script src="//code.tidio.co/fpezrlnx14lzqj1yzhyigw0j3rkhtyzv.js" async></script><script>(()=>{{let i=!1;const d=()=>{window.tidioChatApi.hide(),i=!1},o=()=>{window.tidioChatApi.open(),window.tidioChatApi.show(),i=!0},t=()=>{window.tidioChatApi.hide(),window.tidioChatApi.on("close",d)};window.tidioChatApi?window.tidioChatApi.on("ready",t):document.addEventListener("tidioChat-ready",t),window.chatBtnFn=()=>{window.tidioChatApi&&(i?d():o())}}})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(btf.removeGlobalFnEvent("pjax"),btf.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div><div class="app-refresh" id="app-refresh" style="position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease"><div class="app-refresh-wrap" style="display:flex;color:#fff;height:100%;align-items:center;justify-content:center"><label>✨ 糖果屋上新啦！ 👉</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color:#fff;text-decoration:underline;cursor:pointer">🍭查看新品🍬</span></a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"✨ 糖果屋上新啦！ 👉",backgroundColor:t,duration:5e5,pos:e,actionText:"🍭查看新品🍬",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script></div></body></html>