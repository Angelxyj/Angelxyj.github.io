<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>react基础 | 许小墨のBlog</title><meta name="author" content="许小墨,1440023258@qq.com"><meta name="copyright" content="许小墨"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="《React》课程资料——许小墨  〇、React一、关于React英文官网：https:&#x2F;&#x2F;reactjs.org&#x2F; 中文官网：https:&#x2F;&#x2F;zh-hans.reactjs.org&#x2F; React 起源于 Facebook 的内部项目，因为该公司对市场上所有 JavaScript MVC 框架，都不满意，就决定自己写一套，用来架设Instagram 的网站。做出来以后，发现这套东西很好用，就在"><meta property="og:type" content="article"><meta property="og:title" content="react基础"><meta property="og:url" content="https://angelxyj.github.io/posts/66450fce.html"><meta property="og:site_name" content="许小墨のBlog"><meta property="og:description" content="《React》课程资料——许小墨  〇、React一、关于React英文官网：https:&#x2F;&#x2F;reactjs.org&#x2F; 中文官网：https:&#x2F;&#x2F;zh-hans.reactjs.org&#x2F; React 起源于 Facebook 的内部项目，因为该公司对市场上所有 JavaScript MVC 框架，都不满意，就决定自己写一套，用来架设Instagram 的网站。做出来以后，发现这套东西很好用，就在"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://angelxyj.github.io/img/11.png"><meta property="article:published_time" content="2023-06-18T17:07:34.000Z"><meta property="article:modified_time" content="2024-10-01T16:38:42.728Z"><meta property="article:author" content="许小墨"><meta property="article:tag" content="前端"><meta property="article:tag" content="框架"><meta property="article:tag" content="React"><meta property="article:tag" content="React重制版"><meta property="article:tag" content="react-course"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://angelxyj.github.io/img/11.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://angelxyj.github.io/posts/66450fce.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/favicon-16x16.png"><link rel="mask-icon" href="/img/siteicon/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"找不到您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!0},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: 许小墨",link:"链接: ",source:"来源: 许小墨のBlog",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体中文",cht_to_chs:"你已切换为简体中文",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!0,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!0},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"react基础",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-10-01 16:38:42"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)})),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{const e=document.getElementById("loading-box"),d=document.body,o=()=>{d.style.overflow="",e.classList.add("loaded")},t=()=>{d.style.overflow="hidden",e.classList.remove("loaded")};t(),window.addEventListener("load",(()=>{o()})),document.addEventListener("pjax:send",(()=>{t()})),document.addEventListener("pjax:complete",(()=>{o()}))})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/touxiang.webp" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">198</div></a><a href="/%E6%A0%87%E7%AD%BE/"><div class="headline">标签</div><div class="length-num">183</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">42</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>电影</span></a></li><li><a class="site-page child" href="/poems/"><i class="fa-fw fas fa-book"></i> <span>文学鉴赏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-compass"></i> <span>关于</span></a></li><li><a class="site-page child" href="/sponsor/"><i class="fa-fw fas fa-thumbs-up"></i> <span>打赏</span></a></li><li><a class="site-page child" href="/resume/"><i class="fa-fw fas fa-book"></i> <span>简历</span></a></li><li><a class="site-page child" href="/TodoList"><i class="fa-fw fab fa-internet-explorer"></i> <span>计划</span></a></li><li><a class="site-page child" href="/ChatGPT/"><i class="fa-fw fas fa-fan"></i> <span>GPT</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('/img/11.png')"><nav id="nav"><span id="blog-info"><a href="/" title="许小墨のBlog"><span class="site-name">许小墨のBlog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>电影</span></a></li><li><a class="site-page child" href="/poems/"><i class="fa-fw fas fa-book"></i> <span>文学鉴赏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-compass"></i> <span>关于</span></a></li><li><a class="site-page child" href="/sponsor/"><i class="fa-fw fas fa-thumbs-up"></i> <span>打赏</span></a></li><li><a class="site-page child" href="/resume/"><i class="fa-fw fas fa-book"></i> <span>简历</span></a></li><li><a class="site-page child" href="/TodoList"><i class="fa-fw fab fa-internet-explorer"></i> <span>计划</span></a></li><li><a class="site-page child" href="/ChatGPT/"><i class="fa-fw fas fa-fan"></i> <span>GPT</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">react基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-18T17:07:34.000Z" title="发表于 2023-06-18 17:07:34">2023-06-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-01T16:38:42.728Z" title="更新于 2024-10-01 16:38:42">2024-10-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/">前端开发</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/">框架开发</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/React/">React</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/React/React%E9%87%8D%E5%88%B6%E7%89%88/">React重制版</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91/React/React%E9%87%8D%E5%88%B6%E7%89%88/react-course/">react-course</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">69.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>319分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="react基础"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote><p>《React》课程资料——许小墨</p></blockquote><h1 id="〇、React"><a href="#〇、React" class="headerlink" title="〇、React"></a>〇、React</h1><h1 id="一、关于React"><a href="#一、关于React" class="headerlink" title="一、关于React"></a>一、关于React</h1><p>英文官网：<a target="_blank" rel="noopener" href="https://reactjs.org/">https://reactjs.org/</a></p><p>中文官网：<a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/">https://zh-hans.reactjs.org/</a></p><p>React 起源于 Facebook 的内部项目，因为该公司对市场上所有 JavaScript MVC 框架，都不满意，就决定自己写一套，用来架设Instagram 的网站。做出来以后，发现这套东西很好用，就在2013年5月开源了。</p><p>react在发展过程中，一直跟随原生js的脚步，特别是从v16.0版本开始（用到了class来创建组件）</p><p>2015年推出了使用react来编写移动端的app —- react-native</p><p>重要版本发版时间</p><table><thead><tr><th>序号</th><th>版本号</th><th>发版时间</th><th>重要更新</th></tr></thead><tbody><tr><td>1</td><td>16</td><td>2017年9月26</td><td>引入es6的类组件</td></tr><tr><td>2</td><td>16.3</td><td>2018年4月3日</td><td>生命周期更新</td></tr><tr><td>3</td><td>16.4</td><td>2018年5月23日</td><td>生命周期更新</td></tr><tr><td>4</td><td>16.8</td><td>2019年2月6日</td><td>引入 react hooks</td></tr><tr><td>5</td><td>17.0</td><td>2020年10月20日</td><td>过渡版本</td></tr><tr><td>6</td><td>18.0</td><td>2022年3月29日</td><td>写法改变，严格模式发生改变</td></tr></tbody></table><h1 id="二、脚手架"><a href="#二、脚手架" class="headerlink" title="二、脚手架"></a>二、脚手架</h1><p>英文官网：<a target="_blank" rel="noopener" href="https://create-react-app.dev/">https://create-react-app.dev/</a></p><p>中文官网：<a target="_blank" rel="noopener" href="https://create-react-app.bootcss.com/">https://create-react-app.bootcss.com/</a></p><blockquote><p>补充：react的脚手架并不是只有 <code>create-react-app</code>，还有<code>dva-cli</code>,<code>umi</code>等</p></blockquote><h2 id="2-1-create-react-app脚手架的使用"><a href="#2-1-create-react-app脚手架的使用" class="headerlink" title="2.1 create-react-app脚手架的使用"></a>2.1 create-react-app脚手架的使用</h2><blockquote><p>Create React App 让你仅通过一行命令，即可构建现代化的 Web 应用。</p><p>本文档之后称之为cra</p></blockquote><p>创建项目的方式:</p><blockquote><p>需要保证电脑安装node版本在14以上，系统在win7以上</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方式1:使用npx</span></span><br><span class="line">$ npx create-react-app react-basic</span><br><span class="line"><span class="comment"># 方式2:使用npm</span></span><br><span class="line">$ npm init react-app react-basic</span><br><span class="line"><span class="comment"># 方式3:使用yarn</span></span><br><span class="line">$ yarn create react-app react-basic</span><br></pre></td></tr></table></figure><p>如果需要使用ts开发项目，创建项目时可以通过<code>--template typescript</code>指定模版</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npx create-react-app myapp --template typescript</span><br></pre></td></tr></table></figure><p>如果出现如下内容，即代表项目创建成功</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Success! Created react-basic at /Users/wudaxun/Desktop/workspace/code/bk2207A/code/react-course/react-basic</span><br><span class="line">Inside that directory, you can run several commands:</span><br><span class="line"></span><br><span class="line">  npm start</span><br><span class="line">    Starts the development server.</span><br><span class="line"></span><br><span class="line">  npm run build</span><br><span class="line">    Bundles the app into static files <span class="keyword">for</span> production.</span><br><span class="line"></span><br><span class="line">  npm <span class="built_in">test</span></span><br><span class="line">    Starts the <span class="built_in">test</span> runner.</span><br><span class="line"></span><br><span class="line">  npm run eject</span><br><span class="line">    Removes this tool and copies build dependencies, configuration files</span><br><span class="line">    and scripts into the app directory. If you <span class="keyword">do</span> this, you can’t go back!</span><br><span class="line"></span><br><span class="line">We suggest that you begin by typing:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">cd</span> react-basic</span><br><span class="line">  npm start</span><br><span class="line"></span><br><span class="line">Happy hacking!</span><br></pre></td></tr></table></figure><h2 id="2-2-项目目录解析"><a href="#2-2-项目目录解析" class="headerlink" title="2.2 项目目录解析"></a>2.2 项目目录解析</h2><p>项目创建完毕生成目录结构如下：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">react-basic</span><br><span class="line">├── README.md</span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">├── .gitignore</span><br><span class="line">├── public</span><br><span class="line">│   ├── favicon.ico</span><br><span class="line">│   ├── index.html</span><br><span class="line">│   ├── logo192.png</span><br><span class="line">│   ├── logo512.png</span><br><span class="line">│   ├── manifest.json</span><br><span class="line">│   └── robots.txt</span><br><span class="line">└── src</span><br><span class="line">    ├── App.css</span><br><span class="line">    ├── App.js</span><br><span class="line">    ├── App.test.js</span><br><span class="line">    ├── index.css</span><br><span class="line">    ├── index.js</span><br><span class="line">    ├── logo.svg</span><br><span class="line">    ├── reportWebVitals.js // 做性能测试</span><br><span class="line">    └── setupTests.js // 测试</span><br></pre></td></tr></table></figure><p><code>src/reportWebVitals.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">reportWebVitals</span> = onPerfEntry =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (onPerfEntry &amp;&amp; onPerfEntry <span class="keyword">instanceof</span> <span class="title class_">Function</span>) &#123;</span><br><span class="line">    <span class="keyword">import</span>(<span class="string">&#x27;web-vitals&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">&#123; getCLS, getFID, getFCP, getLCP, getTTFB &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">getCLS</span>(onPerfEntry); <span class="comment">// 衡量视觉稳定性。为了提供一个好的用户体验，CLS应该小于0.1</span></span><br><span class="line">      <span class="title function_">getFID</span>(onPerfEntry); <span class="comment">// 衡量可交互性。为了提供一个好的用户体验，FID应该在100毫秒内。</span></span><br><span class="line">      <span class="title function_">getFCP</span>(onPerfEntry); <span class="comment">// 首次内容绘制</span></span><br><span class="line">      <span class="title function_">getLCP</span>(onPerfEntry); <span class="comment">// 衡量加载性能。为了提供一个好的用户体验，LCP应该在2.5秒内</span></span><br><span class="line">      <span class="title function_">getTTFB</span>(onPerfEntry); <span class="comment">// 到第一个字节的时间</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reportWebVitals;</span><br></pre></td></tr></table></figure><blockquote><p>react官方文档已经给了我们性能提升的方案：<a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/docs/optimizing-performance.html">https://zh-hans.reactjs.org/docs/optimizing-performance.html</a></p></blockquote><p>打开<code>package.json</code>,发现可运行命令如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts start&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts build&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts test&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;eject&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts eject&quot;</span></span><br><span class="line"> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><p><code>start</code>指令用于启动开发者服务器</p><p><code>build</code>指令用于打包项目</p><p><code>test</code>指令用于测试</p><p><code>eject</code>指令用于抽离配置文件</p><blockquote><p><code>cra</code>脚手架基于<code>webpack</code>，默认<code>webpack</code>的配置在 <code>node_modules</code> 下的 <code>react-scripts</code> 内部,但是一般情况下，传输代码时，不会上传 <code>node_modules</code>，那么在必要情况下就必须得抽离配置文件。</p></blockquote><h2 id="2-3-抽离配置文件"><a href="#2-3-抽离配置文件" class="headerlink" title="2.3 抽离配置文件"></a>2.3 抽离配置文件</h2><p>通过<code>npm run eject</code>或者<code>cnpm run eject</code> 或者<code>yarn eject</code>指令抽离配置文件</p><blockquote><p>抽离配置文件过程中注意事项</p><ul><li>1.确保项目的git仓库是最新的</li><li>2.如果不需要对于webpack进行配置，那么不需要抽离配置文件</li><li>create-react-app v2 默认支持 ts 以及sass 以及css的模块化，如果使用 sass作为css预处理器，那么不需要抽离配置文件</li></ul></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">Copying files into /Users/wudaxun/Desktop/workspace/code/bk2207A/code/react-course/react-basic</span><br><span class="line">  Adding /config/env.js to the project</span><br><span class="line">  Adding /config/getHttpsConfig.js to the project</span><br><span class="line">  Adding /config/modules.js to the project</span><br><span class="line">  Adding /config/paths.js to the project</span><br><span class="line">  Adding /config/webpack.config.js to the project</span><br><span class="line">  Adding /config/webpackDevServer.config.js to the project</span><br><span class="line">  Adding /config/jest/babelTransform.js to the project</span><br><span class="line">  Adding /config/jest/cssTransform.js to the project</span><br><span class="line">  Adding /config/jest/fileTransform.js to the project</span><br><span class="line">  Adding /scripts/build.js to the project</span><br><span class="line">  Adding /scripts/start.js to the project</span><br><span class="line">  Adding /scripts/test.js to the project</span><br><span class="line">  Adding /config/webpack/persistentCache/createEnvironmentHash.js to the project</span><br><span class="line"></span><br><span class="line">Updating the dependencies</span><br><span class="line">  Removing react-scripts from dependencies</span><br><span class="line">  Adding @babel/core to dependencies</span><br><span class="line">  Adding @pmmmwh/react-refresh-webpack-plugin to dependencies</span><br><span class="line">  Adding @svgr/webpack to dependencies</span><br><span class="line">  Adding babel-jest to dependencies</span><br><span class="line">  Adding babel-loader to dependencies</span><br><span class="line">  Adding babel-plugin-named-asset-import to dependencies</span><br><span class="line">  Adding babel-preset-react-app to dependencies</span><br><span class="line">  Adding bfj to dependencies</span><br><span class="line">  Adding browserslist to dependencies</span><br><span class="line">  Adding camelcase to dependencies</span><br><span class="line">  Adding case-sensitive-paths-webpack-plugin to dependencies</span><br><span class="line">  Adding css-loader to dependencies</span><br><span class="line">  Adding css-minimizer-webpack-plugin to dependencies</span><br><span class="line">  Adding dotenv to dependencies</span><br><span class="line">  Adding dotenv-expand to dependencies</span><br><span class="line">  Adding eslint to dependencies</span><br><span class="line">  Adding eslint-config-react-app to dependencies</span><br><span class="line">  Adding eslint-webpack-plugin to dependencies</span><br><span class="line">  Adding file-loader to dependencies</span><br><span class="line">  Adding fs-extra to dependencies</span><br><span class="line">  Adding html-webpack-plugin to dependencies</span><br><span class="line">  Adding identity-obj-proxy to dependencies</span><br><span class="line">  Adding jest to dependencies</span><br><span class="line">  Adding jest-resolve to dependencies</span><br><span class="line">  Adding jest-watch-typeahead to dependencies</span><br><span class="line">  Adding mini-css-extract-plugin to dependencies</span><br><span class="line">  Adding postcss to dependencies</span><br><span class="line">  Adding postcss-flexbugs-fixes to dependencies</span><br><span class="line">  Adding postcss-loader to dependencies</span><br><span class="line">  Adding postcss-normalize to dependencies</span><br><span class="line">  Adding postcss-preset-env to dependencies</span><br><span class="line">  Adding prompts to dependencies</span><br><span class="line">  Adding react-app-polyfill to dependencies</span><br><span class="line">  Adding react-dev-utils to dependencies</span><br><span class="line">  Adding react-refresh to dependencies</span><br><span class="line">  Adding resolve to dependencies</span><br><span class="line">  Adding resolve-url-loader to dependencies</span><br><span class="line">  Adding sass-loader to dependencies</span><br><span class="line">  Adding semver to dependencies</span><br><span class="line">  Adding source-map-loader to dependencies</span><br><span class="line">  Adding style-loader to dependencies</span><br><span class="line">  Adding tailwindcss to dependencies</span><br><span class="line">  Adding terser-webpack-plugin to dependencies</span><br><span class="line">  Adding webpack to dependencies</span><br><span class="line">  Adding webpack-dev-server to dependencies</span><br><span class="line">  Adding webpack-manifest-plugin to dependencies</span><br><span class="line">  Adding workbox-webpack-plugin to dependencies</span><br><span class="line"></span><br><span class="line">Updating the scripts</span><br><span class="line">  Replacing <span class="string">&quot;react-scripts start&quot;</span> with <span class="string">&quot;node scripts/start.js&quot;</span></span><br><span class="line">  Replacing <span class="string">&quot;react-scripts build&quot;</span> with <span class="string">&quot;node scripts/build.js&quot;</span></span><br><span class="line">  Replacing <span class="string">&quot;react-scripts test&quot;</span> with <span class="string">&quot;node scripts/test.js&quot;</span></span><br><span class="line"></span><br><span class="line">Configuring package.json</span><br><span class="line">  Adding Jest configuration</span><br><span class="line">  Adding Babel preset</span><br><span class="line"></span><br><span class="line">Running npm install...</span><br><span class="line"></span><br><span class="line">up to <span class="built_in">date</span> <span class="keyword">in</span> 4s</span><br><span class="line"></span><br><span class="line">203 packages are looking <span class="keyword">for</span> funding</span><br><span class="line">  run `npm fund` <span class="keyword">for</span> details</span><br><span class="line">Ejected successfully!</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm start</span><br><span class="line">$ npm build</span><br></pre></td></tr></table></figure><h2 id="2-4-webpack二次封装"><a href="#2-4-webpack二次封装" class="headerlink" title="2.4 webpack二次封装"></a>2.4 webpack二次封装</h2><h3 id="2-4-1-集成css预处理器"><a href="#2-4-1-集成css预处理器" class="headerlink" title="2.4.1 集成css预处理器"></a>2.4.1 集成css预处理器</h3><ul><li><strong>集成less预处理器</strong></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i less less-loader -D</span><br></pre></td></tr></table></figure><ul><li><strong>集成sass预处理器</strong></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i node-sass -D</span><br></pre></td></tr></table></figure><ul><li><strong>集成stylus预处理器</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i stylus stylus-loader -D</span><br></pre></td></tr></table></figure><p>具体配置如下：</p><p><code>React-basic/config/webpack.config.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// style files regexes 可以搜索此关键字快速定位</span></span><br><span class="line"><span class="keyword">const</span> cssRegex = <span class="regexp">/\.css$/</span>;</span><br><span class="line"><span class="keyword">const</span> cssModuleRegex = <span class="regexp">/\.module\.css$/</span>;</span><br><span class="line"><span class="keyword">const</span> sassRegex = <span class="regexp">/\.(scss|sass)$/</span>;</span><br><span class="line"><span class="keyword">const</span> sassModuleRegex = <span class="regexp">/\.module\.(scss|sass)$/</span>;</span><br><span class="line"><span class="keyword">const</span> lessRegex = <span class="regexp">/\.less$/</span>;</span><br><span class="line"><span class="keyword">const</span> lessModuleRegex = <span class="regexp">/\.module\.less$/</span>;</span><br><span class="line"><span class="keyword">const</span> stylusRegex = <span class="regexp">/\.stylus/</span>;</span><br><span class="line"><span class="keyword">const</span> stylusModuleRegex = <span class="regexp">/\.module\.stylus/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;postcss&quot; loader applies autoprefixer to our CSS.可以搜索此关键字快速定位</span></span><br><span class="line"><span class="comment">// &quot;css&quot; loader resolves paths in CSS and adds assets as dependencies.</span></span><br><span class="line"><span class="comment">// &quot;style&quot; loader turns CSS into JS modules that inject &lt;style&gt; tags.</span></span><br><span class="line"><span class="comment">// In production, we use MiniCSSExtractPlugin to extract that CSS</span></span><br><span class="line"><span class="comment">// to a file, but in development &quot;style&quot; loader enables hot editing</span></span><br><span class="line"><span class="comment">// of CSS.</span></span><br><span class="line"><span class="comment">// By default we support CSS Modules with the extension .module.css</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">test</span>: cssRegex,</span><br><span class="line">    <span class="attr">exclude</span>: cssModuleRegex,</span><br><span class="line">      <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(&#123;</span><br><span class="line">        <span class="attr">importLoaders</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">sourceMap</span>: isEnvProduction</span><br><span class="line">        ? shouldUseSourceMap</span><br><span class="line">        : isEnvDevelopment,</span><br><span class="line">        <span class="attr">modules</span>: &#123;</span><br><span class="line">          <span class="attr">mode</span>: <span class="string">&#x27;icss&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;),</span><br><span class="line">        <span class="comment">// Don&#x27;t consider CSS imports dead code even if the</span></span><br><span class="line">        <span class="comment">// containing package claims to have no side effects.</span></span><br><span class="line">        <span class="comment">// Remove this when webpack adds a warning or an error for this.</span></span><br><span class="line">        <span class="comment">// See https://github.com/webpack/webpack/issues/6571</span></span><br><span class="line">        <span class="attr">sideEffects</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;,</span><br><span class="line">  <span class="comment">// Adds support for CSS Modules (https://github.com/css-modules/css-modules)</span></span><br><span class="line">  <span class="comment">// using the extension .module.css</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">test</span>: cssModuleRegex,</span><br><span class="line">      <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(&#123;</span><br><span class="line">        <span class="attr">importLoaders</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">sourceMap</span>: isEnvProduction</span><br><span class="line">        ? shouldUseSourceMap</span><br><span class="line">        : isEnvDevelopment,</span><br><span class="line">        <span class="attr">modules</span>: &#123;</span><br><span class="line">          <span class="attr">mode</span>: <span class="string">&#x27;local&#x27;</span>,</span><br><span class="line">          <span class="attr">getLocalIdent</span>: getCSSModuleLocalIdent,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;),</span><br><span class="line">  &#125;,</span><br><span class="line">    <span class="comment">// Opt-in support for SASS (using .scss or .sass extensions).</span></span><br><span class="line">    <span class="comment">// By default we support SASS Modules with the</span></span><br><span class="line">    <span class="comment">// extensions .module.scss or .module.sass</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">test</span>: sassRegex,</span><br><span class="line">        <span class="attr">exclude</span>: sassModuleRegex,</span><br><span class="line">          <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">importLoaders</span>: <span class="number">3</span>,</span><br><span class="line">              <span class="attr">sourceMap</span>: isEnvProduction</span><br><span class="line">              ? shouldUseSourceMap</span><br><span class="line">              : isEnvDevelopment,</span><br><span class="line">              <span class="attr">modules</span>: &#123;</span><br><span class="line">                <span class="attr">mode</span>: <span class="string">&#x27;icss&#x27;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&#x27;sass-loader&#x27;</span></span><br><span class="line">          ),</span><br><span class="line">            <span class="comment">// Don&#x27;t consider CSS imports dead code even if the</span></span><br><span class="line">            <span class="comment">// containing package claims to have no side effects.</span></span><br><span class="line">            <span class="comment">// Remove this when webpack adds a warning or an error for this.</span></span><br><span class="line">            <span class="comment">// See https://github.com/webpack/webpack/issues/6571</span></span><br><span class="line">            <span class="attr">sideEffects</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">      <span class="comment">// Adds support for CSS Modules, but using SASS</span></span><br><span class="line">      <span class="comment">// using the extension .module.scss or .module.sass</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: sassModuleRegex,</span><br><span class="line">          <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">importLoaders</span>: <span class="number">3</span>,</span><br><span class="line">              <span class="attr">sourceMap</span>: isEnvProduction</span><br><span class="line">              ? shouldUseSourceMap</span><br><span class="line">              : isEnvDevelopment,</span><br><span class="line">              <span class="attr">modules</span>: &#123;</span><br><span class="line">                <span class="attr">mode</span>: <span class="string">&#x27;local&#x27;</span>,</span><br><span class="line">                <span class="attr">getLocalIdent</span>: getCSSModuleLocalIdent,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&#x27;sass-loader&#x27;</span></span><br><span class="line">          ),</span><br><span class="line">      &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">test</span>: lessRegex,</span><br><span class="line">            <span class="attr">exclude</span>: lessModuleRegex,</span><br><span class="line">              <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="attr">importLoaders</span>: <span class="number">3</span>,</span><br><span class="line">                  <span class="attr">sourceMap</span>: isEnvProduction</span><br><span class="line">                  ? shouldUseSourceMap</span><br><span class="line">                  : isEnvDevelopment,</span><br><span class="line">                  <span class="attr">modules</span>: &#123;</span><br><span class="line">                    <span class="attr">mode</span>: <span class="string">&#x27;icss&#x27;</span>,</span><br><span class="line">                  &#125;,</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">&#x27;less-loader&#x27;</span></span><br><span class="line">              ),</span><br><span class="line">                <span class="comment">// Don&#x27;t consider CSS imports dead code even if the</span></span><br><span class="line">                <span class="comment">// containing package claims to have no side effects.</span></span><br><span class="line">                <span class="comment">// Remove this when webpack adds a warning or an error for this.</span></span><br><span class="line">                <span class="comment">// See https://github.com/webpack/webpack/issues/6571</span></span><br><span class="line">                <span class="attr">sideEffects</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">          <span class="comment">// Adds support for CSS Modules, but using SASS</span></span><br><span class="line">          <span class="comment">// using the extension .module.scss or .module.sass</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">test</span>: lessModuleRegex,</span><br><span class="line">              <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="attr">importLoaders</span>: <span class="number">3</span>,</span><br><span class="line">                  <span class="attr">sourceMap</span>: isEnvProduction</span><br><span class="line">                  ? shouldUseSourceMap</span><br><span class="line">                  : isEnvDevelopment,</span><br><span class="line">                  <span class="attr">modules</span>: &#123;</span><br><span class="line">                    <span class="attr">mode</span>: <span class="string">&#x27;local&#x27;</span>,</span><br><span class="line">                    <span class="attr">getLocalIdent</span>: getCSSModuleLocalIdent,</span><br><span class="line">                  &#125;,</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">&#x27;less-loader&#x27;</span></span><br><span class="line">              ),</span><br><span class="line">          &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">          <span class="attr">test</span>: stylusRegex,</span><br><span class="line">            <span class="attr">exclude</span>: stylusModuleRegex,</span><br><span class="line">              <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="attr">importLoaders</span>: <span class="number">3</span>,</span><br><span class="line">                  <span class="attr">sourceMap</span>: isEnvProduction</span><br><span class="line">                  ? shouldUseSourceMap</span><br><span class="line">                  : isEnvDevelopment,</span><br><span class="line">                  <span class="attr">modules</span>: &#123;</span><br><span class="line">                    <span class="attr">mode</span>: <span class="string">&#x27;icss&#x27;</span>,</span><br><span class="line">                  &#125;,</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">&#x27;stylus-loader&#x27;</span></span><br><span class="line">              ),</span><br><span class="line">                <span class="comment">// Don&#x27;t consider CSS imports dead code even if the</span></span><br><span class="line">                <span class="comment">// containing package claims to have no side effects.</span></span><br><span class="line">                <span class="comment">// Remove this when webpack adds a warning or an error for this.</span></span><br><span class="line">                <span class="comment">// See https://github.com/webpack/webpack/issues/6571</span></span><br><span class="line">                <span class="attr">sideEffects</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">          <span class="comment">// Adds support for CSS Modules, but using SASS</span></span><br><span class="line">          <span class="comment">// using the extension .module.scss or .module.sass</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">test</span>: stylusModuleRegex,</span><br><span class="line">              <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="attr">importLoaders</span>: <span class="number">3</span>,</span><br><span class="line">                  <span class="attr">sourceMap</span>: isEnvProduction</span><br><span class="line">                  ? shouldUseSourceMap</span><br><span class="line">                  : isEnvDevelopment,</span><br><span class="line">                  <span class="attr">modules</span>: &#123;</span><br><span class="line">                    <span class="attr">mode</span>: <span class="string">&#x27;local&#x27;</span>,</span><br><span class="line">                    <span class="attr">getLocalIdent</span>: getCSSModuleLocalIdent,</span><br><span class="line">                  &#125;,</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">&#x27;stylus-loader&#x27;</span></span><br><span class="line">              ),</span><br><span class="line">          &#125;,</span><br></pre></td></tr></table></figure><h3 id="2-4-2-配置-解析别名"><a href="#2-4-2-配置-解析别名" class="headerlink" title="2.4.2 配置@解析别名"></a>2.4.2 配置@解析别名</h3><blockquote><p>vue项目中可以使用@代替src目录，那么react中抽离配置文件之后也可以实现此功能</p></blockquote><p><code>react-basic/config/webpack.config.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">alias</span>: &#123;</span><br><span class="line">  <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(<span class="string">&#x27;src&#x27;</span>), <span class="comment">// +++++++++++++</span></span><br><span class="line">    <span class="comment">// Support React Native Web 搜索此关键词快速定位</span></span><br><span class="line">    <span class="comment">// https://www.smashingmagazine.com/2016/08/a-glimpse-into-the-future-with-react-native-for-web/</span></span><br><span class="line">    <span class="string">&#x27;react-native&#x27;</span>: <span class="string">&#x27;react-native-web&#x27;</span>,</span><br><span class="line">      <span class="comment">// Allows for better profiling with ReactDevTools</span></span><br><span class="line">      ...(isEnvProductionProfile &amp;&amp; &#123;</span><br><span class="line">      <span class="string">&#x27;react-dom$&#x27;</span>: <span class="string">&#x27;react-dom/profiling&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;scheduler/tracing&#x27;</span>: <span class="string">&#x27;scheduler/tracing-profiling&#x27;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">      ...(modules.<span class="property">webpackAliases</span> || &#123;&#125;),</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><blockquote><p>如果是ts项目，需要在<code>tsconfig.json</code>中加入如下配置</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es6&quot;</span><span class="punctuation">,</span> <span class="comment">// ts代码以es5为标准</span></span><br><span class="line">    <span class="attr">&quot;lib&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;dom&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;dom.iterable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;esnext&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="comment">// ++++++++++</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./src/*&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;allowJs&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;skipLibCheck&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;esModuleInterop&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;allowSyntheticDefaultImports&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;strict&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;forceConsistentCasingInFileNames&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;noFallthroughCasesInSwitch&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;moduleResolution&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;resolveJsonModule&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;isolatedModules&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;noEmit&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> </span><br><span class="line">    <span class="attr">&quot;jsx&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-jsx&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;src&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;src/**/*&quot;</span> <span class="comment">// ++++++++++</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><p><code>src/index.js</code> 测试</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@/index.css&#x27;</span>; <span class="comment">// ++++++</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;@/App&#x27;</span>;<span class="comment">// ++++++</span></span><br><span class="line"><span class="keyword">import</span> reportWebVitals <span class="keyword">from</span> <span class="string">&#x27;@/reportWebVitals&#x27;</span>;<span class="comment">// ++++++</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// If you want to start measuring performance in your app, pass a function</span></span><br><span class="line"><span class="comment">// to log results (for example: reportWebVitals(console.log))</span></span><br><span class="line"><span class="comment">// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals</span></span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果控制台报错如下，说明@别名没有配置成功</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Failed</span> to compile.</span><br><span class="line"></span><br><span class="line"><span class="title class_">Module</span> not <span class="attr">found</span>: <span class="title class_">Error</span>: <span class="title class_">Can</span><span class="string">&#x27;t resolve &#x27;</span>@/index.<span class="property">css</span><span class="string">&#x27; in &#x27;</span>/<span class="title class_">Users</span>/wudaxun/<span class="title class_">Desktop</span>/workspace/code/bk2207A/code/react-course/react-basic/src<span class="string">&#x27;</span></span><br><span class="line"><span class="string">ERROR in ./src/index.js 6:0-21</span></span><br><span class="line"><span class="string">Module not found: Error: Can&#x27;</span>t resolve <span class="string">&#x27;@/index.css&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;/Users/wudaxun/Desktop/workspace/code/bk2207A/code/react-course/react-basic/src&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable constant_">ERROR</span> <span class="keyword">in</span> ./src/index.<span class="property">js</span> <span class="number">7</span>:<span class="number">0</span>-<span class="number">24</span></span><br><span class="line"><span class="title class_">Module</span> not <span class="attr">found</span>: <span class="title class_">Error</span>: <span class="title class_">Can</span><span class="string">&#x27;t resolve &#x27;</span>@/<span class="title class_">App</span><span class="string">&#x27; in &#x27;</span>/<span class="title class_">Users</span>/wudaxun/<span class="title class_">Desktop</span>/workspace/code/bk2207A/code/react-course/react-basic/src<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ERROR in ./src/index.js 8:0-48</span></span><br><span class="line"><span class="string">Module not found: Error: Can&#x27;</span>t resolve <span class="string">&#x27;@/reportWebVitals&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;/Users/wudaxun/Desktop/workspace/code/bk2207A/code/react-course/react-basic/src&#x27;</span></span><br><span class="line"></span><br><span class="line">webpack compiled <span class="keyword">with</span> <span class="number">3</span> errors</span><br></pre></td></tr></table></figure><p>如果没有错误说明配置是成功的。</p><blockquote><p>如果不抽离配置文件，但是也需要配置别名@</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i @craco/craco -D</span><br></pre></td></tr></table></figure><p>项目根目录中创建 craco 的配置文件：<code>craco.config.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">webpack</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改<code>package.json</code>中运行命令</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;craco start&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;craco build&quot;</span></span><br><span class="line">   <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;craco test&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>重启服务器即可生效</p></blockquote><h2 id="2-5-setupProxy代理"><a href="#2-5-setupProxy代理" class="headerlink" title="2.5 setupProxy代理"></a>2.5 setupProxy代理</h2><blockquote><p>即使不抽离配置文件，也是在此处配置代理</p></blockquote><p>如果整个项目只有一个服务器且有跨域问题，可以直接在<code>package.json</code>中做如下配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;proxy&quot;: &quot;http://121.89.205.189:3001/api/&quot;</span><br></pre></td></tr></table></figure><p>然后在项目中可以如下访问：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// src/index.js</span><br><span class="line">fetch(&#x27;/pro/list&#x27;).then(res =&gt; res.json()).then(res =&gt; &#123;</span><br><span class="line">  console.log(res.data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>那么如果有多个服务器 并且也需要解决跨域问题</p><p>首先，<code>http-proxy-middleware</code>使用 npm 或 Yarn 安装：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm install http-proxy-middleware -S</span><br><span class="line">$ <span class="comment"># or</span></span><br><span class="line">$ yarn add http-proxy-middleware -S</span><br></pre></td></tr></table></figure><p>接下来，创建<code>src/setupProxy.js</code>并在其中放置以下内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; createProxyMiddleware &#125; = <span class="built_in">require</span>(<span class="string">&#x27;http-proxy-middleware&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span>(<span class="params">app</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>您现在可以根据需要注册代理了！这是使用上述内容的示例<code>http-proxy-middleware</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; createProxyMiddleware &#125; = <span class="built_in">require</span>(<span class="string">&#x27;http-proxy-middleware&#x27;</span>); <span class="comment">// 此处不使用import语法</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> (<span class="params">app</span>) &#123;</span><br><span class="line">  <span class="comment">// http://121.89.205.189:3001/api/pro/list ==&gt; /myapi/pro/list</span></span><br><span class="line">  app.<span class="title function_">use</span>(<span class="string">&#x27;/myapi&#x27;</span>, <span class="title function_">createProxyMiddleware</span>(&#123;</span><br><span class="line">      <span class="attr">target</span>: <span class="string">&#x27;http://121.89.205.189:3001/api&#x27;</span>,</span><br><span class="line">      <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">pathRewrite</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;^/myapi&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>注意：</strong>您不需要在任何地方导入此文件。当您启动开发服务器时，它会自动注册。</p></blockquote><blockquote><p><strong>注意：</strong>此文件仅支持 Node 的 JavaScript 语法。确保只使用受支持的语言功能（即不支持 Flow、ES 模块等）。</p></blockquote><blockquote><p><strong>注意：</strong>将路径传递给代理函数允许您在路径上使用通配符和&#x2F;或模式匹配，这比快速路由匹配更灵活。</p></blockquote><h1 id="三、JSX"><a href="#三、JSX" class="headerlink" title="三、JSX"></a>三、JSX</h1><p>设想如下变量声明：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br></pre></td></tr></table></figure><p>这个有趣的标签语法既不是字符串也不是 HTML。</p><p>它被称为 JSX，是一个 JavaScript 的语法扩展。</p><p>JSX 可以生成 React “元素”。</p><blockquote><p>React <a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/docs/react-without-jsx.html">不强制要求</a>使用 JSX，但是大多数人发现，在 JavaScript 代码中将 JSX 和 UI 放在一起时，会在视觉上有辅助作用。它还可以使 React 显示更多有用的错误和警告消息。</p></blockquote><p><code>src</code>文件夹下只保留<code>index.js</code></p><h2 id="3-1-jsx语法详解"><a href="#3-1-jsx语法详解" class="headerlink" title="3.1 jsx语法详解"></a>3.1 jsx语法详解</h2><p>在下面的例子中，我们声明了一个名为 <code>name</code> 的变量，然后在 JSX 中使用它，并将它包裹在大括号中</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="comment">// react 18版本写法</span></span><br><span class="line"><span class="comment">// import React from &#x27;react&#x27;</span></span><br><span class="line"><span class="comment">// import ReactDOM from &#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const name = &lt;h1&gt;千锋HTML5大前端，前端培训界的扛把子！&lt;/h1&gt;</span></span><br><span class="line"><span class="comment">// const app = &lt;div&gt;你好, &#123; name &#125;&lt;/div&gt; // js 变量加&#123;&#125; 变 react</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const root = ReactDOM.createRoot(document.getElementById(&#x27;root&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// root.render(app)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// react 18版本以前</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> name = <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>千锋HTML5大前端，前端培训界的扛把子!!!！<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> app = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>你好, &#123; name &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> <span class="comment">// js 变量加&#123;&#125; 变 react</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 警告信息：ReactDOM.render is no longer supported in React 18. Use createRoot instead. </span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  app,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><blockquote><p>在 JSX 语法中，你可以在大括号内放置任何有效的 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#Expressions">JavaScript 表达式</a>。例如，<code>2+2</code>，<code>user.firstName</code> 或 <code>formatName(user)</code> 都是有效的 JavaScript 表达式。</p></blockquote><p>在下面的示例中，我们将调用 JavaScript 函数 <code>formatName(user)</code> 的结果，并将结果嵌入到 <code>&lt;div&gt;</code> 元素中。</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="comment">// react 18版本写法</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const name = &lt;h1&gt;千锋HTML5大前端，前端培训界的扛把子！&lt;/h1&gt;</span></span><br><span class="line"><span class="comment">// const app = &lt;div&gt;你好, &#123; name &#125;&lt;/div&gt; // js 变量加&#123;&#125; 变 react</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">formatUser</span> (user) &#123;</span><br><span class="line">  <span class="keyword">return</span> user.<span class="property">firstName</span> + user.<span class="property">lastName</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="string">&#x27;吴&#x27;</span>,</span><br><span class="line">  <span class="attr">lastName</span>: <span class="string">&#x27;大勋&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 为了便于阅读，我们会将 JSX 拆分为多行。</span></span><br><span class="line"><span class="comment">// 同时，我们建议将内容包裹在括号中，虽然这样做不是强制要求的，但是这可以避免遇到自动插入分号陷阱。</span></span><br><span class="line"><span class="keyword">const</span> app = (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    你好，</span></span><br><span class="line"><span class="language-xml">    &#123; formatUser(user) &#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line">root.<span class="title function_">render</span>(app)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>jsx也是一个表达式</strong></p><p>在编译之后，JSX 表达式会被转为普通 JavaScript 函数调用，并且对其取值后得到 JavaScript 对象。</p><p>也就是说，你可以在 <code>if</code> 语句和 <code>for</code> 循环的代码块中使用 JSX，将 JSX 赋值给变量，把 JSX 当作参数传入，以及从函数中返回 JSX</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="comment">// react 18版本写法</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const name = &lt;h1&gt;千锋HTML5大前端，前端培训界的扛把子！&lt;/h1&gt;</span></span><br><span class="line"><span class="comment">// const app = &lt;div&gt;你好, &#123; name &#125;&lt;/div&gt; // js 变量加&#123;&#125; 变 react</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">formatUser</span> (user) &#123;</span><br><span class="line">  <span class="keyword">return</span> user.<span class="property">firstName</span> + user.<span class="property">lastName</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="string">&#x27;吴&#x27;</span>,</span><br><span class="line">  <span class="attr">lastName</span>: <span class="string">&#x27;大勋&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 为了便于阅读，我们会将 JSX 拆分为多行。</span></span><br><span class="line"><span class="comment">// 同时，我们建议将内容包裹在括号中，虽然这样做不是强制要求的，但是这可以避免遇到自动插入分号陷阱。</span></span><br><span class="line"><span class="comment">// const app = (</span></span><br><span class="line"><span class="comment">//   &lt;div&gt;</span></span><br><span class="line"><span class="comment">//     你好，</span></span><br><span class="line"><span class="comment">//     &#123; formatUser(user) &#125;</span></span><br><span class="line"><span class="comment">//   &lt;/div&gt;</span></span><br><span class="line"><span class="comment">// )</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getGreeting</span> (user) &#123;</span><br><span class="line">  <span class="keyword">if</span> (user) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        你好，</span></span><br><span class="line"><span class="language-xml">        &#123; formatUser(user) &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>hello error<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const app = getGreeting()</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">getGreeting</span>(user)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line">root.<span class="title function_">render</span>(app)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>因为 JSX 语法上更接近 JavaScript 而不是 HTML，所以 React DOM 使用 <code>camelCase</code>（小驼峰命名）来定义属性的名称，而不使用 HTML 属性名称的命名约定。</p><p>例如，JSX 里的 <code>class</code> 变成了 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/className"><code>className</code></a>，而 <code>tabindex</code> 则变为 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/tabIndex"><code>tabIndex</code></a>。</p></blockquote><p>Babel 会把 JSX 转译成一个名为 <code>React.createElement()</code> 函数调用。</p><blockquote><p>上述代码都没见到使用过 React 模块，但是显示却用了，为什么？</p></blockquote><h2 id="3-2-React-createElement"><a href="#3-2-React-createElement" class="headerlink" title="3.2 React.createElement"></a>3.2 React.createElement</h2><p>先看一个代码</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 因为 JSX 语法上更接近 JavaScript 而不是 HTML，</span></span><br><span class="line"><span class="comment">// 所以 React DOM 使用 `camelCase`（小驼峰命名）来定义属性的名称，</span></span><br><span class="line"><span class="comment">// 而不使用 HTML 属性名称的命名约定。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 例如，JSX 里的 `class` 变成了 className</span></span><br><span class="line"><span class="comment">// class 在React中被看做了关键字</span></span><br><span class="line"><span class="comment">// const app = (</span></span><br><span class="line"><span class="comment">//   &lt;div className=&#x27;box&#x27;&gt;</span></span><br><span class="line"><span class="comment">//     hello react</span></span><br><span class="line"><span class="comment">//   &lt;/div&gt;</span></span><br><span class="line"><span class="comment">// )</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ？为什么react模块被显示使用了</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>, &#123; <span class="attr">className</span>: <span class="string">&#x27;box&#x27;</span> &#125;, <span class="string">&#x27;hello react ！！！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line">root.<span class="title function_">render</span>(app)</span><br></pre></td></tr></table></figure><p><code>React.createElement()</code> 会预先执行一些检查，以帮助你编写无错代码，但实际上它创建了一个这样的对象：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注意：这是简化过的结构</span></span><br><span class="line"><span class="keyword">const</span> element = &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;div&#x27;</span>,</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">className</span>: <span class="string">&#x27;box&#x27;</span>,</span><br><span class="line">    <span class="attr">children</span>: <span class="string">&#x27;hello react&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这些对象被称为 “React 元素”。它们描述了你希望在屏幕上看到的内容。React 通过读取这些对象，然后使用它们来构建 DOM 以及保持随时更新。</p><h1 id="四、组件定义"><a href="#四、组件定义" class="headerlink" title="四、组件定义"></a>四、组件定义</h1><p>组件允许你将 UI 拆分为独立可复用的代码片段，并对每个片段进行独立构思。</p><p>组件，从概念上类似于 JavaScript 函数。它接受任意的入参（即 “props”），并返回用于描述页面展示内容的 React 元素。</p><h2 id="4-1-类组件"><a href="#4-1-类组件" class="headerlink" title="4.1 类组件"></a>4.1 类组件</h2><p>ES6的加入让JavaScript直接支持使用class来定义一个类，react的创建类组件的方式就是使用的类的继承，<code>ES6 class</code>是一种使用React组件的写法，它使用了ES6标准语法来构建</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 类的首字母必须大写</span></span><br><span class="line"><span class="comment">// 组件的首字母必须大写</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// render函数是 类组件必须实现的一个 方法，同时也是react 类组件唯一一个必不可少的方法</span></span><br><span class="line">  <span class="comment">// 在render函数内部一定要返回 jsx 代码（也可以写React.createElement）</span></span><br><span class="line">  <span class="comment">// 如果jsx代码足够复杂，记得使用()包裹jsx代码</span></span><br><span class="line">  <span class="comment">// render 函数是react 类组件的生命周期的钩子函数</span></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>hello react class component<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以标签的形式渲染组件</span></span><br><span class="line"><span class="comment">// ？ 也说明了为什么组件的首字母要大写</span></span><br><span class="line"><span class="comment">// 小写被当作固有的HTML标签</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><h2 id="4-2-函数组件"><a href="#4-2-函数组件" class="headerlink" title="4.2 函数组件"></a>4.2 函数组件</h2><p>定义组件最简单的方式就是编写 JavaScript 函数</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件首字母必须大写</span></span><br><span class="line"><span class="comment">// function App () &#123;</span></span><br><span class="line"><span class="comment">//   return (</span></span><br><span class="line"><span class="comment">//     &lt;div&gt; hello react function component &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//   )</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const App = function () &#123;</span></span><br><span class="line"><span class="comment">//   return (</span></span><br><span class="line"><span class="comment">//     &lt;div&gt; hello react function component &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//   )</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const App = () =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   return (</span></span><br><span class="line"><span class="comment">//     &lt;div&gt; hello react function component &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//   )</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span> hello react function component <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><h2 id="4-3-两组组件的区别"><a href="#4-3-两组组件的区别" class="headerlink" title="4.3 两组组件的区别"></a>4.3 两组组件的区别</h2><ul><li>组件的定义方式不同。</li><li>生命周期不同：类组件有，函数式组件没有。</li><li>副作用操作执行不同：class组件通过生命周期函数，函数组件用hook的useEffect。</li><li>state的定义、读取、修改方式不同：函数组件用hook的useState。</li><li>this： class组件有，函数式组件没有。</li><li>实例： class组件有，函数时组件没有。</li><li>ref使用不同：类组件可以获取子组件实例，函数式组件不可以，因为函数式组件没有实例。</li></ul><blockquote><p>官方推荐使用函数式组件,以上不同点虽然现在不明白是啥意思，没有关系，会随着大家的学习印象加深。</p></blockquote><h1 id="五、Props"><a href="#五、Props" class="headerlink" title="五、Props"></a>五、Props</h1><h2 id="5-1-Props详解"><a href="#5-1-Props详解" class="headerlink" title="5.1 Props详解"></a>5.1 Props详解</h2><p><code>props</code>是正常是外部传入的，组件内部也可以通过一些方式来初始化的设置，属性不能被组件自己更改，但是你可以通过父组件主动重新渲染的方式来传入新的 <code>props</code></p><p>React 非常灵活，但它也有一个严格的规则：</p><p><strong>所有 React 组件都必须像纯函数一样保护它们的 props 不被更改。</strong></p><blockquote><p>纯函数：输入一定，输出一定确定</p></blockquote><p>总的来说，在使用一个组件的时候，可以把参数放在标签的属性当中，所有的属性都会作为组件 <code>props</code> 对象的键值。</p><p>通过箭头函数创建的组件，需要通过函数的参数来接收<code>props</code></p><p>通过类创建的组件，需要通过 <code>this.props</code>来接收</p><p>组件可以在其输出中引用其他组件。</p><p>这就可以让我们用同一组件来抽象出任意层次的细节。</p><p>按钮，表单，对话框，甚至整个屏幕的内容：在 React 应用程序中，这些通常都会以组件的形式表示。</p><h2 id="5-2-父子组件通信"><a href="#5-2-父子组件通信" class="headerlink" title="5.2 父子组件通信"></a>5.2 父子组件通信</h2><h3 id="5-2-1-构建一个父子组件"><a href="#5-2-1-构建一个父子组件" class="headerlink" title="5.2.1 构建一个父子组件"></a>5.2.1 构建一个父子组件</h3><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./01_props/01_Parent_Child&#x27;</span> <span class="comment">// 省略.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/01_props/01_Parent_Child.jsx</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/01_props/01_Parent_Child.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>子组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>父组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>父子组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Parent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure><h3 id="5-2-2-父组件给子组件传值"><a href="#5-2-2-父组件给子组件传值" class="headerlink" title="5.2.2 父组件给子组件传值"></a>5.2.2 父组件给子组件传值</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./01_props/02_Parent_Child_value&#x27;</span> <span class="comment">// 父组件给子组件传值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/01_props/02_Parent_Chil_value.jsx</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/01_props/02_Parent_Chil_value.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="comment">// 父组件在调用子组件的地方，添加自定义的属性，</span></span><br><span class="line"><span class="comment">// 如果属性的值是变量，boolean类型，number类型，对象，数组，null，undefined，函数，</span></span><br><span class="line"><span class="comment">// 需要使用&#123;&#125;包裹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果子组件是类组件，可以通过 this.props 访问到父组件传递的值</span></span><br><span class="line"><span class="comment">// 如果子组件是函数式组件，可以通过 函数的默认参数 props 访问到父组件传递的值</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Child2</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;props2&#x27;</span>, props)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>子组件2<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>str的值为&#123; props.str &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>flag的值为&#123; props.flag + &#x27;&#x27;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>num的值为&#123; props.num &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>obj的a值为&#123; props.obj.a &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>arr的值为&#123; props.arr &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;props1&quot;</span>, <span class="variable language_">this</span>.<span class="property">props</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>子组件1<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>str的值为&#123; this.props.str &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>flag的值为&#123; this.props.flag + &#x27;&#x27;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>num的值为&#123; this.props.num &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>obj的a值为&#123; this.props.obj.a &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>arr的值为&#123; this.props.arr &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">const</span> str = <span class="string">&quot;hello world&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>父组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child1</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">str</span> = <span class="string">&#123;</span> <span class="attr">str</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">flag</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">num</span> = <span class="string">&#123;</span> <span class="attr">100</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">obj</span> = <span class="string">&#123;</span> &#123; <span class="attr">a:</span> <span class="attr">1</span>, <span class="attr">b:</span> <span class="attr">2</span> &#125; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">arr</span> = <span class="string">&#123;</span> [&#x27;<span class="attr">a</span>&#x27;, &#x27;<span class="attr">b</span>&#x27;, &#x27;<span class="attr">c</span>&#x27;] &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child2</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">str</span> = <span class="string">&#123;</span> <span class="attr">str</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">flag</span> = <span class="string">&#123;</span> <span class="attr">false</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">num</span> = <span class="string">&#123;</span> <span class="attr">10000</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">obj</span> = <span class="string">&#123;</span> &#123; <span class="attr">a:</span> <span class="attr">10</span>, <span class="attr">b:</span> <span class="attr">20</span> &#125; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">arr</span> = <span class="string">&#123;</span> [&#x27;<span class="attr">aa</span>&#x27;, &#x27;<span class="attr">bb</span>&#x27;, &#x27;<span class="attr">cc</span>&#x27;] &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>父子组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Parent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure><h3 id="5-2-3-父组件给子组件传值设置默认值"><a href="#5-2-3-父组件给子组件传值设置默认值" class="headerlink" title="5.2.3 父组件给子组件传值设置默认值"></a>5.2.3 父组件给子组件传值设置默认值</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./01_props/03_Parent_Child_default&#x27;</span> <span class="comment">// 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/01_props/03_Parent_Chil_default.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/01_props/03_Parent_Chil_default.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="comment">// 父组件在调用子组件的地方，添加自定义的属性，</span></span><br><span class="line"><span class="comment">// 如果属性的值是变量，boolean类型，number类型，对象，数组，null，undefined，函数，</span></span><br><span class="line"><span class="comment">// 需要使用&#123;&#125;包裹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果子组件是类组件，可以通过 this.props 访问到父组件传递的值</span></span><br><span class="line"><span class="comment">// 如果子组件是函数式组件，可以通过 函数的默认参数 props 访问到父组件传递的值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果子组件是函数式组件，就在组件定义之后通过 组件.defaultProps 设置默认值</span></span><br><span class="line"><span class="comment">// 如果子组件是类组件，其中一种方式就在组件定义之后通过 组件.defaultProps 设置默认值</span></span><br><span class="line"><span class="comment">// 如果子组件是类组件, 另一种方式就是在定义子组件时，通过类的静态属性设置 defaultProps</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Child2</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;props2&#x27;</span>, props)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>子组件2<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>str的值为&#123; props.str &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>flag的值为&#123; props.flag + &#x27;&#x27;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>num的值为&#123; props.num &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>obj的a值为&#123; props.obj.a &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>arr的值为&#123; props.arr &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Child2</span>.<span class="property">defaultProps</span> = &#123;</span><br><span class="line">  <span class="attr">str</span>: <span class="string">&#x27;hello react function&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">    <span class="attr">str</span>: <span class="string">&#x27;hello react static props&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;props1&quot;</span>, <span class="variable language_">this</span>.<span class="property">props</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>子组件1<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>str的值为&#123; this.props.str &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>flag的值为&#123; this.props.flag + &#x27;&#x27;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>num的值为&#123; this.props.num &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>obj的a值为&#123; this.props.obj.a &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>arr的值为&#123; this.props.arr &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Child1.defaultProps = &#123;</span></span><br><span class="line"><span class="comment">//   str: &#x27;hello react class&#x27;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">const</span> str = <span class="string">&quot;hello world&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>父组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child1</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">str</span> = <span class="string">&#123;</span> <span class="attr">str</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">flag</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">num</span> = <span class="string">&#123;</span> <span class="attr">100</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">obj</span> = <span class="string">&#123;</span> &#123; <span class="attr">a:</span> <span class="attr">1</span>, <span class="attr">b:</span> <span class="attr">2</span> &#125; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">arr</span> = <span class="string">&#123;</span> [&#x27;<span class="attr">a</span>&#x27;, &#x27;<span class="attr">b</span>&#x27;, &#x27;<span class="attr">c</span>&#x27;] &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child2</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">flag</span> = <span class="string">&#123;</span> <span class="attr">false</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">num</span> = <span class="string">&#123;</span> <span class="attr">10000</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">obj</span> = <span class="string">&#123;</span> &#123; <span class="attr">a:</span> <span class="attr">10</span>, <span class="attr">b:</span> <span class="attr">20</span> &#125; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">arr</span> = <span class="string">&#123;</span> [&#x27;<span class="attr">aa</span>&#x27;, &#x27;<span class="attr">bb</span>&#x27;, &#x27;<span class="attr">cc</span>&#x27;] &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>父子组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Parent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure><h3 id="5-2-4-使用prop-types属性验证"><a href="#5-2-4-使用prop-types属性验证" class="headerlink" title="5.2.4 使用prop-types属性验证"></a>5.2.4 使用prop-types属性验证</h3><blockquote><p>自 React v15.5 起，<code>React.PropTypes</code> 已移入另一个包中。请使用 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/prop-types"><code>prop-types</code> 库</a> 代替。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i prop-types -D</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">MyComponent</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line"><span class="comment">// 你可以将属性声明为 JS 原生类型，默认情况下</span></span><br><span class="line"><span class="comment">// 这些属性都是可选的。</span></span><br><span class="line"><span class="attr">optionalArray</span>: <span class="title class_">PropTypes</span>.<span class="property">array</span>,</span><br><span class="line"><span class="attr">optionalBool</span>: <span class="title class_">PropTypes</span>.<span class="property">bool</span>,</span><br><span class="line"><span class="attr">optionalFunc</span>: <span class="title class_">PropTypes</span>.<span class="property">func</span>,</span><br><span class="line"><span class="attr">optionalNumber</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line"><span class="attr">optionalObject</span>: <span class="title class_">PropTypes</span>.<span class="property">object</span>,</span><br><span class="line"><span class="attr">optionalString</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>,</span><br><span class="line"><span class="attr">optionalSymbol</span>: <span class="title class_">PropTypes</span>.<span class="property">symbol</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 任何可被渲染的元素（包括数字、字符串、元素或数组）</span></span><br><span class="line"><span class="comment">// (或 Fragment) 也包含这些类型。</span></span><br><span class="line"><span class="attr">optionalNode</span>: <span class="title class_">PropTypes</span>.<span class="property">node</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 一个 React 元素。</span></span><br><span class="line"><span class="attr">optionalElement</span>: <span class="title class_">PropTypes</span>.<span class="property">element</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 一个 React 元素类型（即，MyComponent）。</span></span><br><span class="line"><span class="attr">optionalElementType</span>: <span class="title class_">PropTypes</span>.<span class="property">elementType</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你也可以声明 prop 为类的实例，这里使用</span></span><br><span class="line"><span class="comment">// JS 的 instanceof 操作符。</span></span><br><span class="line"><span class="attr">optionalMessage</span>: <span class="title class_">PropTypes</span>.<span class="title function_">instanceOf</span>(<span class="title class_">Message</span>),</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你可以让你的 prop 只能是特定的值，指定它为</span></span><br><span class="line"><span class="comment">// 枚举类型。</span></span><br><span class="line"><span class="attr">optionalEnum</span>: <span class="title class_">PropTypes</span>.<span class="title function_">oneOf</span>([<span class="string">&#x27;News&#x27;</span>, <span class="string">&#x27;Photos&#x27;</span>]),</span><br><span class="line"></span><br><span class="line"><span class="comment">// 一个对象可以是几种类型中的任意一个类型</span></span><br><span class="line"><span class="attr">optionalUnion</span>: <span class="title class_">PropTypes</span>.<span class="title function_">oneOfType</span>([</span><br><span class="line"> <span class="title class_">PropTypes</span>.<span class="property">string</span>,</span><br><span class="line"> <span class="title class_">PropTypes</span>.<span class="property">number</span>,</span><br><span class="line"> <span class="title class_">PropTypes</span>.<span class="title function_">instanceOf</span>(<span class="title class_">Message</span>)</span><br><span class="line">]),</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以指定一个数组由某一类型的元素组成</span></span><br><span class="line"><span class="attr">optionalArrayOf</span>: <span class="title class_">PropTypes</span>.<span class="title function_">arrayOf</span>(<span class="title class_">PropTypes</span>.<span class="property">number</span>),</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以指定一个对象由某一类型的值组成</span></span><br><span class="line"><span class="attr">optionalObjectOf</span>: <span class="title class_">PropTypes</span>.<span class="title function_">objectOf</span>(<span class="title class_">PropTypes</span>.<span class="property">number</span>),</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以指定一个对象由特定的类型值组成</span></span><br><span class="line"><span class="attr">optionalObjectWithShape</span>: <span class="title class_">PropTypes</span>.<span class="title function_">shape</span>(&#123;</span><br><span class="line"> <span class="attr">color</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>,</span><br><span class="line"> <span class="attr">fontSize</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span></span><br><span class="line">&#125;),</span><br><span class="line"></span><br><span class="line"><span class="comment">// An object with warnings on extra properties</span></span><br><span class="line"><span class="attr">optionalObjectWithStrictShape</span>: <span class="title class_">PropTypes</span>.<span class="title function_">exact</span>(&#123;</span><br><span class="line"> <span class="attr">name</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>,</span><br><span class="line"> <span class="attr">quantity</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span></span><br><span class="line">&#125;),</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你可以在任何 PropTypes 属性后面加上 `isRequired` ，确保</span></span><br><span class="line"><span class="comment">// 这个 prop 没有被提供时，会打印警告信息。</span></span><br><span class="line"><span class="attr">requiredFunc</span>: <span class="title class_">PropTypes</span>.<span class="property">func</span>.<span class="property">isRequired</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 任意类型的必需数据</span></span><br><span class="line"><span class="attr">requiredAny</span>: <span class="title class_">PropTypes</span>.<span class="property">any</span>.<span class="property">isRequired</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你可以指定一个自定义验证器。它在验证失败时应返回一个 Error 对象。</span></span><br><span class="line"><span class="comment">// 请不要使用 `console.warn` 或抛出异常，因为这在 `oneOfType` 中不会起作用。</span></span><br><span class="line"><span class="attr">customProp</span>: <span class="keyword">function</span>(<span class="params">props, propName, componentName</span>) &#123;</span><br><span class="line"> <span class="keyword">if</span> (!<span class="regexp">/matchme/</span>.<span class="title function_">test</span>(props[propName])) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Error</span>(</span><br><span class="line">     <span class="string">&#x27;Invalid prop `&#x27;</span> + propName + <span class="string">&#x27;` supplied to&#x27;</span> +</span><br><span class="line">     <span class="string">&#x27; `&#x27;</span> + componentName + <span class="string">&#x27;`. Validation failed.&#x27;</span></span><br><span class="line">   );</span><br><span class="line"> &#125;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你也可以提供一个自定义的 `arrayOf` 或 `objectOf` 验证器。</span></span><br><span class="line"><span class="comment">// 它应该在验证失败时返回一个 Error 对象。</span></span><br><span class="line"><span class="comment">// 验证器将验证数组或对象中的每个值。验证器的前两个参数</span></span><br><span class="line"><span class="comment">// 第一个是数组或对象本身</span></span><br><span class="line"><span class="comment">// 第二个是他们当前的键。</span></span><br><span class="line"><span class="attr">customArrayProp</span>: <span class="title class_">PropTypes</span>.<span class="title function_">arrayOf</span>(<span class="keyword">function</span>(<span class="params">propValue, key, componentName, location, propFullName</span>) &#123;</span><br><span class="line"> <span class="keyword">if</span> (!<span class="regexp">/matchme/</span>.<span class="title function_">test</span>(propValue[key])) &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Error</span>(</span><br><span class="line">     <span class="string">&#x27;Invalid prop `&#x27;</span> + propFullName + <span class="string">&#x27;` supplied to&#x27;</span> +</span><br><span class="line">     <span class="string">&#x27; `&#x27;</span> + componentName + <span class="string">&#x27;`. Validation failed.&#x27;</span></span><br><span class="line">   );</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./01_props/04_Parent-Child_type&#x27;</span> <span class="comment">// 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/01_props/04_Parent_Chil_type.jsx</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/01_props/04_Parent_Chil_type.jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="comment">// 父组件在调用子组件的地方，添加自定义的属性，</span></span><br><span class="line"><span class="comment">// 如果属性的值是变量，boolean类型，number类型，对象，数组，null，undefined，函数，</span></span><br><span class="line"><span class="comment">// 需要使用&#123;&#125;包裹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果子组件是类组件，可以通过 this.props 访问到父组件传递的值</span></span><br><span class="line"><span class="comment">// 如果子组件是函数式组件，可以通过 函数的默认参数 props 访问到父组件传递的值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果子组件是函数式组件，就在组件定义之后通过 组件.defaultProps 设置默认值</span></span><br><span class="line"><span class="comment">// 如果子组件是类组件，其中一种方式就在组件定义之后通过 组件.defaultProps 设置默认值</span></span><br><span class="line"><span class="comment">// 如果子组件是类组件, 另一种方式就是在定义子组件时，通过类的静态属性设置 defaultProps</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果需要给子组件的值设置数据类型的校验，通过第三方的 prop-types 来完成</span></span><br><span class="line"><span class="comment">// 定义好组件之后， 通过 组件.propTypes 设置</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Child2</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;props2&#x27;</span>, props)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>子组件2<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>str的值为&#123; props.str &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>flag的值为&#123; props.flag + &#x27;&#x27;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>num的值为&#123; props.num &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>obj的a值为&#123; props.obj.a &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>arr的值为&#123; props.arr &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Child2</span>.<span class="property">defaultProps</span> = &#123;</span><br><span class="line">  <span class="attr">str</span>: <span class="string">&#x27;hello react function&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Child2</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line">  <span class="attr">str</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span>, <span class="comment">// 该属性必须传递，但是只要设置了默认值，即可不传（vue即使设置默认值，但是还需要传递值）</span></span><br><span class="line">  <span class="attr">flag</span>: <span class="title class_">PropTypes</span>.<span class="property">bool</span>,</span><br><span class="line">  <span class="comment">// num: PropTypes.string,</span></span><br><span class="line">  <span class="comment">// num: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired, // 多个类型</span></span><br><span class="line">  <span class="attr">obj</span>: <span class="title class_">PropTypes</span>.<span class="property">object</span>,</span><br><span class="line">  <span class="attr">arr</span>: <span class="title class_">PropTypes</span>.<span class="property">array</span>,</span><br><span class="line">  <span class="attr">num</span>: <span class="keyword">function</span> (<span class="params">props, propName, componentName</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(props)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(propName)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(componentName)</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> props[propName] !== <span class="string">&#x27;number&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;请传入number类型数据&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (props[propName] &lt; <span class="number">1000</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;出错了&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">    <span class="attr">str</span>: <span class="string">&#x27;hello react static props&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;props1&quot;</span>, <span class="variable language_">this</span>.<span class="property">props</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>子组件1<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>str的值为&#123; this.props.str &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>flag的值为&#123; this.props.flag + &#x27;&#x27;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>num的值为&#123; this.props.num &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>obj的a值为&#123; this.props.obj.a &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>arr的值为&#123; this.props.arr &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Child1.defaultProps = &#123;</span></span><br><span class="line"><span class="comment">//   str: &#x27;hello react class&#x27;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">const</span> str = <span class="string">&quot;hello world&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>父组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child1</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">str</span> = <span class="string">&#123;</span> <span class="attr">str</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">flag</span> = <span class="string">&#123;</span> <span class="attr">true</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">num</span> = <span class="string">&#123;</span> <span class="attr">100</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">obj</span> = <span class="string">&#123;</span> &#123; <span class="attr">a:</span> <span class="attr">1</span>, <span class="attr">b:</span> <span class="attr">2</span> &#125; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">arr</span> = <span class="string">&#123;</span> [&#x27;<span class="attr">a</span>&#x27;, &#x27;<span class="attr">b</span>&#x27;, &#x27;<span class="attr">c</span>&#x27;] &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child2</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">flag</span> = <span class="string">&#123;</span> <span class="attr">false</span> &#125; </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">num</span> =  <span class="string">&#x27;100&#x27;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">obj</span> = <span class="string">&#123;</span> &#123; <span class="attr">a:</span> <span class="attr">10</span>, <span class="attr">b:</span> <span class="attr">20</span> &#125; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">arr</span> = <span class="string">&#123;</span> [&#x27;<span class="attr">aa</span>&#x27;, &#x27;<span class="attr">bb</span>&#x27;, &#x27;<span class="attr">cc</span>&#x27;] &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>父子组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Parent</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure><h2 id="5-3-props-children"><a href="#5-3-props-children" class="headerlink" title="5.3 props.children"></a>5.3 props.children</h2><p>我们知道使用组件的时候，可以嵌套。要在自定义组件中使用嵌套结构，就需要使用 <code>props.children</code> 。</p><p>等同于 vue中的 slot 插槽</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./01_props/05_App_props_children&#x27;</span> <span class="comment">// 类插槽</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/01_props/05_App_props_children.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// props.children 可以看作是类似于vue中的slot</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Content</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123; props.children &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Header</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">header</span>&gt;</span>&#123; this.props.children &#125;<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Header</span>&gt;</span>这里是首页头部<span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Content</span>&gt;</span>这里是首页内容<span class="tag">&lt;/<span class="name">Content</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Header</span>&gt;</span>这里是分类头部<span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Content</span>&gt;</span>这里是分类内容<span class="tag">&lt;/<span class="name">Content</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p>如果需要给组件添加多个元素，并且显示在多个位置，可以如下设置：</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./01_props/06_App_mutiple_props_children&#x27;</span> <span class="comment">// 类具名插槽（多个插槽）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/01_props/06_App_mutiple_props_children.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 以数组的下标决定显示的位置</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Header</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(props.<span class="property">children</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; props.children[0] &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; props.children[1] &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; props.children[2] &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span>城市<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span>产品名称<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span>更多<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>实现类似vue的具名插槽，需要通过 props.children 的下标去访问</p></blockquote><h2 id="5-4-render-props特性"><a href="#5-4-render-props特性" class="headerlink" title="5.4 render props特性"></a>5.4 render props特性</h2><blockquote><p>使用 Render Props 来解决横切关注点（Cross-Cutting Concerns）</p></blockquote><p>组件是 React 代码复用的主要单元，但如何将一个组件封装的状态或行为共享给其他需要相同状态的组件并不总是显而易见。</p><p>以下组件跟踪 Web 应用程序中的鼠标位置:</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./01_props/07_App_mouse_tracker&#x27;</span> <span class="comment">// 鼠标跟随</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/01_props/07_App_mouse_tracker.jsx</code></p><blockquote><p>还没有学习状态state以及事件处理，这里先用</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="comment">// 初始化状态</span></span><br><span class="line">    <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// style 写为对象，对象使用 &#123;&#125; 包裹</span></span><br><span class="line">    <span class="comment">// onMouseMove 事件，使用小驼峰式命名，函数使用 &#123;&#125; 包裹，函数默认参数为event事件对象</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">width:</span> &#x27;<span class="attr">100vw</span>&#x27;, <span class="attr">height:</span> &#x27;<span class="attr">100vh</span>&#x27; &#125; &#125; <span class="attr">onMouseMove</span> = <span class="string">&#123;</span> (<span class="attr">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        // 修改状态 --  不要使用赋值表达式</span></span><br><span class="line"><span class="language-xml">        this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">          x: event.clientX,</span></span><br><span class="line"><span class="language-xml">          y: event.clientY</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125; &#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>鼠标位置：(&#123; this.state.x &#125;, &#123; this.state.y &#125;)<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>当光标在屏幕上移动时，组件在 <code>&lt;p&gt;</code> 中显示其坐标。</p><p>现在的问题是：我们如何在另一个组件中复用这个行为？换个说法，若另一个组件需要知道鼠标位置，我们能否封装这一行为，以便轻松地与其他组件共享它？</p></blockquote><p><strong>render prop 是一个用于告知组件需要渲染什么内容的函数 prop。</strong></p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./01_props/08_App_render_props&#x27;</span> <span class="comment">// 渲染属性 - 其他组件共享状态</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/01_props/08_App_render_props.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 渲染属性共享组件的状态</span></span><br><span class="line"><span class="comment">// 在调用需要共享的组件（Mouse）上，添加一个render的自定义属性，该属性是一个自定义函数</span></span><br><span class="line"><span class="comment">// 在自定义函数的内部返回需要共享给的那个组件（Cat）</span></span><br><span class="line"><span class="comment">// 在需要共享的组件（Mouse）内部，通过 this.props.render() 或者 props.render() 即可调用，参数即为需要共享的状态</span></span><br><span class="line"><span class="comment">// 那么在定义自定义render属性的函数内部，就会接收到 参数，通过返回的组件（Cat）传递该参数即可</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Cat</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>cat鼠标位置：(&#123; props.point.x &#125;, &#123; props.point.y &#125;)<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Dog</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Dog鼠标位置：(&#123; props.point.x &#125;, &#123; props.point.y &#125;)<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Mouse</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="comment">// 初始化状态</span></span><br><span class="line">    <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// style 写为对象，对象使用 &#123;&#125; 包裹</span></span><br><span class="line">    <span class="comment">// onMouseMove 事件，使用小驼峰式命名，函数使用 &#123;&#125; 包裹，函数默认参数为event事件对象</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">width:</span> &#x27;<span class="attr">100vw</span>&#x27;, <span class="attr">height:</span> &#x27;<span class="attr">50vh</span>&#x27; &#125; &#125; <span class="attr">onMouseMove</span> = <span class="string">&#123;</span> (<span class="attr">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        // 修改状态 --  不要使用赋值表达式</span></span><br><span class="line"><span class="language-xml">        this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">          x: event.clientX,</span></span><br><span class="line"><span class="language-xml">          y: event.clientY</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">        </span></span><br><span class="line"><span class="language-xml">      &#125; &#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>mouse鼠标位置：(&#123; this.state.x &#125;, &#123; this.state.y &#125;)<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; this.props.render(this.state) &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* <span class="tag">&lt;<span class="name">Mouse</span> <span class="attr">render</span> = <span class="string">&#123;</span> (<span class="attr">point</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">Cat</span> <span class="attr">point</span> = <span class="string">&#123;</span> <span class="attr">point</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Cat</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125; &#125;&gt;<span class="tag">&lt;/<span class="name">Mouse</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Mouse</span> <span class="attr">render</span> = <span class="string">&#123;</span> (<span class="attr">point</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return <span class="tag">&lt;<span class="name">Dog</span> <span class="attr">point</span> = <span class="string">&#123;</span> <span class="attr">point</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Dog</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125; &#125;&gt;<span class="tag">&lt;/<span class="name">Mouse</span>&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Mouse</span> <span class="attr">render</span> = <span class="string">&#123;</span> (<span class="attr">point</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Cat</span> <span class="attr">point</span> = <span class="string">&#123;</span> <span class="attr">point</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Cat</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Dog</span> <span class="attr">point</span> = <span class="string">&#123;</span> <span class="attr">point</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Dog</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;<span class="tag">&lt;/<span class="name">Mouse</span>&gt;</span></span></span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>此案例实际上完成了react中子组件给父组件传值</p></blockquote><h1 id="六、State"><a href="#六、State" class="headerlink" title="六、State"></a>六、State</h1><p><code>state</code> 是 <code>class</code>组件的内置对象，用于class组件内部数据更新</p><p><code>state</code>就是组件描述某种显示情况的数据，由组件自己设置和更改，也就是说由组件自己维护，使用<code>state</code>的目的就是为了在不同的状态下使组件的显示不同(自己管理)</p><h2 id="6-1-state及其特点"><a href="#6-1-state及其特点" class="headerlink" title="6.1 state及其特点"></a>6.1 state及其特点</h2><p>State 与 props 类似，但是 state 是私有的，并且完全受控于当前组件</p><p>不要直接修改state</p><p>state更新可能是异步的：出于性能考虑，React 可能会把多个 <code>setState()</code> 调用合并成一个调用。</p><p>state更新会被合并：当你调用 <code>setState()</code> 的时候，React 会把你提供的对象合并到当前的 state</p><h2 id="6-2-state的定义和使用"><a href="#6-2-state的定义和使用" class="headerlink" title="6.2 state的定义和使用"></a>6.2 state的定义和使用</h2><p>目前react中的状态有两种使用方式：</p><h3 id="6-2-1-es6的类-构造函数"><a href="#6-2-1-es6的类-构造函数" class="headerlink" title="6.2.1 es6的类 - 构造函数"></a>6.2.1 es6的类 - 构造函数</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./02_state/01_App_state_es6&#x27;</span> <span class="comment">// es6 构造函数 初始化状态</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/02_state/01_App_state_es6.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ES6 规定，子类必须在constructor()方法中调用super()，否则就会报错。</span></span><br><span class="line"><span class="comment">这是因为子类自己的this对象，必须先通过父类的构造函数完成塑造，</span></span><br><span class="line"><span class="comment">得到与父类同样的实例属性和方法，然后再对其进行加工，添加子类自己的实例属性和方法。</span></span><br><span class="line"><span class="comment">如果不调用super()方法，子类就得不到自己的this对象。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> ES5 的继承机制，是先创造一个独立的子类的实例对象，</span></span><br><span class="line"><span class="comment"> 然后再将父类的方法添加到这个对象上面，即“实例在前，继承在后”。</span></span><br><span class="line"><span class="comment"> ES6 的继承机制，则是先将父类的属性和方法，加到一个空的对象上面，</span></span><br><span class="line"><span class="comment"> 然后再将该对象作为子类的实例，即“继承在前，实例在后”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// constructor (props) &#123; //  Useless constructor </span></span><br><span class="line">  <span class="comment">//   super(props)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span> (props) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        当前时间为：&#123; this.state.date.toLocaleDateString() +  this.state.date.toLocaleTimeString() &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h3 id="6-2-2-es7的类-属性初始化器"><a href="#6-2-2-es7的类-属性初始化器" class="headerlink" title="6.2.2 es7的类 - 属性初始化器"></a>6.2.2 es7的类 - 属性初始化器</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./02_state/02_App_state_es7&#x27;</span> <span class="comment">// es7 属性初始化器 初始化状态</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/02_state/02_App_state_es7.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line"></span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        当前时间为：&#123; this.state.date.toLocaleDateString() +  this.state.date.toLocaleTimeString() &#125;!!</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="6-3-如何正确的修改state"><a href="#6-3-如何正确的修改state" class="headerlink" title="6.3 如何正确的修改state"></a>6.3 如何正确的修改state</h2><p><code>setState()</code> 将对组件 state 的更改排入队列，并通知 React 需要使用更新后的 state 重新渲染此组件及其子组件。这是用于更新用户界面以响应事件处理器和处理服务器数据的主要方式.</p><p>将 <code>setState()</code> 视为<em>请求</em>而不是立即更新组件的命令。为了更好的感知性能，React 会延迟调用它，然后通过一次传递更新多个组件。</p><p><code>setState()</code> 并不总是立即更新组件。它会批量推迟更新。这使得在调用 <code>setState()</code> 后立即读取 <code>this.state</code> 成为了隐患。为了消除隐患，请使用 <code>componentDidUpdate</code> 或者 <code>setState</code> 的回调函数（<code>setState(updater, callback)</code>），这两种方式都可以保证在应用更新后触发。</p><p>记住修改状态的三大原则：</p><ul><li>不要直接修改 State</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">state = &#123; <span class="attr">a</span>: <span class="number">10</span> &#125;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">a</span> = <span class="number">100</span> <span class="comment">// ❌</span></span><br></pre></td></tr></table></figure><ul><li>state 的更新可能是异步的</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">state = &#123; <span class="attr">a</span>: <span class="number">10</span> &#125;</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;<span class="attr">a</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">a</span> + <span class="number">1</span> &#125;)</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;<span class="attr">a</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">a</span> + <span class="number">1</span> &#125;)</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;<span class="attr">a</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">a</span> + <span class="number">1</span> &#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">a</span>) <span class="comment">// 10</span></span><br></pre></td></tr></table></figure><ul><li>state 的更新会被合并</li></ul><h2 id="6-4-this-setState-方法及其特点"><a href="#6-4-this-setState-方法及其特点" class="headerlink" title="6.4 this.setState()方法及其特点"></a>6.4 this.setState()方法及其特点</h2><p><code>setState()</code> 会对一个组件的 <code>state</code> 对象安排一次更新。当 state 改变了，该组件就会重新渲染。</p><p><code>setState()</code>可以添加两个参数,</p><p><code>setState()</code> 的第二个参数为可选的回调函数，它将在 <code>setState</code> 完成合并并重新渲染组件后执行</p><h3 id="6-4-1-传递函数"><a href="#6-4-1-传递函数" class="headerlink" title="6.4.1 传递函数"></a>6.4.1 传递函数</h3><p>参数一为带有形式参数的 <code>updater</code> 函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.setState((state, props) =&gt; stateChange[, callback] )</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./02_state/03_App_setState_function&#x27;</span> <span class="comment">// 修改状态 传递函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/02_state/03_App_setState_function.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">100</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; this.state.count &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.setState((state, props) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return &#123;</span></span><br><span class="line"><span class="language-xml">                count: state.count + 1</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125;, () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              console.log(4, this.state.count) // 103</span></span><br><span class="line"><span class="language-xml">            &#125;)</span></span><br><span class="line"><span class="language-xml">            console.log(1, this.state.count) // 100</span></span><br><span class="line"><span class="language-xml">            this.setState((state, props) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return &#123;</span></span><br><span class="line"><span class="language-xml">                count: state.count + 1</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125;, () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              console.log(5, this.state.count) // 103</span></span><br><span class="line"><span class="language-xml">            &#125;)</span></span><br><span class="line"><span class="language-xml">            console.log(2, this.state.count) // 100</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            this.setState((state, props) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return &#123;</span></span><br><span class="line"><span class="language-xml">                count: state.count + 1</span></span><br><span class="line"><span class="language-xml">              &#125;</span></span><br><span class="line"><span class="language-xml">            &#125;, () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              console.log(6, this.state.count) // 103</span></span><br><span class="line"><span class="language-xml">            &#125;)</span></span><br><span class="line"><span class="language-xml">            console.log(3, this.state.count) // 100</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">          &#125; &#125;</span></span><br><span class="line"><span class="language-xml">        &gt;加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>updater 函数中接收的 <code>state</code> 和 <code>props</code> 都保证为最新。updater 的返回值会与 <code>state</code> 进行浅合并。</p></blockquote><h3 id="6-4-2-传递对象"><a href="#6-4-2-传递对象" class="headerlink" title="6.4.2 传递对象"></a>6.4.2 传递对象</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./02_state/04_App_setState_object&#x27;</span> <span class="comment">// 修改状态 传递对象</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/02_state/04_App_setState_object.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">100</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; this.state.count &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">              count: this.state.count + 1</span></span><br><span class="line"><span class="language-xml">            &#125;, () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              console.log(4, this.state.count) // 101</span></span><br><span class="line"><span class="language-xml">            &#125;)</span></span><br><span class="line"><span class="language-xml">            console.log(1, this.state.count) // 100</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">              count: this.state.count + 1</span></span><br><span class="line"><span class="language-xml">            &#125;, () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              console.log(5, this.state.count) // 101</span></span><br><span class="line"><span class="language-xml">            &#125;)</span></span><br><span class="line"><span class="language-xml">            console.log(2, this.state.count)// 100</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">              count: this.state.count + 1</span></span><br><span class="line"><span class="language-xml">            &#125;, () =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              console.log(6, this.state.count) // 101</span></span><br><span class="line"><span class="language-xml">            &#125;)</span></span><br><span class="line"><span class="language-xml">            console.log(3, this.state.count)// 100</span></span><br><span class="line"><span class="language-xml">          &#125; &#125;</span></span><br><span class="line"><span class="language-xml">        &gt;加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>这种形式的 <code>setState()</code> 是异步的，并且在同一周期内会对多个 <code>setState</code> 进行批处理,相当于</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Object.assign(</span><br><span class="line">      prevState,</span><br><span class="line">      &#123;count: this.state.count + 1&#125;,</span><br><span class="line">      &#123;count: this.state.count + 1&#125;,</span><br><span class="line">      ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>后调用的 <code>setState()</code> 将覆盖同一周期内先调用 <code>setState</code> 的值，因此商品数仅增加一次。如果后续状态取决于当前状态,建议使用 updater 函数的形式代替（前面案例已经实现）。或者在第二个参数中再继续操作。</p></blockquote><blockquote><p>思考题：</p><p>1.<a target="_blank" rel="noopener" href="https://stackoverflow.com/a/48610973/458193">何时以及为什么 <code>setState()</code> 会批量执行？</a></p><p>2.<a target="_blank" rel="noopener" href="https://github.com/facebook/react/issues/11527#issuecomment-360199710">为什么不直接更新 <code>this.state</code>？</a></p></blockquote><h1 id="七、生命周期"><a href="#七、生命周期" class="headerlink" title="七、生命周期"></a>七、生命周期</h1><p>组件的生命周期可分成三个状态：</p><ul><li>Mounting(挂载,初始化)：已插入真实 DOM</li><li>Updating(更新,运行时)：正在被重新渲染</li><li>Unmounting(卸载,销毁)：已移出真实 DOM</li></ul><p>生命周期图谱可以参考链接：<a target="_blank" rel="noopener" href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/">https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/</a></p><blockquote><p>类组件如何实现类似vue的计算属性： <a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#what-about-memoization">https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#what-about-memoization</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i memoize-one -S</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./02_state/05_App_computed&#x27;</span> <span class="comment">// 类组件实现类似计算属性</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/02_state/05_App_computed.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> memoize <span class="keyword">from</span> <span class="string">&#x27;memoize-one&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MemoList</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  filter = <span class="title function_">memoize</span>(<span class="function">(<span class="params">list, text</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> list.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> text !== <span class="string">&#x27;&#x27;</span> &amp;&amp; item.<span class="title function_">includes</span>(text))</span><br><span class="line">  &#125;)</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">const</span> list = <span class="variable language_">this</span>.<span class="title function_">filter</span>(<span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">list</span>, <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">text</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.text</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> (<span class="attr">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">            text: event.target.value</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125; &#125;/&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            list.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return (<span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">index</span> &#125;&gt;</span> &#123; item &#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">            &#125;)</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">list</span>: [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;ab&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;abcd&#x27;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">MemoList</span> <span class="attr">list</span>=<span class="string">&#123;this.state.list&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure></blockquote><h2 id="7-1-三个阶段"><a href="#7-1-三个阶段" class="headerlink" title="7.1 三个阶段"></a>7.1 三个阶段</h2><h3 id="7-1-1-装载阶段"><a href="#7-1-1-装载阶段" class="headerlink" title="7.1.1 装载阶段"></a>7.1.1 装载阶段</h3><p>当组件实例被创建并插入 DOM 中时，其生命周期调用顺序如下：</p><ul><li><p><code>constructor()</code>: 在 React 组件挂载之前，会调用它的构造函数。</p><blockquote><p>如果不需要对类组件添加初始化数据以及绑定事件，那么就不需要写 <code>constructor</code></p></blockquote></li><li><p><code>static getDerivedStateFromProps()</code>: 在调用 render 方法之前调用，并且在初始挂载及后续更新时都会被调用。</p></li><li><p><code>render()</code>: render() 方法是 class 组件中唯一必须实现的方法。</p></li><li><p><code>componentDidMount()</code>: 在组件挂载后（插入 DOM 树中）立即调用。</p></li></ul><p>render() 方法是 class 组件中唯一必须实现的方法，其他方法可以根据自己的需要来实现。</p><h3 id="7-1-2-更新阶段"><a href="#7-1-2-更新阶段" class="headerlink" title="7.1.2 更新阶段"></a>7.1.2 更新阶段</h3><p>每当组件的 state 或 props 发生变化时，组件就会更新。</p><p>当组件的 props 或 state 发生变化时会触发更新。组件更新的生命周期调用顺序如下：</p><ul><li><code>static getDerivedStateFromProps()</code>: 在调用 render 方法之前调用，并且在初始挂载及后续更新时都会被调用。根据 shouldComponentUpdate() 的返回值，判断 React 组件的输出是否受当前 state 或 props 更改的影响。</li><li><code>shouldComponentUpdate()</code>:当 props 或 state 发生变化时，shouldComponentUpdate() 会在渲染执行之前被调用。</li><li><code>render()</code>: render() 方法是 class 组件中唯一必须实现的方法。</li><li><code>getSnapshotBeforeUpdate()</code>: 在最近一次渲染输出（提交到 DOM 节点）之前调用。</li><li><code>componentDidUpdate()</code>: 在更新后会被立即调用,如果你需要<strong>执行副作用</strong>（例如，数据提取或动画）以响应 props 中的更改。</li></ul><p>render() 方法是 class 组件中唯一必须实现的方法，其他方法可以根据自己的需要来实现。</p><h3 id="7-1-3-卸载阶段"><a href="#7-1-3-卸载阶段" class="headerlink" title="7.1.3 卸载阶段"></a>7.1.3 卸载阶段</h3><p>当组件从 DOM 中移除时会调用如下方法：</p><ul><li><code>componentWillUnmount()</code>: 在组件卸载及销毁之前直接调用。</li></ul><h3 id="7-1-4-Error-boundaries"><a href="#7-1-4-Error-boundaries" class="headerlink" title="7.1.4 Error boundaries"></a>7.1.4 Error boundaries</h3><p><a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/docs/error-boundaries.html">Error boundaries</a> 是 React 组件，它会在其子组件树中的任何位置捕获 JavaScript 错误，并记录这些错误，展示降级 UI 而不是崩溃的组件树。Error boundaries 组件会捕获在渲染期间，在生命周期方法以及其整个树的构造函数中发生的错误。</p><blockquote><p>项目中需要使用的最多的生命周期的钩子函数为 <code>render</code>, <code>componentDidMount</code>,<code>componentDidUpdate</code>,<code>componentWillUnmount</code></p></blockquote><blockquote><p>详细介绍范例：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/392532496">https://zhuanlan.zhihu.com/p/392532496</a></p></blockquote><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./02_state/06_App_lifeCycle&#x27;</span> <span class="comment">// 类组件生命周期</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">getDerivedStateFromError</span>(<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="comment">// 更新 state 使下一次渲染可以显示降级 UI</span></span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidCatch</span>(<span class="params">error, info</span>) &#123;</span><br><span class="line">    <span class="comment">// &quot;组件堆栈&quot; 例子:</span></span><br><span class="line">    <span class="comment">//   in ComponentThatThrows (created by App)</span></span><br><span class="line">    <span class="comment">//   in ErrorBoundary (created by App)</span></span><br><span class="line">    <span class="comment">//   in div (created by App)</span></span><br><span class="line">    <span class="comment">//   in App</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(info.<span class="property">componentStack</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">hasError</span>) &#123;</span><br><span class="line">      <span class="comment">// 你可以渲染任何自定义的降级 UI</span></span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Something went wrong.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">children</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ErrorBoundary</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">App</span> <span class="attr">root</span> = <span class="string">&#123;</span> <span class="attr">root</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">ErrorBoundary</span>&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/02_state/06_App_lifeCycle.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// constructor (props) &#123; // Useless constructor</span></span><br><span class="line">  <span class="comment">//   super(props)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  state = &#123; <span class="attr">count</span>: <span class="number">100</span> &#125;</span><br><span class="line">  <span class="comment">// static getDerivedStateFromProps (props, state) &#123; // 一般不使用</span></span><br><span class="line">  <span class="comment">//   // getDerivedStateFromProps 会在调用 render 方法之前调用，并且在初始挂载及后续更新时都会被调用。</span></span><br><span class="line">  <span class="comment">//   // 它应返回一个对象来更新 state，如果返回 null 则不更新任何内容</span></span><br><span class="line">  <span class="comment">//   // state 的值在任何时候都取决于 props</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="comment">// 等同于 vue中的 mounted</span></span><br><span class="line">    <span class="comment">// 数据请求，实例化操作，DOM操作，定时器，计时器，订阅数据变化</span></span><br><span class="line">    <span class="comment">// 修改状态</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">100</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  shouldComponentUpdate (nextProps, nextState) &#123;</span><br><span class="line">    <span class="comment">// 可以作为react组件的性能优化的手段，但是也要慎用</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// getSnapshotBeforeUpdate(prevProps, prevState) &#123;</span></span><br><span class="line">  <span class="comment">//   // 在最近一次渲染输出（提交到 DOM 节点）之前调用。</span></span><br><span class="line">  <span class="comment">//   // 它使得组件能在发生更改之前从 DOM 中捕获一些信息（例如，滚动位置）。</span></span><br><span class="line">  <span class="comment">//   // 此生命周期方法的任何返回值将作为参数传递给 componentDidUpdate()。</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidUpdate</span>(<span class="params">prevProps, prevState, snapshot</span>) &#123;</span><br><span class="line">    <span class="comment">// 参照vue中 updated</span></span><br><span class="line">    <span class="comment">// 实例化操作，DOM操作, 特定条件可以请求数据以及修改数据</span></span><br><span class="line">    <span class="comment">// if (this.props.userID !== prevProps.userID) &#123; // 监听数据的变化</span></span><br><span class="line">    <span class="comment">//   this.fetchData(this.props.userID);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount () &#123;</span><br><span class="line">    <span class="comment">// 参照vue  beforeDestory</span></span><br><span class="line">    <span class="comment">// 清理对象，取消订阅，消除定时器计时器</span></span><br><span class="line">    <span class="comment">// 当count的值等于210的时候销毁组件</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 挂载阶段 依据初始化数据渲染数据</span></span><br><span class="line">    <span class="comment">// 更新阶段 当该组件的状态或者属性发生改变时触发此函数，也就输数据的改变引起视图的二次渲染</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; this.state.count &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          if (this.state.count === 210) &#123;</span></span><br><span class="line"><span class="language-xml">            console.log(&#x27;销毁组件&#x27;)</span></span><br><span class="line"><span class="language-xml">            // 销毁组件</span></span><br><span class="line"><span class="language-xml">            this.props.root.unmount()</span></span><br><span class="line"><span class="language-xml">          &#125; else &#123;</span></span><br><span class="line"><span class="language-xml">            this.setState(&#123; count: this.state.count + 1 &#125; )</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        &#125; &#125;&gt;加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="7-2-两个时期"><a href="#7-2-两个时期" class="headerlink" title="7.2 两个时期"></a>7.2 两个时期</h2><p>将应用的渲染过程分为<code>mount</code>阶段（应用首次渲染）和<code>update</code>阶段（应用状态更新），无论在<code>mount</code>阶段还是<code>update</code>阶段，都会经历两个子阶段，一个是<code>render</code>阶段，一个是<code>commit</code>阶段。</p><p><strong>mount时</strong>：<br>在<code>render</code>阶段会根据jsx对象构建新的<code>workInProgressFiber</code>树，然后将相应的<code>fiber</code>节点标记为<code>Placement</code>，表示这个<code>fiber</code>节点需要被插入到<code>dom</code>树中，然后会这些带有副作用的<code>fiber</code>节点加入一条叫做<code>Effect List</code>的链表中。<br>在<code>commit</code>阶段会遍历<code>render</code>阶段形成的<code>Effect List</code>，执行链表上相应<code>fiber</code>节点的副作用，比如<code>Placement</code>插入，或者执行<code>Passive</code>（useEffect的副作用）。将这些副作用应用到真实节点上<br><strong>update时</strong>：<br>在<code>render</code>阶段会根据最新状态的jsx对象对比<code>current Fiber</code>，再构建新的<code>workInProgressFiber</code>树，这个对比的过程就是<code>diff算法</code>，<code>diff算法</code>又分成单节点的对比和多节点的对比，对比的过程中同样会经历收集副作用的过程，也就是将对比出来的差异标记出来，加入<code>Effect List</code>中，这些对比出来的副作用例如：<code>Placement</code>（插入）、<code>Update</code>(更新)、<code>Deletion</code>（删除）等。<br>在<code>commit</code>阶段同样会遍历<code>Effect List</code>，将这些fiber节点上的副作用应用到真实节点上。</p><blockquote><p>参考链接: <a target="_blank" rel="noopener" href="https://blog.csdn.net/bemystery/article/details/121897223">https://blog.csdn.net/bemystery/article/details/121897223</a></p></blockquote><h2 id="7-3-入门理解React-Fiber架构"><a href="#7-3-入门理解React-Fiber架构" class="headerlink" title="7.3 入门理解React Fiber架构"></a>7.3 入门理解React Fiber架构</h2><p>在 React 16 之前，<code>VirtualDOM</code> 的更新采用的是<code>Stack</code>架构实现的，也就是循环递归方式。不过，这种对比方式有明显的缺陷，就是一旦任务开始进行就无法中断，如果遇到应用中组件数量比较庞大，那么<code>VirtualDOM</code> 的层级就会比较深，带来的结果就是主线程被长期占用，进而阻塞渲染、造成卡顿现象。</p><p>为了避免出现卡顿等问题，我们必须保障在执行更新操作时计算时不能超过16ms，如果超过16ms，就需要先暂停，让给浏览器进行渲染，后续再继续执行更新计算。而<code>Fiber</code>架构就是为了支持“可中断渲染”而创建的。</p><p>在<code>React</code>中，<code>Fiber</code>使用了一种新的数据结构<code>fiber tree</code>，它可以把虚拟<code>dom tree</code>转换成一个链表，然后再执行遍历操作，而链表在执行遍历操作时是支持断点重启的，示意图如下。<br><img src="https://segmentfault.com/img/bVc1w1a" alt="image.png"></p><p>官方介绍中，<code>Fiber</code> 被理解为是一种数据结构，但是我们也可以将它理解为是一个执行单元。</p><p><code>Fiber</code> 可以理解为一个执行单元，每次执行完一个执行单元，<code>React Fiber</code>就会检查还剩多少时间，如果没有时间则将控制权让出去，然后由浏览器执行渲染操作。<code>React Fiber</code> 与浏览器的交互流程如下图。<br><img src="https://segmentfault.com/img/bVc1w1b" alt="image.png"></p><p>可以看到，<code>React</code> 首先向浏览器请求调度，浏览器在执行完一帧后如果还有空闲时间，会去判断是否存在待执行任务，不存在就直接将控制权交给浏览器；如果存在就会执行对应的任务，执行完一个新的任务单元之后会继续判断是否还有时间，有时间且有待执行任务则会继续执行下一个任务，否则将控制权交给浏览器执行渲染，这个流程是循环进行的。</p><p>所以，我们可以将<code>Fiber</code> 理解为一个执行单元，并且这个执行单元必须是一次完成的，不能出现暂停。并且，这个小的执行单元在执行完后计算之后，可以移交控制权给浏览器去响应用户，从而提升了渲染的效率。</p><p>在官方的文档中，<code>Fibe</code>r 被解释为是一种数据结构，即链表结构。在链表结构中，每个 <code>Virtual DOM</code> 都可以表示为一个 <code>fiber</code>，如下图所示。<br><img src="https://segmentfault.com/img/bVc1w1c" alt="image.png"><br>通常，一个 <code>fiber</code>包括了 <code>child</code>（第一个子节点）、<code>sibling</code>（兄弟节点）、<code>return</code>（父节点)等属性，<code>React Fiber</code> 机制的实现，就是依赖于上面的数据结构。</p><p>通过介绍，我们知道<code>Fiber</code>使用的是链表结构，准确的说是<strong>单链表树结构</strong>。为了方便理解 <code>Fiber</code> 的遍历过程，下面我们就看下<code>Fiber</code>链表结构。</p><p><img src="https://segmentfault.com/img/bVc1w1d" alt="image.png"></p><p>在上面的例子中，每一个单元都包含了<code>payload</code>（数据）和<code>nextUpdate</code>（指向下一个单元的指针）两个元素</p><blockquote><p>参考链接：<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000042271919">https://segmentfault.com/a/1190000042271919</a></p></blockquote><h1 id="八、事件绑定"><a href="#八、事件绑定" class="headerlink" title="八、事件绑定"></a>八、事件绑定</h1><p>React 元素的事件处理和 DOM 元素的很相似，但是有一点语法上的不同：</p><ul><li><p>React 事件的命名采用小驼峰式（camelCase），而不是纯小写。</p></li><li><p>使用 JSX 语法时你需要传入一个函数作为事件处理函数，而不是一个字符串。\</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 保证是一个函数</span><br><span class="line">* 如果需要使用this关键词，保证this指向</span><br></pre></td></tr></table></figure></li></ul><h2 id="8-1-ES5语法绑定事件"><a href="#8-1-ES5语法绑定事件" class="headerlink" title="8.1 ES5语法绑定事件"></a>8.1 ES5语法绑定事件</h2><h3 id="8-1-1-无参数的绑定"><a href="#8-1-1-无参数的绑定" class="headerlink" title="8.1.1 无参数的绑定"></a>8.1.1 无参数的绑定</h3><h4 id="8-1-1-1-方法一"><a href="#8-1-1-1-方法一" class="headerlink" title="8.1.1.1 方法一"></a>8.1.1.1 方法一</h4><ul><li>定义函数</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">handleClick(e) &#123; // e - 事件对象</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  // doSomething ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>constructor 中绑定函数执行上下文</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.handleClick = this.handleClick.bind(this);</span><br></pre></td></tr></table></figure><ul><li>jsx中调用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;this.hanleClick&#125; /&gt;</span><br></pre></td></tr></table></figure><h4 id="8-1-1-1-方法二"><a href="#8-1-1-1-方法二" class="headerlink" title="8.1.1.1 方法二"></a>8.1.1.1 方法二</h4><ul><li>定义函数</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">handleClick(e) &#123; // e - 事件对象</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  // doSomething ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>jsx 中调用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;this.hanleClick.bind(this)&#125; /&gt;</span><br></pre></td></tr></table></figure><h3 id="8-1-2-有参数的绑定"><a href="#8-1-2-有参数的绑定" class="headerlink" title="8.1.2 有参数的绑定"></a>8.1.2 有参数的绑定</h3><ul><li>定义函数</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">handleClick(param1, param2, e) &#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  // do something ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注意此时无论多少个参数， e 一定放在最后</p></blockquote><ul><li>jsx 中调用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;this.hanleClick.bind(this, &#x27;x&#x27;, &#x27;xx&#x27;)&#125; /&gt;</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./03_event/01_App_event_es5&#x27;</span> <span class="comment">// 事件处理 es5绑定事件方式</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/03_event/01_App_event_es5.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// es5绑定事件 ---- 主要是对this指向的处理</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span> (props) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handlerClickFn</span> = <span class="variable language_">this</span>.<span class="property">handlerClick</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handlerClick (event) &#123; <span class="comment">// event为事件默认参数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>, <span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handlerParamsClick (a , b, event) &#123; <span class="comment">// 自定义参数  event将作为最后一个参数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a&#x27;</span>, a) <span class="comment">// a  1</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;b&#x27;</span>, b) <span class="comment">// b  2</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.handlerClickFn</span> &#125;&gt;</span>es5绑定事件-构造函数<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.handlerClick.bind</span>(<span class="attr">this</span>) &#125;&gt;</span>es5绑定事件-jsx改变this指向<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.handlerParamsClick.bind</span>(<span class="attr">this</span>, &#x27;<span class="attr">1</span>&#x27;, &#x27;<span class="attr">2</span>&#x27;) &#125;&gt;</span>es5绑定事件-传递参数<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="8-2-ES6语法绑定事件"><a href="#8-2-ES6语法绑定事件" class="headerlink" title="8.2 ES6语法绑定事件"></a>8.2 ES6语法绑定事件</h2><h3 id="8-2-1-无参数绑定"><a href="#8-2-1-无参数绑定" class="headerlink" title="8.2.1 无参数绑定"></a>8.2.1 无参数绑定</h3><h4 id="8-2-1-1-方法一"><a href="#8-2-1-1-方法一" class="headerlink" title="8.2.1.1 方法一"></a>8.2.1.1 方法一</h4><ul><li>定义函数</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">handleClick = (e) =&gt; &#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  // do something ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>jsx中调用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;this.hanleClick&#125; /&gt;</span><br></pre></td></tr></table></figure><blockquote><p>比起 es 5 中的无参数函数的绑定调用， es 6 不需要使用 bind 函数；</p></blockquote><h4 id="8-2-1-2-方法二"><a href="#8-2-1-2-方法二" class="headerlink" title="8.2.1.2 方法二"></a>8.2.1.2 方法二</h4><p>jsx中定义箭头函数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123; () =&gt; &#123;&#125;&#125; /&gt;</span><br></pre></td></tr></table></figure><h3 id="8-2-2-有参数绑定"><a href="#8-2-2-有参数绑定" class="headerlink" title="8.2.2 有参数绑定"></a>8.2.2 有参数绑定</h3><h4 id="8-2-2-1-方法一"><a href="#8-2-2-1-方法一" class="headerlink" title="8.2.2.1 方法一"></a>8.2.2.1 方法一</h4><ul><li>定义函数</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">handleClick = (param1, e) =&gt; &#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  // do something ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>jsx调用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;this.hanleClick.bind(this, &#x27;x&#x27;)&#125; /&gt;</span><br></pre></td></tr></table></figure><blockquote><p>有参数时，在绑定时依然要使用 bind；<br>并且参数一定要传，不然仍然存在 this 指向错误问题；</p></blockquote><h4 id="8-2-2-2-方法二"><a href="#8-2-2-2-方法二" class="headerlink" title="8.2.2.2 方法二"></a>8.2.2.2 方法二</h4><ul><li>定义函数</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">handleClick = (param1, e) =&gt; &#123;</span><br><span class="line">  // do something ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>jsx调用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;() =&gt; this.handleClick(&#x27;c&#x27;)&#125; /&gt;</span><br><span class="line">// 如果需要对 event 对象进行处理的话，需要写成下面的格式</span><br><span class="line">&lt;button onClick=&#123;(e) =&gt; this.handleClick(&#x27;c&#x27;, e)&#125; /&gt;</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./03_event/02_App_event_es6&#x27;</span> <span class="comment">// 事件处理 es6绑定事件方式</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/03_event/02_App_event_es6.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// es5绑定事件 ---- 主要是对this指向的处理</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  </span><br><span class="line">  handlerClickFn = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;<span class="comment">// event 默认参数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>, <span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  handlerParamsClick = <span class="function">(<span class="params">a, b, event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;a&#x27;</span>, a) <span class="comment">// a 1</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;b&#x27;</span>, b) <span class="comment">// b 2</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.handlerClickFn</span> &#125;&gt;</span>es6绑定事件-定义箭头函数<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> (<span class="attr">event</span>) =&gt;</span> &#123; // event 默认参数</span></span><br><span class="line"><span class="language-xml">          console.log(2, this)</span></span><br><span class="line"><span class="language-xml">        &#125; &#125;&gt;es6绑定事件-jsx写箭头函数<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.handlerParamsClick.bind</span>(<span class="attr">this</span>, &#x27;<span class="attr">1</span>&#x27;, &#x27;<span class="attr">2</span>&#x27;) &#125;&gt;</span>es6绑定事件-传递参数<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> (<span class="attr">event</span>) =&gt;</span> &#123; // event 默认参数</span></span><br><span class="line"><span class="language-xml">          console.log(2, this)</span></span><br><span class="line"><span class="language-xml">          // this.fetchData(&#123; count: this.state.count &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125; &#125;&gt;es6绑定事件-jsx写箭头函数,直接使用参数<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="8-3-合成事件的特点"><a href="#8-3-合成事件的特点" class="headerlink" title="8.3 合成事件的特点"></a>8.3 合成事件的特点</h2><h3 id="8-3-1-事件机制"><a href="#8-3-1-事件机制" class="headerlink" title="8.3.1 事件机制"></a>8.3.1 事件机制</h3><ul><li><code>react</code>自身实现了一套事件机制，包括事件的注册、事件的存储、事件的合成及执行等。</li><li><code>react</code> 的所有事件并没有绑定到具体的<code>dom</code>节点上而是绑定在了<code>document</code> 上，然后由统一的事件处理程序来派发执行。</li><li>通过这种处理，减少了事件注册的次数，另外<code>react</code>还在事件合成过程中，对不同浏览器的事件进行了封装处理，抹平浏览器之间的事件差异。</li></ul><h3 id="8-3-2-对合成事件的理解"><a href="#8-3-2-对合成事件的理解" class="headerlink" title="8.3.2 对合成事件的理解"></a>8.3.2 对合成事件的理解</h3><p>（1）对原生事件的封装</p><blockquote><p><code>react</code>会根据原生事件类型来使用不同的合成事件对象，比如: 聚焦合成事件对象<code>SyntheticFoucsEvent</code>（合成事件对象：<code>SyntheticEvent</code>是<code>react</code>合成事件的基类，定义了合成事件的基础公共属性和方法。合成事件对象就是在该基类上创建的，原生js的 事件对象为 <code>PointerEvent</code>）</p></blockquote><p>（2）不同浏览器事件兼容的处理</p><blockquote><p>在对事件进行合成时，<code>react</code>针对不同的浏览器，也进行了事件的兼容处理</p></blockquote><h3 id="8-3-3-事件机制的流程"><a href="#8-3-3-事件机制的流程" class="headerlink" title="8.3.3 事件机制的流程"></a>8.3.3 事件机制的流程</h3><h4 id="1、事件注册"><a href="#1、事件注册" class="headerlink" title="1、事件注册"></a>1、事件注册</h4><blockquote><p>在组件挂载阶段，根据组件内声明的事件类型-<code>onclick</code>，<code>onchange</code> 等，给 <code>document</code> 上添加事件 -<code>addEventListener</code>，并指定统一的事件处理程序 <code>dispatchEvent</code>。</p></blockquote><h4 id="2、事件存储"><a href="#2、事件存储" class="headerlink" title="2、事件存储"></a>2、事件存储</h4><blockquote><p>完成事件注册后，将 <code>react dom</code> ，事件类型，事件处理函数<code>fn</code>放入数组存储，组件挂载完成后，经过遍历把事件处理函数存储到 <code>listenerBank</code>(一个对象)中，缓存起来，为了在触发事件的时候可以查找到对应的事件处理方法去执行。</p></blockquote><blockquote><p>开始事件的存储，在 <code>react</code> 里所有事件的触发都是通过 <code>dispatchEvent</code>方法统一进行派发的，而不是在注册的时候直接注册声明的回调，来看下如何存储的 。<br><code>react</code> 把所有的事件和事件类型以及<code>react</code> 组件进行关联，把这个关系保存在了一个 <code>map</code>里，也就是一个对象里（键值对），然后在事件触发的时候去根据当前的 组件id和 事件类型查找到对应的 事件fn</p></blockquote><h4 id="3、事件执行"><a href="#3、事件执行" class="headerlink" title="3、事件执行"></a>3、事件执行</h4><blockquote><p>1、进入统一的事件分发函数(<code>dispatchEvent</code>)<br>2、结合原生事件找到当前节点对应的<code>ReactDOMComponent</code>对象<br>3、开始 事件的合成</p><blockquote><ul><li>根据当前事件类型生成指定的合成对象</li><li>封装原生事件和冒泡机制</li><li>在 <code>listenerBank</code>事件池中查找事件回调并合成到 <code>event</code>(合成事件结束)</li></ul></blockquote><p>4.处理合成事件内的回调事件（事件触发完成 end）</p></blockquote><h3 id="8-3-4-合成事件、原生事件之间的冒泡执行关系"><a href="#8-3-4-合成事件、原生事件之间的冒泡执行关系" class="headerlink" title="8.3.4 合成事件、原生事件之间的冒泡执行关系"></a>8.3.4 合成事件、原生事件之间的冒泡执行关系</h3><p>结论：</p><ul><li><p>原生事件阻止冒泡肯定会阻止合成事件的触发。</p></li><li><p>合成事件的阻止冒泡不会影响原生事件。</p></li></ul><p>原因：</p><ul><li>浏览器事件的执行需要经过三个阶段，<code>捕获阶段-目标元素阶段-冒泡阶段</code>。</li></ul><blockquote><p>节点上的原生事件的执行是在目标阶段，然而合成事件的执行是在冒泡阶段，所以原生事件会先合成事件执行，然后再往父节点冒泡，所以原生事件阻止冒泡会阻止合成事件的触发，而合成事件的阻止冒泡不会影响原生事件。</p></blockquote><h1 id="九、条件渲染"><a href="#九、条件渲染" class="headerlink" title="九、条件渲染"></a>九、条件渲染</h1><p>在 React 中，你可以创建不同的组件来封装各种你需要的行为。然后还可以根据应用的状态变化只渲染其中的一部分。</p><p>React 中的条件渲染和 JavaScript 中的一致，使用 JavaScript 操作符 if 或条件运算符来创建表示当前状态的元素，然后让 React 根据它们来更新 UI。</p><h2 id="9-1"><a href="#9-1" class="headerlink" title="9.1 &amp;&amp;"></a>9.1 &amp;&amp;</h2><p>你可以通过用花括号包裹代码在 JSX 中嵌入任何表达式 ，也包括 JavaScript 的逻辑与 &amp;&amp;，它可以方便地条件渲染一个元素。</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./04_condition/01_App_condition_yu&#x27;</span> <span class="comment">// 条件渲染 &amp;&amp;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/04_condition/01_App_condition_yu.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MainBox</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; </span></span><br><span class="line"><span class="language-xml">          this.props.unReadMessage.length &gt; 0 &amp;&amp; <span class="tag">&lt;<span class="name">span</span>&gt;</span>还有&#123; this.props.unReadMessage.length &#125;条未读消息<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">message</span>: [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          this.state.message.map((item, index) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">index</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123; item &#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                  const arr = this.state.message // 获取数据</span></span><br><span class="line"><span class="language-xml">                  arr.splice(index, 1) // 处理数据</span></span><br><span class="line"><span class="language-xml">                  this.setState(&#123; // 修改状态</span></span><br><span class="line"><span class="language-xml">                    message: arr</span></span><br><span class="line"><span class="language-xml">                  &#125;)</span></span><br><span class="line"><span class="language-xml">                &#125;&#125;&gt;已读<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            )</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">MainBox</span> <span class="attr">unReadMessage</span> = <span class="string">&#123;</span> <span class="attr">this.state.message</span> &#125; &gt;</span><span class="tag">&lt;/<span class="name">MainBox</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="9-2-三元运算符"><a href="#9-2-三元运算符" class="headerlink" title="9.2 三元运算符"></a>9.2 三元运算符</h2><p>条件渲染的另一种方法是使用 JavaScript 的条件运算符:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">condition ? true : false。</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./04_condition/02_App_condition_san&#x27;</span> <span class="comment">// 条件渲染 三元运算符</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/04_condition/02_App_condition_san.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">loginState</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; this.state.loginState + &#x27;&#x27; &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123; this.setState(&#123; loginState: !this.state.loginState &#125;) &#125; &#125;&gt;切换<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          this.state.loginState ? <span class="tag">&lt;<span class="name">button</span>&gt;</span>退出<span class="tag">&lt;/<span class="name">button</span>&gt;</span> : <span class="tag">&lt;<span class="name">button</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// render() &#123;</span></span><br><span class="line">  <span class="comment">//   if (this.state.loginState) &#123;</span></span><br><span class="line">  <span class="comment">//     return (</span></span><br><span class="line">  <span class="comment">//       &lt;div&gt;</span></span><br><span class="line">  <span class="comment">//         &#123; this.state.loginState + &#x27;&#x27; &#125;</span></span><br><span class="line">  <span class="comment">//         &lt;button onClick=&#123; () =&gt; &#123; this.setState(&#123; loginState: !this.state.loginState &#125;) &#125; &#125;&gt;切换&lt;/button&gt;</span></span><br><span class="line">  <span class="comment">//          &lt;button&gt;退出&lt;/button&gt;</span></span><br><span class="line">  <span class="comment">//       &lt;/div&gt;</span></span><br><span class="line">  <span class="comment">//     );</span></span><br><span class="line">  <span class="comment">//   &#125; else &#123;</span></span><br><span class="line">  <span class="comment">//     return (</span></span><br><span class="line">  <span class="comment">//       &lt;div&gt;</span></span><br><span class="line">  <span class="comment">//         &#123; this.state.loginState + &#x27;&#x27; &#125;</span></span><br><span class="line">  <span class="comment">//         &lt;button onClick=&#123; () =&gt; &#123; this.setState(&#123; loginState: !this.state.loginState &#125;) &#125; &#125;&gt;切换&lt;/button&gt;</span></span><br><span class="line">  <span class="comment">//          &lt;button&gt;登录&lt;/button&gt;</span></span><br><span class="line">  <span class="comment">//       &lt;/div&gt;</span></span><br><span class="line">  <span class="comment">//     )</span></span><br><span class="line">  <span class="comment">//   &#125;</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="comment">// render () &#123;</span></span><br><span class="line">  <span class="comment">//   // let test = null</span></span><br><span class="line">  <span class="comment">//   // if (this.state.loginState) &#123;</span></span><br><span class="line">  <span class="comment">//   //   test = &lt;button&gt;退出&lt;/button&gt;</span></span><br><span class="line">  <span class="comment">//   // &#125; else &#123;</span></span><br><span class="line">  <span class="comment">//   //   test = &lt;button&gt;登录&lt;/button&gt;</span></span><br><span class="line">  <span class="comment">//   // &#125;</span></span><br><span class="line">  <span class="comment">//   const test = this.state.loginState ? &lt;button&gt;退出&lt;/button&gt; : &lt;button&gt;登录&lt;/button&gt;</span></span><br><span class="line">  <span class="comment">//   return (</span></span><br><span class="line">  <span class="comment">//     &lt;div&gt;</span></span><br><span class="line">  <span class="comment">//       &#123; this.state.loginState + &#x27;&#x27; &#125;</span></span><br><span class="line">  <span class="comment">//       &lt;button onClick=&#123; () =&gt; &#123; this.setState(&#123; loginState: !this.state.loginState &#125;) &#125; &#125;&gt;切换&lt;/button&gt;</span></span><br><span class="line">  <span class="comment">//       &#123; test &#125;</span></span><br><span class="line">  <span class="comment">//     &lt;/div&gt;</span></span><br><span class="line">  <span class="comment">//   )</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="9-3-动态className"><a href="#9-3-动态className" class="headerlink" title="9.3 动态className"></a>9.3 动态className</h2><p>Vue中有很方便的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A&spm=1001.2101.3001.7020">动态绑定</a>class属性的方式，v-bind:class,那么react怎么实现这样的效果呢？</p><blockquote><p><code>&lt;button class=&quot;btn btn-success btn-sm&quot;&gt;&lt;/button&gt;</code></p><p><code>&lt;button class=&quot;btn btn-danger btn-sm&quot;&gt;&lt;/button&gt;</code></p><p><code>&lt;button class=&quot;btn btn-warning btn-sm&quot;&gt;&lt;/button&gt;</code></p></blockquote><p><code>&#123; this.state.type === &#39;success&#39; ? &#39;btn btn-success btn-sm&#39; : &#39;btn btn-sm&#39;&#125;</code></p><p>通过classnames这个插件可以实现</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i classnames -S</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./04_condition/03_App_condition_classname&#x27;</span> <span class="comment">// 条件渲染 动态的class</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/04_condition/03_App_condition_classname.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> classnames <span class="keyword">from</span> <span class="string">&#x27;classnames&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;default&#x27;</span>,</span><br><span class="line">    <span class="attr">size</span>: <span class="string">&#x27;sm&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">classnames</span>(&#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#x27;<span class="attr">btn</span>&#x27;<span class="attr">:</span> <span class="attr">true</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#x27;<span class="attr">btn-sm</span>&#x27;<span class="attr">:</span> <span class="attr">this.state.size</span> === <span class="string">&#x27;sm&#x27;</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#x27;<span class="attr">btn-success</span>&#x27;<span class="attr">:</span> <span class="attr">this.state.type</span> === <span class="string">&#x27;default&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;)</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&gt;</span>default<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">classnames</span>(&#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#x27;<span class="attr">btn</span>&#x27;<span class="attr">:</span> <span class="attr">true</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#x27;<span class="attr">btn-md</span>&#x27;<span class="attr">:</span> <span class="attr">this.state.size</span> === <span class="string">&#x27;md&#x27;</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#x27;<span class="attr">btn-success</span>&#x27;<span class="attr">:</span> <span class="attr">this.state.type</span> === <span class="string">&#x27;success&#x27;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;)</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&gt;</span>success md<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>补充：</p><ul><li><strong>css-in-js</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i styled-components -S</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./04_condition/04_App_condition_cssinjs&#x27;</span> <span class="comment">// cssInJs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/04_condition/04_App_condition_cssinjs.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> styled <span class="keyword">from</span> <span class="string">&#x27;styled-components&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// css-in-js 内部写的都是纯css</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ODiv</span> = styled.<span class="property">div</span><span class="string">`</span></span><br><span class="line"><span class="string">  font-size: 30px;</span></span><br><span class="line"><span class="string">  color: #f66</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Button</span> = styled.<span class="property">button</span><span class="string">`</span></span><br><span class="line"><span class="string">  padding: 10px 30px;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ODiv</span>&gt;</span>你好<span class="tag">&lt;/<span class="name">ODiv</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><ul><li><strong>模块化css</strong></li></ul><blockquote><p>可以解决类似于 vue中 scoped</p></blockquote><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./04_condition/05_App_module_css&#x27;</span> <span class="comment">// 模块化css</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/04_condition/05_App_module_css.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// import &#x27;./style.module.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> style <span class="keyword">from</span> <span class="string">&#x27;./style.module.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="comment">// &lt;div className=&#x27;container&#x27;&gt;</span></span><br><span class="line">      <span class="comment">//   &lt;div className=&quot;header&quot;&gt;&lt;/div&gt;</span></span><br><span class="line">      <span class="comment">//   &lt;div className=&quot;box&quot;&gt;&lt;/div&gt;</span></span><br><span class="line">      <span class="comment">//   &lt;div className=&quot;footer&quot;&gt;&lt;/div&gt;</span></span><br><span class="line">      <span class="comment">// &lt;/div&gt;</span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span> <span class="attr">style.container</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span> <span class="attr">style.header</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span> <span class="attr">style.box</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span> <span class="attr">style.footer</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p><code>src/04_condition/style.module.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">600px</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f66</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.footer</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><h2 id="9-4-动态style"><a href="#9-4-动态style" class="headerlink" title="9.4 动态style"></a>9.4 动态style</h2><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./04_condition/06_App_style&#x27;</span> <span class="comment">// 动态style</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/04_condition/06_App_style.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">size</span>: <span class="number">12</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&#x27;#333&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">            size: this.state.size + 2</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;字号+2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;color&quot;</span> <span class="attr">value</span>=<span class="string">&#123;this.state.color&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(event)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">            color: event.target.value</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span> = <span class="string">&#123;</span> &#123; <span class="attr">fontSize:</span> <span class="attr">this.state.size</span>, <span class="attr">color:</span> <span class="attr">this.state.color</span> &#125; &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          中国共产党第十九届中央委员会第七次全体会议9日上午在京召开。中央委员会总书记习近平代表中央政治局向全会作工作报告，并就十九届中央委员会向中国共产党第二十次全国代表大会的报告讨论稿向全会作了说明。王沪宁就《中国共产党章程（修正案）》讨论稿向全会作了说明。</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h1 id="十、列表渲染"><a href="#十、列表渲染" class="headerlink" title="十、列表渲染"></a>十、列表渲染</h1><ul><li>map()方法、key</li></ul><p>使用 map() 方法遍历数组</p><blockquote><p>组件接收数组参数，每个列表元素分配一个 key，不然会出现警告 <strong>a key should be provided for list items</strong>，意思就是需要包含 key：</p></blockquote><p>Keys 可以在 DOM 中的某些元素被增加或删除的时候帮助 React 识别哪些元素发生了变化。因此你应当给数组中的每一个元素赋予一个确定的标识。</p><p>一个元素的 key 最好是这个元素在列表中拥有的一个独一无二的字符串。通常，我们使用来自数据的<code>id</code>作为元素的 key</p><p>当元素没有确定的 id 时，你可以使用他的序列号索引 <code>index</code> 作为 <code>key</code></p><blockquote><p>如果列表可以重新排序，我们不建议使用索引来进行排序，因为这会导致渲染变得很慢。</p></blockquote><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./05_list/01_App_map&#x27;</span> <span class="comment">// 列表渲染 使用map</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/05_list/01_App_map.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">proList</span>: []</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        <span class="attr">proList</span>: res.<span class="property">data</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 边遍历边渲染</span></span><br><span class="line">  <span class="comment">// render() &#123;</span></span><br><span class="line">  <span class="comment">//   const &#123; proList &#125; = this.state</span></span><br><span class="line">  <span class="comment">//   return (</span></span><br><span class="line">  <span class="comment">//     &lt;div&gt;</span></span><br><span class="line">  <span class="comment">//       &#123;</span></span><br><span class="line">  <span class="comment">//         // proList &amp;&amp; proList.forEach((item, index) =&gt; &#123; // forEach没有返回值</span></span><br><span class="line">  <span class="comment">//         //   return (</span></span><br><span class="line">  <span class="comment">//         //     &lt;p key=&#123; item.proid &#125;&gt;&#123;index + 1&#125; - &#123; item.proname &#125;&lt;/p&gt;</span></span><br><span class="line">  <span class="comment">//         //   )</span></span><br><span class="line">  <span class="comment">//         // &#125;)</span></span><br><span class="line">  <span class="comment">//         proList &amp;&amp; proList.map((item, index) =&gt; &#123; // map没有返回值</span></span><br><span class="line">  <span class="comment">//           return (</span></span><br><span class="line">  <span class="comment">//             &lt;p key=&#123; item.proid &#125;&gt;&#123;index + 1&#125; - &#123; item.proname &#125;&lt;/p&gt;</span></span><br><span class="line">  <span class="comment">//           )</span></span><br><span class="line">  <span class="comment">//         &#125;)</span></span><br><span class="line">  <span class="comment">//       &#125;</span></span><br><span class="line">  <span class="comment">//     &lt;/div&gt;</span></span><br><span class="line">  <span class="comment">//   );</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 先遍历后渲染 - 利用数组装填jsx代码思想</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> arr = []</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">proList</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">      arr.<span class="title function_">push</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span>=<span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span>&#123; index + 1 &#125; --- &#123; item.proname &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; arr &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>接口 <code>http://121.89.205.189:3001/api/city/sortCity</code></p><p>实现多层遍历</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./05_list/02_App_mutiple_map&#x27;</span> <span class="comment">// 列表渲染 多层遍历</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/05_list/02_App_mutiple_map.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">cityList</span>: []</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/city/sortCity&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(res.<span class="property">data</span>))</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        <span class="attr">cityList</span>: <span class="title class_">JSON</span>.<span class="title function_">parse</span>(res.<span class="property">data</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; cityList &#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            cityList &amp;&amp; cityList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.letter</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                  &#123; item.letter &#125;</span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    &#123;</span></span><br><span class="line"><span class="language-xml">                      item.data &amp;&amp; item.data.map(itm =&gt; (</span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">itm.cityId</span> &#125;&gt;</span> &#123; itm.name &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      ))</span></span><br><span class="line"><span class="language-xml">                    &#125;</span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              )</span></span><br><span class="line"><span class="language-xml">            &#125;)</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure></blockquote><h1 id="十一、表单绑定"><a href="#十一、表单绑定" class="headerlink" title="十一、表单绑定"></a>十一、表单绑定</h1><p>在 React 里，HTML 表单元素的工作方式和其他的 DOM 元素有些不同，这是因为表单元素通常会保持一些内部的 state。例如这个纯 HTML 表单只接受一个名称：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">    名字:</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>此表单具有默认的 HTML 表单行为，即在用户提交表单后浏览到新页面。如果你在 React 中执行相同的代码，它依然有效。但大多数情况下，使用 JavaScript 函数可以很方便的处理表单的提交， 同时还可以访问用户填写的表单数据。实现这种效果的标准方式是使用“受控组件”。</p><p>表单元素的value值受 state的控制</p></blockquote><h2 id="11-1-各种表单的绑定与取值"><a href="#11-1-各种表单的绑定与取值" class="headerlink" title="11.1 各种表单的绑定与取值"></a>11.1 各种表单的绑定与取值</h2><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./06_form/01_App_form&#x27;</span> <span class="comment">// 表单绑定 受控组件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/06_form/01_App_form.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">userName</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">sex</span>: <span class="string">&#x27;女&#x27;</span>,</span><br><span class="line">    <span class="attr">hobby</span>: [],</span><br><span class="line">    <span class="attr">lesson</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">note</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">flag</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// handlerUserNameChange = (event) =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   this.setState(&#123; userName: event.target.value &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="comment">// handlerPasswordChange = (event) =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   this.setState(&#123; password: event.target.value &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// handlerChange = (type, event) =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   this.setState(&#123; [type]: event.target.value &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  handlerChange = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(event.<span class="property">target</span>.<span class="property">name</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; [event.<span class="property">target</span>.<span class="property">name</span>]: event.<span class="property">target</span>.<span class="property">value</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handlerHobbyChange = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> checked = event.<span class="property">target</span>.<span class="property">checked</span></span><br><span class="line">    <span class="keyword">const</span> value = event.<span class="property">target</span>.<span class="property">value</span></span><br><span class="line">    <span class="keyword">const</span> arr = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">hobby</span></span><br><span class="line">    <span class="comment">// checked 为真选中，加入数组，为假 删除</span></span><br><span class="line">    <span class="keyword">if</span> (checked) &#123;</span><br><span class="line">      arr.<span class="title function_">push</span>(value)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> index = arr.<span class="title function_">findIndex</span>(<span class="function"><span class="params">item</span> =&gt;</span> item === value)</span><br><span class="line">      arr.<span class="title function_">splice</span>(index, <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(arr)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">hobby</span>: arr &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handlerFlagChange = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">flag</span>: event.<span class="property">target</span>.<span class="property">checked</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;/* <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&#x27;用户名&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.userName</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">this.handlerUserNameChange</span> &#125;/&gt;</span> &#123; this.state.userName &#125; */&#125;</span></span><br><span class="line"><span class="language-xml">          &#123;/* <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&#x27;用户名&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.userName</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">this.handlerChange.bind</span>(<span class="attr">this</span>, &#x27;<span class="attr">userName</span>&#x27;) &#125;/&gt;</span> &#123; this.state.userName &#125; */&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&#x27;用户名&#x27;</span> <span class="attr">name</span>=<span class="string">&quot;userName&quot;</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.userName</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">this.handlerChange</span> &#125;/&gt;</span> &#123; this.state.userName &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;/* <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&#x27;密码&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.password</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">this.handlerPasswordChange</span> &#125;/&gt;</span> &#123; this.state.password &#125; */&#125;</span></span><br><span class="line"><span class="language-xml">          &#123;/* <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&#x27;密码&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.password</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">this.handlerChange.bind</span>(<span class="attr">this</span>, &#x27;<span class="attr">password</span>&#x27;) &#125;/&gt;</span> &#123; this.state.password &#125; */&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&#x27;密码&#x27;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.password</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">this.handlerChange</span> &#125;/&gt;</span> &#123; this.state.password &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span>=<span class="string">&quot;男&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">checked</span>=<span class="string">&#123;</span> <span class="attr">this.state.sex</span> === <span class="string">&#x27;男&#x27;</span>&#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">this.handlerChange</span> &#125;/&gt;</span>男</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span>=<span class="string">&quot;女&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">checked</span>=<span class="string">&#123;</span> <span class="attr">this.state.sex</span> === <span class="string">&#x27;女&#x27;</span>&#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">this.handlerChange</span> &#125;/&gt;</span>女 --- &#123; this.state.sex &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;🏀&quot;</span> <span class="attr">onChange</span>=<span class="string">&#123;</span> <span class="attr">this.handlerHobbyChange</span> &#125;/&gt;</span>🏀</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;⚽&quot;</span> <span class="attr">onChange</span>=<span class="string">&#123;</span> <span class="attr">this.handlerHobbyChange</span> &#125;/&gt;</span>⚽</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;🏐&quot;</span> <span class="attr">onChange</span>=<span class="string">&#123;</span> <span class="attr">this.handlerHobbyChange</span> &#125;/&gt;</span>🏐</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;🏓&quot;</span> <span class="attr">onChange</span>=<span class="string">&#123;</span> <span class="attr">this.handlerHobbyChange</span> &#125;/&gt;</span>🏓 --- </span></span><br><span class="line"><span class="language-xml">          &#123; </span></span><br><span class="line"><span class="language-xml">            this.state.hobby &amp;&amp; this.state.hobby.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return <span class="tag">&lt;<span class="name">span</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item</span> &#125;&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#125;) </span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;lesson&quot;</span> <span class="attr">value</span>=<span class="string">&#123;this.state.lesson&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;</span> <span class="attr">this.handlerChange</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&#123;1&#125;</span>&gt;</span>1阶段<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&#123;2&#125;</span>&gt;</span>2阶段<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&#123;3&#125;</span>&gt;</span>3阶段<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">select</span>&gt;</span> --- &#123; this.state.lesson &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&#x27;note&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.note</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">this.handlerChange</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">checked</span> = <span class="string">&#123;</span> <span class="attr">this.state.flag</span> &#125; <span class="attr">onChange</span> = <span class="string">&#123;</span> <span class="attr">this.handlerFlagChange</span> &#125; /&gt;</span> ***** 用户协议 -- &#123; this.state.flag + &#x27;&#x27;&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="11-2-受控表单以及受控组件"><a href="#11-2-受控表单以及受控组件" class="headerlink" title="11.2 受控表单以及受控组件"></a>11.2 受控表单以及受控组件</h2><p>在 HTML 中，表单元素（如<code>&lt;input&gt;</code>、 <code>&lt;textarea&gt;</code> 和 <code>&lt;select&gt;</code>）之类的表单元素通常自己维护 state，并根据用户输入进行更新。而在 React 中，可变状态（mutable state）通常保存在组件的 state 属性中，并且只能通过使用 <a target="_blank" rel="noopener" href="https://react.docschina.org/docs/react-component.html#setstate"><code>setState()</code></a>来更新。</p><p>我们可以把两者结合起来，使 React 的 state 成为“唯一数据源”。渲染表单的 React 组件还控制着用户输入过程中表单发生的操作。被 React 以这种方式控制取值的表单输入元素就叫做“受控组件”。</p><blockquote><p><code>input</code>、<code>textarea</code>、<code>select</code> 受控组件： value的属性受了 <code>state</code> 的控制</p><ul><li>使用了受控组件，一定要写 <code>value</code> 属性以及<code>onChange</code>事件</li></ul><p><code>radio</code>、’checkbox’ 受控组件: checked 的属性受了<code>state</code>的控制</p><p>如果需要设置默认值，那么需要通过 <code>defaultValue</code> 以及<code>defaultChecked</code>设置</p></blockquote><p>案例如上</p><h1 id="十二、状态提升"><a href="#十二、状态提升" class="headerlink" title="十二、状态提升"></a>十二、状态提升</h1><p>在 React 中，将多个组件中需要共享的 state 向上移动到它们的最近共同父组件中，便可实现共享 state。这就是所谓的“状态提升”。</p><h2 id="12-1-父子组件通信"><a href="#12-1-父子组件通信" class="headerlink" title="12.1 父子组件通信"></a>12.1 父子组件通信</h2><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./07_state_up/01_App-parent-child-value&#x27;</span> <span class="comment">// 状态提升 多组件数据共享</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/07_state_up/01_App-parent-child-value.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">count</span>: <span class="number">1</span> &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>child1组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; this.state.count &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123; this.setState(&#123;count: this.state.count + 1&#125; ) &#125;&#125;&gt;加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child2</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">count</span>: <span class="number">1</span> &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>child2组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; this.state.count &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123; this.setState(&#123;count: this.state.count + 1&#125; ) &#125;&#125;&gt;加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child1</span> &gt;</span><span class="tag">&lt;/<span class="name">Child1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span>&gt;</span><span class="tag">&lt;/<span class="name">hr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child2</span> &gt;</span><span class="tag">&lt;/<span class="name">Child2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>我们发现Child1和Child2都是两个独立的个体，并没有实现数据共享</p></blockquote><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./07_state_up/02_App_state_up&#x27;</span> <span class="comment">// 状态提升 多组件数据共享</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/07_state_up/02_App_state_up.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// state = &#123; count: 1 &#125;</span></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>child1组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* &#123; this.state.count &#125; */&#125;</span></span><br><span class="line"><span class="language-xml">        &#123; this.props.count &#125;</span></span><br><span class="line"><span class="language-xml">        &#123;/* <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123; this.setState(&#123;count: this.state.count + 1&#125; ) &#125;&#125;&gt;加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.props.onClick</span> &#125;&gt;</span>加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Child2</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// state = &#123; count: 1 &#125;</span></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>child2组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       &#123;/* &#123; this.state.count &#125; */&#125;</span></span><br><span class="line"><span class="language-xml">       &#123; this.props.count &#125;</span></span><br><span class="line"><span class="language-xml">        &#123;/* <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123; this.setState(&#123;count: this.state.count + 1&#125; ) &#125;&#125;&gt;加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.props.onClick</span> &#125;&gt;</span>加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">count</span>: <span class="number">1</span> &#125;</span><br><span class="line">  add = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;<span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span>&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child1</span> <span class="attr">count</span> = <span class="string">&#123;</span> <span class="attr">this.state.count</span> &#125; <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">this.add</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Child1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span>&gt;</span><span class="tag">&lt;/<span class="name">hr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Child2</span> <span class="attr">count</span> = <span class="string">&#123;</span> <span class="attr">this.state.count</span> &#125; <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">this.add</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Child2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="12-2-状态提升解读"><a href="#12-2-状态提升解读" class="headerlink" title="12.2 状态提升解读"></a>12.2 状态提升解读</h2><p>实现方式是 利用最近的共同的父级组件中，用<code>props</code>的方式传过去到两个子组件，<code>props</code>中传的是一个<code>setState</code>的方法，通过子组件触发<code>props</code>传过去的方法，进而调用父级组件的<code>setState</code>的方法，改变了父级组件的<code>state</code>，调用父级组件的<code>add</code>方法，进而同时改变了两个子级组件的<code>数据</code>。</p><p>这是 两个有关连的<strong>同级组件</strong>的传值，因为<code>react</code>的单项数据流，所以不在两个组件中进行传值，而是提升到 最近的共同的父级组件中，改变父级的<code>state</code>,进而影响了两个子级组件的<code>render</code>。</p><blockquote><p>注意如果两个组件是同级组件（这两个组件的父组件是同一个）才考虑状态提升共享数据</p></blockquote><h1 id="十三、组合vs继承"><a href="#十三、组合vs继承" class="headerlink" title="十三、组合vs继承"></a>十三、组合vs继承</h1><p>React 有十分强大的组合模式。我们推荐使用组合而非继承来实现组件间的代码重用。</p><h2 id="13-1-理解组件化"><a href="#13-1-理解组件化" class="headerlink" title="13.1 理解组件化"></a>13.1 理解组件化</h2><p><strong>组件化是React的核心思想</strong>：</p><ul><li><p>组件化提供了一种抽象，让我们可以开发出一个个独立可复用的小组件来构造我们的应用。</p></li><li><p>任何的应用都会被抽象成一颗组件树。</p></li></ul><p><strong>组件化思想的应用</strong>：</p><ul><li><p>有了组件化的思想，我们在之后的开发中就要充分的利用它。</p></li><li><p>尽可能的将页面拆分成一个个小的、可复用的组件。</p></li><li><p>这样让我们的代码更加方便组织和管理，并且扩展性也更强。</p></li></ul><p><strong>React的组件相对于Vue更加的灵活和多样，按照不同的方式可以分成很多类 组件</strong>：</p><ul><li>根据组件的定义方式，可以分为：函数组件(Functional Component )和类组件(Class Component)；</li></ul><blockquote><p>vue 中有没有类组件和函数式组件？vue2中有</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line"> props:[],</span><br><span class="line"> data () &#123;</span><br><span class="line"> 	return &#123;&#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ul><li>vue中的函数式组件 - 无状态组件，所有的数据来源均来自父组件</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;template functional&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;props.msg&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>vue 中的类组件 - 兼容ts时</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;hello vue&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">class Home extends Vue &#123;&#125; // export default &#123;&#125;</span><br></pre></td></tr></table></figure></blockquote><ul><li><p>根据组件内部是否有状态需要维护，可以分成：无状态组件(Stateless Component )和有状态组件(Stateful Component)；</p></li><li><p>根据组件的不同职责，可以分成：展示型组件(Presentational Component - 只做数据的展示，一般不需要写更多的业务逻辑-数据请求不出现在展示型组件-顶多发出请求的指令-具体的请求交给容器型组件)和容器型组件(Container Component - 负责给展示性组件提供数据以及处理展示型组件需要的具体的业务逻辑) - 状态管理器-更容易理解；</p></li></ul><p>这些概念有很多重叠，但是他们最主要是关注数据逻辑和UI展示的分离：</p><ul><li>函数组件、无状态组件、展示型组件主要关注UI的展示；</li><li>类组件、有状态组件、容器型组件主要关注数据逻辑；</li></ul><h2 id="13-2-使用组合而非继承实现React组件化"><a href="#13-2-使用组合而非继承实现React组件化" class="headerlink" title="13.2 使用组合而非继承实现React组件化"></a>13.2 使用组合而非继承实现React组件化</h2><p>有些组件无法提前知晓它们子组件的具体内容，建议这些组件使用一个特殊的 <code>children</code> prop 来将他们的子组件传递到渲染结果中。</p><p><code>参照5.3章节</code></p><p>少数情况下，你可能需要在一个组件中预留出几个“洞”。这种情况下，我们可以不使用 <code>children</code>，而是自行约定：将所需内容传入 props，并使用相应的 prop。</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./08_com/01_App_props_slot&#x27;</span> <span class="comment">// 组合VS继承</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/08_com/01_App_props_slot.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Header</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; this.props.left &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; this.props.default &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; this.props.right &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; this.props.children &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Header1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; this.props.children[0] &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; this.props.children[1] &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; this.props.children[2] &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Header</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">left</span> = <span class="string">&#123;</span> &lt;<span class="attr">span</span>&gt;</span>logo<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">          default = &#123; <span class="tag">&lt;<span class="name">span</span>&gt;</span>搜索框<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">          right = &#123; <span class="tag">&lt;<span class="name">span</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          1111111111</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Header</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">left</span> = <span class="string">&#123;</span> &lt;<span class="attr">span</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">          default = &#123; <span class="tag">&lt;<span class="name">span</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">          right = &#123; <span class="tag">&lt;<span class="name">span</span>&gt;</span>更多<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Header1</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>logo<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>搜索框<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Header1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Header1</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>更多<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Header1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>像 App组件中的<code>left</code> 和<code>default</code>以及 right 的 属性对应的之类的<code>React</code> 元素本质就是对象（<code>object</code>），所以你可以把它们当作 <code>props</code>，像其他数据一样传递。这种方法可能使你想起vue中“插槽”（<code>slot</code>）的概念，但在 <code>React</code> 中没有“插槽”这一概念的限制，你可以将任何东西作为 props 进行传递。</p></blockquote><h2 id="13-3-封装Modal弹窗"><a href="#13-3-封装Modal弹窗" class="headerlink" title="13.3 封装Modal弹窗"></a>13.3 封装Modal弹窗</h2><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./08_com/02_App_modal&#x27;</span> <span class="comment">// 组合VS继承</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/08_com/02_App_modal.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Modal</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">position:</span> &#x27;<span class="attr">fixed</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">top:</span> <span class="attr">0</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">left:</span> <span class="attr">0</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">bottom:</span> <span class="attr">0</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">right:</span> <span class="attr">0</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">backgroundColor:</span> &#x27;<span class="attr">rgba</span>(<span class="attr">0</span>,<span class="attr">0</span>,<span class="attr">0</span>, <span class="attr">0.4</span>)&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125; &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">width:</span> &#x27;<span class="attr">50</span>%&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">minHeight:</span> &#x27;<span class="attr">300px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">backgroundColor:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125; &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          这里是一个模态框</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.props.onClick</span> &#125;&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">show</span>: <span class="literal">false</span> &#125;</span><br><span class="line">  close = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">show</span>: <span class="literal">false</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> this.setState(&#123; show: true &#125;)&#125;&gt;打开模态框<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          this.state.show ? <span class="tag">&lt;<span class="name">Modal</span> <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">this.close</span> &#125;/&gt;</span> : null</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>审查元素发现 Modal 组件是渲染在原来的组件的位置的，如果想要让它渲染到不同的位置怎么办呢？</p></blockquote><h2 id="13-4-ReactDOM-createPortal"><a href="#13-4-ReactDOM-createPortal" class="headerlink" title="13.4 ReactDOM.createPortal()"></a>13.4 ReactDOM.createPortal()</h2><p>普通的组件，子组件的元素将挂载到父组件的DOM节点中。</p><p>有时需要将元素渲染到DOM中的不同位置上去，这是就用到的portal的方法。</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./08_com/03_App_portal&#x27;</span> <span class="comment">// 封装模态框 portal</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/08_com/03_App_portal.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span> <span class="comment">// 这里不要使用 &#x27;react-dom/client&#x27; 引入</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Modal</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  modalRef = <span class="title class_">React</span>.<span class="title function_">createRef</span>()</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">ReactDOM</span>.<span class="title function_">createPortal</span>(</span><br><span class="line">      <span class="comment">// &lt;div id=&#x27;modal&#x27; ref=&quot;modal&quot; style=&#123; &#123;</span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;modal&#x27;</span> <span class="attr">ref</span>= <span class="string">&#123;</span> <span class="attr">this.modalRef</span> &#125; <span class="attr">style</span>=<span class="string">&#123;</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">position:</span> &#x27;<span class="attr">fixed</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">top:</span> <span class="attr">0</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">left:</span> <span class="attr">0</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">bottom:</span> <span class="attr">0</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">right:</span> <span class="attr">0</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">backgroundColor:</span> &#x27;<span class="attr">rgba</span>(<span class="attr">0</span>,<span class="attr">0</span>,<span class="attr">0</span>, <span class="attr">0.4</span>)&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">justifyContent:</span> &#x27;<span class="attr">center</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">this.props.onClick</span> &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span> = <span class="string">&#123;</span> (<span class="attr">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          console.log(event.target)</span></span><br><span class="line"><span class="language-xml">          console.log(document.getElementById(&#x27;modal&#x27;))</span></span><br><span class="line"><span class="language-xml">          console.log(this.modalRef)</span></span><br><span class="line"><span class="language-xml">          // if (event.target === document.getElementById(&#x27;modal&#x27;)) &#123; // ? id ?</span></span><br><span class="line"><span class="language-xml">          // if (event.target === this.refs.modal) &#123; // ? ref 删除线？</span></span><br><span class="line"><span class="language-xml">          if (event.target === this.modalRef.current) &#123; // ref的使用</span></span><br><span class="line"><span class="language-xml">            // 如何判断当前点击的是自身而不是子元素</span></span><br><span class="line"><span class="language-xml">            this.props.onClick()</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">          </span></span><br><span class="line"><span class="language-xml">        &#125; &#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">width:</span> &#x27;<span class="attr">50</span>%&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">minHeight:</span> &#x27;<span class="attr">300px</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">backgroundColor:</span> &#x27;#<span class="attr">fff</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125; &#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          // <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">event</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          //   event.stopPropagation()</span></span><br><span class="line"><span class="language-xml">          // &#125; &#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          这里是一个模态框</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.props.onClick</span> &#125;&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>,</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;body&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">show</span>: <span class="literal">false</span> &#125;</span><br><span class="line">  close = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">show</span>: <span class="literal">false</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> this.setState(&#123; show: true &#125;)&#125;&gt;打开模态框<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          this.state.show ? <span class="tag">&lt;<span class="name">Modal</span> <span class="attr">onClick</span> = <span class="string">&#123;</span> <span class="attr">this.close</span> &#125;/&gt;</span> : null</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>一个 portal 的典型用例是当父组件有 <code>overflow: hidden</code> 或 <code>z-index</code> 样式时，但你需要子组件能够在视觉上“跳出”其容器。例如，对话框、悬浮卡以及提示框：</p></blockquote><h1 id="十四、上下文Context"><a href="#十四、上下文Context" class="headerlink" title="十四、上下文Context"></a>十四、上下文Context</h1><h2 id="14-1-理解上下文、作用及其特点"><a href="#14-1-理解上下文、作用及其特点" class="headerlink" title="14.1 理解上下文、作用及其特点"></a>14.1 理解上下文、作用及其特点</h2><p>Context 提供了一个无需为每层组件手动添加 props，就能在组件树间进行数据传递的方法。</p><p>Context 设计目的是为了共享那些对于一个组件树而言是“全局”的数据，例如当前认证的用户、主题或首选语言。</p><p>Context 主要应用场景在于<em>很多</em>不同层级的组件需要访问同样一些的数据。请谨慎使用，因为这会使得组件的复用性变差。</p><h2 id="14-2-使用React-createContext"><a href="#14-2-使用React-createContext" class="headerlink" title="14.2 使用React.createContext()"></a>14.2 使用React.createContext()</h2><h3 id="14-2-1-逐层传递数据"><a href="#14-2-1-逐层传递数据" class="headerlink" title="14.2.1 逐层传递数据"></a>14.2.1 逐层传递数据</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./09_context/01_App_next_value&#x27;</span> <span class="comment">// 逐层传递数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/09_context/01_App_next_value.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Third</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>third<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123; this.props.val &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Second</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>second<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Third</span> <span class="attr">val</span> = <span class="string">&#123;</span> <span class="attr">props.val</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">First</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>first<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Second</span> <span class="attr">val</span>=<span class="string">&#123;</span> <span class="attr">props.val</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">First</span> <span class="attr">val</span>=<span class="string">&quot;传家宝&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h3 id="14-2-2-使用Context传值"><a href="#14-2-2-使用Context传值" class="headerlink" title="14.2.2 使用Context传值"></a>14.2.2 使用Context传值</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./09_context/02_App_context&#x27;</span> <span class="comment">// 上下文对象Context传值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/09_context/02_App_context.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 1.创建上下文对象 - 首字母大写，大驼峰式命名</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">LangContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.如果后代组件是类组件，可以有三种方式接收祖先组件的传递的值</span></span><br><span class="line"><span class="comment">//   3.1 定义好组件后 通过  组件.contextType = 上下文对象，这样就可以在组件中通过 this.context 获取到 组件组件的数据</span></span><br><span class="line"><span class="comment">// class Third extends Component &#123;</span></span><br><span class="line"><span class="comment">//   render () &#123;</span></span><br><span class="line"><span class="comment">//     return (</span></span><br><span class="line"><span class="comment">//       &lt;div&gt;</span></span><br><span class="line"><span class="comment">//         &lt;h3&gt;third&lt;/h3&gt;</span></span><br><span class="line"><span class="comment">//         &#123; this.context &#125;</span></span><br><span class="line"><span class="comment">//       &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//     )</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// Third.contextType = LangContext</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.2 使用类的静态属性contextType 等于上下文对象，然后通过 this.context 获取值</span></span><br><span class="line"><span class="comment">// class Third extends Component &#123;</span></span><br><span class="line"><span class="comment">//   static contextType = LangContext</span></span><br><span class="line"><span class="comment">//   render () &#123;</span></span><br><span class="line"><span class="comment">//     return (</span></span><br><span class="line"><span class="comment">//       &lt;div&gt;</span></span><br><span class="line"><span class="comment">//         &lt;h3&gt;third&lt;/h3&gt;</span></span><br><span class="line"><span class="comment">//         &#123; this.context &#125;</span></span><br><span class="line"><span class="comment">//       &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//     )</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.3 使用上下文对象的 Consumer 组件来获取值,需要组件内容写一个回调函数，回调函数参数即为祖先组件传递的值</span></span><br><span class="line"><span class="comment">// 发现第三种写法看似麻烦，但是如果祖先组件给后代组件通过多个上下文对象传递很多个数据时就很有用了，而前两种方法显得无能为力</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Third</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>third<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">LangContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            (val) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span>&gt;</span>语言为： &#123; val &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              )</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">LangContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Second</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Third</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">First</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>First<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Second</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">lang</span>: <span class="string">&#x27;zh&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; lang: &#x27;zh&#x27;&#125;)&#125;&gt;中文<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; lang: &#x27;en&#x27;&#125;)&#125;&gt;英文<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 2.祖先组件通过 上下文对象的Provider 组件 配合value进行传值 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">LangContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;this.state.lang&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">First</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">LangContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h3 id="14-2-3-传递多个值"><a href="#14-2-3-传递多个值" class="headerlink" title="14.2.3 传递多个值"></a>14.2.3 传递多个值</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./09_context/03_App_context_multiple_value&#x27;</span> <span class="comment">// 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/09_context/03_App_context_multiple_value.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 1.创建上下文对象 - 首字母大写，大驼峰式命名</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">LangContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ColorContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.如果后代组件是类组件，可以有三种方式接收祖先组件的传递的值</span></span><br><span class="line"><span class="comment">//   3.1 定义好组件后 通过  组件.contextType = 上下文对象，这样就可以在组件中通过 this.context 获取到 组件组件的数据</span></span><br><span class="line"><span class="comment">//   3.2 使用类的静态属性contextType 等于上下文对象，然后通过 this.context 获取值</span></span><br><span class="line"><span class="comment">//   3.3 使用上下文对象的 Consumer 组件来获取值,需要组件内容写一个回调函数，回调函数参数即为祖先组件传递的值</span></span><br><span class="line"><span class="comment">// 发现第三种写法看似麻烦，但是如果祖先组件给后代组件通过多个上下文对象传递很多个数据时就很有用了，而前两种方法显得无能为力</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Third</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>third<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ColorContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            (color) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">LangContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    &#123;</span></span><br><span class="line"><span class="language-xml">                      (val) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                        return (</span></span><br><span class="line"><span class="language-xml">                          <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span> = <span class="string">&#123;&#123;</span> <span class="attr">color:</span> <span class="attr">color</span> &#125;&#125;&gt;</span>语言为： &#123; val &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        )</span></span><br><span class="line"><span class="language-xml">                      &#125;</span></span><br><span class="line"><span class="language-xml">                    &#125;</span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;/<span class="name">LangContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/&gt;</span></span></span><br><span class="line"><span class="language-xml">              )</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ColorContext.Consumer</span>&gt;</span></span></span><br><span class="line">        </span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Second</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Third</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">First</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>First<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Second</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">lang</span>: <span class="string">&#x27;zh&#x27;</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&#x27;#f66&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; lang: &#x27;zh&#x27;&#125;)&#125;&gt;中文<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; lang: &#x27;en&#x27;&#125;)&#125;&gt;英文<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;color&quot;</span>  <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.color</span> &#125; <span class="attr">onChange</span>= <span class="string">&#123;</span> (<span class="attr">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">            color: event.target.value</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">        &#123;/* 2.祖先组件通过 上下文对象的Provider 组件 配合value进行传值 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">LangContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;this.state.lang&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">ColorContext.Provider</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">this.state.color</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">First</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">ColorContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">LangContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p>上述案例，还可以通过一个上下文对象传递多个值</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./09_context/04_App_one_context_multiple_value&#x27;</span> <span class="comment">// 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/09_context/04_App_one_context_multiple_value.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 1.创建上下文对象 - 首字母大写，大驼峰式命名</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.如果后代组件是类组件，可以有三种方式接收祖先组件的传递的值</span></span><br><span class="line"><span class="comment">//   3.1 定义好组件后 通过  组件.contextType = 上下文对象，这样就可以在组件中通过 this.context 获取到 组件组件的数据</span></span><br><span class="line"><span class="comment">// class Third extends Component &#123;</span></span><br><span class="line"><span class="comment">//   render () &#123;</span></span><br><span class="line"><span class="comment">//     return (</span></span><br><span class="line"><span class="comment">//       &lt;div&gt;</span></span><br><span class="line"><span class="comment">//         &lt;h3&gt;third&lt;/h3&gt;</span></span><br><span class="line"><span class="comment">//         &lt;div style = &#123;&#123; color: this.context.color &#125;&#125;&gt;1语言为： &#123; this.context.lang &#125;&lt;/div&gt;</span></span><br><span class="line"><span class="comment">//       &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//     )</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// Third.contextType = MyContext</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.2 使用类的静态属性contextType 等于上下文对象，然后通过 this.context 获取值</span></span><br><span class="line"><span class="comment">// class Third extends Component &#123;</span></span><br><span class="line"><span class="comment">//   static contextType = MyContext</span></span><br><span class="line"><span class="comment">//   render () &#123;</span></span><br><span class="line"><span class="comment">//     return (</span></span><br><span class="line"><span class="comment">//       &lt;div&gt;</span></span><br><span class="line"><span class="comment">//         &lt;h3&gt;third&lt;/h3&gt;</span></span><br><span class="line"><span class="comment">//         &lt;div style = &#123;&#123; color: this.context.color &#125;&#125;&gt;2语言为： &#123; this.context.lang &#125;&lt;/div&gt;</span></span><br><span class="line"><span class="comment">//       &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//     )</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.3 使用上下文对象的 Consumer 组件来获取值,需要组件内容写一个回调函数，回调函数参数即为祖先组件传递的值</span></span><br><span class="line"><span class="comment">// 发现第三种写法看似麻烦，但是如果祖先组件给后代组件通过多个上下文对象传递很多个数据时就很有用了，而前两种方法显得无能为力</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Third</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>third<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">MyContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            (val) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span> = <span class="string">&#123;&#123;</span> <span class="attr">color:val.color</span> &#125;&#125;&gt;</span>3语言为： &#123; val.lang &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              )</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">MyContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Second</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Third</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">First</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>First<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Second</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">lang</span>: <span class="string">&#x27;zh&#x27;</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&#x27;#f66&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; lang: &#x27;zh&#x27;&#125;)&#125;&gt;中文<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; lang: &#x27;en&#x27;&#125;)&#125;&gt;英文<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;color&quot;</span>  <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.color</span> &#125; <span class="attr">onChange</span>= <span class="string">&#123;</span> (<span class="attr">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">            color: event.target.value</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">        &#123;/* 2.祖先组件通过 上下文对象的Provider 组件 配合value进行传值 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">MyContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">lang:</span> <span class="attr">this.state.lang</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">color:</span> <span class="attr">this.state.color</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125; &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">First</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">MyContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p>如果遇到函数式组件如何获取Context的值</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./09_context/05_App_function_context_value&#x27;</span> <span class="comment">// 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/09_context/05_App_function_context_value.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 1.创建上下文对象 - 首字母大写，大驼峰式命名</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">LangContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.如果后代组件是类组件，可以有三种方式接收祖先组件的传递的值</span></span><br><span class="line"><span class="comment">//   3.1 定义好组件后 通过  组件.contextType = 上下文对象，这样就可以在组件中通过 this.context 获取到 组件组件的数据</span></span><br><span class="line"><span class="comment">// class Third extends Component &#123;</span></span><br><span class="line"><span class="comment">//   render () &#123;</span></span><br><span class="line"><span class="comment">//     return (</span></span><br><span class="line"><span class="comment">//       &lt;div&gt;</span></span><br><span class="line"><span class="comment">//         &lt;h3&gt;third&lt;/h3&gt;</span></span><br><span class="line"><span class="comment">//         &#123; this.context &#125;</span></span><br><span class="line"><span class="comment">//       &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//     )</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// Third.contextType = LangContext</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.2 使用类的静态属性contextType 等于上下文对象，然后通过 this.context 获取值</span></span><br><span class="line"><span class="comment">// class Third extends Component &#123;</span></span><br><span class="line"><span class="comment">//   static contextType = LangContext</span></span><br><span class="line"><span class="comment">//   render () &#123;</span></span><br><span class="line"><span class="comment">//     return (</span></span><br><span class="line"><span class="comment">//       &lt;div&gt;</span></span><br><span class="line"><span class="comment">//         &lt;h3&gt;third&lt;/h3&gt;</span></span><br><span class="line"><span class="comment">//         &#123; this.context &#125;</span></span><br><span class="line"><span class="comment">//       &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//     )</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.3 使用上下文对象的 Consumer 组件来获取值,需要组件内容写一个回调函数，回调函数参数即为祖先组件传递的值</span></span><br><span class="line"><span class="comment">// 发现第三种写法看似麻烦，但是如果祖先组件给后代组件通过多个上下文对象传递很多个数据时就很有用了，而前两种方法显得无能为力</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Third</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>third<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">LangContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            (val) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span>&gt;</span>语言为： &#123; val &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              )</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">LangContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 4.如果后代组件是函数式组件，可以有两种写法</span></span><br><span class="line"><span class="comment">// 4.1 使用上下文对象.Consumer完成传值</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Second</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">LangContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            (val) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> &gt;</span>Second - 语言为： &#123; val &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              )</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">LangContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Third</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.2 可以使用 useContext hooks 来获取值</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">First</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> lang = <span class="title function_">useContext</span>(<span class="title class_">LangContext</span>)</span><br><span class="line">  <span class="comment">// const color = useContext(ColorContext)</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>First<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> &gt;</span>First - 语言为： &#123; lang &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Second</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">lang</span>: <span class="string">&#x27;zh&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; lang: &#x27;zh&#x27;&#125;)&#125;&gt;中文<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; lang: &#x27;en&#x27;&#125;)&#125;&gt;英文<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 2.祖先组件通过 上下文对象的Provider 组件 配合value进行传值 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">LangContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;this.state.lang&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">First</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">LangContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>如果浏览器安装过 react的开发者工具,打开之后发现上述代码，都显示为 <code>Context.Provider</code> 和 <code>Context.Consumer</code>,不好区分</p><p>加入 上下文对象的 <code>displayName</code></p></blockquote><h3 id="14-2-4-displayName"><a href="#14-2-4-displayName" class="headerlink" title="14.2.4 displayName"></a>14.2.4 displayName</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./09_context/06_App_context_displayName&#x27;</span> <span class="comment">// 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/09_context/06_App_context_displayName.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 1.创建上下文对象 - 首字母大写，大驼峰式命名</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">LangContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ColorContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"></span><br><span class="line"><span class="title class_">LangContext</span>.<span class="property">displayName</span> = <span class="string">&#x27;LangContext&#x27;</span></span><br><span class="line"><span class="title class_">ColorContext</span>.<span class="property">displayName</span> = <span class="string">&#x27;ColorContext&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.如果后代组件是类组件，可以有三种方式接收祖先组件的传递的值</span></span><br><span class="line"><span class="comment">//   3.1 定义好组件后 通过  组件.contextType = 上下文对象，这样就可以在组件中通过 this.context 获取到 组件组件的数据</span></span><br><span class="line"><span class="comment">//   3.2 使用类的静态属性contextType 等于上下文对象，然后通过 this.context 获取值</span></span><br><span class="line"><span class="comment">//   3.3 使用上下文对象的 Consumer 组件来获取值,需要组件内容写一个回调函数，回调函数参数即为祖先组件传递的值</span></span><br><span class="line"><span class="comment">// 发现第三种写法看似麻烦，但是如果祖先组件给后代组件通过多个上下文对象传递很多个数据时就很有用了，而前两种方法显得无能为力</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Third</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>third<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ColorContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;</span></span><br><span class="line"><span class="language-xml">            (color) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">              return (</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">LangContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    &#123;</span></span><br><span class="line"><span class="language-xml">                      (val) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">                        return (</span></span><br><span class="line"><span class="language-xml">                          <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span> = <span class="string">&#123;&#123;</span> <span class="attr">color:</span> <span class="attr">color</span> &#125;&#125;&gt;</span>语言为： &#123; val &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        )</span></span><br><span class="line"><span class="language-xml">                      &#125;</span></span><br><span class="line"><span class="language-xml">                    &#125;</span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;/<span class="name">LangContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/&gt;</span></span></span><br><span class="line"><span class="language-xml">              )</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">          &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ColorContext.Consumer</span>&gt;</span></span></span><br><span class="line">        </span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Second</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Third</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">First</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>First<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Second</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">lang</span>: <span class="string">&#x27;zh&#x27;</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&#x27;#f66&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; lang: &#x27;zh&#x27;&#125;)&#125;&gt;中文<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setState(&#123; lang: &#x27;en&#x27;&#125;)&#125;&gt;英文<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;color&quot;</span>  <span class="attr">value</span>=<span class="string">&#123;</span> <span class="attr">this.state.color</span> &#125; <span class="attr">onChange</span>= <span class="string">&#123;</span> (<span class="attr">event</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          this.setState(&#123;</span></span><br><span class="line"><span class="language-xml">            color: event.target.value</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">        &#123;/* 2.祖先组件通过 上下文对象的Provider 组件 配合value进行传值 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">LangContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;this.state.lang&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">ColorContext.Provider</span> <span class="attr">value</span> = <span class="string">&#123;</span> <span class="attr">this.state.color</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">First</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">ColorContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">LangContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="14-3-常见应用场景解读"><a href="#14-3-常见应用场景解读" class="headerlink" title="14.3 常见应用场景解读"></a>14.3 常见应用场景解读</h2><ul><li>共享那些对于一个组件树而言是“全局”的数据，例如当前认证的用户、主题或首选语言</li><li>配合<code>react hooks</code> 中的<code>useReducer</code>可以实现轻量的 <code>redux</code></li></ul><h1 id="十五、高阶组件"><a href="#十五、高阶组件" class="headerlink" title="十五、高阶组件"></a>十五、高阶组件</h1><p>高阶组件（HOC）是 React 中用于复用组件逻辑的一种高级技巧。</p><p>HOC 自身不是 React API 的一部分，它是一种基于 React 的组合特性而形成的设计模式。</p><p>具体而言，<strong>高阶组件是参数为组件，返回值为新组件的函数。</strong></p><h2 id="15-1-理解高阶组件、作用及其特点"><a href="#15-1-理解高阶组件、作用及其特点" class="headerlink" title="15.1 理解高阶组件、作用及其特点"></a>15.1 理解高阶组件、作用及其特点</h2><p>一个高阶组件只是一个包装了另外一个 React 组件的 函数。<br>这种形式通常实现为一个函数，本质上是一个类工厂。</p><p>.实现了对原有组件的<code>增强和优化</code>。</p><p>可以对原有<code>组件</code>中的state, props和逻辑执行增删改操作, 一般用于代码<code>重用</code>和组件<code>增强优化</code></p><h2 id="15-2-高阶组件语法详解"><a href="#15-2-高阶组件语法详解" class="headerlink" title="15.2 高阶组件语法详解"></a>15.2 高阶组件语法详解</h2><p>我们想要我们的组件通过自动注入一个版权信息</p><h3 id="15-2-1-组件嵌套"><a href="#15-2-1-组件嵌套" class="headerlink" title="15.2.1 组件嵌套"></a>15.2.1 组件嵌套</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./10_hoc/01_App-more-use&#x27;</span> <span class="comment">// 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/10_hoc/01_App-more-use.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Footer</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">footer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Copyright © 2022 Meta Platforms, Inc.</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Page1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">userName</span>: <span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">userName</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;userName&#x27;</span>) &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>page1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Footer</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Page2</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">userName</span>: <span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">userName</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;userName&#x27;</span>) &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>page2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Footer</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Page3</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">userName</span>: <span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">userName</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;userName&#x27;</span>) &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>page3<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Footer</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Page1</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Page2</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Page3</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>通过<code>Footer</code>组件可以复用jsx代码，但是其余的业务逻辑代码显得无能为力，可以通过高阶组件来实现</p></blockquote><h3 id="15-2-2-高阶组件"><a href="#15-2-2-高阶组件" class="headerlink" title="15.2.2 高阶组件"></a>15.2.2 高阶组件</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./10_hoc/02_App-more-use-hoc&#x27;</span> <span class="comment">// 高阶组件 高阶组件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>)</span><br></pre></td></tr></table></figure><p><code>src/10_hoc/02_App-more-use-hoc.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;userName&#x27;</span>, <span class="string">&#x27;吴大勋&#x27;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Footer</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">footer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Copyright © 2022 Meta Platforms, Inc.</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 高阶组件的本质是一个函数，将一个组件作为参数，返回一个新的组件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">withFooter</span> = (<span class="params">Com</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">Component</span> &#123; <span class="comment">// 此处可以省略新组件的名称</span></span><br><span class="line">    <span class="comment">// 写公共部分的业务逻辑</span></span><br><span class="line">    state = &#123; <span class="attr">userName</span>: <span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line">    componentDidMount () &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;0000&#x27;</span>)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">userName</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;userName&#x27;</span>) &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render () &#123; <span class="comment">// 实际上此操作相当于完成父组件给子组件传值</span></span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Com</span> <span class="attr">userName</span> = <span class="string">&#123;</span> <span class="attr">this.state.userName</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Footer</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Page1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// state = &#123; userName: &#x27;&#x27;&#125;</span></span><br><span class="line">  <span class="comment">// componentDidMount () &#123;</span></span><br><span class="line">  <span class="comment">//   this.setState(&#123; userName: localStorage.getItem(&#x27;userName&#x27;) &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1111&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* <span class="tag">&lt;<span class="name">h1</span>&gt;</span>page1 - &#123; this.state.userName &#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>page1 - &#123; this.props.userName &#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* <span class="tag">&lt;<span class="name">Footer</span> /&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Page1</span> = <span class="title function_">withFooter</span>(<span class="title class_">Page1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Page2</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// state = &#123; userName: &#x27;&#x27;&#125;</span></span><br><span class="line">  <span class="comment">// componentDidMount () &#123;</span></span><br><span class="line">  <span class="comment">//   this.setState(&#123; userName: localStorage.getItem(&#x27;userName&#x27;) &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* <span class="tag">&lt;<span class="name">h1</span>&gt;</span>page2 - &#123; this.state.userName &#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>page2 - &#123; this.props.userName &#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* <span class="tag">&lt;<span class="name">Footer</span> /&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Page2</span> = <span class="title function_">withFooter</span>(<span class="title class_">Page2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Page3</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="comment">// state = &#123; userName: &#x27;&#x27;&#125;</span></span><br><span class="line">  <span class="comment">// componentDidMount () &#123;</span></span><br><span class="line">  <span class="comment">//   this.setState(&#123; userName: localStorage.getItem(&#x27;userName&#x27;) &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* <span class="tag">&lt;<span class="name">h1</span>&gt;</span>page3 - &#123; this.state.userName &#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>page3 - &#123; this.props.userName &#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* <span class="tag">&lt;<span class="name">Footer</span> /&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Page3</span> = <span class="title function_">withFooter</span>(<span class="title class_">Page3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Page1</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Page2</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Page3</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>先执行了 组件的生命周期，后执行了高阶组件的生命周期</p><p>但是以后再复用组件的业务时，可以选用函数式组件的自定义hooks</p></blockquote><h2 id="15-3-常见应用场景解读"><a href="#15-3-常见应用场景解读" class="headerlink" title="15.3 常见应用场景解读"></a>15.3 常见应用场景解读</h2><p>1.需要代码重用时, react如果有多个组件都用到了<code>同一段逻辑</code>, 这时,就可以把共同的逻辑部分提取出来,利用高阶组件的形式将这段逻辑整合到每一个组件中, 从而减少代码的逻辑重复</p><p>2.需要组件<code>增强优化时</code>, 比如我们在项目中使用的组件有些不是自己写的, 而是从网上撸下来的,但是<code>第三方</code>写的组件可能比较复杂, 有时不能完全满足需求, 但第三方组件不易修改, 此时也可以用高阶组件,在不修改原始组件的前提下, 对组件添加满足实际开发需求的功能</p><p>3.可以对原有<code>组件</code>中的state, props和逻辑执行增删改操作, 一般用于代码<code>重用</code>和组件<code>增强优化</code></p><p>4.也可以用来替换 <code>mixins</code> 混入</p><blockquote><p>父组件和高阶组件有什么区别？</p><ul><li>首先从逻辑的执行流程上来看，高阶组件确实和父组件比较相像</li><li>但是<code>高阶</code>组件强调的是<code>逻辑</code>的抽象。高阶组件是一个<code>函数</code>，函数关注的是逻辑；</li><li><code>父组件</code>是一个组件，组件主要关注的是<code>UI/DOM</code>。如果逻辑是与DOM直接相关的，那么这部分逻辑适合放到父组件中实现；</li><li>如果逻辑是与DOM不直接相关的，那么这部分逻辑适合使用高阶组件抽象，如数据校验、请求发送等。</li></ul></blockquote><h1 id="十六、ref"><a href="#十六、ref" class="headerlink" title="十六、ref"></a>十六、ref</h1><p>Refs 提供了一种方式，允许我们访问 DOM 节点或在 render 方法中创建的 React 元素。</p><h2 id="16-1-ref访问DOM"><a href="#16-1-ref访问DOM" class="headerlink" title="16.1 ref访问DOM"></a>16.1 ref访问DOM</h2><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./11_ref/01_App_ref&#x27;</span> <span class="comment">// ref的使用以及严格模式</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="comment">// 开启React的严格模式</span></span><br><span class="line">  <span class="comment">// https://react.docschina.org/docs/strict-mode.html</span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">React.StrictMode</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"><span class="comment">// react 18 为严格模式引入了一个全新的仅用于开发环境的检查操作。</span></span><br><span class="line"><span class="comment">// 每当第一次安装组件时，这个新的检查将自动卸载并重新安装每个组件，并在第二次挂载时恢复之前的 state。</span></span><br><span class="line"><span class="comment">// 慎用严格模式</span></span><br></pre></td></tr></table></figure><p><code>src/11_ref/01_App_ref.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span>)</span><br><span class="line">    <span class="comment">// this.setState(&#123; // Object.assign(&#123;&#125;)</span></span><br><span class="line">    <span class="comment">//   count: this.state.count + 1</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">state</span>) =&gt;</span> &#123; <span class="comment">// state 拿到的最新的值</span></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">count</span>: state.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;id&#x27;</span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn1&#x27;</span>))</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;refs&#x27;</span>, <span class="variable language_">this</span>.<span class="property">refs</span>.<span class="property">btn2</span>) <span class="comment">// refs已经被废弃，但是没有移除,严格模式下会报警告信息</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// componentWillMount () &#123;&#125; // 警告：被重命名</span></span><br><span class="line">  <span class="comment">// UNSAFE_componentWillMount () &#123;&#125; // 严格模式下识别不安全的生命周期</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 如果开启严格模式并且使用函数形式修改状态，输出结果为3 */&#125;</span></span><br><span class="line"><span class="language-xml">        &#123; this.state.count &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&#x27;btn1&#x27;</span>&gt;</span>按钮1-id<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">ref</span>=<span class="string">&#x27;btn2&#x27;</span>&gt;</span>按钮2-refs - 废弃<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./11_ref/02_App_ref&#x27;</span> <span class="comment">// ref的使用以及严格模式</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/11_ref/02_App_ref.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Com</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;类组件&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  testFn = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">name</span> + <span class="string">&#x27;!!!!!!!&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>类组件ref的使用<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">FunCom</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>函数式组件ref<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  btn3Ref = <span class="title class_">React</span>.<span class="title function_">createRef</span>() <span class="comment">// 创建一个唯一的 ref</span></span><br><span class="line">  comRef = <span class="title class_">React</span>.<span class="title function_">createRef</span>()</span><br><span class="line">  funRef = <span class="title class_">React</span>.<span class="title function_">createRef</span>()</span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;id&#x27;</span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn1&#x27;</span>))</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;refs&#x27;</span>, <span class="variable language_">this</span>.<span class="property">refs</span>.<span class="property">btn2</span>) <span class="comment">// refs已经被废弃，但是没有移除,严格模式下会报警告信息</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;domCreateRef&#x27;</span>, <span class="variable language_">this</span>.<span class="property">btn3Ref</span>.<span class="property">current</span>) </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;comCreateRef&#x27;</span>, <span class="variable language_">this</span>.<span class="property">comRef</span>.<span class="property">current</span>) </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;FuncomCreateRef&#x27;</span>, <span class="variable language_">this</span>.<span class="property">funRef</span>.<span class="property">current</span>) <span class="comment">// null</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&#x27;btn1&#x27;</span>&gt;</span>按钮1-id<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">ref</span>=<span class="string">&#x27;btn2&#x27;</span>&gt;</span>按钮2-refs - 废弃<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">ref</span>=<span class="string">&#123;</span> <span class="attr">this.btn3Ref</span> &#125;&gt;</span>按钮2 - createRef <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 父组件可以直接通过ref 获取 子组件的实例 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Com</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">this.comRef</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Com</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 函数式组件没有实例，获取不到子组件实例 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">FunCom</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">this.funRef</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">FunCom</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>如果在上述案例中，在<code>FunCom</code>组件中上使用ref，发现报了警告信息</p><p>Function components cannot be given refs. Attempts to access this ref will fail. Did you mean to use React.forwardRef()?</p><p>其原因是，函数式组件使用ref，<strong>必须使用React.forwardRef()方法二次包装</strong></p></blockquote><h2 id="16-2-详解ref转发"><a href="#16-2-详解ref转发" class="headerlink" title="16.2 详解ref转发"></a>16.2 详解ref转发</h2><p><strong>Ref 转发是一个可选特性，其允许某些组件接收 <code>ref</code>，并将其向下传递（换句话说，“转发”它）给子组件。</strong></p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./11_ref/03_App_ref_forward&#x27;</span> <span class="comment">// 转发ref</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/11_ref/03_App_ref_forward.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Com</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;类组件&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  testFn = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">name</span> + <span class="string">&#x27;!!!!!!!&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>类组件ref的使用<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FunCom</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span>&gt;</span>函数式组件ref<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Form</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&#x27;userName&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&#x27;password&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;/* <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span> <span class="attr">value</span>=<span class="string">&quot;重置&quot;</span> /&gt;</span> */&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  btn3Ref = <span class="title class_">React</span>.<span class="title function_">createRef</span>() <span class="comment">// 创建一个唯一的 ref</span></span><br><span class="line">  comRef = <span class="title class_">React</span>.<span class="title function_">createRef</span>()</span><br><span class="line">  funRef = <span class="title class_">React</span>.<span class="title function_">createRef</span>()</span><br><span class="line">  formRef = <span class="title class_">React</span>.<span class="title function_">createRef</span>()</span><br><span class="line">  componentDidMount () &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;id&#x27;</span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn1&#x27;</span>))</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;refs&#x27;</span>, <span class="variable language_">this</span>.<span class="property">refs</span>.<span class="property">btn2</span>) <span class="comment">// refs已经被废弃，但是没有移除,严格模式下会报警告信息</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;domCreateRef&#x27;</span>, <span class="variable language_">this</span>.<span class="property">btn3Ref</span>.<span class="property">current</span>) </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;comCreateRef&#x27;</span>, <span class="variable language_">this</span>.<span class="property">comRef</span>.<span class="property">current</span>) </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;FuncomCreateRef&#x27;</span>, <span class="variable language_">this</span>.<span class="property">funRef</span>.<span class="property">current</span>) <span class="comment">// </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 直接给form表单设置初始值</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">formRef</span>.<span class="property">current</span>.<span class="property">children</span>) <span class="comment">// </span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setFieldValue</span>(&#123;</span><br><span class="line">      <span class="attr">userName</span>: <span class="string">&#x27;吴大勋&#x27;</span>,</span><br><span class="line">      <span class="attr">password</span>: <span class="string">&#x27;123456&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  setFieldValue = <span class="function">(<span class="params">obj</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">formRef</span>.<span class="property">current</span>.<span class="property">children</span>[<span class="number">0</span>].<span class="property">value</span> = obj.<span class="property">userName</span> </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">formRef</span>.<span class="property">current</span>.<span class="property">children</span>[<span class="number">1</span>].<span class="property">value</span> = obj.<span class="property">password</span> </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&#x27;btn1&#x27;</span>&gt;</span>按钮1-id<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">ref</span>=<span class="string">&#x27;btn2&#x27;</span>&gt;</span>按钮2-refs - 废弃<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">ref</span>=<span class="string">&#123;</span> <span class="attr">this.btn3Ref</span> &#125;&gt;</span>按钮2 - createRef <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 父组件可以直接通过ref 获取 子组件的实例 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Com</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">this.comRef</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">Com</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 函数式组件没有实例，获取不到子组件实例 */&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">FunCom</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">this.funRef</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">FunCom</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Form</span> <span class="attr">ref</span>=<span class="string">&#123;this.formRef&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          console.log(this.formRef.current)</span></span><br><span class="line"><span class="language-xml">          this.formRef.current.reset()</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;重置表单<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h2 id="16-3-使用ref注意事项"><a href="#16-3-使用ref注意事项" class="headerlink" title="16.3 使用ref注意事项"></a>16.3 使用ref注意事项</h2><ul><li><p>当 <code>ref</code> 属性用于 HTML 元素时，使用 <code>React.createRef()</code> 创建的 <code>ref</code> 接收底层 DOM 元素作为其 <code>current</code> 属性。</p></li><li><p>当 <code>ref</code> 属性用于自定义 class 组件时，<code>ref</code> 对象接收组件的挂载实例作为其 <code>current</code> 属性。</p></li><li><p><strong>你不能在函数组件上使用 <code>ref</code> 属性</strong>，因为他们没有实例。如果非要使用，实际上是转发ref（父组件中获取到了子组件的某个DOM）</p></li><li><ul><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usedebugvalue">https://react.docschina.org/docs/hooks-reference.html#usedebugvalue</a>)</li></ul></li></ul><h1 id="十七、hooks"><a href="#十七、hooks" class="headerlink" title="十七、hooks"></a>十七、hooks</h1><h2 id="17-1-为什么使用hooks"><a href="#17-1-为什么使用hooks" class="headerlink" title="17.1 为什么使用hooks"></a>17.1 为什么使用hooks</h2><p>React 没有提供将可复用性行为“附加”到组件的途径（例如，把组件连接到 store）。如果你使用过 React 一段时间，你也许会熟悉一些解决此类问题的方案，比如 <a href="https://gitee.com/link?target=https://zh-hans.reactjs.org/docs/render-props.html">render props</a> 和 <a href="https://gitee.com/link?target=https://zh-hans.reactjs.org/docs/higher-order-components.html">高阶组件</a>。</p><p><strong>Hook 使你在非 class 的情况下可以使用更多的 React 特性。</strong> 从概念上讲，React 组件一直更像是函数。而 Hook 则拥抱了函数，同时也没有牺牲 React 的精神原则。Hook 提供了问题的解决方案，无需学习复杂的函数式或响应式编程技术。</p><p><strong>react 18版本以前hooks</strong></p><ul><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#basic-hooks">基础 Hook</a><ul><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usestate"><code>useState</code></a></li><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#useeffect"><code>useEffect</code></a></li><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usecontext"><code>useContext</code></a></li></ul></li><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#additional-hooks">额外的 Hook</a><ul><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usereducer"><code>useReducer</code></a></li><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usecallback"><code>useCallback</code></a></li><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#usememo"><code>useMemo</code></a></li><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#useref"><code>useRef</code></a></li><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#useimperativehandle"><code>useImperativeHandle</code></a></li><li><a target="_blank" rel="noopener" href="https://react.docschina.org/docs/hooks-reference.html#uselayouteffect"><code>useLayoutEffect</code></a></li><li><code>useDebugValue</code></li></ul></li></ul><h2 id="17-2常见的hooks"><a href="#17-2常见的hooks" class="headerlink" title="17.2常见的hooks"></a>17.2常见的hooks</h2><h3 id="17-2-1-useState"><a href="#17-2-1-useState" class="headerlink" title="17.2.1 useState"></a>17.2.1 useState</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/01_App_hooks_useState&#x27;</span> <span class="comment">// hooks useState</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/01_App_hooks_useState.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rsc</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数式组件内不要使用this</span></span><br><span class="line"><span class="comment">// 如果想要 this 指向函数式组件，本身这个想法就是错误的</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 定义了一个初始化状态 为count</span></span><br><span class="line">  <span class="comment">// 定义了一个修改初始化状态的函数 为 setCount</span></span><br><span class="line">  <span class="comment">// 使用 useState 定义了初始化装 count 的值为 1</span></span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [name, setName] = <span class="title function_">useState</span>(<span class="string">&#x27;吴&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">add100</span> () &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(count + <span class="number">100</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">add1000</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(count + <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">add10000</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(<span class="function"><span class="params">prevCount</span> =&gt;</span> &#123; <span class="comment">// 函数写法</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(prevCount) </span><br><span class="line">      <span class="keyword">return</span> prevCount + <span class="number">10000</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123; count &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        // 修改函数内部的值为 运算之后的结果</span></span><br><span class="line"><span class="language-xml">        setCount(count + 1)</span></span><br><span class="line"><span class="language-xml">      &#125; &#125;&gt;加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">function</span> () &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        // <span class="attr">修改函数内部的值为</span> <span class="attr">运算之后的结果</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">setCount</span>(<span class="attr">count</span> + <span class="attr">10</span>)</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125; &#125;&gt;</span>加10<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">add100</span> &#125;&gt;</span>加100<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">add1000</span> &#125;&gt;</span>加1000<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">add10000</span> &#125;&gt;</span>加10000<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123; name &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        setName(&#x27;吴大勋&#x27;)</span></span><br><span class="line"><span class="language-xml">      &#125; &#125;&gt;修改name<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/02_App_hooks_useState_obj&#x27;</span> <span class="comment">// hooks useState  object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/02_App_hooks_useState_obj.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [obj, setObj] = <span class="title function_">useState</span>(&#123;</span><br><span class="line">    <span class="attr">w</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attr">h</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">mouseMove</span> = (<span class="params">event</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 鼠标移动，发现 w 和 h 的数据丢失, &#123; x: 1, y: 1&#125; 代替了原来的对象 obj </span></span><br><span class="line">    <span class="comment">// setObj(&#123;</span></span><br><span class="line">    <span class="comment">//   x: event.clientX,</span></span><br><span class="line">    <span class="comment">//   y: event.clientY</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// setObj(&#123; // 合并新数据到原来的 obj</span></span><br><span class="line">    <span class="comment">//   ...obj,</span></span><br><span class="line">    <span class="comment">//   x: event.clientX,</span></span><br><span class="line">    <span class="comment">//   y: event.clientY</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">setObj</span>(<span class="function"><span class="params">prevObj</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// return &#123;</span></span><br><span class="line">      <span class="comment">//   w: prevObj.w,</span></span><br><span class="line">      <span class="comment">//   h: prevObj.h,</span></span><br><span class="line">      <span class="comment">//   x: event.clientX,</span></span><br><span class="line">      <span class="comment">//   y: event.clientY</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, prevObj, &#123; <span class="attr">x</span>: event.<span class="property">clientX</span> &#125;, &#123; <span class="attr">y</span>: event.<span class="property">clientY</span>&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">width:</span> &#x27;<span class="attr">100vw</span>&#x27;, <span class="attr">height:</span> &#x27;<span class="attr">100vh</span>&#x27; &#125; &#125; <span class="attr">onMouseMove</span> = <span class="string">&#123;</span> <span class="attr">mouseMove</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>元素的宽为: &#123; obj.w &#125;，元素的高为： &#123; obj.h &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>元素的坐标点为： (&#123; obj.x &#125;,&#123;  obj.y&#125;)<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/03_App_hooks_useState_state&#x27;</span> <span class="comment">// hooks useState  拆分对象状态</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/03_App_hooks_useState_state.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果不需要修改状态，那么可以不写解构的第二个值</span></span><br><span class="line">  <span class="keyword">const</span> [ box ] = <span class="title function_">useState</span>(&#123; <span class="attr">w</span>: <span class="number">100</span>, <span class="attr">h</span>: <span class="number">100</span> &#125;)</span><br><span class="line">  <span class="keyword">const</span> [position, setPosition] = <span class="title function_">useState</span>(&#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">mouseMove</span> = (<span class="params">event</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setPosition</span>(&#123;</span><br><span class="line">      <span class="attr">x</span>: event.<span class="property">clientX</span>,</span><br><span class="line">      <span class="attr">y</span>: event.<span class="property">clientY</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> &#123; <span class="attr">width:</span> &#x27;<span class="attr">100vw</span>&#x27;, <span class="attr">height:</span> &#x27;<span class="attr">100vh</span>&#x27; &#125; &#125; <span class="attr">onMouseMove</span> = <span class="string">&#123;</span> <span class="attr">mouseMove</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>元素的宽为: &#123; box.w &#125;，元素的高为： &#123; box.h &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span>元素的坐标点为： (&#123; position.x &#125;,&#123;  position.y&#125;)<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><ul><li><p><strong>不要在循环，条件或嵌套函数中调用 Hook，</strong> 确保总是在你的 React 函数的最顶层以及任何 return 之前调用他们。</p></li><li><p><strong>只在 React 函数中调用 Hook，</strong>不要在普通的 JavaScript 函数中调用 Hook。你可以：</p><ul><li>在 React 的函数组件中调用 Hook</li><li>在自定义 Hook 中调用其他 Hook</li></ul></li><li><p>如果遇到需要以对象的形式定义状态时，根据需求划分对象，因为修改状态使用的是替换</p></li></ul></blockquote><h3 id="17-2-2-useEffect"><a href="#17-2-2-useEffect" class="headerlink" title="17.2.2 useEffect"></a>17.2.2 useEffect</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/04_App_hooks_useEffect&#x27;</span> <span class="comment">// hooks useEffect  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> <span class="attr">root</span>=<span class="string">&#123;root&#125;/</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/04_App_hooks_useEffect.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [proList, setProList] = <span class="title function_">useState</span>([])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="comment">// 数据请求 --- 函数式组件没有 生命周期钩子函数</span></span><br><span class="line">  <span class="comment">// useEffect 的第一个参数是一个回调函数 类似于类组件中的 componentDidMount 以及 componentDidUpdate</span></span><br><span class="line">  <span class="comment">// useEffect 内的代码会自动执行</span></span><br><span class="line">  <span class="comment">// useEffect 如果没有添加第二个依赖的参数，那么只要内部修改果状态，此部分代码就会一直执行</span></span><br><span class="line">  <span class="comment">// useEffect(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   fetch(&#x27;http://121.89.205.189:3001/api/pro/list&#x27;).then(res =&gt; res.json()).then(res =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     console.log(res.data) // 第一次打印 - componentDidMount</span></span><br><span class="line">  <span class="comment">//     setProList(res.data) // 发现上一句话一直在打印 - componentDidUpdate 且没有条件限制</span></span><br><span class="line">  <span class="comment">//   &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 可以给useEffect添加第二个参数进行控制内部代码执行的次数</span></span><br><span class="line">  <span class="comment">// useEffect(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   fetch(&#x27;http://121.89.205.189:3001/api/pro/list&#x27;).then(res =&gt; res.json()).then(res =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     console.log(res.data) </span></span><br><span class="line">  <span class="comment">//     setProList(res.data) </span></span><br><span class="line">  <span class="comment">//   &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;, []) // useEffect 第二个参数为空数组，代表useEffect 内部只会执行类似 componentDidMount 的操作</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 依赖值发生改变，再次触发代码执行，类似于componentDidUpdate中特定条件下请求数据</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>) </span><br><span class="line">      <span class="title function_">setProList</span>(res.<span class="property">data</span>) </span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [count]) <span class="comment">// 第二个参数写入值，代表只有当count的值发生改变时，才会再次触发useEffect，再次执行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如何模拟 组件的销毁呢？</span></span><br><span class="line">  <span class="comment">// 在useEffect内部的回调函数中 返回一个函数</span></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 为防止内存泄漏，清除函数会在组件卸载前执行。</span></span><br><span class="line">    <span class="comment">// 另外，如果组件多次渲染（通常如此），则在执行下一个 effect 之前，上一个 effect 就已被清除。</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123; <span class="comment">// 类似于类组件中的componentWillUnmount</span></span><br><span class="line">      <span class="comment">// 取消订阅的操作，销毁定时器，计时器等操作</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;组件销毁了&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [count])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        setCount(count + 1)</span></span><br><span class="line"><span class="language-xml">        if (count === 5) &#123;</span></span><br><span class="line"><span class="language-xml">          props.root.unmount()</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span> &#123; count &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          proList &amp;&amp; proList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span> &#123; item.proname &#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><ol><li>useEffect() 是个副作用函数。</li><li>useEffect() 函数在每次组件重新渲染时，可再次被调用。</li><li>在开发环境中，开启了 React.StrictMode 模式，组件开始时被渲染两次。</li><li>useEffect() 通过返回函数来清理副作用。</li><li>useEffect() 通过传递第二个参数数组来提高渲染性能，或者说实现 watch 效果。</li></ol></blockquote><h3 id="17-2-3-useRef"><a href="#17-2-3-useRef" class="headerlink" title="17.2.3 useRef"></a>17.2.3 useRef</h3><p>利用 <code>useRef</code> 就可以绕过 Capture Value 的特性。<strong>可以认为</strong> <code>ref</code> <strong>在所有 Render 过程中保持着唯一引用，因此所有对</strong> <code>ref</code> <strong>的赋值或取值，拿到的都只有一个最终状态</strong>，而不会在每个 Render 间存在隔离。</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/05_App_hooks_useRef&#x27;</span> <span class="comment">// hooks useRef  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/05_App_hooks_useRef.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FunCom</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">ref</span> &#125;&gt;</span>函数式组件<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Com</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">name</span>: <span class="string">&#x27;类组件&#x27;</span> &#125;</span><br><span class="line">  testFn = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">name</span> + <span class="string">&#x27;!!&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>类组件<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> btnRef = <span class="title function_">useRef</span>() <span class="comment">// 类组件中  React.createRef()</span></span><br><span class="line">  <span class="keyword">const</span> comRef = <span class="title function_">useRef</span>()</span><br><span class="line">  <span class="keyword">const</span> funRef = <span class="title function_">useRef</span>()</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(btnRef.<span class="property">current</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(comRef.<span class="property">current</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(funRef.<span class="property">current</span>)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">btnRef</span> &#125;&gt;</span>按钮ref<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Com</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">comRef</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">FunCom</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">funRef</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><h3 id="17-2-4-useReducer"><a href="#17-2-4-useReducer" class="headerlink" title="17.2.4 useReducer"></a>17.2.4 useReducer</h3><p>useReducer 践行了 Flux&#x2F;Redux 思想。使用步骤：</p><p>1、创建初始值initialState</p><p>2、创建所有操作 reducer(state, action);</p><p>3、传给 userReducer，得到读和写API</p><p>4、调用写 ({type: ‘操作类型’})</p><p>总的来说，useReducer 是 useState 的复杂版。</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/05_App_hooks_useRef&#x27; // hooks useRef  </span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/06_App_hooks_useReducer&#x27;</span> <span class="comment">// hooks useReducer  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/06_App_hooks_useReducer.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 1.创建初始化状态</span></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  <span class="attr">bannerList</span>: [],</span><br><span class="line">  <span class="attr">proList</span>: []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.创建所有操作 reducer(state, action)</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_BANNER_LIST&#x27;</span>:</span><br><span class="line">      <span class="comment">// 返回一个新的状态 -- 当触发修改轮播图数据时，得到一个新的数据</span></span><br><span class="line">      <span class="comment">// 如何保证得到一份新的数据  -- 推荐使用 对象的合并</span></span><br><span class="line">      <span class="comment">// return &#123; ...state, bannerList: action.payload &#125;</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, state, &#123; <span class="attr">bannerList</span>: action.<span class="property">payload</span> &#125;)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">proList</span>: action.<span class="property">payload</span> &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 3.传给 userReducer，得到读和写API</span></span><br><span class="line">  <span class="comment">// state代表所有的数据</span></span><br><span class="line">  <span class="comment">// dispatch可以触发reducer的改变</span></span><br><span class="line">  <span class="keyword">const</span> [state, dispatch] = <span class="title function_">useReducer</span>(reducer, initialState)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/banner/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;CHANGE_BANNER_LIST&#x27;</span>,</span><br><span class="line">        <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>,</span><br><span class="line">        <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       &#123;</span></span><br><span class="line"><span class="language-xml">          state.bannerList &amp;&amp; state.bannerList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.bannerid</span> &#125;  <span class="attr">alt</span>=<span class="string">&#123;</span> <span class="attr">item.alt</span> &#125; <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">item.img</span> &#125; <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">100</span> &#125;&#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          state.proList &amp;&amp; state.proList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span> &#123; item.proname &#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>如果遇到多个组件需要共享状态时，单纯useReducer就显得无能为力</p></blockquote><h3 id="17-2-5-useContext"><a href="#17-2-5-useContext" class="headerlink" title="17.2.5 useContext"></a>17.2.5 useContext</h3><p>1、使用 C &#x3D; createContext(initial) 创建上下文</p><p>2、使用 &lt;C.Provider&gt; 圈定作用域</p><p>3、在作用域内使用 useContext(C)来使用上下文</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/05_App_hooks_useRef&#x27; // hooks useRef  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/06_App_hooks_useReducer&#x27; // hooks useReducer  </span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/07_App_hooks_useContext&#x27;</span> <span class="comment">// hooks useContext  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/07_App_hooks_useContext.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">LangContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ColorContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Second</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> lang = <span class="title function_">useContext</span>(<span class="title class_">LangContext</span>)</span><br><span class="line">  <span class="keyword">const</span> color = <span class="title function_">useContext</span>(<span class="title class_">ColorContext</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123; lang &#125; - &#123; color &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">First</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>first<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Second</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">LangContext.Provider</span> <span class="attr">value</span> = <span class="string">&quot;中文&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ColorContext.Provider</span> <span class="attr">value</span> = <span class="string">&quot;red&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">First</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ColorContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">LangContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p><strong>使用 useReducer 和 useContext 实现轻型Redux,可以让组件间共享状态</strong></p><p>步骤：</p><p>1、将数据集中在一个 store 对象</p><p>2、将所有操作集中在 reducer</p><p>3、创建一个 Context</p><p>4、创建对数据的读取 API</p><p>5、将第四步的内容放到第三步的 Context</p><p>6、用 Context.Provider 将 Context 提供给所有组件</p><p>7、各个组件用 useContext 获取读写API</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/05_App_hooks_useRef&#x27; // hooks useRef  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/06_App_hooks_useReducer&#x27; // hooks useReducer  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/07_App_hooks_useContext&#x27; // hooks useContext  </span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/08_App_hooks_redux&#x27;</span> <span class="comment">// hooks useContext useReducer redux</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/09-App-redux.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>()</span><br><span class="line"><span class="keyword">const</span> intitalState = &#123;</span><br><span class="line">  <span class="attr">userName</span>: <span class="string">&#x27;吴大勋&#x27;</span>,</span><br><span class="line">  <span class="attr">count</span>: <span class="number">100</span>,</span><br><span class="line">  <span class="attr">proList</span>: []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state, action</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_USER_NAME&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">userName</span>: action.<span class="property">payload</span> &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_COUNT&#x27;</span>: </span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">count</span>: action.<span class="property">payload</span>&#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>: </span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">proList</span>: action.<span class="property">payload</span>&#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// const [state, dispatch] = useReducer(reducer, intitalState)</span></span><br><span class="line">  <span class="keyword">const</span> &#123; state, dispatch &#125;  = <span class="title function_">useContext</span>(<span class="title class_">MyContext</span>)</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// 不要直接在回调函数上使用async</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">fetchData</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span>  <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">      <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>,</span><br><span class="line">        <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">fetchData</span>()</span><br><span class="line"></span><br><span class="line">  &#125;, [dispatch])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          state.proList &amp;&amp; state.proList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span> &#123; item.proname &#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">List</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// const [state, dispatch] = useReducer(reducer, intitalState)</span></span><br><span class="line">  <span class="keyword">const</span> &#123; state &#125;  = <span class="title function_">useContext</span>(<span class="title class_">MyContext</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>List<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          state.proList &amp;&amp; state.proList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span> &#123; item.proname &#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Home 组件  以及 List 组件共享 列表数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [state, dispatch] = <span class="title function_">useReducer</span>(reducer, intitalState)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MyContext.Provider</span> <span class="attr">value</span> = <span class="string">&#123;</span> &#123;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">state</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">dispatch</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125; &gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">List</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">MyContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>useContext + useReducer 可以实现轻型redux，但是不适合应用于多模块管理的大型项目</p></blockquote><h3 id="17-2-6-useMemo"><a href="#17-2-6-useMemo" class="headerlink" title="17.2.6 useMemo"></a>17.2.6 useMemo</h3><h3 id="17-2-7-useCallback"><a href="#17-2-7-useCallback" class="headerlink" title="17.2.7 useCallback"></a>17.2.7 useCallback</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/05_App_hooks_useRef&#x27; // hooks useRef  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/06_App_hooks_useReducer&#x27; // hooks useReducer  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/07_App_hooks_useContext&#x27; // hooks useContext  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/08_App_hooks_redux&#x27; // hooks useContext useReducer redux</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/09_App_hooks_useCallback_useMemo&#x27;</span> <span class="comment">// hooks useCallback useMemo 提升性能以及计算属性</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/09_App_hooks_useCallback_useMemo.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useCallback &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const Child = (props) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   console.log(&#x27;child被执行了&#x27;)</span></span><br><span class="line"><span class="comment">//   return (</span></span><br><span class="line"><span class="comment">//     &lt;div&gt;child - &#123; props.b &#125;&lt;/div&gt;</span></span><br><span class="line"><span class="comment">//   )</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Child</span> = <span class="title class_">React</span>.<span class="title function_">memo</span>(<span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;child被执行了&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>child - &#123; props.b &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Com</span> = <span class="title class_">React</span>.<span class="title function_">memo</span>(<span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;com被执行了&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>com - &#123; props.b &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [a, setA] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line">  <span class="comment">// const [b] = useState(100)</span></span><br><span class="line">  <span class="keyword">const</span> [b, setB] = <span class="title function_">useState</span>(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [list, setList] = <span class="title function_">useState</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setA</span>(a + <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">addB</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setB</span>(b + <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 每次更新生成一个新的引用，意味这属性发生改变</span></span><br><span class="line">  <span class="comment">// const testFn = () =&gt; &#123;&#125;</span></span><br><span class="line">  <span class="comment">// 如果记住这个函数 useCallback 以及 useMemo ，从而达到提升组件性能的目的</span></span><br><span class="line">  <span class="comment">// const testFn = useCallback(() =&gt; &#123; // useCallback结构</span></span><br><span class="line">  <span class="comment">//   return (event) =&gt; &#123; // 真正的函数实现</span></span><br><span class="line">  <span class="comment">//   &#125;</span></span><br><span class="line">  <span class="comment">// &#125;, []) // 依赖值的改变，重新生成新的引用</span></span><br><span class="line">  <span class="keyword">const</span> testFn = <span class="title function_">useMemo</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123; <span class="comment">// 真正的函数</span></span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 函数式组件中，通常使用useMemo可以实现计算属性</span></span><br><span class="line">  <span class="comment">// const doubleA = a * 2 // 不推荐</span></span><br><span class="line">  <span class="keyword">const</span> doubleA = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a * <span class="number">2</span></span><br><span class="line">  &#125;, [a])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> len = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> list.<span class="property">length</span></span><br><span class="line">  &#125;, [list])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        const arr = JSON.parse(JSON.stringify(list)) // 深拷贝</span></span><br><span class="line"><span class="language-xml">        arr.push(len+1)</span></span><br><span class="line"><span class="language-xml">        setList(arr)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;&gt;追加数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span>&#123;list&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">add</span> &#125;&gt;</span>a加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span> &#123; a &#125; - &#123; doubleA &#125; - &#123; len &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">addB</span> &#125;&gt;</span>b加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span> &#123; b &#125;</span></span><br><span class="line"><span class="language-xml">      &#123;/* 理想情况 b的值发生改变，Child 组件才被重新渲染 */&#125;</span></span><br><span class="line"><span class="language-xml">      &#123;/* 可以使用高阶组件 React.memo() 包裹一下Child组件 */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Child</span> <span class="attr">b</span>=<span class="string">&#123;</span> <span class="attr">b</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      &#123;/* 组件的状态发生改变，组件重新渲染，重新渲染，就会给函数生成一个新的地址，意味着全新的一个属性 */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Com</span> <span class="attr">b</span> = <span class="string">&#123;</span> <span class="attr">b</span> &#125; <span class="attr">testFn</span> = <span class="string">&#123;</span> <span class="attr">testFn</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>useCallback 应用于 组件的事件，使用useCallback 包裹组件 - 记忆函数</p><p>useMemo 可以是计算属性， 也应用于 组件的事件，使用useMemo 包裹组件 - 记忆组件</p></blockquote><h3 id="17-2-8-useImperativeHandle"><a href="#17-2-8-useImperativeHandle" class="headerlink" title="17.2.8 useImperativeHandle"></a>17.2.8 useImperativeHandle</h3><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/05_App_hooks_useRef&#x27; // hooks useRef  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/06_App_hooks_useReducer&#x27; // hooks useReducer  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/07_App_hooks_useContext&#x27; // hooks useContext  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/08_App_hooks_redux&#x27; // hooks useContext useReducer redux</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/09_App_hooks_useCallback_useMemo&#x27; // hooks useCallback useMemo 提升性能以及计算属性</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/10_App_hooks_useImperativeHandle.jsx&#x27;</span> <span class="comment">// useImperativeHandle 父组件操作子组件的方法</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/10_App_hooks_useImperativeHandle.jsx.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const Child = React.forwardRef((props, ref) =&gt; &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   return (</span></span><br><span class="line"><span class="comment">//     &lt;&gt;</span></span><br><span class="line"><span class="comment">//       &lt;input ref = &#123; ref &#125;/&gt;</span></span><br><span class="line"><span class="comment">//     &lt;/&gt;</span></span><br><span class="line"><span class="comment">//   )</span></span><br><span class="line"><span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以实现子组件中多个 ref 的使用</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Child</span> = <span class="title class_">React</span>.<span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title class_">React</span>.<span class="title function_">useRef</span>()</span><br><span class="line">  <span class="keyword">const</span> divRef = <span class="title class_">React</span>.<span class="title function_">useRef</span>()</span><br><span class="line">  <span class="comment">// 父组件通过 ref 即可 调用 内部自定义的函数 通过透传ref解决问题</span></span><br><span class="line">  <span class="title class_">React</span>.<span class="title function_">useImperativeHandle</span>(ref, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">inputFocus</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        inputRef.<span class="property">current</span>.<span class="title function_">focus</span>()</span><br><span class="line">      &#125;,</span><br><span class="line">      wirteVal (str) &#123;</span><br><span class="line">        divRef.<span class="property">current</span>.<span class="property">innerHTML</span> = str</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">inputRef</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">divRef</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> childRef = <span class="title class_">React</span>.<span class="title function_">useRef</span>()</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        // childRef.current.focus()</span></span><br><span class="line"><span class="language-xml">        childRef.current.inputFocus()</span></span><br><span class="line"><span class="language-xml">      &#125;&#125; style=&#123;&#123; marginRight: 30 &#125;&#125;&gt;获取焦点<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        // childRef.current.focus()</span></span><br><span class="line"><span class="language-xml">        childRef.current.wirteVal(&#x27;hello hooks!!&#x27;)</span></span><br><span class="line"><span class="language-xml">      &#125;&#125; style=&#123;&#123; marginRight: 30 &#125;&#125;&gt;写入内容<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Child</span> <span class="attr">ref</span> = <span class="string">&#123;</span> <span class="attr">childRef</span> &#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p>上面这个例子中与直接转发 ref 不同，直接转发 ref 是将 <code>React.forwardRef</code> 中函数上的 ref 参数直接应用在了返回元素的 ref 属性上，其实父、子组件引用的是同一个 ref 的 current 对象，官方不建议使用这样的 ref 透传，而使用 <code>useImperativeHandle</code> 后，可以让父、子组件分别有自己的 ref，通过 <code>React.forwardRef</code> 将父组件的 ref 透传过来，通过 <code>useImperativeHandle</code> 方法来自定义开放给父组件的 current。</p><p><code>useImperativeHandle</code> 的第一个参数是定义 current 对象的 ref，第二个参数是一个函数，返回值是一个对象，即这个 ref 的 current 对象，这样可以像上面的案例一样，通过自定义父组件的 ref 来使用子组件 ref 的某些方法。</p><p><code>useImperativeHandle</code> 和<code>React.forwardRef</code>必须是配合使用的，这也是为什么在开头要介绍 ref 的转发。</p><h3 id="17-2-9-useLayoutEffect"><a href="#17-2-9-useLayoutEffect" class="headerlink" title="17.2.9 useLayoutEffect"></a>17.2.9 useLayoutEffect</h3><p>useLayoutEffect 与 useEffect的区别：</p><ul><li><code>useEffect</code> 是异步执行的，而<code>useLayoutEffect</code>是同步执行的。</li><li><code>useEffect</code> 的执行时机是浏览器完成渲染之后，而 <code>useLayoutEffect</code> 的执行时机是浏览器把内容真正渲染到界面之前</li></ul><p>举个例子：</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/05_App_hooks_useRef&#x27; // hooks useRef  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/06_App_hooks_useReducer&#x27; // hooks useReducer  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/07_App_hooks_useContext&#x27; // hooks useContext  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/08_App_hooks_redux&#x27; // hooks useContext useReducer redux</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/09_App_hooks_useCallback_useMemo&#x27; // hooks useCallback useMemo 提升性能以及计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/10_App_hooks_useImperativeHandle.jsx&#x27; // useImperativeHandle 父组件操作子组件的方法</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/11_App_hooks_useLayoutEffect&#x27;</span> <span class="comment">// useLayoutEffect </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/13-App-useLayoutEffect.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useLayoutEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const App = () =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   const [count, setCount] = useState(1)</span></span><br><span class="line"><span class="comment">//   useEffect(() =&gt; &#123; // 副作用操作- 异步操作</span></span><br><span class="line"><span class="comment">//     console.log(&#x27;useEffect&#x27;) // 后执行</span></span><br><span class="line"><span class="comment">//     document.title = count + &#x27;!!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   &#125;)</span></span><br><span class="line"><span class="comment">//   useLayoutEffect(() =&gt; &#123; // 同步操作 - DOM相关</span></span><br><span class="line"><span class="comment">//     console.log(&#x27;useLayoutEffect&#x27;) // 先执行</span></span><br><span class="line"><span class="comment">//     document.title = count</span></span><br><span class="line"><span class="comment">//   &#125;) </span></span><br><span class="line"><span class="comment">//   return (</span></span><br><span class="line"><span class="comment">//     &lt;div&gt;</span></span><br><span class="line"><span class="comment">//       &lt;h1&gt;useLayoutEffect&lt;/h1&gt;</span></span><br><span class="line"><span class="comment">//       &#123; count &#125;</span></span><br><span class="line"><span class="comment">//       &lt;button onClick=&#123; () =&gt; &#123;</span></span><br><span class="line"><span class="comment">//         setCount(count + 1)</span></span><br><span class="line"><span class="comment">//       &#125;&#125;&gt;加1&lt;/button&gt;</span></span><br><span class="line"><span class="comment">//     &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//   );</span></span><br><span class="line"><span class="comment">// &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [ state1, setState1 ] = <span class="title function_">useState</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> [ state2, setState2 ] = <span class="title function_">useState</span>(<span class="string">&#x27;hi&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt; <span class="number">1000000000</span>) &#123;</span><br><span class="line">      i++</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">setState1</span>(<span class="string">&#x27;world&#x27;</span>)</span><br><span class="line">  &#125;, [])</span><br><span class="line">  <span class="title function_">useLayoutEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt; <span class="number">1000000000</span>) &#123;</span><br><span class="line">      i++</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">setState2</span>(<span class="string">&#x27;world&#x27;</span>)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;state1&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;state2&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>注意观察 useEffect 抖动现象</p><p>useLayoutEffect 做DOM操作</p><p>useEffect 中 副作用执行</p></blockquote><h3 id="17-2-10-useDebugValue"><a href="#17-2-10-useDebugValue" class="headerlink" title="17.2.10 useDebugValue"></a>17.2.10 useDebugValue</h3><p><code>useDebugValue</code> 可用于在 React 开发者工具中显示自定义 hook 的标签。</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/05_App_hooks_useRef&#x27; // hooks useRef  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/06_App_hooks_useReducer&#x27; // hooks useReducer  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/07_App_hooks_useContext&#x27; // hooks useContext  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/08_App_hooks_redux&#x27; // hooks useContext useReducer redux</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/09_App_hooks_useCallback_useMemo&#x27; // hooks useCallback useMemo 提升性能以及计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/10_App_hooks_useImperativeHandle.jsx&#x27; // useImperativeHandle 父组件操作子组件的方法</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/11_App_hooks_useLayoutEffect&#x27; // useLayoutEffect </span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/12_App_hooks_useDebugValue&#x27;</span> <span class="comment">// useDebugValue </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/12_App_hooks_useDebugValue.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect, useState, useDebugValue &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const App = () =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   const [count, setCount] = useState(1)</span></span><br><span class="line"><span class="comment">//   const add = () =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     setCount(count + 1)</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   useEffect(() =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     document.title = `点击了$&#123;count&#125;次`</span></span><br><span class="line"><span class="comment">//   &#125;)</span></span><br><span class="line"><span class="comment">//   return (</span></span><br><span class="line"><span class="comment">//     &lt;div&gt;</span></span><br><span class="line"><span class="comment">//       &lt;button onClick=&#123; add &#125;&gt;加1&lt;/button&gt;</span></span><br><span class="line"><span class="comment">//     &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//   );</span></span><br><span class="line"><span class="comment">// &#125;;</span></span><br><span class="line"><span class="comment">// 自定义hook</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useCount</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setCount</span>(count + <span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">useDebugValue</span>(<span class="string">&#x27;myCount&#x27;</span>) <span class="comment">// 自定义Hook起名</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    count,</span><br><span class="line">    add</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useTitle</span> = (<span class="params">count</span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">`点击了<span class="subst">$&#123;count&#125;</span>次`</span></span><br><span class="line">  &#125;) </span><br><span class="line">  <span class="title function_">useDebugValue</span>(<span class="string">&#x27;myTitle&#x27;</span>) <span class="comment">// 自定义Hook起名</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// const [count, setCount] = useState(1)</span></span><br><span class="line">  <span class="comment">// const add = () =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   setCount(count + 1)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; count, add &#125; = <span class="title function_">useCount</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// useEffect(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//   document.title = `点击了$&#123;count&#125;次`</span></span><br><span class="line">  <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">useTitle</span>(count)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">add</span> &#125;&gt;</span>加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p>接下来的hooks是属于react18版本新增的hooks</p><h3 id="17-2-11-useId"><a href="#17-2-11-useId" class="headerlink" title="17.2.11 useId"></a>17.2.11 useId</h3><p><code>useId</code>是一个钩子，用于生成唯一的ID，在服务器和客户端之间是稳定的，同时避免hydration 不匹配。</p><blockquote><p>注意：</p><p><code>useId</code>不是用来生成列表中的键的。<code>Keys</code> 应该从你的数据中生成。</p><p>不能用于列表渲染的key值</p></blockquote><p>对于一个基本的例子，直接将id传递给需要它的元素。</p><p>对于同一组件中的多个ID，使用相同的ID附加一个后缀。</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/05_App_hooks_useRef&#x27; // hooks useRef  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/06_App_hooks_useReducer&#x27; // hooks useReducer  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/07_App_hooks_useContext&#x27; // hooks useContext  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/08_App_hooks_redux&#x27; // hooks useContext useReducer redux</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/09_App_hooks_useCallback_useMemo&#x27; // hooks useCallback useMemo 提升性能以及计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/10_App_hooks_useImperativeHandle.jsx&#x27; // useImperativeHandle 父组件操作子组件的方法</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/11_App_hooks_useLayoutEffect&#x27; // useLayoutEffect </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/12_App_hooks_useDebugValue&#x27; // useDebugValue </span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/13_App_hooks_useId&#x27;</span> <span class="comment">// useId </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/13_App_hooks_useId.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useId &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//React Hook &quot;useId&quot; cannot be called inside a callback. </span></span><br><span class="line"><span class="comment">// React Hooks must be called in a React function component or a custom React Hook function</span></span><br><span class="line"><span class="comment">// useId不能在回调函数中使用，</span></span><br><span class="line"><span class="comment">// react hooks 必须包裹在函数式组件或者自定义hooks中使用</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// const [list] = useState([&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;])</span></span><br><span class="line">  <span class="keyword">const</span> useNameId = <span class="title function_">useId</span>()</span><br><span class="line">  <span class="keyword">const</span> passwordId = <span class="title function_">useId</span>()</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        // list &amp;&amp; list.map((item) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">        //   const id = useId() // 这样的写法是错误的</span></span><br><span class="line"><span class="language-xml">        //   return (</span></span><br><span class="line"><span class="language-xml">        //     <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">id</span> &#125;&gt;</span> &#123; item &#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        //   )</span></span><br><span class="line"><span class="language-xml">        // &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">      &#123;/* HTML 中使用for，react中使用HtmlFor */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">&#123;</span> <span class="attr">useNameId</span> &#125;&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span> = <span class="string">&#123;</span> <span class="attr">useNameId</span> &#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span> = <span class="string">&#123;</span> <span class="attr">passwordId</span> &#125;&gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span> = <span class="string">&#123;</span> <span class="attr">passwordId</span> &#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p><strong>注意：</strong></p><p><code>useId</code> 会生成一个包含 : token的字符串。这有助于确保令牌是唯一的，但在CSS选择器或API（如<code>querySelectorAll</code>）中不支持。</p><p><code>useId</code>支持一个<code>identifierPrefix</code>，以防止在多根应用程序中发生碰撞。要配置，请参阅 <code>hydrateRoot</code> 和 <code>ReactDOMServer</code> 的选项。</p><p>hooks需要在函数式组件以及自定义hook的顶级使用（返回jsx代码之前），不要在jsx代码中使用hooks</p></blockquote><h3 id="17-2-12-useDeferredValue"><a href="#17-2-12-useDeferredValue" class="headerlink" title="17.2.12 useDeferredValue"></a>17.2.12 useDeferredValue</h3><blockquote><p>真实需求其实不需要实时渲染所有的数据</p></blockquote><p><code>useDeferredValue</code> 需要接收一个值, 返回这个值的副本, 副本的更新会在值更新渲染之后进行更新, 以此来避免一些不必要的重复渲染. 打个比方页面中有输入框, 输入框下的内容依赖于输入框的值, 但是输入框是一个高频操作, 如果输入10次, 可能用户只想看到最终的结果那么中途的实时渲染就显得不那么重要了, 页面元素少点还好, 一旦元素过多页面就会及其的卡顿, 渲染引擎堵得死死的, 用户就会骂娘了, 此时使用useDeferredValue是一个很好的选择</p><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/05_App_hooks_useRef&#x27; // hooks useRef  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/06_App_hooks_useReducer&#x27; // hooks useReducer  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/07_App_hooks_useContext&#x27; // hooks useContext  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/08_App_hooks_redux&#x27; // hooks useContext useReducer redux</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/09_App_hooks_useCallback_useMemo&#x27; // hooks useCallback useMemo 提升性能以及计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/10_App_hooks_useImperativeHandle.jsx&#x27; // useImperativeHandle 父组件操作子组件的方法</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/11_App_hooks_useLayoutEffect&#x27; // useLayoutEffect </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/12_App_hooks_useDebugValue&#x27; // useDebugValue </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/13_App_hooks_useId&#x27; // useId </span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/14_App_hooks_useDeferredValue&#x27;</span> <span class="comment">// useDeferredValue </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/14_App_hooks_useDeferredValue.jsx</code> 数据量必须过大，否则看不到效果</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useDeferredValue, useEffect, useState, useMemo, memo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">List</span> = <span class="title function_">memo</span>(<span class="keyword">function</span> <span class="title function_">List</span>(<span class="params">&#123;count&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = <span class="title function_">useState</span>([])</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> data = []</span><br><span class="line">    data.<span class="property">length</span> = <span class="number">50000</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      data.<span class="title function_">fill</span>(i+<span class="number">1</span>, i)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">setData</span>(data)</span><br><span class="line"></span><br><span class="line">  &#125;, [count])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        data.map((item) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span>=<span class="string">&#123;item&#125;</span>&gt;</span>&#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">UseDeferredValueDemo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [inpVal, setInpVal] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> deferredValue = <span class="title function_">useDeferredValue</span>(inpVal) <span class="comment">// 备份数据</span></span><br><span class="line">  <span class="keyword">const</span> memoList = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">List</span> <span class="attr">count</span>=<span class="string">&#123;deferredValue&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">List</span>&gt;</span></span>, [deferredValue])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>UseDeferredValue<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&#123;inpVal&#125;</span>  <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> setInpVal(e.target.value)&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">      &#123;memoList&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="17-2-13-useTransition"><a href="#17-2-13-useTransition" class="headerlink" title="17.2.13 useTransition"></a>17.2.13 useTransition</h3><p><code>useTransition</code> 又叫过渡, 他的作用就是标记非紧急更新, 这些被标记非紧急更新会在紧急更新完之后进行更新, <code>useTransition</code> 使用场景在应对渲染量很大的页面，需要及时响应某些事件的情况。</p><p>举个例子，准备一个进度条, 通过滑动进度条来显示进度条的进度并且渲染相同进度数量的div, 如果我们不对渲染进行优化那无疑页面会很卡, 此时使用过渡配合useMemo来缓存页面结构, diffing算法就会对比出少量的变化进行局部修改。</p><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/01_Parent_Child&#x27; // 父子组件省略.jsx</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/02_Parent_Child_value&#x27; // 父组件给子组件传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/03_Parent_Child_default&#x27; // 父组件给子组件传值,子组件设置默认值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/04_Parent-Child_type&#x27; // 父组件给子组件传值,子组件设置默认值,并且验证数据类型</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/05_App_props_children&#x27; // 类插槽</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/06_App_mutiple_props_children&#x27; // 类具名插槽（多个插槽）</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/07_App_mouse_tracker&#x27; // 鼠标跟随</span></span><br><span class="line"><span class="comment">// import App from &#x27;./01_props/08_App_render_props&#x27; // 渲染属性 - 其他组件共享状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/01_App_state_es6&#x27; // es6 构造函数 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/02_App_state_es7&#x27; // es7 属性初始化器 初始化状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/03_App_setState_function&#x27; // 修改状态 传递函数</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/04_App_setState_object&#x27; // 修改状态 传递对象</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/05_App_computed&#x27; // 类组件实现类似计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./02_state/06_App_lifeCycle&#x27; // 类组件生命周期</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/01_App_event_es5&#x27; // 事件处理 es5绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./03_event/02_App_event_es6&#x27; // 事件处理 es6绑定事件方式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/01_App_condition_yu&#x27; // 条件渲染 &amp;&amp;</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/02_App_condition_san&#x27; // 条件渲染 三元运算符</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/03_App_condition_classname&#x27; // 条件渲染 动态的class</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/04_App_condition_cssinjs&#x27; // cssInJs</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/05_App_module_css&#x27; // 模块化css</span></span><br><span class="line"><span class="comment">// import App from &#x27;./04_condition/06_App_style&#x27; // 动态style</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/01_App_map&#x27; // 列表渲染 使用map</span></span><br><span class="line"><span class="comment">// import App from &#x27;./05_list/02_App_mutiple_map&#x27; // 列表渲染 多层遍历</span></span><br><span class="line"><span class="comment">// import App from &#x27;./06_form/01_App_form&#x27; // 表单绑定 受控组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/01_App-parent-child-value&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./07_state_up/02_App_state_up&#x27; // 状态提升 多组件数据共享</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/01_App_props_slot&#x27; // 组合VS继承</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/02_App_modal&#x27; // 封装模态框</span></span><br><span class="line"><span class="comment">// import App from &#x27;./08_com/03_App_portal&#x27; // 封装模态框 portal</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/01_App_next_value&#x27; // 逐层传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/02_App_context&#x27; // 上下文对象Context传值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/03_App_context_multiple_value&#x27; // 上下文对象Context传值 多个上下文对象传递数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/04_App_one_context_multiple_value&#x27; // 上下文对象Context传值 1个上下文对象传递多个数据</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/05_App_function_context_value&#x27; // 上下文对象Context传值 函数式组件获取值</span></span><br><span class="line"><span class="comment">// import App from &#x27;./09_context/06_App_context_displayName&#x27; // 上下文对象Context传值 开发者工具显示Context名称</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/01_App-more-use&#x27; // 高阶组件 多个组件引入同一个组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./10_hoc/02_App-more-use-hoc&#x27; // 高阶组件 高阶组件</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/01_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/02_App_ref&#x27; // ref的使用以及严格模式</span></span><br><span class="line"><span class="comment">// import App from &#x27;./11_ref/03_App_ref_forward&#x27; // 转发ref</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/01_App_hooks_useState&#x27; // hooks useState</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/02_App_hooks_useState_obj&#x27; // hooks useState  object</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/03_App_hooks_useState_state&#x27; // hooks useState  拆分对象状态</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/04_App_hooks_useEffect&#x27; // hooks useEffect  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/05_App_hooks_useRef&#x27; // hooks useRef  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/06_App_hooks_useReducer&#x27; // hooks useReducer  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/07_App_hooks_useContext&#x27; // hooks useContext  </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/08_App_hooks_redux&#x27; // hooks useContext useReducer redux</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/09_App_hooks_useCallback_useMemo&#x27; // hooks useCallback useMemo 提升性能以及计算属性</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/10_App_hooks_useImperativeHandle.jsx&#x27; // useImperativeHandle 父组件操作子组件的方法</span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/11_App_hooks_useLayoutEffect&#x27; // useLayoutEffect </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/12_App_hooks_useDebugValue&#x27; // useDebugValue </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/13_App_hooks_useId&#x27; // useId </span></span><br><span class="line"><span class="comment">// import App from &#x27;./12_hooks/14_App_hooks_useDeferredValue&#x27; // useDeferredValue </span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./12_hooks/15_App_hooks_useTransition&#x27;</span> <span class="comment">// useTransition </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>src/12_hooks/15_App_hooks_useTransition</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useTransition, useState, useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">UseTransition</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [isPending, startTransition] = <span class="title function_">useTransition</span>()</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">const</span> [rangeValue, setRangeValue] = <span class="title function_">useState</span>(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">const</span> [renderData, setRenderData] = <span class="title function_">useState</span>([<span class="number">1</span>])</span><br><span class="line">  <span class="keyword">const</span> [isStartTransition, setIsStartTransition] = <span class="title function_">useState</span>(<span class="literal">false</span>)</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleChange</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">setRangeValue</span>(e.<span class="property">target</span>.<span class="property">value</span>)</span><br><span class="line">    <span class="keyword">const</span> arr = []</span><br><span class="line">    arr.<span class="property">length</span> = e.<span class="property">target</span>.<span class="property">value</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;= arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      arr.<span class="title function_">fill</span>(i, i + <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (isStartTransition) &#123;</span><br><span class="line">      <span class="title function_">startTransition</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">setRenderData</span>(arr)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">setRenderData</span>(arr)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> jsx = <span class="title function_">useMemo</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> renderData.<span class="title function_">map</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">width:</span> <span class="attr">50</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">height:</span> <span class="attr">50</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">backgroundColor:</span> `#$&#123;<span class="attr">Math.floor</span>(<span class="attr">Math.random</span>() * <span class="attr">16777215</span>)<span class="attr">.toString</span>(</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">16</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            )&#125;`,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">margin:</span> <span class="attr">10</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">display:</span> &#x27;<span class="attr">inline-block</span>&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">key</span>=<span class="string">&#123;</span>&#x27;<span class="attr">item</span>&#x27;+<span class="attr">index</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;item&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [renderData])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">textAlign:</span> &#x27;<span class="attr">center</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">checked</span>=<span class="string">&#123;isStartTransition&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              setIsStartTransition(e.target.checked)</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">          useTransition</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;range&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">value</span>=<span class="string">&#123;rangeValue&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">min</span>=<span class="string">&#123;0&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">max</span>=<span class="string">&#123;10000&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> <span class="attr">120</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onChange</span>=<span class="string">&#123;handleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>进度条 &#123;rangeValue&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;jsx&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="17-2-14-useSyncExternalStore"><a href="#17-2-14-useSyncExternalStore" class="headerlink" title="17.2.14 useSyncExternalStore"></a>17.2.14 useSyncExternalStore</h3><p>React18的beta版本将<code>useMutableSource</code>更新为了<code>useSyncExternalStore</code>，这个新的api将会对React的各种状态管理库产生非常大的影响，下面我来介绍<code>useSyncExternalStore</code>的用法和场景。</p><p>我们可以通过这个api自行设计一个redux + react-redux的数据方案：</p><p><strong>1、设计store</strong></p><p>首先我们要设计一个store，它必须有如下属性：</p><ul><li>currentState:当前状态</li><li>subscribe:提供状态发生变化时的订阅能力</li><li>getSnapshot: 获取当前状态</li></ul><p>以及改变state的方法，这里参考redux，设计了dispatch、reducer</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = &#123;</span><br><span class="line">    <span class="attr">currentState</span>:&#123;<span class="attr">data</span>:<span class="number">0</span>&#125;,</span><br><span class="line">    <span class="attr">listeners</span>:[],</span><br><span class="line">    <span class="title function_">reducer</span>(<span class="params">action</span>)&#123;</span><br><span class="line">        <span class="keyword">switch</span>(action.<span class="property">type</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="attr">data</span>:store.<span class="property">currentState</span>.<span class="property">data</span>+<span class="number">1</span>&#125;</span><br><span class="line">            <span class="attr">default</span>:</span><br><span class="line">                <span class="keyword">return</span> store.<span class="property">state</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">subscribe</span>(<span class="params">l</span>)&#123;</span><br><span class="line">        store.<span class="property">listeners</span>.<span class="title function_">push</span>(l)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">getSnapshot</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> store.<span class="property">currentState</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="params">action</span>) &#123;</span><br><span class="line">        store.<span class="property">currentState</span> = store.<span class="title function_">reducer</span>(action)</span><br><span class="line">        store.<span class="property">listeners</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">l</span>=&gt;</span><span class="title function_">l</span>())</span><br><span class="line">        <span class="keyword">return</span> action;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、应用 store 同步组件状态</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useSyncExternalStore &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">UseSyncExternalStoreDemo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> state = <span class="title function_">useSyncExternalStore</span>(store.<span class="property">subscribe</span>, <span class="function">() =&gt;</span> store.<span class="title function_">getSnapshot</span>().<span class="property">data</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>count: &#123;state&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>store.dispatch(&#123;type:&#x27;ADD&#x27;&#125;)&#125;&gt;add+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="17-2-15-useInsertionEffect"><a href="#17-2-15-useInsertionEffect" class="headerlink" title="17.2.15 useInsertionEffect"></a>17.2.15 useInsertionEffect</h3><p><code>useInsertionEffect</code> 与useEffect相同，在所有DOM变更之前同步触发。在使用 useLayoutEffect 读取布局之前，使用这个函数将样式注入到DOM中。因为这个钩子的作用域是有限的，所以这个钩子不能访问 refs，也不能调度更新。</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useInsertionEffect, useEffect, useLayoutEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">UseInsertionEffect</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useInsertionEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;useInsertionEffect&#x27;</span>) <span class="comment">// 1</span></span><br><span class="line">    <span class="comment">// const style = document.createElement(&#x27;style&#x27;)</span></span><br><span class="line">    <span class="comment">// style.innerHTML = &#x27;.box &#123; color: red &#125;&#x27;</span></span><br><span class="line">    <span class="comment">// document.head.appendChild(style)</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;useEffect&#x27;</span>) <span class="comment">// 3</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useLayoutEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;useLayoutEffect&#x27;</span>) <span class="comment">// 2</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;box&quot;</span>&gt;</span>UseInsertionEffect<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="17-3-自定义hooks"><a href="#17-3-自定义hooks" class="headerlink" title="17.3 自定义hooks"></a>17.3 自定义hooks</h2><p>以use开头的小驼峰式的函数</p><h1 id="十八、Redux"><a href="#十八、Redux" class="headerlink" title="十八、Redux"></a>十八、Redux</h1><h2 id="18-1-理解Flux架构"><a href="#18-1-理解Flux架构" class="headerlink" title="18.1 理解Flux架构"></a>18.1 理解Flux架构</h2><p>在2013年，Facebook让<code>React</code>亮相的同时推出了Flux框架，<code>React</code>的初衷实际上是用来替代<code>jQuery</code>的，<code>Flux</code>实际上就可以用来替代<code>Backbone.js</code>，<code>Ember.js</code>等一系列<code>MVC</code>架构的前端JS框架。</p><p>其实<code>Flux</code>在<code>React</code>里的应用就类似于<code>Vue</code>中的<code>Vuex</code>的作用，但是在<code>Vue</code>中，<code>Vue</code>是完整的<code>mvvm</code>框架，而<code>Vuex</code>只是一个全局的插件。</p><p><code>React</code>只是一个MVC中的V(视图层)，只管页面中的渲染，一旦有数据管理的时候，<code>React</code>本身的能力就不足以支撑复杂组件结构的项目，在传统的<code>MVC</code>中，就需要用到Model和Controller。Facebook对于当时世面上的<code>MVC</code>框架并不满意，于是就有了<code>Flux</code>, 但<code>Flux</code>并不是一个<code>MVC</code>框架，他是一种新的思想。</p><p><img src="/posts/66450fce/flux.png" alt="image-20220812002755397"></p><ul><li>View： 视图层</li><li>ActionCreator（动作创造者）：视图层发出的消息（比如mouseClick）</li><li>Dispatcher（派发器）：用来接收Actions、执行回调函数</li><li>Store（数据层）：用来存放应用的状态，一旦发生变动，就提醒Views要更新页面</li></ul><p>Flux的流程：</p><ol><li>组件获取到store中保存的数据挂载在自己的状态上</li><li>用户产生了操作，调用actions的方法</li><li>actions接收到了用户的操作，进行一系列的逻辑代码、异步操作</li><li>然后actions会创建出对应的action，action带有标识性的属性</li><li>actions调用dispatcher的dispatch方法将action传递给dispatcher</li><li>dispatcher接收到action并根据标识信息判断之后，调用store的更改数据的方法</li><li>store的方法被调用后，更改状态，并触发自己的某一个事件</li><li>store更改状态后事件被触发，该事件的处理程序会通知view去获取最新的数据</li></ol><h2 id="18-2-理解Redux单向数据流流程"><a href="#18-2-理解Redux单向数据流流程" class="headerlink" title="18.2 理解Redux单向数据流流程"></a>18.2 理解Redux单向数据流流程</h2><p>React 只是 DOM 的一个抽象层，并不是 Web 应用的完整解决方案。有两个方面，它没涉及。</p><ul><li>代码结构</li><li>组件之间的通信</li></ul><p>2013年 Facebook 提出了 Flux 架构的思想，引发了很多的实现。2015年，Redux 出现，将 Flux 与<a target="_blank" rel="noopener" href="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/">函数式编程</a>结合一起，很短时间内就成为了最热门的前端架构。</p><p>如果你不知道是否需要 Redux，那就是不需要它</p><p>只有遇到 React 实在解决不了的问题，你才需要 Redux</p><p>简单说，如果你的UI层非常简单，没有很多互动，Redux 就是不必要的，用了反而增加复杂性。</p><ul><li>用户的使用方式非常简单</li><li>用户之间没有协作</li><li>不需要与服务器大量交互，也没有使用 WebSocket</li><li>视图层（View）只从单一来源获取数据</li></ul><p><strong>需要使用Redux的项目:</strong></p><ul><li>用户的使用方式复杂</li><li>不同身份的用户有不同的使用方式（比如普通用户和管理员）</li><li>多个用户之间可以协作</li><li>与服务器大量交互，或者使用了WebSocket</li><li>View要从多个来源获取数据</li></ul><p><strong>从组件层面考虑，什么样子的需要Redux：</strong></p><ul><li>某个组件的状态，需要共享</li><li>某个状态需要在任何地方都可以拿到</li><li>一个组件需要改变全局状态</li><li>一个组件需要改变另一个组件的状态</li></ul><p><strong>Redux的设计思想：</strong></p><ol><li>Web 应用是一个状态机，视图与状态是一一对应的。</li><li>所有的状态，保存在一个对象里面（唯一数据源）。</li></ol><blockquote><p>注意：flux、redux都不是必须和react搭配使用的，因为flux和redux是完整的架构，在学习react的时候，只是将react的组件作为redux中的视图层去使用了。</p></blockquote><p><img src="/posts/66450fce/redux" alt="image-20220812002936378"></p><h2 id="18-3-redux使用三大原则"><a href="#18-3-redux使用三大原则" class="headerlink" title="18.3 redux使用三大原则"></a>18.3 redux使用三大原则</h2><ul><li>Single Source of Truth(唯一的数据源)</li><li>State is read-only(状态是只读的) - 无法直接修改状态</li><li>Changes are made with pure function(数据的改变必须通过纯函数完成)</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i redux -S</span><br></pre></td></tr></table></figure><p><code>src/13_redux/store.js</code> 创建状态管理器</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// createStore 方法在新版本中已经被弃用</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.创建所有操作 reducer 以及定义初始化的状态 - 纯函数</span></span><br><span class="line"><span class="comment">// 第一个参数为管理的状态，需要在此处书写 初始的状态</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state = &#123;</span></span><br><span class="line"><span class="params">  msg: <span class="string">&#x27;hello redux&#x27;</span>,</span></span><br><span class="line"><span class="params">  count: <span class="number">10</span></span></span><br><span class="line"><span class="params">&#125;, action</span>) =&gt; &#123; <span class="comment">// action中type代表动作的标识，用于触发行为，payload代表传递的参数</span></span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CAHNGE_MSG&#x27;</span>: <span class="comment">// type的名字可以根据自己公司的需求进行更改</span></span><br><span class="line">      <span class="comment">// 必须返回最新的状态</span></span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">msg</span>: action.<span class="property">payload</span> &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;INCREMENT_COUNT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">count</span>: state.<span class="property">count</span> + action.<span class="property">payload</span> &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DECREMENT_COUNT&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, state, &#123; <span class="attr">count</span>: state.<span class="property">count</span> - action.<span class="property">payload</span> &#125;)</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建状态管理器</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><p><code>src/index.js</code> 配置状态管理器 - 状态管理器修改订阅视图的更新</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入状态管理器</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./13_redux/store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./13_redux/App&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(store)</span><br><span class="line"><span class="comment">// dispatch 可以触发reducer的更改</span></span><br><span class="line"><span class="comment">// getState 可以用来获取状态管理器的数据</span></span><br><span class="line"><span class="comment">// replaceReducer 替换reducer</span></span><br><span class="line"><span class="comment">// subscribe 订阅数据的变化</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 订阅数据的变化，重新渲染视图</span></span><br><span class="line">store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 一旦检测到数据发生改变，此处代码就会执行</span></span><br><span class="line">  root.<span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><code>src/13_redux/App.jsx</code>使用状态管理器</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Child1</span> <span class="keyword">from</span> <span class="string">&#x27;./Child1&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Child2</span> <span class="keyword">from</span> <span class="string">&#x27;./Child2&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>使用redux<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Child1</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Child2</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p><code>src/13_redux/Child1.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Child1</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> state = store.<span class="title function_">getState</span>() <span class="comment">// 获取状态管理器中的状态</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>child1<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; state.msg &#125; - &#123; state.count &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          store.dispatch(&#123;</span></span><br><span class="line"><span class="language-xml">            type: &#x27;CAHNGE_MSG&#x27;,</span></span><br><span class="line"><span class="language-xml">            payload: &#x27;hello child1 redux&#x27;</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;修改msg<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          store.dispatch(&#123;</span></span><br><span class="line"><span class="language-xml">            type: &#x27;INCREMENT_COUNT&#x27;,</span></span><br><span class="line"><span class="language-xml">            payload: 10</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125; &#125;&gt;加10<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Child1</span>;</span><br></pre></td></tr></table></figure><p><code>src/13_redux/Child2.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Child2</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> state = store.<span class="title function_">getState</span>() <span class="comment">// 获取状态管理器中的状态</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>child2<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123; state.msg &#125; - &#123; state.count &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          store.dispatch(&#123;</span></span><br><span class="line"><span class="language-xml">            type: &#x27;CAHNGE_MSG&#x27;,</span></span><br><span class="line"><span class="language-xml">            payload: &#x27;hello child2 redux&#x27;</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;&gt;修改msg<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> () =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          store.dispatch(&#123;</span></span><br><span class="line"><span class="language-xml">            type: &#x27;DECREMENT_COUNT&#x27;,</span></span><br><span class="line"><span class="language-xml">            payload: 10</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125; &#125;&gt;减10<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Child2</span>;</span><br></pre></td></tr></table></figure><p>以上代码是最最最最最最最基本的redux的使用，现在企业里基本上不使用这种原始的方法</p><h2 id="18-4-redux-react-redux配合使用"><a href="#18-4-redux-react-redux配合使用" class="headerlink" title="18.4 redux + react-redux配合使用"></a>18.4 redux + react-redux配合使用</h2><blockquote><p>redux是属于js的状态管理模式，不独属于react，在react中需要结合 react-redux 模块使用</p></blockquote><p>react-redux提供两个核心的api：</p><ul><li><p>Provider: 提供store <code>&lt;Provider store = &#123; store &#125;&gt;&lt;App /&gt;&lt;/store&gt;</code></p></li><li><p>connect: 用于连接容器组件和展示组件</p><ul><li><p>Provider</p><p>根据单一store原则 ，一般只会出现在整个应用程序的最顶层。</p></li><li><p>connect</p><p>语法格式为</p><p><code>connect(mapStateToProps?, mapDispatchToProps?, mergeProps?, options?)(component)</code></p><p>一般来说只会用到前面两个，它的作用是：</p><ul><li>把<code>store.getState()</code>的状态转化为展示组件的<code>props</code></li><li>把<code>actionCreators</code>转化为展示组件<code>props</code>上的方法</li></ul></li></ul></li></ul><p>只要上层中有<code>Provider</code>组件并且提供了<code>store</code>, 那么，子孙级别的任何组件，要想使用<code>store</code>里的状态，都可以通过<code>connect</code>方法进行连接。如果只是想连接<code>actionCreators</code>，可以第一个参数传递为<code>null</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i react-redux -S</span><br></pre></td></tr></table></figure><h3 id="18-4-1-创建状态管理器"><a href="#18-4-1-创建状态管理器" class="headerlink" title="18.4.1 创建状态管理器"></a>18.4.1 创建状态管理器</h3><p><code>src/14_redux-react_redux/store.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state = &#123;</span></span><br><span class="line"><span class="params">  proList: [],</span></span><br><span class="line"><span class="params">  kindList: []</span></span><br><span class="line"><span class="params">&#125;, &#123; type, payload &#125;</span>) =&gt; &#123; <span class="comment">// action  解构了 &#123; type, payload &#125;</span></span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">proList</span>: payload &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_KIND_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">kindList</span>: payload &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><blockquote><p>1.引入 createStore 方法（新版本中建议使用rtk）</p><p>2.创建reducer（包含初始化状态，包含了修改状态的标识，返回了新的状态（对象合并））</p><p>3.创建store</p><p>4.暴露store</p></blockquote><h3 id="18-4-2-使用react-redux"><a href="#18-4-2-使用react-redux" class="headerlink" title="18.4.2  使用react-redux"></a>18.4.2 使用react-redux</h3><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入状态管理器</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span> <span class="comment">// 提供Provier组件，可以添加store属性</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./14_redux_react-redux/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./14_redux_react-redux/App&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span> = <span class="string">&#123;</span> <span class="attr">store</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>使用了 react-redux 提供的组件组件 Provider 配合 store 完成传递数据</p></blockquote><p><code>src/14_redux_react-redux/App.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./Home&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Kind</span> <span class="keyword">from</span> <span class="string">&#x27;./Kind&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>redux + react-redux<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Kind</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p><code>src/14_redux_react-redux/Home.jsx</code> 业务逻辑写到了组件中</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// 引入 connect 高阶组件 实际上 connect() 返回值才是高阶组件</span></span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 展示组件   ---- 理想情况：  负责数据的展示以及发起指令</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(props) <span class="comment">// &#123; proList: [], dispatch: function()&#125;</span></span><br><span class="line">  <span class="keyword">const</span> &#123; proList, dispatch &#125; = props</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 在展示组件内 写业务逻辑</span></span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>) </span><br><span class="line">      <span class="comment">// 修改状态</span></span><br><span class="line">      <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>,</span><br><span class="line">        <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [dispatch]) <span class="comment">// 依赖项最好 不要直接使用props，先将props进行解构，后添加依赖项</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>home<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          proList &amp;&amp; proList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return (<span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span>&#123; item.proname &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// mapStateToProps 负责给展示组件提供数据，提供给展示组件的props属性</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mapStateToProps</span> = (<span class="params">state</span>) =&gt; &#123; <span class="comment">// state 参数即为管理的所有的状态</span></span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="comment">// 必须含有返回值，返回什么取决于你的展示组件需要什么数据</span></span><br><span class="line">    <span class="attr">proList</span>: state.<span class="property">proList</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 返回的是一个 容器组件  ---- 理想情况： 负责给展示组件提供数据 以及执行 业务逻辑</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(mapStateToProps)(<span class="title class_">Home</span>);</span><br></pre></td></tr></table></figure><p><code>src/14_redux_react-redux/Kind.jsx</code> 业务逻辑写到容器组件中</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Kind</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; kindList, getKindListData &#125; = props</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 展示组件发起指令，后续交给容器组件处理</span></span><br><span class="line">    <span class="title function_">getKindListData</span>()</span><br><span class="line">  &#125;, [getKindListData])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>kind<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        kindList &amp;&amp; kindList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item</span> &#125;&gt;</span> &#123; item &#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mapStateToProps</span> = (<span class="params">state</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">kindList</span>: state.<span class="property">kindList</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将业务逻辑交给容器组件组件处理</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mapDispatchToProps</span> = (<span class="params">dispatch</span>) =&gt; &#123; <span class="comment">// dispatch 为默认参数，可以通过此 触发 reducer 中状态的更新</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    getKindListData () &#123; <span class="comment">// 返回自定义函数，供 展示组件调用，展示组件通过 props 访问即可</span></span><br><span class="line">      <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/categorylist&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>) </span><br><span class="line">        <span class="comment">// 修改状态</span></span><br><span class="line">        <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;CHANGE_KIND_LIST&#x27;</span>,</span><br><span class="line">          <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(mapStateToProps, mapDispatchToProps)(<span class="title class_">Kind</span>);</span><br></pre></td></tr></table></figure><blockquote><p>vuex中 可以把异步操作提取到vuex中的actions中，react中异步操作方式会有很多，最常见的就是 redux-thunk</p></blockquote><h2 id="18-5-redux-react-redux分模块使用"><a href="#18-5-redux-react-redux分模块使用" class="headerlink" title="18.5 redux+react-redux分模块使用"></a>18.5 redux+react-redux分模块使用</h2><blockquote><p>如果项目很大，或者项目划分比较明确，需要将状态管理器也分模块去处理</p><p>假设现在有一个home模块，管理 bannerList 以及 proList</p><p>还有一个模块 kind 模块，管理 kindList</p></blockquote><p><code>src/15_redux_react-redux_combine/store/modules/home.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单独管理home模块的状态管理器</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state = &#123;</span></span><br><span class="line"><span class="params">  bannerList: [],</span></span><br><span class="line"><span class="params">  proList: []</span></span><br><span class="line"><span class="params">&#125;, &#123; type, payload &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_BANNER_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">bannerList</span>: payload &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">proList</span>: payload &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</span><br></pre></td></tr></table></figure><p><code>src/15_redux_react-redux_combine/store/modules/kind.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单独管理kind模块的状态管理器</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state = &#123;</span></span><br><span class="line"><span class="params">  kindList: []</span></span><br><span class="line"><span class="params">&#125;, &#123; type, payload &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_KIND_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">kindList</span>: payload &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</span><br></pre></td></tr></table></figure><blockquote><p>整合多个reducer 为一个，因为 有一个原则 ： 单一数据源 的原则</p></blockquote><p><code>src/15_redux_react-redux_combine/store/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; combineReducers, createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> home <span class="keyword">from</span> <span class="string">&#x27;./modules/home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> kind <span class="keyword">from</span> <span class="string">&#x27;./modules/kind&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reducer = <span class="title function_">combineReducers</span>(&#123;</span><br><span class="line">  home,</span><br><span class="line">  kind</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><blockquote><p>入口文件处引入状态管理器</p></blockquote><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入状态管理器</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span> <span class="comment">// 提供Provier组件，可以添加store属性</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./15_redux_react-redux_combine/store/index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./15_redux_react-redux_combine/App&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span> = <span class="string">&#123;</span> <span class="attr">store</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>组件中使用状态管理器</p></blockquote><p><code>src/15_redux_react-redux_combine/App.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./views/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Kind</span> <span class="keyword">from</span> <span class="string">&#x27;./views/Kind&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span>&gt;</span><span class="tag">&lt;/<span class="name">hr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Kind</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p><code>src/15_redux_react-redux_combine/views/Home.jsx</code> 业务逻辑在展示型组件中</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params">&#123; bannerList, proList, dispatch &#125;</span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/banner/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;CHANGE_BANNER_LIST&#x27;</span>,</span><br><span class="line">        <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>,</span><br><span class="line">        <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [dispatch])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; </span></span><br><span class="line"><span class="language-xml">          bannerList &amp;&amp; bannerList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.bannerid</span> &#125; <span class="attr">src</span>=<span class="string">&#123;</span> <span class="attr">item.img</span> &#125; <span class="attr">alt</span>=<span class="string">&#123;item.alt&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">100</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          proList &amp;&amp; proList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return (<span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span>&#123; item.proname &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(</span><br><span class="line">  <span class="comment">// (state) =&gt; (&#123; bannerList: state.home.bannerList, proList: state.home.proList &#125;)</span></span><br><span class="line">  <span class="comment">// (&#123; home &#125;) =&gt; (&#123; bannerList: home.bannerList, proList: home.proList &#125;)</span></span><br><span class="line">  <span class="comment">// (&#123; home: &#123; bannerList, proList &#125; &#125;) =&gt; (&#123; bannerList: bannerList, proList: proList &#125;)</span></span><br><span class="line">  <span class="function">(<span class="params">&#123; home: &#123; bannerList, proList &#125; &#125;</span>) =&gt;</span> (&#123; bannerList, proList &#125;)</span><br><span class="line">)(<span class="title class_">Home</span>);</span><br></pre></td></tr></table></figure><p><code>src/15_redux_react-redux_combine/views/Kind.jsx</code> 业务逻辑在容器组件中</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="comment">// const Kind = connect(</span></span><br><span class="line"><span class="comment">//   (&#123; kind: &#123; kindList &#125;&#125;) =&gt; (&#123; kindList &#125;), // state =&gt; &#123; return &#123; kindList: state.kind.kindList &#125;&#125;</span></span><br><span class="line"><span class="comment">//   (dispatch) =&gt; (&#123;</span></span><br><span class="line"><span class="comment">//     getKindListData () &#123;</span></span><br><span class="line"><span class="comment">//       fetch(&#x27;http://121.89.205.189:3001/api/pro/categorylist&#x27;).then(res =&gt; res.json()).then(res =&gt; &#123;</span></span><br><span class="line"><span class="comment">//         dispatch(&#123;</span></span><br><span class="line"><span class="comment">//           type: &#x27;CHANGE_KIND_LIST&#x27;,</span></span><br><span class="line"><span class="comment">//           payload: res.data</span></span><br><span class="line"><span class="comment">//         &#125;)</span></span><br><span class="line"><span class="comment">//       &#125;)</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//   &#125;)</span></span><br><span class="line"><span class="comment">// )((&#123; kindList, getKindListData &#125;) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   useEffect(() =&gt; &#123;</span></span><br><span class="line"><span class="comment">//     getKindListData()</span></span><br><span class="line"><span class="comment">//   &#125;, [getKindListData])</span></span><br><span class="line"><span class="comment">//   return (</span></span><br><span class="line"><span class="comment">//     &lt;div&gt;</span></span><br><span class="line"><span class="comment">//       &lt;h1&gt;Kind&lt;/h1&gt;</span></span><br><span class="line"><span class="comment">//       &#123;</span></span><br><span class="line"><span class="comment">//         kindList &amp;&amp; kindList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="comment">//           return (</span></span><br><span class="line"><span class="comment">//             &lt;p key = &#123; item &#125;&gt; &#123; item &#125; &lt;/p&gt;</span></span><br><span class="line"><span class="comment">//           )</span></span><br><span class="line"><span class="comment">//         &#125;)</span></span><br><span class="line"><span class="comment">//       &#125;</span></span><br><span class="line"><span class="comment">//     &lt;/div&gt;</span></span><br><span class="line"><span class="comment">//   );</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"><span class="comment">// export default Kind;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Kind</span> = (<span class="params">&#123; kindList, getKindListData &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getKindListData</span>()</span><br><span class="line">  &#125;, [getKindListData])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Kind<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        kindList &amp;&amp; kindList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item</span> &#125;&gt;</span> &#123; item &#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(</span><br><span class="line">  <span class="function">(<span class="params">&#123; kind: &#123; kindList &#125;&#125;</span>) =&gt;</span> (&#123; kindList &#125;), <span class="comment">// state =&gt; &#123; return &#123; kindList: state.kind.kindList &#125;&#125;</span></span><br><span class="line">  <span class="function">(<span class="params">dispatch</span>) =&gt;</span> (&#123;</span><br><span class="line">    getKindListData () &#123;</span><br><span class="line">      <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/categorylist&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;CHANGE_KIND_LIST&#x27;</span>,</span><br><span class="line">          <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">)(<span class="title class_">Kind</span>);</span><br></pre></td></tr></table></figure><blockquote><p>细心的你发现，虽然展示组件的代码变少了，但是容器组件中还有 异步相关操作，能否把这些异步操作提取出去</p></blockquote><h2 id="18-6-redux-react-redux-分模块-异步操作"><a href="#18-6-redux-react-redux-分模块-异步操作" class="headerlink" title="18.6 redux + react-redux + 分模块+ 异步操作"></a>18.6 redux + react-redux + 分模块+ 异步操作</h2><blockquote><p>配合redux 常用的异步模块 为 <code>redux-thunk</code>, <code>redux-saga</code></p></blockquote><h3 id="18-6-1-redux-thunk"><a href="#18-6-1-redux-thunk" class="headerlink" title="18.6.1 redux-thunk"></a>18.6.1 redux-thunk</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i redux-thunk -S</span><br></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/store/modules/home.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params"></span></span><br><span class="line"><span class="params">  state = &#123;</span></span><br><span class="line"><span class="params">    bannerList: [],</span></span><br><span class="line"><span class="params">    proList: []</span></span><br><span class="line"><span class="params">  &#125;,</span></span><br><span class="line"><span class="params">  &#123; type, payload &#125;</span></span><br><span class="line"><span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_BANNER_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">bannerList</span>: payload &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">proList</span>: payload &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</span><br></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/store/modules/kind.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params"></span></span><br><span class="line"><span class="params">  state = &#123;</span></span><br><span class="line"><span class="params">    kindList: []</span></span><br><span class="line"><span class="params">  &#125;,</span></span><br><span class="line"><span class="params">  &#123; type, payload &#125;</span></span><br><span class="line"><span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_KIND_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">kindList</span>: payload &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</span><br></pre></td></tr></table></figure><blockquote><p>整合多个reducer 为一个，因为 有一个原则 ： 单一数据源 的原则</p><p>并且后续需要使用 异步操作，将异步操作模块 使用进来</p></blockquote><p><code>src/16_redux_react-redux_redux-thunk_combine/store/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, combineReducers, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">&#x27;redux-thunk&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> home <span class="keyword">from</span> <span class="string">&#x27;./modules/home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> kind <span class="keyword">from</span> <span class="string">&#x27;./modules/kind&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reducer = <span class="title function_">combineReducers</span>(&#123;</span><br><span class="line">  home,</span><br><span class="line">  kind</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二个参数表示代码中含有异步操作，且异步操作需要提取出 容器组件</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer, <span class="title function_">applyMiddleware</span>(thunk))</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入状态管理器</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span> <span class="comment">// 提供Provier组件，可以添加store属性</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./16_redux_react-redux_redux-thunk_combine/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./16_redux_react-redux_redux-thunk_combine/App&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span> = <span class="string">&#123;</span> <span class="attr">store</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/App.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./views/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Kind</span> <span class="keyword">from</span> <span class="string">&#x27;./views/Kind&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Kind</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><blockquote><p>上一个案例 异步操作在组件，现在需要将其放到 异步操作模块中去 actionCreator</p></blockquote><p><code>src/16_redux_react-redux_redux-thunk_combine/api/home.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getBannerList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/banner/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getProList</span> (params) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/list?limitNum=&#x27;</span> + params.<span class="property">limitNum</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/api/kind.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getKindList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/categorylist&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/store/actions/home.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 容器组件抽离的异步操作都写在这里</span></span><br><span class="line"><span class="comment">// 每一个action的函数记住一个原则，默认的参数为dispatch</span></span><br><span class="line"><span class="comment">// 如果接口调用不需要传递参数，直接给函数写默认参数 dispatch</span></span><br><span class="line"><span class="comment">// 如果接口调用需要传递参数，一般在返回一个函数，返回函数的 参数为 dispatch</span></span><br><span class="line"><span class="keyword">import</span> &#123; getBannerList, getProList &#125; <span class="keyword">from</span> <span class="string">&#x27;../../api/home&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// actionCreator 本质是一个带有 dispatch 参数的函数</span></span><br><span class="line"><span class="keyword">const</span> action = &#123;</span><br><span class="line">  getBannerListAction (dispatch) &#123; <span class="comment">// 因为此接口不需要参数，所有拥有了默认参数 dispatch</span></span><br><span class="line">    <span class="title function_">getBannerList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;CHANGE_BANNER_LIST&#x27;</span>,</span><br><span class="line">        <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  getProListAction (params) &#123; <span class="comment">// 组件调用需要传递参数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">getProList</span>(params).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>,</span><br><span class="line">          <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> action</span><br></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/store/actions/kind.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getKindList &#125; <span class="keyword">from</span> <span class="string">&#x27;../../api/kind&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> action = &#123;</span><br><span class="line">  getKindListAction (dispatch) &#123;</span><br><span class="line">    <span class="title function_">getKindList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;CHANGE_KIND_LIST&#x27;</span>,</span><br><span class="line">        <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> action </span><br></pre></td></tr></table></figure><blockquote><p>记住接口有无参数影响 action 的写法，还影响其调用</p></blockquote><p><code>src/16_redux_react-redux_redux-thunk_combine/views/Home.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> action <span class="keyword">from</span> <span class="string">&#x27;../store/actions/home&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Home</span> = <span class="title function_">connect</span>(<span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">bannerList</span>: state.<span class="property">home</span>.<span class="property">bannerList</span>,</span><br><span class="line">    <span class="attr">proList</span>: state.<span class="property">home</span>.<span class="property">proList</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    getBannerList () &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(action.<span class="property">getBannerListAction</span>) <span class="comment">// 因为没有参数，所以不加()</span></span><br><span class="line">    &#125;,</span><br><span class="line">    getProList () &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(action.<span class="title function_">getProListAction</span>(&#123; <span class="attr">count</span>: <span class="number">2</span>, <span class="attr">limitNum</span>: <span class="number">3</span> &#125;))  <span class="comment">// 因为有参数，所以加()</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)(<span class="function">(<span class="params">&#123; bannerList, proList, getBannerList, getProList &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getBannerList</span>()</span><br><span class="line">    <span class="title function_">getProList</span>()</span><br><span class="line">  &#125;, [getBannerList, getProList])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          bannerList &amp;&amp; bannerList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span> = <span class="string">&#123;</span> <span class="attr">item.img</span> &#125; <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.bannerid</span> &#125; <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">60</span> &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          proList &amp;&amp; proList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span>&#123; item.proname &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Home</span>;</span><br></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/views/Home.jsx</code> 异步在组件</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="comment">// import &#123; getBannerList, getProList &#125; from &#x27;../api/home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> action <span class="keyword">from</span> <span class="string">&#x27;../store/actions/home&#x27;</span> <span class="comment">// 异步操作</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params">&#123; bannerList, proList, getBannerListData, getProListData &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getBannerListData</span>()</span><br><span class="line">    <span class="title function_">getProListData</span>()</span><br><span class="line">  &#125;, [getBannerListData, getProListData])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; </span></span><br><span class="line"><span class="language-xml">          bannerList &amp;&amp; bannerList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.bannerid</span> &#125; <span class="attr">src</span>=<span class="string">&#123;</span> <span class="attr">item.img</span> &#125; <span class="attr">alt</span>=<span class="string">&#123;item.alt&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">100</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          proList &amp;&amp; proList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return (<span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span>&#123; item.proname &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(</span><br><span class="line">  <span class="function">(<span class="params">&#123; home: &#123; bannerList, proList &#125;&#125;</span>) =&gt;</span> (&#123; bannerList, proList &#125;),</span><br><span class="line">  <span class="function">(<span class="params">dispatch</span>) =&gt;</span> (&#123;</span><br><span class="line">    getBannerListData () &#123;</span><br><span class="line">      <span class="comment">// getBannerList().then(res =&gt; &#123;</span></span><br><span class="line">      <span class="comment">//   dispatch(&#123;</span></span><br><span class="line">      <span class="comment">//     type: &#x27;CHANGE_BANNER_LIST&#x27;,</span></span><br><span class="line">      <span class="comment">//     payload: res.data</span></span><br><span class="line">      <span class="comment">//   &#125;)</span></span><br><span class="line">      <span class="comment">// &#125;)</span></span><br><span class="line">      <span class="comment">// 根据生成的actionCreate 规则去写，午餐不加（）</span></span><br><span class="line">      <span class="title function_">dispatch</span>(action.<span class="property">getBannerListAction</span>)</span><br><span class="line">      </span><br><span class="line">    &#125;,</span><br><span class="line">    getProListData () &#123;</span><br><span class="line">      <span class="comment">// getProList().then(res =&gt; &#123;</span></span><br><span class="line">      <span class="comment">//   dispatch(&#123;</span></span><br><span class="line">      <span class="comment">//     type: &#x27;CHANGE_PRO_LIST&#x27;,</span></span><br><span class="line">      <span class="comment">//     payload: res.data</span></span><br><span class="line">      <span class="comment">//   &#125;)</span></span><br><span class="line">      <span class="comment">// &#125;)</span></span><br><span class="line">      <span class="title function_">dispatch</span>(action.<span class="title function_">getProListAction</span>(&#123; <span class="attr">limitNum</span>: <span class="number">2</span> &#125;))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">)(<span class="title class_">Home</span>);</span><br></pre></td></tr></table></figure><p><code>src/16_redux_react-redux_redux-thunk_combine/views/Kind.jsx</code> 异步在store</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="comment">// import &#123; getKindList &#125; from &#x27;../api/kind&#x27;</span></span><br><span class="line"><span class="keyword">import</span> action <span class="keyword">from</span> <span class="string">&#x27;../store/actions/kind&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Kind</span> = (<span class="params">&#123; kindList, getKindListData &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getKindListData</span>()</span><br><span class="line">  &#125;, [getKindListData])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Kind<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        kindList &amp;&amp; kindList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item</span> &#125;&gt;</span> &#123; item &#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(</span><br><span class="line">  <span class="function">(<span class="params">&#123; kind: &#123; kindList &#125; &#125;</span>) =&gt;</span> (&#123; kindList &#125;),</span><br><span class="line">  <span class="function">(<span class="params">dispatch</span>) =&gt;</span> (&#123;</span><br><span class="line">    getKindListData () &#123;</span><br><span class="line">      <span class="comment">// getKindList().then(res =&gt; &#123;</span></span><br><span class="line">      <span class="comment">//   dispatch(&#123;</span></span><br><span class="line">      <span class="comment">//     type: &#x27;CHANGE_KIND_LIST&#x27;,</span></span><br><span class="line">      <span class="comment">//     payload: res.data</span></span><br><span class="line">      <span class="comment">//   &#125;)</span></span><br><span class="line">      <span class="comment">// &#125;)</span></span><br><span class="line">      <span class="title function_">dispatch</span>(action.<span class="property">getKindListAction</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">)(<span class="title class_">Kind</span>);</span><br></pre></td></tr></table></figure><blockquote><p>虽然引入了redux-thunk，但是仍然可以把 异步放在组件中，具体根据项目的需求而定</p></blockquote><blockquote><p>创建状态模块</p><p>整合模块</p><p>创建异步的 actionCreator</p><p>组件触发 actionCreator</p><p>传递数据以及修改界面</p></blockquote><h3 id="18-6-2-redux-saga"><a href="#18-6-2-redux-saga" class="headerlink" title="18.6.2 redux-saga"></a>18.6.2 redux-saga</h3><blockquote><p>先要了解解决异步操作方案：回调函数、promise、async await、generator yield</p></blockquote><p><a target="_blank" rel="noopener" href="https://es6.ruanyifeng.com/#docs/generator-async">https://es6.ruanyifeng.com/#docs/generator-async</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i redux-saga -S</span><br></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/store/modules/home.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> =  (<span class="params">state = &#123;</span></span><br><span class="line"><span class="params">  bannerList: [],</span></span><br><span class="line"><span class="params">  proList: []</span></span><br><span class="line"><span class="params">&#125;, &#123; type, payload &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_BANNER_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">bannerList</span>: payload &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">proList</span>: payload &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</span><br></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/store/modules/kind.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">state = &#123;</span></span><br><span class="line"><span class="params">  kindList: []</span></span><br><span class="line"><span class="params">&#125;, &#123; type, payload &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;CHANGE_KIND_LIST&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">kindList</span>: payload &#125;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> reducer</span><br></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/api/home.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getBannerList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/banner/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getProList</span> (params) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/list?limitNum=&#x27;</span> + params.<span class="property">limitNum</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/api/kind.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getKindList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/categorylist&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/store/mySaga.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// put 类似 dispatch put(&#123; type: &#x27;&#x27;, payload: &#x27;&#x27;&#125;) 触发状态的修改</span></span><br><span class="line"><span class="comment">// call 用来调用数据请求   call(getBannerList)  ===&gt;    getBannerList()</span></span><br><span class="line"><span class="comment">// takeLatest 用来响应触发哪一个异步操作</span></span><br><span class="line"><span class="keyword">import</span> &#123; put, call, takeLatest &#125; <span class="keyword">from</span> <span class="string">&#x27;redux-saga/effects&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; getBannerList, getProList &#125; <span class="keyword">from</span> <span class="string">&#x27;../api/home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getKindList &#125; <span class="keyword">from</span> <span class="string">&#x27;../api/kind&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 异步操作</span></span><br><span class="line"><span class="keyword">function</span> * getBannerListAction () &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">yield</span> <span class="title function_">call</span>(getBannerList)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;banner&#x27;</span>, res.<span class="property">data</span>)</span><br><span class="line">  <span class="comment">// 修改状态</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">put</span>(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;CHANGE_BANNER_LIST&#x27;</span>,</span><br><span class="line">    <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> * getProListAction (action) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">111</span>, action)</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">yield</span> <span class="title function_">call</span>(getProList, action.<span class="property">payload</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;pro&#x27;</span>, res.<span class="property">data</span>)</span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">put</span>(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;CHANGE_PRO_LIST&#x27;</span>,</span><br><span class="line">    <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> * getKindListAction () &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">yield</span> <span class="title function_">call</span>(getKindList)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;kind&#x27;</span>, res.<span class="property">data</span>)</span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">put</span>(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;CHANGE_KIND_LIST&#x27;</span>,</span><br><span class="line">    <span class="attr">payload</span>: res.<span class="property">data</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义异步触发的条件</span></span><br><span class="line"><span class="keyword">function</span> * mySaga () &#123;</span><br><span class="line">  <span class="comment">// 组件触发 REQUEST_BANNER 即可执行 getBannerListAction 异步行为</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">takeLatest</span>(<span class="string">&#x27;REQUEST_BANNER&#x27;</span>, getBannerListAction)</span><br><span class="line">  <span class="comment">// 组件触发 REQUEST_PRO 即可执行 getProListAction 异步行为</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">takeLatest</span>(<span class="string">&#x27;REQUEST_PRO&#x27;</span>, getProListAction)</span><br><span class="line">   <span class="comment">// 组件触发 REQUEST_KIND 即可执行 getKindListAction 异步行为</span></span><br><span class="line">  <span class="keyword">yield</span> <span class="title function_">takeLatest</span>(<span class="string">&#x27;REQUEST_KIND&#x27;</span>, getKindListAction)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> mySaga</span><br></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/store/index.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, combineReducers, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> createSagaMiddleWare <span class="keyword">from</span> <span class="string">&#x27;redux-saga&#x27;</span> <span class="comment">// 导入生成中间件的函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> mySaga <span class="keyword">from</span> <span class="string">&#x27;./mySaga&#x27;</span> <span class="comment">// 异步行为</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 分模块</span></span><br><span class="line"><span class="keyword">import</span> home <span class="keyword">from</span> <span class="string">&#x27;./modules/home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> kind <span class="keyword">from</span> <span class="string">&#x27;./modules/kind&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> reducer = <span class="title function_">combineReducers</span>(&#123; home, kind &#125;) <span class="comment">// 整合reducer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> middleware = <span class="title function_">createSagaMiddleWare</span>() <span class="comment">// 生成中间件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(reducer, <span class="title function_">applyMiddleware</span>(middleware)) <span class="comment">// 创建状态管理器</span></span><br><span class="line"></span><br><span class="line">middleware.<span class="title function_">run</span>(mySaga) <span class="comment">// 中间件使用异步，放到store创建之后</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入状态管理器</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span> <span class="comment">// 提供Provier组件，可以添加store属性</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./17_redux_react-redux_redux-saga_combine/store/index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./17_redux_react-redux_redux-saga_combine/App&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span> = <span class="string">&#123;</span> <span class="attr">store</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/views/Home.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params">&#123; bannerList, proList, dispatch &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 触发某个行为，从而触发 异步操作</span></span><br><span class="line">    <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;REQUEST_BANNER&#x27;</span> &#125;)</span><br><span class="line">    <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;REQUEST_PRO&#x27;</span>, <span class="attr">payload</span>: &#123; <span class="attr">limitNum</span>: <span class="number">3</span> &#125; &#125;)</span><br><span class="line">  &#125;, [dispatch])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; </span></span><br><span class="line"><span class="language-xml">          bannerList &amp;&amp; bannerList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.bannerid</span> &#125; <span class="attr">src</span>=<span class="string">&#123;</span> <span class="attr">item.img</span> &#125; <span class="attr">alt</span>=<span class="string">&#123;item.alt&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">100</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          proList &amp;&amp; proList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return (<span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span>&#123; item.proname &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(</span><br><span class="line">  <span class="function">(<span class="params">&#123; home: &#123; bannerList, proList &#125;&#125;</span>) =&gt;</span> (&#123; bannerList, proList &#125;)</span><br><span class="line">)(<span class="title class_">Home</span>);</span><br></pre></td></tr></table></figure><p><code>src/17_redux_react-redux_redux-saga_combine/views/Kind.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Kind</span> = (<span class="params">&#123; kindList, getKindListData &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getKindListData</span>()</span><br><span class="line">  &#125;, [getKindListData])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Kind<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        kindList &amp;&amp; kindList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item</span> &#125;&gt;</span> &#123; item &#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(</span><br><span class="line">  <span class="function">(<span class="params">&#123; kind: &#123; kindList &#125;&#125;</span>) =&gt;</span> (&#123;kindList&#125;),</span><br><span class="line">  <span class="function">(<span class="params">dispatch</span>) =&gt;</span> (&#123;</span><br><span class="line">    getKindListData () &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;REQUEST_KIND&#x27;</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">)(<span class="title class_">Kind</span>);</span><br></pre></td></tr></table></figure><h2 id="18-7-使用immutable不可变数据数据结构"><a href="#18-7-使用immutable不可变数据数据结构" class="headerlink" title="18.7 使用immutable不可变数据数据结构"></a>18.7 使用immutable不可变数据数据结构</h2><p>immutable不可变的数据解构，意思就是一旦数据被创建，需要使用特殊的方法进行修改（修改过后的数据也是符合immutable数据解构的，他是一个全新的对象）</p><p>学习immutable： <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/immutable">https://www.npmjs.com/package/immutable</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i immutable redux-immutable -S</span><br></pre></td></tr></table></figure><p>重点就是修改 reducer 的数据机构以及组件中获取状态的方式（整合reducer时使用 redux-immutable 提供的 combineReducers）</p><p>拷贝17文件，修改 store&#x2F;modules&#x2F;home.js store&#x2F;modules&#x2F;kind.js store&#x2F;index.js</p><p>views&#x2F;Home.jsx views&#x2F;Kind.jsx</p><h1 id="十九、redux-toolkit"><a href="#十九、redux-toolkit" class="headerlink" title="十九、redux toolkit"></a>十九、redux toolkit</h1><p><a target="_blank" rel="noopener" href="https://cn.redux.js.org/">https://cn.redux.js.org/</a></p><h2 id="19-1-什么是Redux-Toolkit"><a href="#19-1-什么是Redux-Toolkit" class="headerlink" title="19.1 什么是Redux Toolkit"></a>19.1 什么是Redux Toolkit</h2><p><a target="_blank" rel="noopener" href="https://cn.redux.js.org/redux-toolkit/overview/">https://cn.redux.js.org/redux-toolkit/overview/</a></p><p><strong><a target="_blank" rel="noopener" href="https://redux-toolkit.js.org/">Redux Toolkit</a></strong> 是我们官方的，有观点的，开箱即用的高效 Redux 开发工具集。它旨在成为标准的 Redux 逻辑开发方式，我们强烈建议您使用它。</p><p>它包括几个实用程序功能，这些功能可以简化最常见场景下的 Redux 开发，包括配置 store、定义 reducer，不可变的更新逻辑、甚至可以立即创建整个状态的 “切片 slice”，而无需手动编写任何 action creator 或者 action type。它还包括使用最广泛的 Redux 插件，例如 Redux Thunk 用于异步逻辑，而 Reselect 用于编写选择器 selector 函数，因此你可以立即使用它们。</p><h2 id="19-2-如何使用redux-toolkit"><a href="#19-2-如何使用redux-toolkit" class="headerlink" title="19.2 如何使用redux-toolkit"></a>19.2 如何使用redux-toolkit</h2><p><a target="_blank" rel="noopener" href="https://cn.redux.js.org/tutorials/quick-start">https://cn.redux.js.org/tutorials/quick-start</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cnpm i @reduxjs/toolkit redux react-redux redux-devtools -S</span><br></pre></td></tr></table></figure><h3 id="19-2-1-创建状态管理器"><a href="#19-2-1-创建状态管理器" class="headerlink" title="19.2.1 创建状态管理器"></a>19.2.1 创建状态管理器</h3><p><code>src/19_rtk/store/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123; <span class="comment">// 此处可以设置多模块</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><h3 id="19-2-2-入口文件配置状态管理器"><a href="#19-2-2-入口文件配置状态管理器" class="headerlink" title="19.2.2 入口文件配置状态管理器"></a>19.2.2 入口文件配置状态管理器</h3><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入状态管理器</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span> <span class="comment">// 提供Provier组件，可以添加store属性</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./19_rtk/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./19_rtk/App&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span> = <span class="string">&#123;</span> <span class="attr">store</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="19-2-3-创建分模块切片"><a href="#19-2-3-创建分模块切片" class="headerlink" title="19.2.3 创建分模块切片"></a>19.2.3 创建分模块切片</h3><p>创建 slice 需要一个字符串名称来标识切片、一个初始 state 以及一个或多个定义了该如何更新 state 的 reducer 函数。slice 创建后 ，我们可以导出 slice 中生成的 Redux action creators 和 reducer 函数。</p><p><code>src/19_rtk/store/modules/home.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSlice &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"><span class="comment">// 创建 slice 需要一个字符串名称来标识切片、一个初始 state 以及一个或多个定义了该如何更新 state 的 reducer 函数。</span></span><br><span class="line"><span class="comment">// slice 创建后 ，我们可以导出 slice 中生成的 Redux action creators 和 reducer 函数。</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> homeSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;home&#x27;</span>, <span class="comment">// vuex namespaced: true</span></span><br><span class="line">  <span class="attr">initialState</span>: &#123; <span class="comment">// vuex state</span></span><br><span class="line">    <span class="attr">bannerList</span>: [],</span><br><span class="line">    <span class="attr">proList</span>: []</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123; <span class="comment">// vuex mutations</span></span><br><span class="line">    changeBannerList (state, action) &#123;</span><br><span class="line">      state.<span class="property">bannerList</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;,</span><br><span class="line">    changeProList (state, action) &#123;</span><br><span class="line">      state.<span class="property">proList</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;home&#x27;</span>, homeSlice)</span><br><span class="line"><span class="comment">// 每个 case reducer 函数会生成对应的 Action creators</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; changeBannerList, changeProList &#125; = homeSlice.<span class="property">actions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> homeSlice.<span class="property">reducer</span> <span class="comment">// redux时 管理状态都是 reducer</span></span><br></pre></td></tr></table></figure><p><code>src/19_rtk/store/modules/kind.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSlice &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> kindSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;kind&#x27;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">kindList</span>: []</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    changeKindList (state, action) &#123;</span><br><span class="line">      state.<span class="property">kindList</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; changeKindList &#125; = kindSlice.<span class="property">actions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> kindSlice.<span class="property">reducer</span></span><br></pre></td></tr></table></figure><h3 id="19-2-4-整合切片"><a href="#19-2-4-整合切片" class="headerlink" title="19.2.4 整合切片"></a>19.2.4 <strong>整合切片</strong></h3><p><code>src/19_rtk/store/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"><span class="keyword">import</span> home <span class="keyword">from</span> <span class="string">&#x27;./modules/home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> kind <span class="keyword">from</span> <span class="string">&#x27;./modules/kind&#x27;</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123; <span class="comment">// 所有的模块都可以配置到此</span></span><br><span class="line">    home, kind</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><h3 id="19-2-5-组件中使用状态管理器"><a href="#19-2-5-组件中使用状态管理器" class="headerlink" title="19.2.5 组件中使用状态管理器"></a>19.2.5 组件中使用状态管理器</h3><p><code>src/19_rtk/views/Home.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="comment">// useSelector 用来获取状态管理器的状态</span></span><br><span class="line"><span class="comment">// useDispatch 用来修改状态</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSelector, useDispatch &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; changeBannerList, changeProList &#125; <span class="keyword">from</span> <span class="string">&#x27;./../store/modules/home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getBannerList, getProList  &#125; <span class="keyword">from</span> <span class="string">&#x27;../api/home&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> bannerList = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">home</span>.<span class="property">bannerList</span>)</span><br><span class="line">  <span class="keyword">const</span> proList = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">home</span>.<span class="property">proList</span>)</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>()</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getBannerList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123; </span><br><span class="line">      <span class="title function_">dispatch</span>(<span class="title function_">changeBannerList</span>(res.<span class="property">data</span>))</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">getProList</span>(&#123; <span class="attr">limitNum</span>: <span class="number">5</span> &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123; </span><br><span class="line">      <span class="title function_">dispatch</span>(<span class="title function_">changeProList</span>(res.<span class="property">data</span>))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [dispatch])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; </span></span><br><span class="line"><span class="language-xml">          bannerList &amp;&amp; bannerList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.bannerid</span> &#125; <span class="attr">src</span>=<span class="string">&#123;</span> <span class="attr">item.img</span> &#125; <span class="attr">alt</span>=<span class="string">&#123;item.alt&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">100</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          proList &amp;&amp; proList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return (<span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span>&#123; item.proname &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Home</span>;</span><br></pre></td></tr></table></figure><p><code>src/19_rtk/views/Kind.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getKindList &#125; <span class="keyword">from</span> <span class="string">&#x27;../api/kind&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; changeKindList &#125; <span class="keyword">from</span> <span class="string">&#x27;../store/modules/kind&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Kind</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> kindList = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">kind</span>.<span class="property">kindList</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>()</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">getKindList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(<span class="title function_">changeKindList</span>(res.<span class="property">data</span>))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, [dispatch])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Kind<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        kindList &amp;&amp; kindList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item</span> &#125;&gt;</span> &#123; item &#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Kind</span>;</span><br></pre></td></tr></table></figure><blockquote><ul><li><p>使用<code>configureStore</code>创建 Redux store</p><ul><li><code>configureStore</code> 接受 <code>reducer</code> 函数作为命名参数</li><li><code>configureStore</code> 使用的好用的默认设置自动设置 store</li></ul></li><li><p>为 React 应用程序组件提供 Redux store</p><ul><li>使用 React-Redux <code>&lt;Provider&gt;</code> 组件包裹你的 <code>&lt;App /&gt;</code></li><li>传递 Redux store 如 <code>&lt;Provider store=&#123;store&#125;&gt;</code></li></ul></li><li><p>使用 <code>createSlice</code> 创建 Redux “slice” reducer</p><ul><li><p>使用字符串名称、初始状态和命名的 reducers 函数调用“createSlice”</p></li><li><p>Reducer 函数可以使用 Immer 来“改变”状态</p></li><li><p>导出生成的 slice reducer 和 action creators</p></li></ul></li><li><p>在 React 组件中使用 React-Redux <code>useSelector/useDispatch</code> 钩子</p><ul><li><p>使用 <code>useSelector</code> 钩子从 store 中读取数据</p></li><li><p>使用 <code>useDispatch</code> 钩子获取 <code>dispatch</code> 函数，并根据需要 dispatch actions</p></li></ul></li></ul></blockquote><blockquote><p>此时发现，组件中的异步操作在 组件内部调用，接下来需要研究如何将异步操作从组件提取出来</p></blockquote><h2 id="19-3-提取异步操作"><a href="#19-3-提取异步操作" class="headerlink" title="19.3 提取异步操作"></a>19.3 提取异步操作</h2><h3 id="19-3-1-自己定义请求函数"><a href="#19-3-1-自己定义请求函数" class="headerlink" title="19.3.1 自己定义请求函数"></a>19.3.1 自己定义请求函数</h3><p><code>src/20_rtk_async/api/home.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getBannerList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/banner/list&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getProList</span> (params) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/list?limitNum=&#x27;</span> + params.<span class="property">limitNum</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>src/20_rtk_async/api/kind.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getKindList</span> () &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://121.89.205.189:3001/api/pro/categorylist&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>src/20_rtk_async/store/modules/home.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSlice &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getBannerList, getProList &#125; <span class="keyword">from</span> <span class="string">&#x27;../../api/home&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> homeSlice = <span class="title function_">createSlice</span>(&#123; <span class="comment">// 主要定义模块，后期从模块中取值给组件以及整合状态管理器</span></span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;home&#x27;</span>, <span class="comment">// 模块名称</span></span><br><span class="line">  <span class="attr">initialState</span>: &#123; <span class="comment">// 模块代表的初始化状态</span></span><br><span class="line">    <span class="attr">bannerList</span>: [],</span><br><span class="line">    <span class="attr">proList</span>: []</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123; <span class="comment">// 修改状态</span></span><br><span class="line">    changeBannerList (state, action) &#123;</span><br><span class="line">      state.<span class="property">bannerList</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;,</span><br><span class="line">    changeProList (state, action) &#123;</span><br><span class="line">      state.<span class="property">proList</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 取得数据之后，只需要 dispatch 触发此函数即可，参数即为修改时用的action的值</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; changeBannerList, changeProList &#125; = homeSlice.<span class="property">actions</span></span><br><span class="line"><span class="comment">// 如果异步操作在状态管理器，写如下代码，参照 redux-thunk 写法</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getBannerListAction</span> (dispatch) &#123; <span class="comment">// dispatch 为默认参数</span></span><br><span class="line">  <span class="title function_">getBannerList</span>().<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">changeBannerList</span>(res.<span class="property">data</span>))</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getProListAction</span> (params) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123; <span class="comment">// dispatch 为默认参数</span></span><br><span class="line">    <span class="title function_">getProList</span>(params).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">dispatch</span>(<span class="title function_">changeProList</span>(res.<span class="property">data</span>))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> homeSlice.<span class="property">reducer</span></span><br></pre></td></tr></table></figure><p><code>src/20_rtk_async/store/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"><span class="keyword">import</span> home <span class="keyword">from</span> <span class="string">&#x27;./modules/home&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123;</span><br><span class="line">    home</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><p><code>src/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入状态管理器</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span> <span class="comment">// 提供Provier组件，可以添加store属性</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./20_rtk_async/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./20_rtk_async/App&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签形式调用</span></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span> = <span class="string">&#123;</span> <span class="attr">store</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>src/20_rtk_async/App.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./views/Home&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Kind</span> <span class="keyword">from</span> <span class="string">&#x27;./views/Kind&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Home</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Kind</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p><code>src/20_rtk_async/views/Home.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getBannerListAction, getProListAction &#125; <span class="keyword">from</span> <span class="string">&#x27;../store/modules/home&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> bannerList = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">home</span>.<span class="property">bannerList</span>)</span><br><span class="line">  <span class="keyword">const</span> proList = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">home</span>.<span class="property">proList</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>()</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(getBannerListAction) <span class="comment">// 无参不加（）</span></span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">getProListAction</span>(&#123; <span class="attr">limitNum</span>: <span class="number">8</span> &#125;)) <span class="comment">// 有参加（）</span></span><br><span class="line">  &#125;, [dispatch])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Home20<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123; </span></span><br><span class="line"><span class="language-xml">          bannerList &amp;&amp; bannerList.map(item =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.bannerid</span> &#125; <span class="attr">src</span>=<span class="string">&#123;</span> <span class="attr">item.img</span> &#125; <span class="attr">alt</span>=<span class="string">&#123;item.alt&#125;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">100</span> &#125;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;</span></span><br><span class="line"><span class="language-xml">          proList &amp;&amp; proList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            return (<span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item.proid</span> &#125;&gt;</span>&#123; item.proname &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">          &#125;)</span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Home</span>;</span><br></pre></td></tr></table></figure><h3 id="19-3-2-使用-createAsyncThunk-请求数据"><a href="#19-3-2-使用-createAsyncThunk-请求数据" class="headerlink" title="19.3.2 使用 createAsyncThunk 请求数据"></a>19.3.2 使用 <code>createAsyncThunk</code> 请求数据</h3><p>Redux Toolkit 的 <code>createAsyncThunk</code> API 生成 thunk，为您自动 dispatch 那些 “start&#x2F;success&#x2F;failure” action。</p><p><code>src/20_rtk_async/store/modules/kind.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSlice, createAsyncThunk &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getKindList &#125; <span class="keyword">from</span> <span class="string">&#x27;./../../api//kind&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> kindSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;kind&#x27;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">kindList</span>: []</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    changeKindList (state, action) &#123; <span class="comment">// 如果使用了 createAsyncThunk 此处修改状态失效</span></span><br><span class="line">      state.<span class="property">kindList</span> = action.<span class="property">payload</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">extraReducers</span>: <span class="function">(<span class="params">builder</span>) =&gt;</span> &#123; <span class="comment">// createAsyncThunk 在这里修改状态 下面可以看作固定的写法</span></span><br><span class="line">    builder</span><br><span class="line">      .<span class="title function_">addCase</span>(getKindListAction.<span class="property">pending</span>, <span class="function"><span class="params">state</span> =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">status</span> = <span class="string">&#x27;loading&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">addCase</span>(getKindListAction.<span class="property">fulfilled</span>, <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">status</span> = <span class="string">&#x27;idle&#x27;</span></span><br><span class="line">        state.<span class="property">kindList</span> = action.<span class="property">payload</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">addCase</span>(getKindListAction.<span class="property">rejected</span>, <span class="function"><span class="params">state</span> =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">status</span> = <span class="string">&#x27;failed&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// kind/getKindListAction1123 可以自定义，但是最好有意义</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getKindListAction = <span class="title function_">createAsyncThunk</span>(<span class="string">&#x27;kind/getKindListAction1123&#x27;</span>, <span class="keyword">async</span> (num) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;num&#x27;</span>, num)</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getKindList</span>()</span><br><span class="line">  <span class="keyword">return</span> res.<span class="property">data</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; changeKindList &#125; = kindSlice.<span class="property">actions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> kindSlice.<span class="property">reducer</span></span><br></pre></td></tr></table></figure><p><code>src/20_rtk_async/views/Kind.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getKindListAction &#125; <span class="keyword">from</span> <span class="string">&#x27;../store/modules/kind&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Kind</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> kindList = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">kind</span>.<span class="property">kindList</span>)</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>()</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">getKindListAction</span>(<span class="number">1000000</span>))</span><br><span class="line">  &#125;, [dispatch])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Kind20<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;</span></span><br><span class="line"><span class="language-xml">        kindList &amp;&amp; kindList.map(item =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">          return (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span> = <span class="string">&#123;</span> <span class="attr">item</span> &#125;&gt;</span> &#123; item &#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          )</span></span><br><span class="line"><span class="language-xml">        &#125;)</span></span><br><span class="line"><span class="language-xml">      &#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Kind</span>;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="https://angelxyj.github.io">许小墨</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接:</span> <span class="post-copyright-info"><a href="https://angelxyj.github.io/posts/66450fce.html">https://angelxyj.github.io/posts/66450fce.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://angelxyj.github.io" target="_blank">许小墨のBlog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/%E5%89%8D%E7%AB%AF/">前端</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/%E6%A1%86%E6%9E%B6/">框架</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/React/">React</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/React%E9%87%8D%E5%88%B6%E7%89%88/">React重制版</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/react-course/">react-course</a></div><div class="post_share"><div class="social-share" data-image="/img/11.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>感谢支持！</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat.png" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/1c915f8b.html" title="37-React综合案例"><img class="cover" src="/img/jujingyi.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">37-React综合案例</div></div></a></div><div class="next-post pull-right"><a href="/posts/60af50c8.html" title="react-pc"><img class="cover" src="/img/7.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">react-pc</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/57ee22ab.html" title="next.js"><img class="cover" src="/img/3.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-18</div><div class="title">next.js</div></div></a></div><div><a href="/posts/60af50c8.html" title="react-pc"><img class="cover" src="/img/7.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-18</div><div class="title">react-pc</div></div></a></div><div><a href="/posts/c22d7424.html" title="react-mobile"><img class="cover" src="/img/16.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-18</div><div class="title">react-mobile</div></div></a></div><div><a href="/posts/e639fe97.html" title="git-note"><img class="cover" src="/img/jujingyi.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-01</div><div class="title">git-note</div></div></a></div><div><a href="/posts/4ce86b9.html" title="小程序登录"><img class="cover" src="/img/6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-01</div><div class="title">小程序登录</div></div></a></div><div><a href="/posts/b76d08a1.html" title="小程序笔记"><img class="cover" src="/img/7.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-01</div><div class="title">小程序笔记</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div><div class="comment-switch"><span class="first-comment">Waline</span><span id="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/touxiang.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">许小墨</div><div class="author-info__description">全栈攻城狮的基本素养</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">198</div></a><a href="/%E6%A0%87%E7%AD%BE/"><div class="headline">标签</div><div class="length-num">183</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">42</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Angelxyj"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Angelxyj" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1440023258@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E3%80%87%E3%80%81React"><span class="toc-number">1.</span> <span class="toc-text">〇、React</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%85%B3%E4%BA%8EReact"><span class="toc-number">2.</span> <span class="toc-text">一、关于React</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%84%9A%E6%89%8B%E6%9E%B6"><span class="toc-number">3.</span> <span class="toc-text">二、脚手架</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-create-react-app%E8%84%9A%E6%89%8B%E6%9E%B6%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 create-react-app脚手架的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95%E8%A7%A3%E6%9E%90"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 项目目录解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E6%8A%BD%E7%A6%BB%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 抽离配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-webpack%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 webpack二次封装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-1-%E9%9B%86%E6%88%90css%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">3.4.1.</span> <span class="toc-text">2.4.1 集成css预处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-2-%E9%85%8D%E7%BD%AE-%E8%A7%A3%E6%9E%90%E5%88%AB%E5%90%8D"><span class="toc-number">3.4.2.</span> <span class="toc-text">2.4.2 配置@解析别名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-setupProxy%E4%BB%A3%E7%90%86"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 setupProxy代理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81JSX"><span class="toc-number">4.</span> <span class="toc-text">三、JSX</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-jsx%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 jsx语法详解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-React-createElement"><span class="toc-number">4.2.</span> <span class="toc-text">3.2 React.createElement</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%BB%84%E4%BB%B6%E5%AE%9A%E4%B9%89"><span class="toc-number">5.</span> <span class="toc-text">四、组件定义</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E7%B1%BB%E7%BB%84%E4%BB%B6"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 类组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6"><span class="toc-number">5.2.</span> <span class="toc-text">4.2 函数组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E4%B8%A4%E7%BB%84%E7%BB%84%E4%BB%B6%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">5.3.</span> <span class="toc-text">4.3 两组组件的区别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81Props"><span class="toc-number">6.</span> <span class="toc-text">五、Props</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-Props%E8%AF%A6%E8%A7%A3"><span class="toc-number">6.1.</span> <span class="toc-text">5.1 Props详解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">6.2.</span> <span class="toc-text">5.2 父子组件通信</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-1-%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6"><span class="toc-number">6.2.1.</span> <span class="toc-text">5.2.1 构建一个父子组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-2-%E7%88%B6%E7%BB%84%E4%BB%B6%E7%BB%99%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC"><span class="toc-number">6.2.2.</span> <span class="toc-text">5.2.2 父组件给子组件传值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-3-%E7%88%B6%E7%BB%84%E4%BB%B6%E7%BB%99%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">6.2.3.</span> <span class="toc-text">5.2.3 父组件给子组件传值设置默认值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-4-%E4%BD%BF%E7%94%A8prop-types%E5%B1%9E%E6%80%A7%E9%AA%8C%E8%AF%81"><span class="toc-number">6.2.4.</span> <span class="toc-text">5.2.4 使用prop-types属性验证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-props-children"><span class="toc-number">6.3.</span> <span class="toc-text">5.3 props.children</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-render-props%E7%89%B9%E6%80%A7"><span class="toc-number">6.4.</span> <span class="toc-text">5.4 render props特性</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81State"><span class="toc-number">7.</span> <span class="toc-text">六、State</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-state%E5%8F%8A%E5%85%B6%E7%89%B9%E7%82%B9"><span class="toc-number">7.1.</span> <span class="toc-text">6.1 state及其特点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-state%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">7.2.</span> <span class="toc-text">6.2 state的定义和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-1-es6%E7%9A%84%E7%B1%BB-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">7.2.1.</span> <span class="toc-text">6.2.1 es6的类 - 构造函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-2-es7%E7%9A%84%E7%B1%BB-%E5%B1%9E%E6%80%A7%E5%88%9D%E5%A7%8B%E5%8C%96%E5%99%A8"><span class="toc-number">7.2.2.</span> <span class="toc-text">6.2.2 es7的类 - 属性初始化器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E5%A6%82%E4%BD%95%E6%AD%A3%E7%A1%AE%E7%9A%84%E4%BF%AE%E6%94%B9state"><span class="toc-number">7.3.</span> <span class="toc-text">6.3 如何正确的修改state</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-this-setState-%E6%96%B9%E6%B3%95%E5%8F%8A%E5%85%B6%E7%89%B9%E7%82%B9"><span class="toc-number">7.4.</span> <span class="toc-text">6.4 this.setState()方法及其特点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-1-%E4%BC%A0%E9%80%92%E5%87%BD%E6%95%B0"><span class="toc-number">7.4.1.</span> <span class="toc-text">6.4.1 传递函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-2-%E4%BC%A0%E9%80%92%E5%AF%B9%E8%B1%A1"><span class="toc-number">7.4.2.</span> <span class="toc-text">6.4.2 传递对象</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.</span> <span class="toc-text">七、生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5"><span class="toc-number">8.1.</span> <span class="toc-text">7.1 三个阶段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-1-%E8%A3%85%E8%BD%BD%E9%98%B6%E6%AE%B5"><span class="toc-number">8.1.1.</span> <span class="toc-text">7.1.1 装载阶段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-2-%E6%9B%B4%E6%96%B0%E9%98%B6%E6%AE%B5"><span class="toc-number">8.1.2.</span> <span class="toc-text">7.1.2 更新阶段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-3-%E5%8D%B8%E8%BD%BD%E9%98%B6%E6%AE%B5"><span class="toc-number">8.1.3.</span> <span class="toc-text">7.1.3 卸载阶段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-4-Error-boundaries"><span class="toc-number">8.1.4.</span> <span class="toc-text">7.1.4 Error boundaries</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E4%B8%A4%E4%B8%AA%E6%97%B6%E6%9C%9F"><span class="toc-number">8.2.</span> <span class="toc-text">7.2 两个时期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E5%85%A5%E9%97%A8%E7%90%86%E8%A7%A3React-Fiber%E6%9E%B6%E6%9E%84"><span class="toc-number">8.3.</span> <span class="toc-text">7.3 入门理解React Fiber架构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A"><span class="toc-number">9.</span> <span class="toc-text">八、事件绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-ES5%E8%AF%AD%E6%B3%95%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6"><span class="toc-number">9.1.</span> <span class="toc-text">8.1 ES5语法绑定事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-1-%E6%97%A0%E5%8F%82%E6%95%B0%E7%9A%84%E7%BB%91%E5%AE%9A"><span class="toc-number">9.1.1.</span> <span class="toc-text">8.1.1 无参数的绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-1-1-%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-number">9.1.1.1.</span> <span class="toc-text">8.1.1.1 方法一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-1-1-%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-number">9.1.1.2.</span> <span class="toc-text">8.1.1.1 方法二</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-2-%E6%9C%89%E5%8F%82%E6%95%B0%E7%9A%84%E7%BB%91%E5%AE%9A"><span class="toc-number">9.1.2.</span> <span class="toc-text">8.1.2 有参数的绑定</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-ES6%E8%AF%AD%E6%B3%95%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6"><span class="toc-number">9.2.</span> <span class="toc-text">8.2 ES6语法绑定事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-1-%E6%97%A0%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9A"><span class="toc-number">9.2.1.</span> <span class="toc-text">8.2.1 无参数绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-1-1-%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-number">9.2.1.1.</span> <span class="toc-text">8.2.1.1 方法一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-1-2-%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-number">9.2.1.2.</span> <span class="toc-text">8.2.1.2 方法二</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-2-%E6%9C%89%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9A"><span class="toc-number">9.2.2.</span> <span class="toc-text">8.2.2 有参数绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-2-1-%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-number">9.2.2.1.</span> <span class="toc-text">8.2.2.1 方法一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-2-2-%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-number">9.2.2.2.</span> <span class="toc-text">8.2.2.2 方法二</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">9.3.</span> <span class="toc-text">8.3 合成事件的特点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-1-%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6"><span class="toc-number">9.3.1.</span> <span class="toc-text">8.3.1 事件机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-2-%E5%AF%B9%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-number">9.3.2.</span> <span class="toc-text">8.3.2 对合成事件的理解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-3-%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-number">9.3.3.</span> <span class="toc-text">8.3.3 事件机制的流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%86%8C"><span class="toc-number">9.3.3.1.</span> <span class="toc-text">1、事件注册</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E4%BA%8B%E4%BB%B6%E5%AD%98%E5%82%A8"><span class="toc-number">9.3.3.2.</span> <span class="toc-text">2、事件存储</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E4%BA%8B%E4%BB%B6%E6%89%A7%E8%A1%8C"><span class="toc-number">9.3.3.3.</span> <span class="toc-text">3、事件执行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-4-%E5%90%88%E6%88%90%E4%BA%8B%E4%BB%B6%E3%80%81%E5%8E%9F%E7%94%9F%E4%BA%8B%E4%BB%B6%E4%B9%8B%E9%97%B4%E7%9A%84%E5%86%92%E6%B3%A1%E6%89%A7%E8%A1%8C%E5%85%B3%E7%B3%BB"><span class="toc-number">9.3.4.</span> <span class="toc-text">8.3.4 合成事件、原生事件之间的冒泡执行关系</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-number">10.</span> <span class="toc-text">九、条件渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1"><span class="toc-number">10.1.</span> <span class="toc-text">9.1 &amp;&amp;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-%E4%B8%89%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">10.2.</span> <span class="toc-text">9.2 三元运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-3-%E5%8A%A8%E6%80%81className"><span class="toc-number">10.3.</span> <span class="toc-text">9.3 动态className</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4-%E5%8A%A8%E6%80%81style"><span class="toc-number">10.4.</span> <span class="toc-text">9.4 动态style</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="toc-number">11.</span> <span class="toc-text">十、列表渲染</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E8%A1%A8%E5%8D%95%E7%BB%91%E5%AE%9A"><span class="toc-number">12.</span> <span class="toc-text">十一、表单绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1-%E5%90%84%E7%A7%8D%E8%A1%A8%E5%8D%95%E7%9A%84%E7%BB%91%E5%AE%9A%E4%B8%8E%E5%8F%96%E5%80%BC"><span class="toc-number">12.1.</span> <span class="toc-text">11.1 各种表单的绑定与取值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2-%E5%8F%97%E6%8E%A7%E8%A1%A8%E5%8D%95%E4%BB%A5%E5%8F%8A%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6"><span class="toc-number">12.2.</span> <span class="toc-text">11.2 受控表单以及受控组件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E7%8A%B6%E6%80%81%E6%8F%90%E5%8D%87"><span class="toc-number">13.</span> <span class="toc-text">十二、状态提升</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#12-1-%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">13.1.</span> <span class="toc-text">12.1 父子组件通信</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-2-%E7%8A%B6%E6%80%81%E6%8F%90%E5%8D%87%E8%A7%A3%E8%AF%BB"><span class="toc-number">13.2.</span> <span class="toc-text">12.2 状态提升解读</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81%E7%BB%84%E5%90%88vs%E7%BB%A7%E6%89%BF"><span class="toc-number">14.</span> <span class="toc-text">十三、组合vs继承</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#13-1-%E7%90%86%E8%A7%A3%E7%BB%84%E4%BB%B6%E5%8C%96"><span class="toc-number">14.1.</span> <span class="toc-text">13.1 理解组件化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-2-%E4%BD%BF%E7%94%A8%E7%BB%84%E5%90%88%E8%80%8C%E9%9D%9E%E7%BB%A7%E6%89%BF%E5%AE%9E%E7%8E%B0React%E7%BB%84%E4%BB%B6%E5%8C%96"><span class="toc-number">14.2.</span> <span class="toc-text">13.2 使用组合而非继承实现React组件化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-3-%E5%B0%81%E8%A3%85Modal%E5%BC%B9%E7%AA%97"><span class="toc-number">14.3.</span> <span class="toc-text">13.3 封装Modal弹窗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-4-ReactDOM-createPortal"><span class="toc-number">14.4.</span> <span class="toc-text">13.4 ReactDOM.createPortal()</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81%E4%B8%8A%E4%B8%8B%E6%96%87Context"><span class="toc-number">15.</span> <span class="toc-text">十四、上下文Context</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#14-1-%E7%90%86%E8%A7%A3%E4%B8%8A%E4%B8%8B%E6%96%87%E3%80%81%E4%BD%9C%E7%94%A8%E5%8F%8A%E5%85%B6%E7%89%B9%E7%82%B9"><span class="toc-number">15.1.</span> <span class="toc-text">14.1 理解上下文、作用及其特点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-2-%E4%BD%BF%E7%94%A8React-createContext"><span class="toc-number">15.2.</span> <span class="toc-text">14.2 使用React.createContext()</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-1-%E9%80%90%E5%B1%82%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE"><span class="toc-number">15.2.1.</span> <span class="toc-text">14.2.1 逐层传递数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-2-%E4%BD%BF%E7%94%A8Context%E4%BC%A0%E5%80%BC"><span class="toc-number">15.2.2.</span> <span class="toc-text">14.2.2 使用Context传值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-3-%E4%BC%A0%E9%80%92%E5%A4%9A%E4%B8%AA%E5%80%BC"><span class="toc-number">15.2.3.</span> <span class="toc-text">14.2.3 传递多个值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-4-displayName"><span class="toc-number">15.2.4.</span> <span class="toc-text">14.2.4 displayName</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-3-%E5%B8%B8%E8%A7%81%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E8%A7%A3%E8%AF%BB"><span class="toc-number">15.3.</span> <span class="toc-text">14.3 常见应用场景解读</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%BA%94%E3%80%81%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6"><span class="toc-number">16.</span> <span class="toc-text">十五、高阶组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#15-1-%E7%90%86%E8%A7%A3%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E3%80%81%E4%BD%9C%E7%94%A8%E5%8F%8A%E5%85%B6%E7%89%B9%E7%82%B9"><span class="toc-number">16.1.</span> <span class="toc-text">15.1 理解高阶组件、作用及其特点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-2-%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3"><span class="toc-number">16.2.</span> <span class="toc-text">15.2 高阶组件语法详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#15-2-1-%E7%BB%84%E4%BB%B6%E5%B5%8C%E5%A5%97"><span class="toc-number">16.2.1.</span> <span class="toc-text">15.2.1 组件嵌套</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-2-2-%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6"><span class="toc-number">16.2.2.</span> <span class="toc-text">15.2.2 高阶组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-3-%E5%B8%B8%E8%A7%81%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E8%A7%A3%E8%AF%BB"><span class="toc-number">16.3.</span> <span class="toc-text">15.3 常见应用场景解读</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%85%AD%E3%80%81ref"><span class="toc-number">17.</span> <span class="toc-text">十六、ref</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#16-1-ref%E8%AE%BF%E9%97%AEDOM"><span class="toc-number">17.1.</span> <span class="toc-text">16.1 ref访问DOM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-2-%E8%AF%A6%E8%A7%A3ref%E8%BD%AC%E5%8F%91"><span class="toc-number">17.2.</span> <span class="toc-text">16.2 详解ref转发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-3-%E4%BD%BF%E7%94%A8ref%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">17.3.</span> <span class="toc-text">16.3 使用ref注意事项</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%83%E3%80%81hooks"><span class="toc-number">18.</span> <span class="toc-text">十七、hooks</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#17-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8hooks"><span class="toc-number">18.1.</span> <span class="toc-text">17.1 为什么使用hooks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-2%E5%B8%B8%E8%A7%81%E7%9A%84hooks"><span class="toc-number">18.2.</span> <span class="toc-text">17.2常见的hooks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-1-useState"><span class="toc-number">18.2.1.</span> <span class="toc-text">17.2.1 useState</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-2-useEffect"><span class="toc-number">18.2.2.</span> <span class="toc-text">17.2.2 useEffect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-3-useRef"><span class="toc-number">18.2.3.</span> <span class="toc-text">17.2.3 useRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-4-useReducer"><span class="toc-number">18.2.4.</span> <span class="toc-text">17.2.4 useReducer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-5-useContext"><span class="toc-number">18.2.5.</span> <span class="toc-text">17.2.5 useContext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-6-useMemo"><span class="toc-number">18.2.6.</span> <span class="toc-text">17.2.6 useMemo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-7-useCallback"><span class="toc-number">18.2.7.</span> <span class="toc-text">17.2.7 useCallback</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-8-useImperativeHandle"><span class="toc-number">18.2.8.</span> <span class="toc-text">17.2.8 useImperativeHandle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-9-useLayoutEffect"><span class="toc-number">18.2.9.</span> <span class="toc-text">17.2.9 useLayoutEffect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-10-useDebugValue"><span class="toc-number">18.2.10.</span> <span class="toc-text">17.2.10 useDebugValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-11-useId"><span class="toc-number">18.2.11.</span> <span class="toc-text">17.2.11 useId</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-12-useDeferredValue"><span class="toc-number">18.2.12.</span> <span class="toc-text">17.2.12 useDeferredValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-13-useTransition"><span class="toc-number">18.2.13.</span> <span class="toc-text">17.2.13 useTransition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-14-useSyncExternalStore"><span class="toc-number">18.2.14.</span> <span class="toc-text">17.2.14 useSyncExternalStore</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-2-15-useInsertionEffect"><span class="toc-number">18.2.15.</span> <span class="toc-text">17.2.15 useInsertionEffect</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-3-%E8%87%AA%E5%AE%9A%E4%B9%89hooks"><span class="toc-number">18.3.</span> <span class="toc-text">17.3 自定义hooks</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%85%AB%E3%80%81Redux"><span class="toc-number">19.</span> <span class="toc-text">十八、Redux</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#18-1-%E7%90%86%E8%A7%A3Flux%E6%9E%B6%E6%9E%84"><span class="toc-number">19.1.</span> <span class="toc-text">18.1 理解Flux架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-2-%E7%90%86%E8%A7%A3Redux%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81%E6%B5%81%E7%A8%8B"><span class="toc-number">19.2.</span> <span class="toc-text">18.2 理解Redux单向数据流流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-3-redux%E4%BD%BF%E7%94%A8%E4%B8%89%E5%A4%A7%E5%8E%9F%E5%88%99"><span class="toc-number">19.3.</span> <span class="toc-text">18.3 redux使用三大原则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-4-redux-react-redux%E9%85%8D%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-number">19.4.</span> <span class="toc-text">18.4 redux + react-redux配合使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-1-%E5%88%9B%E5%BB%BA%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">19.4.1.</span> <span class="toc-text">18.4.1 创建状态管理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-4-2-%E4%BD%BF%E7%94%A8react-redux"><span class="toc-number">19.4.2.</span> <span class="toc-text">18.4.2 使用react-redux</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-5-redux-react-redux%E5%88%86%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8"><span class="toc-number">19.5.</span> <span class="toc-text">18.5 redux+react-redux分模块使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-6-redux-react-redux-%E5%88%86%E6%A8%A1%E5%9D%97-%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">19.6.</span> <span class="toc-text">18.6 redux + react-redux + 分模块+ 异步操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#18-6-1-redux-thunk"><span class="toc-number">19.6.1.</span> <span class="toc-text">18.6.1 redux-thunk</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-6-2-redux-saga"><span class="toc-number">19.6.2.</span> <span class="toc-text">18.6.2 redux-saga</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-7-%E4%BD%BF%E7%94%A8immutable%E4%B8%8D%E5%8F%AF%E5%8F%98%E6%95%B0%E6%8D%AE%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">19.7.</span> <span class="toc-text">18.7 使用immutable不可变数据数据结构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B9%9D%E3%80%81redux-toolkit"><span class="toc-number">20.</span> <span class="toc-text">十九、redux toolkit</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#19-1-%E4%BB%80%E4%B9%88%E6%98%AFRedux-Toolkit"><span class="toc-number">20.1.</span> <span class="toc-text">19.1 什么是Redux Toolkit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-2-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8redux-toolkit"><span class="toc-number">20.2.</span> <span class="toc-text">19.2 如何使用redux-toolkit</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#19-2-1-%E5%88%9B%E5%BB%BA%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">20.2.1.</span> <span class="toc-text">19.2.1 创建状态管理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-2-2-%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">20.2.2.</span> <span class="toc-text">19.2.2 入口文件配置状态管理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-2-3-%E5%88%9B%E5%BB%BA%E5%88%86%E6%A8%A1%E5%9D%97%E5%88%87%E7%89%87"><span class="toc-number">20.2.3.</span> <span class="toc-text">19.2.3 创建分模块切片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-2-4-%E6%95%B4%E5%90%88%E5%88%87%E7%89%87"><span class="toc-number">20.2.4.</span> <span class="toc-text">19.2.4 整合切片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-2-5-%E7%BB%84%E4%BB%B6%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">20.2.5.</span> <span class="toc-text">19.2.5 组件中使用状态管理器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-3-%E6%8F%90%E5%8F%96%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">20.3.</span> <span class="toc-text">19.3 提取异步操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#19-3-1-%E8%87%AA%E5%B7%B1%E5%AE%9A%E4%B9%89%E8%AF%B7%E6%B1%82%E5%87%BD%E6%95%B0"><span class="toc-number">20.3.1.</span> <span class="toc-text">19.3.1 自己定义请求函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-3-2-%E4%BD%BF%E7%94%A8-createAsyncThunk-%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE"><span class="toc-number">20.3.2.</span> <span class="toc-text">19.3.2 使用 createAsyncThunk 请求数据</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/3d9e6dac.html" title="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia"><img src="/img/14.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia"></a><div class="content"><a class="title" href="/posts/3d9e6dac.html" title="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia">004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia</a><time datetime="2024-06-12T21:53:42.000Z" title="发表于 2024-06-12 21:53:42">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4f9a63a7.html" title="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？"><img src="/img/18.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？"></a><div class="content"><a class="title" href="/posts/4f9a63a7.html" title="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？">003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？</a><time datetime="2024-06-12T21:45:44.000Z" title="发表于 2024-06-12 21:45:44">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dda8b3d8.html" title="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分"><img src="/img/jujingyi.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分"></a><div class="content"><a class="title" href="/posts/dda8b3d8.html" title="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分">002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分</a><time datetime="2024-06-12T21:35:34.000Z" title="发表于 2024-06-12 21:35:34">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1faddbca.html" title="001_组件化开发原理，鸿蒙组件化实现思路"><img src="/img/1.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="001_组件化开发原理，鸿蒙组件化实现思路"></a><div class="content"><a class="title" href="/posts/1faddbca.html" title="001_组件化开发原理，鸿蒙组件化实现思路">001_组件化开发原理，鸿蒙组件化实现思路</a><time datetime="2024-06-12T21:28:54.000Z" title="发表于 2024-06-12 21:28:54">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/6d6b0b0f.html" title="019_Gauge"><img src="/img/9.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="019_Gauge"></a><div class="content"><a class="title" href="/posts/6d6b0b0f.html" title="019_Gauge">019_Gauge</a><time datetime="2024-06-12T21:24:14.000Z" title="发表于 2024-06-12 21:24:14">2024-06-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2024 By 许小墨</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_60306931/category_12251529.html">blog</a>!<br><span>备案号：xxxxxx</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach(((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,a="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent,i=mermaid.render(r,a);var m;"string"==typeof i?(m=i,d.insertAdjacentHTML("afterend",m)):i.then((({svg:e})=>{d.insertAdjacentHTML("afterend",e)}))}))},n=()=>{window.loadMermaid?t():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(t)};btf.addGlobalFn("themeChange",t,"mermaid"),window.pjax?n():document.addEventListener("DOMContentLoaded",n)})()</script><script>(()=>{let n=window.walineFn||null;const e=n=>{const e=n(Object.assign({el:"#waline-wrap",serverURL:"https://xuxiaomo-waline-i53b26l6n-xuxiaomo-xyj.vercel.app/",pageview:!1,dark:'html[data-theme="dark"]',path:window.location.pathname,comment:!1},null));btf.addGlobalFn("pjax",(()=>{e.destroy()}),"destroyWaline")},t=async()=>{if(n)e(n);else{await getCSS("https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css");const{init:t}=await import("https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js");n=t||Waline.init,e(n),window.walineFn=n}};btf.loadComment(document.getElementById("waline-wrap"),t)})()</script><script>(()=>{const t=function(){this.page.url="https://angelxyj.github.io/posts/66450fce.html",this.page.identifier="/posts/66450fce.html",this.page.title="react基础"},e=()=>{window.DISQUS&&window.DISQUS.reset({reload:!0,config:t})};btf.addGlobalFn("themeChange",e,"disqus");const i=()=>{if(window.DISQUS)e();else{const t=document.createElement("script");t.src="https://xuxiaomo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),document.head.appendChild(t)}};window.loadOtherComment=i})()</script></div><script>window.addEventListener("load",(()=>{const e=e=>{let t="";if(e.length)for(let a=0;a<e.length;a++){t+="<div class='aside-list-item'>";{const n="src";t+=`<a href='${e[a].url}' class='thumbnail'><img ${n}='${e[a].avatar}' alt='${e[a].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[a].url}' title='${e[a].content}'>${e[a].content}</a>\n        <div class='name'><span>${e[a].nick} / </span><time datetime="${e[a].date}">${btf.diffDate(e[a].date,!0)}</time></div>\n        </div></div>`}else t+="没有评论";let a=document.querySelector("#card-newest-comments .aside-list");a&&(a.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(a)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("waline-newest-comments");t?e(JSON.parse(t)):(async()=>{try{const t=await fetch("https://xuxiaomo-waline-i53b26l6n-xuxiaomo-xyj.vercel.app/api/comment?type=recent&count=6",{method:"GET"}),a=(await t.json()).data.map((e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[图片]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[链接]")).replace(/<pre><code>.*?<\/pre>/gi,"[代码]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.objectId,date:e.time||e.insertedAt};var t}));saveToLocal.set("waline-newest-comments",JSON.stringify(a),10/1440),e(a)}catch(e){console.error(e),document.querySelector("#card-newest-comments .aside-list").textContent="无法获取评论，请确认相关配置是否正确"}})()}};t(),document.addEventListener("pjax:complete",t)}))</script><div class="aplayer no-destroy" data-id="8760365089" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-autoplay="false"></div><script defer src="/live2d-widget/autoload.js"></script><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="true" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script src="//code.tidio.co/fpezrlnx14lzqj1yzhyigw0j3rkhtyzv.js" async></script><script>(()=>{{let i=!1;const d=()=>{window.tidioChatApi.hide(),i=!1},o=()=>{window.tidioChatApi.open(),window.tidioChatApi.show(),i=!0},t=()=>{window.tidioChatApi.hide(),window.tidioChatApi.on("close",d)};window.tidioChatApi?window.tidioChatApi.on("ready",t):document.addEventListener("tidioChat-ready",t),window.chatBtnFn=()=>{window.tidioChatApi&&(i?d():o())}}})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(btf.removeGlobalFnEvent("pjax"),btf.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div><div class="app-refresh" id="app-refresh" style="position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease"><div class="app-refresh-wrap" style="display:flex;color:#fff;height:100%;align-items:center;justify-content:center"><label>✨ 糖果屋上新啦！ 👉</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color:#fff;text-decoration:underline;cursor:pointer">🍭查看新品🍬</span></a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"✨ 糖果屋上新啦！ 👉",backgroundColor:t,duration:5e5,pos:e,actionText:"🍭查看新品🍬",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script></div></body></html>