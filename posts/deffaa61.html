<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>docker1-基础 | 许小墨のBlog</title><meta name="author" content="许小墨,1440023258@qq.com"><meta name="copyright" content="许小墨"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一、Docker介绍问题12问题1:某IT部门要上线一个项目。常规操作，直接去线上服务器，拷贝一个tomcat，然后改端口号，然后部署应用到webapps文件夹下，重启就好。一个服务器上可能会部署多个应用服务。如果某个应用出现问题，CPU100%，可能这个服务器上的其他应用也会出现问题。对于一个大型应用拆分为几十个微服务，分别交由不同的团队开发，不同团队之间水平参差不齐。如果还采用这种部署方式，你"><meta property="og:type" content="article"><meta property="og:title" content="docker1-基础"><meta property="og:url" content="https://angelxyj.github.io/posts/deffaa61.html"><meta property="og:site_name" content="许小墨のBlog"><meta property="og:description" content="一、Docker介绍问题12问题1:某IT部门要上线一个项目。常规操作，直接去线上服务器，拷贝一个tomcat，然后改端口号，然后部署应用到webapps文件夹下，重启就好。一个服务器上可能会部署多个应用服务。如果某个应用出现问题，CPU100%，可能这个服务器上的其他应用也会出现问题。对于一个大型应用拆分为几十个微服务，分别交由不同的团队开发，不同团队之间水平参差不齐。如果还采用这种部署方式，你"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://angelxyj.github.io/img/timg.jpg"><meta property="article:published_time" content="2024-03-16T15:09:42.000Z"><meta property="article:modified_time" content="2024-10-01T16:38:42.878Z"><meta property="article:author" content="许小墨"><meta property="article:tag" content="运维"><meta property="article:tag" content="docker"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://angelxyj.github.io/img/timg.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://angelxyj.github.io/posts/deffaa61.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/favicon-16x16.png"><link rel="mask-icon" href="/img/siteicon/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"找不到您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!0},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: 许小墨",link:"链接: ",source:"来源: 许小墨のBlog",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体中文",cht_to_chs:"你已切换为简体中文",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!0,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!0},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"docker1-基础",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-10-01 16:38:42"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)})),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{const e=document.getElementById("loading-box"),d=document.body,o=()=>{d.style.overflow="",e.classList.add("loaded")},t=()=>{d.style.overflow="hidden",e.classList.remove("loaded")};t(),window.addEventListener("load",(()=>{o()})),document.addEventListener("pjax:send",(()=>{t()})),document.addEventListener("pjax:complete",(()=>{o()}))})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/touxiang.webp" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">198</div></a><a href="/%E6%A0%87%E7%AD%BE/"><div class="headline">标签</div><div class="length-num">183</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">42</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>电影</span></a></li><li><a class="site-page child" href="/poems/"><i class="fa-fw fas fa-book"></i> <span>文学鉴赏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-compass"></i> <span>关于</span></a></li><li><a class="site-page child" href="/sponsor/"><i class="fa-fw fas fa-thumbs-up"></i> <span>打赏</span></a></li><li><a class="site-page child" href="/resume/"><i class="fa-fw fas fa-book"></i> <span>简历</span></a></li><li><a class="site-page child" href="/TodoList"><i class="fa-fw fab fa-internet-explorer"></i> <span>计划</span></a></li><li><a class="site-page child" href="/ChatGPT/"><i class="fa-fw fas fa-fan"></i> <span>GPT</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('/img/timg.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="许小墨のBlog"><span class="site-name">许小墨のBlog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i> <span>清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i> <span>照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i> <span>电影</span></a></li><li><a class="site-page child" href="/poems/"><i class="fa-fw fas fa-book"></i> <span>文学鉴赏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-heart"></i> <span>关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-compass"></i> <span>关于</span></a></li><li><a class="site-page child" href="/sponsor/"><i class="fa-fw fas fa-thumbs-up"></i> <span>打赏</span></a></li><li><a class="site-page child" href="/resume/"><i class="fa-fw fas fa-book"></i> <span>简历</span></a></li><li><a class="site-page child" href="/TodoList"><i class="fa-fw fab fa-internet-explorer"></i> <span>计划</span></a></li><li><a class="site-page child" href="/ChatGPT/"><i class="fa-fw fas fa-fan"></i> <span>GPT</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">docker1-基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-16T15:09:42.000Z" title="发表于 2024-03-16 15:09:42">2024-03-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-01T16:38:42.878Z" title="更新于 2024-10-01 16:38:42">2024-10-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/">运维开发</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91/Docker/">Docker</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>30分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="docker1-基础"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="一、Docker介绍"><a href="#一、Docker介绍" class="headerlink" title="一、Docker介绍"></a>一、Docker介绍</h1><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">问题1:</span><br><span class="line">某IT部门要上线一个项目。常规操作，直接去线上服务器，拷贝一个tomcat，然后改端口号，然后部署应用到webapps文件夹下，重启就好。一个服务器上可能会部署多个应用服务。如果某个应用出现问题，CPU100%，可能这个服务器上的其他应用也会出现问题。对于一个大型应用拆分为几十个微服务，分别交由不同的团队开发，不同团队之间水平参差不齐。如果还采用这种部署方式，你的应用可能会因为另一个团队的应用发生意外。因部署在了同一台服务器上，导致全部出现问题。</span><br></pre></td></tr></table></figure><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">问题2:</span><br><span class="line">开发和线上代码（同一套代码）问题。开发阶段部署一套软件环境，测试人员在开发中测试没有问题，运维进行部署。但是正式部署到服务器时，发生了问题(启动参数、环境问题、漏配了参数)等意外。</span><br></pre></td></tr></table></figure><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">问题3:</span><br><span class="line">随着微服务技术的兴起，一个大的应用需要拆分成多个微服务。多个微服务的生成，就会面临庞大系统的部署效率，开发协同效率问题。然后通过服务的拆分，数据的读写分离、分库分表等方式重新架构，而且这种方式如果要做的彻底，需要花费大量人力物力。可能需要部署很多个服务器。</span><br></pre></td></tr></table></figure><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">问题4:</span><br><span class="line">持续的软件版本发布/测试项目。到线上环境的集成</span><br></pre></td></tr></table></figure><p><img src="/posts/deffaa61/image0.jpg" alt="docker"></p><h2 id="什么是docker"><a href="#什么是docker" class="headerlink" title="什么是docker"></a>什么是docker</h2><p>Docker 是一个开源的应用容器引擎，基于 <strong><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/go/953521">Go 语言</a></strong> 并遵从Apache2.0协议开源。</p><p><strong>Docker</strong> 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 <strong>Linux</strong> 机器上，也可以实现虚拟化。</p><p>容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。</p><h2 id="为什么用docker"><a href="#为什么用docker" class="headerlink" title="为什么用docker"></a>为什么用docker</h2><h4 id="1、简化程序"><a href="#1、简化程序" class="headerlink" title="1、简化程序"></a>1、简化程序</h4><p>Docker 让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的 Linux 机器上，便可以实现虚拟化。Docker改变了虚拟化的方式，使开发者可以直接将自己的成果放入Docker中进行管理。方便快捷已经是 Docker 的最大优势，过去需要用数天乃至数周的 任务，在Docker容器的处理下，只需要数秒就能完成。</p><h4 id="2、避免选择恐惧症"><a href="#2、避免选择恐惧症" class="headerlink" title="2、避免选择恐惧症"></a>2、避免选择恐惧症</h4><p>如果你有选择恐惧症，还是资深患者。Docker 帮你 打包你的纠结！比如 Docker 镜像；<br>Docker 镜像中包含了运行环境和配置，所以 Docker 可以简化部署多种应用实例工作。比如 Web 应用、后台应用、数据库应用、大数据应用比如 Hadoop 集群、消息队列等等都可以打包成一个镜像部署。</p><h4 id="3、节省开支"><a href="#3、节省开支" class="headerlink" title="3、节省开支"></a>3、节省开支</h4><p>一方面，云计算时代到来，使开发者不必为了追求效果而配置高额的硬件，Docker 改变了高性能必然高价格的思维定势。Docker 与云的结合，让云空间得到更充分的利用。不仅解决了硬件管理的问题，也改变了虚拟化的方式。</p><h4 id="4、持续交付和部署"><a href="#4、持续交付和部署" class="headerlink" title="4、持续交付和部署"></a>4、持续交付和部署</h4><p>对开发和运维（DevOps）人员来说，最希望的就是一次创建或配置，可以在任意地方正常运行。使用 Docker 可以通过定制应用镜像来实现持续集成、持续交付、部署。开发人员可以通过 Dockerfile 来进行镜像构建，并结合 持续集成(Continuous Integration) 系统进行集成测试，而运维人员则可以直接在生产环境中快速部署该镜像，甚至结合 持续部<br>署(Continuous Delivery&#x2F;Deployment) 系统进行自动部署。而且使用 Dockerfile 使镜像构建透明化，不仅仅开发团队可以理解应用运行环境，也方便运维团队理解应用运行所需条件，帮助更好的生产环境中部署该镜像</p><h4 id="5、更轻松的迁移"><a href="#5、更轻松的迁移" class="headerlink" title="5、更轻松的迁移"></a>5、更轻松的迁移</h4><p>由于 Docker 确保了执行环境的一致性，使得应用的迁移更加容易。Docker 可以在很多平台上运行，无论是物理机、虚拟机、公有云、私有云，甚至是笔记本，其运行结果是一致的。因此用户可以很轻易的将在一个平台上运行的应用，迁移到另一个平台上，而不用担心运行环境的变化导致应用无法正常运行的情况</p><h2 id="Docker的应用场景"><a href="#Docker的应用场景" class="headerlink" title="Docker的应用场景"></a>Docker的应用场景</h2><p>Web 应用的自动化打包和发布。</p><p>自动化测试和持续集成、发布。</p><p>在服务型环境中部署和调整数据库或其他的后台应用。</p><p>从头编译或者扩展现有的 OpenShi 或 Cloud Foundry 平台来搭建自己的 PaaS 环境。</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IaaS:（Infrastructure-as-a-Service）(基础设施即服务)</span><br><span class="line">PaaS:（Platform as a Service）(平台即服务)</span><br><span class="line">SaaS:（Software-as-a-Service）(软件即服务)</span><br></pre></td></tr></table></figure><h2 id="Docker和虚拟机总结"><a href="#Docker和虚拟机总结" class="headerlink" title="Docker和虚拟机总结"></a>Docker和虚拟机总结</h2><p><img src="/posts/deffaa61/image2.jpg" alt="docker和虚拟机"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">名词解释：</span><br><span class="line">infrastructure （基础服务）硬件 Host OS 主机操作系统</span><br><span class="line">VM 虚拟机 Hypervisor 虚拟层程序</span><br></pre></td></tr></table></figure><ol><li><strong>实现原理技术不同</strong> 虚拟机是用来进行硬件资源划分的完美解决方案，利用的是硬件虚拟化技术，如此VT-x 、AMD-V会通 过一个 hypervisor 层来实现对资源的彻底隔离。 而容器则是操作系统级别的虚拟化，利用的是内核的 Cgroup 和 Namespace 特性，此功能通过软件 来实现，仅仅是进程本身就可以实现互相隔离，不需要任何辅助。</li><li><strong>使用资源方面不同</strong> Docker 容器与主机共享操作系统内核，不同的容器之间可以共享部分系统资源，因此更加轻量级， 消耗的资源更少。 虚拟机会独占分配给自己的资源，不存在资源共享，各个虚拟机之间近乎完全隔离，更加重量级，也 会消耗更多的资源。</li><li><strong>应用场景不同</strong> 若需要资源的完全隔离并且不考虑资源的消耗，可以使用虚拟机。 若是想隔离进程并且需要运行大量进程实例，应该选择 Docker 容器。</li></ol><p><img src="/posts/deffaa61/image3.jpg" alt="容器和虚拟机"></p><h2 id="Docker总结"><a href="#Docker总结" class="headerlink" title="Docker总结"></a>Docker总结</h2><ul><li>Docker是世界领先的软件容器平台。</li><li>Docker使用Google公司推出的Go语言进行开发实现，基于Linux内核的cgroup，namespace，以及AUFS类的<em>UnionFS</em>等技术，对进程进行封装隔离，属于操作系统层面的虚拟化技术。由于隔离的进程独立于宿主和其它的隔离的进程，因此也称其为容器。Docke最初实现是基于LXC。</li><li>Docker能够自动执行重复性任务，例如搭建和配置开发环境，从而解放了开发人员以便他们专注在真正重要的事情上：<strong>构建杰出的软件</strong>。</li><li>用户可以方便地<strong>创建和使用容器</strong>，把自己的应用放入容器。容器还可以进行版本管理、复制、分享、修改，就像管理普通的代码一样。</li><li>Docker的镜像提供了除内核外完整的运行时环境，确保了应用运行环境一致性，从而不会再出现“这段代码在我机器上没问题啊”这类问题；——<strong>一致的运行环境</strong></li><li>可以做到秒级、甚至毫秒级的启动时间。大大的节约了开发、测试、部署的时间。——<strong>更快速的启动时间</strong></li><li>避免公用的服务器，资源会容易受到其他用户的影响。——<strong>隔离性</strong></li><li>善于处理集中爆发的服务器使用压力；——<strong>弹性伸缩，快速扩展</strong></li><li>可以很轻易的将在一个平台上运行的应用，迁移到另一个平台上，而不用担心运行环境的变化导致应用无法正常运行的情况。——<strong>迁移方便</strong></li><li>使用Docker可以通过定制应用镜像来实现持续集成、持续交付、部署。——<strong>持续交付和部署</strong></li></ul><h1 id="二、-Docker架构"><a href="#二、-Docker架构" class="headerlink" title="二、 Docker架构"></a>二、 Docker架构</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Docker 使用客户端-服务器 (C&#x2F;S) 架构模式，使用远程API来管理和创建Docker容器。</p><p>Docker 容器通过 Docker 镜像来创建。</p><p>容器与镜像的关系类似于面向对象编程中的对象与类。</p><h2 id="Docker-基本概念"><a href="#Docker-基本概念" class="headerlink" title="Docker 基本概念"></a>Docker 基本概念</h2><p>Docker 包括三个基本概念</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">镜像（Image）</span><br><span class="line">容器（Container）</span><br><span class="line">仓库（Repository）</span><br></pre></td></tr></table></figure><p>理解了这三个概念，就理解了 Docker 的整个生命周期。</p><h2 id="Docker-引擎"><a href="#Docker-引擎" class="headerlink" title="Docker 引擎"></a>Docker 引擎</h2><p><img src="/posts/deffaa61/image4.jpg" alt="docker引擎"></p><p>Docker 使用客户端-服务器 (C&#x2F;S) 架构模式，使用远程API来管理和创建Docker容器。</p><p>Docker 容器通过 Docker 镜像来创建。</p><h2 id="Docker-架构"><a href="#Docker-架构" class="headerlink" title="Docker 架构"></a>Docker 架构</h2><p>容器与镜像的关系类似于面向对象编程中的对象与类</p><table><thead><tr><th>Docker</th><th>面向对象</th></tr></thead><tbody><tr><td>容器</td><td>对象</td></tr><tr><td>镜像</td><td>类</td></tr></tbody></table><p><img src="/posts/deffaa61/image5.png" alt="docker架构"></p><table><thead><tr><th>Docker 镜像(Images)</th><th>Docker 镜像是用于创建 Docker 容器的模板。</th></tr></thead><tbody><tr><td>Docker 容器(Container)</td><td>容器是独立运行的一个或一组应用。</td></tr><tr><td>Docker 客户端(Client)</td><td>Docker 客户端通过命令行或者其他工具使用 Docker API 与 Docker 的守护进程通信。</td></tr><tr><td>Docker 主机(Host)</td><td>一个物理或者虚拟的机器用于执行 Docker 守护进程和容器。</td></tr><tr><td>Docker 仓库(Registry)</td><td>Docker 仓库用来保存镜像，可以理解为代码控制中的代码仓库。Docker Hub提供了庞大的镜像集合供使用。</td></tr><tr><td>Docker Machine</td><td>Docker Machine是一个简化Docker安装的命令行工具，通过一个简单的命令行即可在相应的平台上安装Docker，比如VirtualBox、 Digital Ocean、Microso Azure。</td></tr></tbody></table><h3 id="Docker-镜像"><a href="#Docker-镜像" class="headerlink" title="Docker 镜像"></a>Docker 镜像</h3><p>是一个存入镜像的仓库。通常被部署在互联网服务器或者云端</p><p><a target="_blank" rel="noopener" href="https://hub.docker.com/">Docker Hub</a>(<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com</a>) 提供了庞大的镜像集合供使用。</p><p>Docker 镜像是一个特殊的文件系统，除了提供容器运行时所需的程序、库、资源、配置等文件外，还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。镜像不包含任何动态数据，其内容在构建之后也不会被改变。</p><h4 id="分层存储"><a href="#分层存储" class="headerlink" title="分层存储"></a>分层存储</h4><p>因为镜像包含操作系统完整的 <code>root</code> 文件系统，其体积往往是庞大的，因此在 Docker 设计时，就充分利用 <code>UnionFS</code> 的技术，将其设计为分层存储的架构。所以严格来说，镜像并非是像一个 ISO 那样的打包文件，镜像只是一个虚拟的概念，其实际体现并非由一个文件组成，而是由一组文件系统组成，或者说，由多层文件系统联合组成。</p><p>镜像构建时，会一层层构建，前一层是后一层的基础。每一层构建完就不会再发生改变，后一层上的任何改变只发生在自己这一层。比如，删除前一层文件的操作，实际不是真的删除前一层的文件，而是仅在当前层标记为该文件已删除。在最终容器运行的时候，虽然不会看到这个文件，但是实际上该文件会一直跟随镜像。因此，在构建镜像的时候，需要额外小心，每一层尽量只包含该层需要添加的东西，任何额外的东西应该在该层构建结束前清理掉。</p><p>分层存储的特征还使得镜像的复用、定制变的更为容易。甚至可以用之前构建好的镜像作为基础层，然后进一步添加新的层，以定制自己所需的内容，构建新的镜像</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jdk</span><br><span class="line">linux</span><br><span class="line">docker</span><br></pre></td></tr></table></figure><h3 id="Docker-容器"><a href="#Docker-容器" class="headerlink" title="Docker 容器"></a>Docker 容器</h3><p><em><strong>容器与镜像的关系类似于面向对象编程中的对象与类</strong></em></p><table><thead><tr><th>Docker</th><th>面向对象</th></tr></thead><tbody><tr><td>容器</td><td>对象</td></tr><tr><td>镜像</td><td>类</td></tr></tbody></table><p>镜像（<code>Image</code>）和容器（<code>Container</code>）的关系，就像是面向对象程序设计中的 <code>类</code> 和 <code>实例</code> 一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。</p><p>容器的实质是进程，但与直接在宿主执行的进程不同，容器进程运行于属于自己的独立的 <strong>命名空间</strong>。因此容器可以拥有自己的 <code>root</code> 文件系统、自己的网络配置、自己的进程空间，甚至自己的用户 ID 空间。容器内的进程是运行在一个隔离的环境里，使用起来，就好像是在一个独立于宿主的系统下操作一样。这种特性使得容器封装的应用比直接在宿主运行更加安全。也因为这种隔离的特性，很多人初学 Docker 时常常会混淆容器和虚拟机。</p><p>前面讲过镜像使用的是分层存储，容器也是如此。每一个容器运行时，是以镜像为基础层，在其上创建一个当前容器的存储层，我们可以称这个为容器运行时读写而准备的存储层为<strong>容器存储层</strong>。</p><p>容器存储层的生存周期和容器一样，容器消亡时，容器存储层也随之消亡。因此，任何保存于容器存储层的信息都会随容器删除而丢失。</p><p>按照 Docker 最佳实践的要求，容器不应该向其存储层内写入任何数据，容器存储层要保持无状态化。所有的文件写入操作，都应该使用 <code>数据卷（Volume）</code>、或者绑定宿主目录，在这些位置的读写会跳过容器存储层，直接对宿主（或网络存储）发生读写，其性能和稳定性更高。</p><p>数据卷的生存周期独立于容器，容器消亡，数据卷不会消亡。因此，使用数据卷后，容器删除或者重新运行之后，数据却不会丢失</p><h1 id="三、Docker-仓库"><a href="#三、Docker-仓库" class="headerlink" title="三、Docker 仓库"></a>三、Docker 仓库</h1><p>Docker 仓库用来保存镜像，可以理解为代码控制中的代码仓库。</p><p>Docker Hub(<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com</a>) 提供了庞大的镜像集合供使用。</p><h2 id="公有-Docker-Registry"><a href="#公有-Docker-Registry" class="headerlink" title="公有 Docker Registry"></a>公有 Docker Registry</h2><p>Docker Registry 公开服务是开放给用户使用、允许用户管理镜像的 Registry 服务。一般这类公开服务允许用户免费上传、下载公开的镜像，并可能提供收费服务供用户管理私有镜像。</p><p>最常使用的 Registry 公开服务是官方的 <code>Docker Hub</code>，这也是默认的 Registry，并拥有大量的高质量的官方镜像。除此以外，还有 <code>CoreOS</code> 的 <code>Quay.io</code>，CoreOS 相关的镜像存储在这里；Google 的 <code>Google Container Registry</code>，<code>Kubernetes</code> 的镜像使用的就是这个服务。</p><p>由于某些原因，在国内访问这些服务可能会比较慢。国内的一些云服务商提供了针对 Docker Hub 的镜像服务（<code>Registry Mirror</code>），这些镜像服务被称为加速器。常见的有 <strong>阿里云加速器</strong>、<strong>DaoCloud 加速器</strong> 等。使用加速器会直接从国内的地址下载 Docker Hub 的镜像，比直接从 Docker Hub 下载速度会提高很多。</p><p>国内也有一些云服务商提供类似于 Docker Hub 的公开服务。比如 <em><strong>时速云镜像仓库</strong></em>、<em><strong>网易云镜像服务</strong></em>、<em><strong>DaoCloud 镜像市场</strong></em>、<em><strong>阿里云镜像库</strong></em> 等。</p><h2 id="私有-Docker-Registry"><a href="#私有-Docker-Registry" class="headerlink" title="私有 Docker Registry"></a>私有 Docker Registry</h2><p>除了使用公开服务外，用户还可以在本地搭建私有 Docker Registry。Docker 官方提供了 <code>Docker Registry</code> 镜像，可以直接使用做为私有 Registry 服务。</p><p>开源的 Docker Registry 镜像只提供了 <code>Docker Registry API</code> 的服务端实现，足以支持 <code>docker</code> 命令，不影响使用。但不包含图形界面，以及镜像维护、用户管理、访问控制等高级功能。在官方的商业化版本 <code>Docker Trusted Registry</code>中，提供了这些高级功能。</p><p>除了官方的 Docker Registry 外，还有第三方软件实现了 Docker Registry API，甚至提供了用户界面以及一些高级功能。比如，<code>VMWare Harbor</code> 和 <code>Sonatype Nexus</code>。</p><h1 id="四、Docker安装"><a href="#四、Docker安装" class="headerlink" title="四、Docker安装"></a>四、Docker安装</h1><h4 id="官方提供的安装教程"><a href="#官方提供的安装教程" class="headerlink" title="官方提供的安装教程"></a>官方提供的安装教程</h4><p><a target="_blank" rel="noopener" href="https://docs.docker.com/install/linux/docker-ce/centos/#install-using-the-repository">https://docs.docker.com/install/linux/docker-ce/centos/#install-using-the-repository</a></p><h2 id="CentOS安装要求"><a href="#CentOS安装要求" class="headerlink" title="CentOS安装要求"></a>CentOS安装要求</h2><p>Docker支持以下的CentOS版本：</p><p>· CentOS 7 (64-bit)</p><p>· CentOS 6.5 (64-bit) 或更高的版本</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>目前，CentOS 仅发行版本中的内核支持 Docker。Docker 运行在 CentOS 7 上，要求系统为 64 位、系统内核版本为 3.10以上。Docker 运行在 CentOS-6.5 或更高的版本的 CentOS 上，要求系统为 64 位、系统内核版本为 2.6.32-431 或者更高版本。</p><h4 id="1-校验版本"><a href="#1-校验版本" class="headerlink" title="1 校验版本"></a>1 校验版本</h4><blockquote><p>命令：uname -r 校验Linux内核版本（3.10以上版本）</p></blockquote><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">从 2017 年 3 月开始 docker 在原来的基础上分为两个分支版本: Docker CE 和 Docker EE。</span><br><span class="line">Docker CE 即社区免费版，Docker EE 即企业版，强调安全，但需付费使用。</span><br><span class="line">本文介绍 Docker CE 的安装使用。</span><br></pre></td></tr></table></figure><h4 id="2-移除旧的版本"><a href="#2-移除旧的版本" class="headerlink" title="2 移除旧的版本"></a>2 移除旧的版本</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo yum remove docker \</span><br><span class="line">docker-client \</span><br><span class="line">docker-client-latest \</span><br><span class="line">docker-common \</span><br><span class="line">docker-latest \</span><br><span class="line">docker-latest-logrotate \</span><br><span class="line">docker-logrotate \</span><br><span class="line">docker-selinux \</span><br><span class="line">docker-engine-selinux \</span><br><span class="line">docker-engine</span><br></pre></td></tr></table></figure><h4 id="3-安装一些必要的系统工具"><a href="#3-安装一些必要的系统工具" class="headerlink" title="3 安装一些必要的系统工具"></a>3 安装一些必要的系统工具</h4><blockquote><p>如果<code>yum</code>报告未安装这些软件包，则可以。</p></blockquote><blockquote><p>安装所需的软件包。<code>yum-utils</code>提供了 <code>yum-config-manager</code> 应用，并<code>device-mapper-persistent-data</code>和<code>lvm2</code>由需要 <code>devicemapper</code> 存储驱动程序。</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm</span><br></pre></td></tr></table></figure><h4 id="4-添加软件源信息"><a href="#4-添加软件源信息" class="headerlink" title="4 添加软件源信息"></a>4 添加软件源信息</h4><ul><li><p>源 1 ：（官方推荐）</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure></li><li><p>源 2 ：（阿里云源）</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum-config-manager --add-repo &lt;http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo&gt;</span><br></pre></td></tr></table></figure></li></ul><h4 id="5-更新-yum-缓存"><a href="#5-更新-yum-缓存" class="headerlink" title="5 更新 yum 缓存"></a>5 更新 yum 缓存</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum makecache fast</span><br></pre></td></tr></table></figure><h4 id="6-安装-Docker-CE"><a href="#6-安装-Docker-CE" class="headerlink" title="6 安装 Docker-CE"></a>6 安装 Docker-CE</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install docker-ce</span><br></pre></td></tr></table></figure><h4 id="7-启动-Docker-后台服务"><a href="#7-启动-Docker-后台服务" class="headerlink" title="7 启动 Docker 后台服务"></a>7 启动 Docker 后台服务</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure><h4 id="8-重启-Docker服务"><a href="#8-重启-Docker服务" class="headerlink" title="8 重启 Docker服务"></a>8 重启 Docker服务</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><h4 id="9-安装成功后可通过查看"><a href="#9-安装成功后可通过查看" class="headerlink" title="9 安装成功后可通过查看"></a>9 安装成功后可通过查看</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker version</span><br></pre></td></tr></table></figure><h4 id="10-测试"><a href="#10-测试" class="headerlink" title="10 测试"></a>10 测试</h4><p>通过运行hello-world 映像来验证是否正确安装了Docker Engine-Community</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure><h2 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h2><p>执行以下命令来删除 Docker CE：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yum remove docker-ce</span><br><span class="line">sudo <span class="built_in">rm</span> -rf /var/lib/docker</span><br></pre></td></tr></table></figure><h1 id="五、Docker-镜像加速器"><a href="#五、Docker-镜像加速器" class="headerlink" title="五、Docker 镜像加速器"></a>五、Docker 镜像加速器</h1><p>鉴于国内网络问题，后续拉取 Docker 镜像十分缓慢，我们可以需要配置加速器来解决</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用Docker 的时候，需要经常从官方获取镜像，但是由于显而易见的网络原因，拉取镜像的过程非常耗时，严重 影响使用 Docker 的体验。因此 DaoCloud 推出了加速器工具解决这个难题，通过智能路由和缓存机制，极大提 升了国内网络访问 Docker Hub 的速度，目前已经拥有了广泛的用户群体，并得到了 Docker 官方的大力推荐。 如果您是在国内的网络环境使用 Docker，那么 Docker 加速器一定能帮助到您。</span><br></pre></td></tr></table></figure><p>Docker 官方和国内很多云服务商都提供了国内加速器服务，例如：</p><ul><li>Docker 官方提供的中国 registry mirror</li><li>阿里云加速器</li><li>DaoCloud 加速器</li></ul><h2 id="Docker官方加速器"><a href="#Docker官方加速器" class="headerlink" title="Docker官方加速器"></a>Docker官方加速器</h2><p>我们以 Docker 官方加速器进行介绍</p><p><a target="_blank" rel="noopener" href="https://docs.docker.com/registry/recipes/mirror/#use-case-the-china-registry-mirror">https://docs.docker.com/registry/recipes/mirror/#use-case-the-china-registry-mirror</a></p><p>通过命令查看：在 <code>/etc/docker/daemon.json</code> 中写入如下内容（如果文件不存在请新建该文件）</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;https://registry.docker-cn.com&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意，一定要保证该文件符合 json 规范，否则 Docker 将不能启动</p></blockquote><p><strong>重启Docker:</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="阿里云加速器"><a href="#阿里云加速器" class="headerlink" title="阿里云加速器"></a>阿里云加速器</h2><p>阿里云的镜像源有个加速器，可以加速你获取容器的速度。这个加速器地址是每个人专属的。 网址: <a target="_blank" rel="noopener" href="https://dev.aliyun.com/">https://dev.aliyun.com/</a></p><ol><li><p>登录阿里云个人帐号</p></li><li><p>管理中心–容器镜像服务–镜像加速器</p><p><img src="/posts/deffaa61/image6.jpg" alt="aliyun"></p><p><a target="_blank" rel="noopener" href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> -p /etc/docker</span><br><span class="line">sudo <span class="built_in">tee</span> /etc/docker/daemon.json &lt;&lt;-<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://gxeo3yz7.mirror.aliyuncs.com&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure></li></ol><h2 id="检查加速器是否生效"><a href="#检查加速器是否生效" class="headerlink" title="检查加速器是否生效"></a>检查加速器是否生效</h2><p>配置加速器之后，如果拉取镜像仍然十分缓慢，请手动检查加速器配置是否生效</p><p>在命令行执行 <code>docker info</code>，查看镜像地址是否匹配，如匹配，说明配置成功</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker info</span><br></pre></td></tr></table></figure><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ol><li><p>尝试从docker库中下载镜像：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull tomcat</span><br></pre></td></tr></table></figure><p>通过观察，下载速度明显提升。</p></li><li><p>查看docker下载的镜像内容：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure></li><li><p>下载指定的镜像版本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images tomcat:9-jre</span><br></pre></td></tr></table></figure></li><li><p>启动tomcat:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run –p 8080:8080 tomcat</span><br></pre></td></tr></table></figure></li></ol><h1 id="六、Docker镜像"><a href="#六、Docker镜像" class="headerlink" title="六、Docker镜像"></a>六、Docker镜像</h1><p>镜像是Docker的三大组件之一。</p><p>Docker运行容器前需要本地存在对应的镜像，如果本地不存，Docker会从镜像仓库下载。</p><p><strong>本节将介绍更多关于镜像的内容，包括：</strong></p><ul><li>从仓库获取镜像；</li><li>管理本地主机上的镜像</li><li>介绍镜像实现的基本原理</li></ul><p><strong>Docker命令使用</strong></p><blockquote><p>获取命令行帮助信息直接在命令行内输入docker 命令后敲回车</p></blockquote><h2 id="Docker-获取镜像"><a href="#Docker-获取镜像" class="headerlink" title="Docker 获取镜像"></a>Docker 获取镜像</h2><p>之前提到过，Docker Hub 上有大量的高质量的镜像可以用，这里我们就说一下怎么获取这些镜像。</p><h3 id="查找镜像"><a href="#查找镜像" class="headerlink" title="查找镜像"></a>查找镜像</h3><p>我们可以从 Docker Hub 网站来搜索镜像，Docker Hub 网址为： <a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a></p><p>我们也可以使用 docker search 命令来搜索镜像。比如我们需要一个tomcat的镜像来作为我们的web服务。我们可以通过 <code>docker search</code> 命令搜索tomcat来寻找适合我们的镜像。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@guoweixin ~]<span class="comment"># docker search --help</span></span><br><span class="line">Usage: docker search [OPTIONS] TERM</span><br><span class="line">Search the Docker Hub <span class="keyword">for</span> images</span><br><span class="line">Options:</span><br><span class="line">-f, --filter filter Filter output based on conditions provided</span><br><span class="line">根据提供的条件过滤器输出</span><br><span class="line">--format string Pretty-<span class="built_in">print</span> search using a Go template</span><br><span class="line">用Go模板打印出漂亮的搜索结果</span><br><span class="line">--<span class="built_in">limit</span> int Max number of search results (default 25)</span><br><span class="line">搜索结果的最大数量（默认值为 25 ）</span><br><span class="line">--no-trunc Don<span class="string">&#x27;t truncate output</span></span><br><span class="line"><span class="string">不要截断输出</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search tomcat</span><br></pre></td></tr></table></figure><h3 id="获取镜像"><a href="#获取镜像" class="headerlink" title="获取镜像"></a>获取镜像</h3><p>从 Docker 镜像仓库获取镜像的命令是 <code>docker pull</code> 其命令格式为：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull [选项] [Docker Registey 地址[:端口号]/] 仓库名[:标签]</span><br></pre></td></tr></table></figure><p>具体的选项可以通过 <code>docker pull --help</code> 命令看到，这里我们说一下镜像名称的格式。</p><ul><li>Docker 镜像仓库地址： 地址的格式一般是 &lt;域名&#x2F;IP&gt;[:端口号]。默认地址是 Docker Hub。</li><li>仓库名：这里的仓库名是两段式名称， 即 &lt;用户名&gt;&#x2F;&lt;软件名&gt;。对于 Docker Hub，如果不给出用户名，则默认为 library，也就是官方镜像。</li></ul><p>我们需要一个tomcat的镜像来作为我们的web服务。通过 docker pull获取镜像</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull tomcat:版本号 //不写 ：版本号 代表laster版本</span><br></pre></td></tr></table></figure><p><img src="/posts/deffaa61/image7.jpg" alt="docker image"></p><p>如上图所示。从下载过程中可以看到我们之前提及的分层存储的概念，镜像是由多层存储所构成。下载也是一层层的去下载，并非单一文件。下载过程中给出了每一层的 ID 的前 12 位。并且下载结束后，给出该镜像完整的 sha256 的摘要，以确保下载一致性。在使用上面命令的时候，你可能会发现，你所看到的层 ID 以及 sha256 的摘要和这里的不一样。这是因为官方镜像是一直在维护的，有任何新的 bug，或者版本更新，都会进行修复再以原来的标签发布，这样可以确保任何使用这个标签的用户可以获得更安全、更稳定的镜像。</p><h2 id="Docker-列出镜像"><a href="#Docker-列出镜像" class="headerlink" title="Docker 列出镜像"></a>Docker 列出镜像</h2><p>要想列出已经下载下来的镜像，可以使用 <code>docker image ls</code> 命令。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images // docker image <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p><img src="/posts/deffaa61/image8.jpg" alt="image list"></p><p>列表包含了 <strong>仓库名、标签、镜像 ID、创建时间 以及 所占用的空间</strong>。 其中仓库名、标签在之前的基础概念已经介绍过了。<strong>镜像 ID 则是镜像的唯一标识</strong>，一个镜像可以对应多个标签。因此，如果拥有相同的 ID，因为它们对应的是同一个镜像</p><blockquote><p><strong>镜像体积</strong> 如果仔细观察，会注意到，这里标识的所占用空间和在 Docker Hub 上看到的镜像大小不同。这是因为 Docker Hub 中显示的体积是压缩后的体积。在镜像下载和上传过程中镜像是保持着压缩状态的，因此 Docker Hub 所显示的大小是网络传输中更关心的流量大小。而 docker image ls 显示的是镜像下载到本地后，展开的大小，准确说，是展开后的各层所占空间的总和，因为镜像到本地后，查看空间的时候，更关心的是本地磁盘空间占用的大小。 另外一个需要注意的问题是，docker image ls 列表中的镜像体积总和并非是所有镜像实际硬盘消耗。由于 Docker 镜像是多层存储结构，并且可以继承、复用，因此不同镜像可能会因为使用相同的基础镜像，从而拥有共同的层。由于 Docker 使用 Union FS，相同的层只需要保存一份即可，因此实际镜像硬盘占用空间很可能要比这个列表镜像大小的总和要小的多。</p></blockquote><h3 id="虚悬镜像"><a href="#虚悬镜像" class="headerlink" title="虚悬镜像"></a>虚悬镜像</h3><p>镜像列表中，还可以看到一个特殊的镜像，这个镜像既没有仓库名，也没有标签，均为</p><blockquote><p>这个镜像原本是有镜像名和标签的，原来为 tomcat:8.0，随着官方镜像维护，发布了新版本后，重新 docker pull tomcat:8.0 时，tomcat:8.0 这个镜像名被转移到了新下载的镜像身上，而旧的镜像上的这个名称则被取消，从而成为了 。除了 docker pull 可能导致这种情况，docker build 也同样可以导致这种现象。由于新旧镜像同名，旧镜像名称被取消，从而出现仓库名、标签均为 的镜像。这类无标签镜像也被称为 虚悬镜像(dangling image) 。 一般来说，虚悬镜像已经失去了存在的价值，是可以随意删除的，可以用下面的命令删除：</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image prune</span><br></pre></td></tr></table></figure><h2 id="Docker-删除本地镜像"><a href="#Docker-删除本地镜像" class="headerlink" title="Docker 删除本地镜像"></a>Docker 删除本地镜像</h2><p><strong>语法</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image <span class="built_in">rm</span> [选项] &lt;镜像1&gt; [&lt;镜像2&gt;.....]</span><br></pre></td></tr></table></figure><blockquote><p>用 ID、镜像名、摘要删除镜像 其中，&lt;镜像&gt; 可以是 镜像短 ID、镜像长 ID、镜像名 或者 镜像摘要</p></blockquote><p>如果要删除本地的镜像，可以使用 <code>docker image rmi / rm</code> 命令</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image rmi 镜像ID //常用</span><br></pre></td></tr></table></figure><blockquote><p>要删除镜像必须确认此镜像目前没有被任何容器使用</p></blockquote><h2 id="Docker其它辅助命令"><a href="#Docker其它辅助命令" class="headerlink" title="Docker其它辅助命令"></a>Docker其它辅助命令</h2><p>查看本地镜像的 IMAGE ID</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images -q</span><br></pre></td></tr></table></figure><p>查看一个镜像的制作历程</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">history</span> 镜像名称</span><br></pre></td></tr></table></figure><h2 id="Docker保存镜像"><a href="#Docker保存镜像" class="headerlink" title="Docker保存镜像"></a>Docker保存镜像</h2><p>备份本地仓库的镜像</p><ol><li><p>用 save 子命令将本地仓库的镜像保存当前目录下</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker save -o tomcat.guo.tar 镜像名称</span><br></pre></td></tr></table></figure></li><li><p>将本地目录下的镜像备份文件导入到本地 Docker 仓库</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方式一（不输出详细信息）</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker load -i tomcat.guo.tar</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方式二（输出详细信息）</span></span><br><span class="line">[root@localhost ~]<span class="comment"># docker load &lt; tomcat.guo.tar</span></span><br></pre></td></tr></table></figure><p><img src="/posts/deffaa61/image9.jpg" alt="保存镜像"></p></li></ol><h1 id="七、Docker-容器"><a href="#七、Docker-容器" class="headerlink" title="七、Docker 容器"></a>七、Docker 容器</h1><p><strong>容器是 Docker核心概念。</strong></p><blockquote><p>简单的说，容器是独立运行的一个或一组应用，以及它们的运行环境。<br>对应的，虚拟机可以理解为模拟运行的一整套操作系统（提供了运行态环境和其他系统环境）和运行在上面的应用。</p></blockquote><p><strong>容器与镜像的关系类似于面向对象编程中的对象与类</strong></p><table><thead><tr><th>Docker</th><th>面向对象</th></tr></thead><tbody><tr><td>容器</td><td>对象</td></tr><tr><td>镜像</td><td>类</td></tr></tbody></table><p>如下将具体介绍如何来管理一个容器，包括创建、启动和停止等</p><h2 id="1-查看容器状态"><a href="#1-查看容器状态" class="headerlink" title="1 查看容器状态"></a>1 查看容器状态</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker ps //查看运行的容器</span><br><span class="line">docker ps –a //查看所有的容器（包含运行和退出）</span><br><span class="line">docker container <span class="built_in">ls</span></span><br><span class="line">docker container <span class="built_in">ls</span>–a</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-Docker-启动容器"><a href="#2-Docker-启动容器" class="headerlink" title="2 Docker 启动容器"></a>2 Docker 启动容器</h2><p>启动容器有二种方式，一种是基于镜像新建一个容器并启动，一种是将在终止状态（stopped）的容器重新启动</p><p><em><strong>docker run 参数 镜像名称:tag 执行的命令</strong></em> 常用参数:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-i 保持和 docker 容器内的交互，启动容器时，运行的命令结束后，容器依然存活，没有退出（默认是会退出，即停止的）</span><br><span class="line">-t 为容器的标准输入虚拟一个<span class="built_in">tty</span></span><br><span class="line">-d 后台运行容器</span><br><span class="line">--<span class="built_in">rm</span> 容器在启动后，执行完成命令或程序后就销毁</span><br><span class="line">--name 给容器起一个自定义名称</span><br><span class="line">-p 宿主机：内部端口</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> -d --name tomcat1 -p 8080:8080 tomcat</span><br></pre></td></tr></table></figure><h3 id="练习-1"><a href="#练习-1" class="headerlink" title="练习 1"></a>练习 1</h3><p>运行一个tomcat镜像容器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -i-t --name tomcat1 tomcat</span><br></pre></td></tr></table></figure><h2 id="3-查看正在运行的容器"><a href="#3-查看正在运行的容器" class="headerlink" title="3 查看正在运行的容器"></a>3 查看正在运行的容器</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><blockquote><p>CONTAINER ID 容器ID IMAGE 容器依赖的镜像 COMMAND 启动容器时执行的命令或程序 CREATED 容器启动时到现在的相隔时间 STATUS 容器状态 PORTS 宿主机到容器的端口映射<br>注意: 当运行一个容器的时候，没有用参数–name去指定容器名时，Docker会从自己的名称库中随机给这个容器起一个名字</p></blockquote><h2 id="4-查看所有容器"><a href="#4-查看所有容器" class="headerlink" title="4 查看所有容器"></a>4 查看所有容器</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure><h2 id="5-停止容器"><a href="#5-停止容器" class="headerlink" title="5 停止容器"></a>5 停止容器</h2><blockquote><p>通过docker ps 找到容器id</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker stop 9be696a0c283 //停止正在运行容器（或Ctrl+c）</span><br><span class="line">docker container stop tomcat1//停止正运行容器(ID或Names)</span><br></pre></td></tr></table></figure><h2 id="6-启动已终止容器"><a href="#6-启动已终止容器" class="headerlink" title="6 启动已终止容器"></a>6 启动已终止容器</h2><blockquote><p>通过docker ps 找到容器id</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器名/容器 ID</span><br></pre></td></tr></table></figure><h2 id="7-重启已关闭容器"><a href="#7-重启已关闭容器" class="headerlink" title="7 重启已关闭容器"></a>7 重启已关闭容器</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart 9be696a0c283//启动容器（根据ID或NAMES）</span><br></pre></td></tr></table></figure><h2 id="8-关闭和删除容器"><a href="#8-关闭和删除容器" class="headerlink" title="8 关闭和删除容器"></a>8 关闭和删除容器</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">rm</span> 容器ID</span><br></pre></td></tr></table></figure><h3 id="练习-2"><a href="#练习-2" class="headerlink" title="练习 2"></a>练习 2</h3><p>docker方式完整的启动tomcat服务器</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> -d --name tomcat1 -p 8080:8080 tomcat</span><br></pre></td></tr></table></figure><p>在浏览器上访问 <a target="_blank" rel="noopener" href="http://10.12.19.13:8080/">http://10.12.19.13:8080</a></p><h2 id="9-Docker-守护态运行"><a href="#9-Docker-守护态运行" class="headerlink" title="9 Docker 守护态运行"></a>9 Docker 守护态运行</h2><blockquote><p>更多的时候，需要让 Docker 在后台运行而不是直接把执行命令的结果输出在当前宿主机下。此时，可以通过添加 -d 参数来实现<br>如果不使用 -d 参数运行容器:将会在当前宿主机运行。</p></blockquote><p>如果使用了 -d 参数运行容器。此时容器会在后台运行并不会把输出的结果 (STDOUT) 打印到宿主机上面(输出结果可<br>以用 docker logs查看)。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">查看控制台结果：</span><br><span class="line">docker logs tomcat1//(ID或Names)</span><br></pre></td></tr></table></figure><h2 id="10-Docker-进入容器"><a href="#10-Docker-进入容器" class="headerlink" title="10 Docker 进入容器"></a>10 Docker 进入容器</h2><p>某些时候需要进入容器进行操作，使用 <code>docker exec</code> 命令</p><blockquote><p>-i -t 参数 docker exec 后边可以跟多个参数，这里主要说明 -i -t 参数。 只用 -i 参数时，由于没有分配伪终端，界面没有我们熟悉的 Linux 命令提示符，但命令执行结果仍然可以返回。 当 -i -t 参数一起使用时，则可以看到我们熟悉的 Linux 命令提示符。</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it 容器ID（Names）bash</span><br></pre></td></tr></table></figure><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>进入容器，对默认的tomcat进行页面修改，然后再访问查看效果。</p><blockquote><p>注意默认容器内linux包是最小安装。只拥有最基本的命令<br>exit，不会导致容器的停止</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it tomcat1 bash //进入容器名称叫tomcat</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;xuxiaomo-nginx-weixin&#x27;</span>&gt;&gt;index.jsp //对容器内的index.jsp进行字符串追加</span><br></pre></td></tr></table></figure><h2 id="11-在宿主机和容器之间交换文件"><a href="#11-在宿主机和容器之间交换文件" class="headerlink" title="11 在宿主机和容器之间交换文件"></a>11 在宿主机和容器之间交换文件</h2><p>在宿主机和容器之间相互COPY文件 cp的用法如下</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">cp</span> [OPTIONS] CONTAINER:PATH LOCALPATH //容器中 复制到 宿主机</span><br><span class="line">docker <span class="built_in">cp</span> [OPTIONS] LOCALPATH|- CONTAINER:PATH //宿主机 复制到 容器中</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">宿主机复制一个图片到容器中：将png图片复制到了容器指定目录下</span><br><span class="line">docker <span class="built_in">cp</span> guoweixin.png tomcat2:/usr/local/tomcat/webapps/ROOT</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">将容器内的index.jsp 复制出来，修改再复制回去</span><br><span class="line">docker <span class="built_in">cp</span> tomcat2:/usr/local/tomcat/webapps/ROOT/index.jsp /root</span><br></pre></td></tr></table></figure><h1 id="八、Docker-查看日志"><a href="#八、Docker-查看日志" class="headerlink" title="八、Docker 查看日志"></a>八、Docker 查看日志</h1><p>Docker查看日志</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs 容器名称/ID</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f -t --since=<span class="string">&quot;2018-12-1&quot;</span> --<span class="built_in">tail</span>=10 qfjy_exam</span><br></pre></td></tr></table></figure><blockquote><p>–since : 此参数指定了输出日志开始日期，即只输出指定日期之后的日志。<br>-f : 查看实时日志<br>-t : 查看日志产生的日期<br>-tail&#x3D;10 : 查看最后的 10 条日志<br>qfjy_exam : 容器名称</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f --<span class="built_in">tail</span>=10 容器名称</span><br></pre></td></tr></table></figure><h1 id="九、案例"><a href="#九、案例" class="headerlink" title="九、案例"></a>九、案例</h1><p>根据前面学的知识点内容，将项目页面，用docker的方式部署到tomcat服务器上。</p><p>要求集群的方式部署 3 台。(8080&#x2F;8081&#x2F;8082)</p><h1 id="十、Docker-数据卷"><a href="#十、Docker-数据卷" class="headerlink" title="十、Docker 数据卷"></a>十、Docker 数据卷</h1><p>问题：通过镜像创建一个容器。容器一旦被销毁，则容器内的数据将一并被删除。但有些情况下，通过服务器上传的图片出会丢失。容器中的数据不是持久化状态的</p><blockquote><p>那有没有一种独立于容器、提供持久化并能服务于多个容器的东西呢？</p></blockquote><h2 id="什么是数据卷"><a href="#什么是数据卷" class="headerlink" title="什么是数据卷"></a>什么是数据卷</h2><p><strong>数据卷 ： 是一个可供一个或多个容器使用的特殊目录</strong></p><blockquote><p>特性<br>· 数据卷可以在容器之间共享和重用<br>· 对数据卷的修改会立马生效<br>· 对数据卷的更新，不会影响镜像<br>· 数据卷默认会一直存在，即使容器被删除</p></blockquote><p><img src="/posts/deffaa61/image10.jpg" alt="volume"></p><h2 id="为什么需要数据卷？"><a href="#为什么需要数据卷？" class="headerlink" title="为什么需要数据卷？"></a>为什么需要数据卷？</h2><blockquote><p>这得从 docker 容器的文件系统说起。出于效率等一系列原因，docker 容器的文件系统在宿主机上存在的方式很复杂，这会带来下面几个问题：<br>· 不能在宿主机上很方便地访问容器中的文件。<br>· 无法在多个容器之间共享数据。<br>· 当容器删除时，容器中产生的数据将丢失。</p></blockquote><p>为了解决这些问题，docker 引入了数据卷(volume) 机制。数据卷是存在于一个或多个容器中的特定文件或文件夹，这<br>个文件或文件夹以独立于 docker 文件系统的形式存在于宿主机中。</p><p>数据卷的最大特定是：其生存周期独立于容器的生存周期。</p><blockquote><p>使用数据卷的最佳场景<br>· 在多个容器之间共享数据，多个容器可以同时以只读或者读写的方式挂载同一个数据卷，从而共享数据卷中的数据<br>· 当宿主机不能保证一定存在某个目录或一些固定路径的文件时，使用数据卷可以规避这种限制带来的问题<br>· 当你想把容器中的数据存储在宿主机之外的地方时，比如远程主机上或云存储上<br>· 当你需要把容器数据在不同的宿主机之间备份、恢复或迁移时，数据卷是很好的选择</p></blockquote><h2 id="数据卷应用"><a href="#数据卷应用" class="headerlink" title="数据卷应用"></a>数据卷应用</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 创建数据卷</span></span><br><span class="line">docker volume create 数据卷名称</span><br><span class="line"><span class="comment"># 创建数据卷之后，默认会存放到目录： /var/lib/docker/volume/数据卷名称/_data目录下</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2 查看数据卷</span></span><br><span class="line">docker volume inspect 数据卷名称</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3 查看全部数据卷信息</span></span><br><span class="line">docker volume <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4 删除数据卷</span></span><br><span class="line">docker volume <span class="built_in">rm</span> 数据卷名称</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 5 应用数据卷</span></span><br><span class="line"><span class="comment"># 5.1 当你映射数据卷时，如果数据卷不存在，Docker会帮你自动创建</span></span><br><span class="line">docker run -v 数据卷名称:容器内路径 镜像ID</span><br><span class="line"><span class="comment"># 5.2 直接指定一个路径作为数据卷的存储位置</span></span><br><span class="line">docker run -v 路径:容器内部的路径 镜像ID</span><br></pre></td></tr></table></figure><h2 id="案例-1"><a href="#案例-1" class="headerlink" title="案例 1"></a>案例 1</h2><h4 id="数据卷方式"><a href="#数据卷方式" class="headerlink" title="数据卷方式"></a>数据卷方式</h4><p>创建数据卷，将项目案例放入数据卷中，启动Tomcat。来访问并进行查看(5.1)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker volume create vol_xuxiaomo-nginx <span class="comment">#创建数据卷</span></span><br><span class="line">docker run -it --name tomcat-8080 -d -p 8080:8080 -v vol_xuxiaomo-nginx:/usr/local/tomcat/webapps/ tomcat <span class="comment">#运行容器</span></span><br></pre></td></tr></table></figure><h4 id="路径方式"><a href="#路径方式" class="headerlink" title="路径方式"></a>路径方式</h4><p>将项目案例放入指定路径中，-v数据卷。启动Tomcat。来访问并进行查看(5.2)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8080:8080 --name tomcat-8080 -v /opt/volumn_exam:/usr/local/tomcat/webapps tomcat</span><br></pre></td></tr></table></figure><h2 id="案例-2"><a href="#案例-2" class="headerlink" title="案例 2"></a>案例 2</h2><p><strong>xuxiaomo-nginx公共的文件夹资源静态资源</strong></p><p>创建数据卷</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker volume create vol-xuxiaomo-nginx //xuxiaomo-nginx公共的文件夹资源静态资源</span><br></pre></td></tr></table></figure><p>查看所有的 数据卷</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker volume <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p>将xuxiaomo-nginx文件夹 放入宿主机目录下。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> xuxiaomo-nginx /usr/local/docker/ //复制到 宿主机 /usr/local/docker 下</span><br></pre></td></tr></table></figure><p>分别根据镜像tomcat 启动两个容器，并挂上数据卷。查看效果：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> -d --name tomcat-8080 -p 8080:8080</span><br><span class="line">-v /usr/local/docker/xuxiaomo-nginx/:/usr/local/tomcat/webapps/xuxiaomo-nginx tomcat</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> -d --name tomcat-8081 -p 8081:8080 -v</span><br><span class="line">/usr/local/docker/xuxiaomo-nginx/:/usr/local/tomcat/webapps/xuxiaomo-nginx tomcat</span><br></pre></td></tr></table></figure><blockquote><p>-v &#x2F;usr&#x2F;local&#x2F;docker&#x2F;xuxiaomo-nginx&#x2F;:&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps&#x2F;xuxiaomo-nginx tomcat<br>-v 数据卷参数。<br>将宿主机 &#x2F;usr&#x2F;local&#x2F;docker&#x2F;xuxiaomo-nginx&#x2F; 文件内的内容信息<br>挂载在容器 &#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps&#x2F;xuxiaomo-nginx 目录下</p></blockquote><h1 id="Centos防火墙端口"><a href="#Centos防火墙端口" class="headerlink" title="Centos防火墙端口"></a>Centos防火墙端口</h1><p>开放 8080 端口（如下命令只针对Centos7以上）</p><p>查看已经开放的端口：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --list-ports</span><br></pre></td></tr></table></figure><p>开启端口:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=8080/tcp --permanent</span><br></pre></td></tr></table></figure><p>关闭端口：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --permanent --zone=public --remove-port=8080/tcp</span><br></pre></td></tr></table></figure><p>开启防火墙：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start firewalld</span><br></pre></td></tr></table></figure><p>重启防火墙:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --reload <span class="comment">#重启</span></span><br><span class="line">firewall systemctl stop firewalld.service <span class="comment">#停止</span></span><br><span class="line">firewall systemctl <span class="built_in">disable</span> firewalld.service <span class="comment">#禁止firewall开机启动</span></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="https://angelxyj.github.io">许小墨</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接:</span> <span class="post-copyright-info"><a href="https://angelxyj.github.io/posts/deffaa61.html">https://angelxyj.github.io/posts/deffaa61.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://angelxyj.github.io" target="_blank">许小墨のBlog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/%E8%BF%90%E7%BB%B4/">运维</a><a class="post-meta__tags" href="/%E6%A0%87%E7%AD%BE/docker/">docker</a></div><div class="post_share"><div class="social-share" data-image="/img/timg.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>感谢支持！</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat.png" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/7d579b91.html" title="08-Java常用API"><img class="cover" src="/img/4.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">08-Java常用API</div></div></a></div><div class="next-post pull-right"><a href="/posts/67afbacb.html" title="docker2-安装"><img class="cover" src="/img/13.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">docker2-安装</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/84e4a128.html" title="Docker 容器化解决方案"><img class="cover" src="/img/18.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-17</div><div class="title">Docker 容器化解决方案</div></div></a></div><div><a href="/posts/67afbacb.html" title="docker2-安装"><img class="cover" src="/img/13.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-16</div><div class="title">docker2-安装</div></div></a></div><div><a href="/posts/3d7899de.html" title="docker3-高级-Dockerfile"><img class="cover" src="/img/17.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-16</div><div class="title">docker3-高级-Dockerfile</div></div></a></div><div><a href="/posts/9a3440fa.html" title="docker4-仓库"><img class="cover" src="/img/timg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-16</div><div class="title">docker4-仓库</div></div></a></div><div><a href="/posts/e2abdbc7.html" title="docker5-idea整合 -CA认证"><img class="cover" src="/img/17.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-16</div><div class="title">docker5-idea整合 -CA认证</div></div></a></div><div><a href="/posts/ccf7dfff.html" title="docker6-图像化工具"><img class="cover" src="/img/6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-16</div><div class="title">docker6-图像化工具</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div><div class="comment-switch"><span class="first-comment">Waline</span><span id="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/touxiang.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">许小墨</div><div class="author-info__description">全栈攻城狮的基本素养</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">198</div></a><a href="/%E6%A0%87%E7%AD%BE/"><div class="headline">标签</div><div class="length-num">183</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">42</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Angelxyj"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Angelxyj" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1440023258@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81Docker%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">一、Docker介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">1.1.</span> <span class="toc-text">问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFdocker"><span class="toc-number">1.2.</span> <span class="toc-text">什么是docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8docker"><span class="toc-number">1.3.</span> <span class="toc-text">为什么用docker</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E7%AE%80%E5%8C%96%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">1、简化程序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E9%81%BF%E5%85%8D%E9%80%89%E6%8B%A9%E6%81%90%E6%83%A7%E7%97%87"><span class="toc-number">1.3.0.2.</span> <span class="toc-text">2、避免选择恐惧症</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E8%8A%82%E7%9C%81%E5%BC%80%E6%94%AF"><span class="toc-number">1.3.0.3.</span> <span class="toc-text">3、节省开支</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98%E5%92%8C%E9%83%A8%E7%BD%B2"><span class="toc-number">1.3.0.4.</span> <span class="toc-text">4、持续交付和部署</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81%E6%9B%B4%E8%BD%BB%E6%9D%BE%E7%9A%84%E8%BF%81%E7%A7%BB"><span class="toc-number">1.3.0.5.</span> <span class="toc-text">5、更轻松的迁移</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.4.</span> <span class="toc-text">Docker的应用场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E5%92%8C%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%BB%E7%BB%93"><span class="toc-number">1.5.</span> <span class="toc-text">Docker和虚拟机总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E6%80%BB%E7%BB%93"><span class="toc-number">1.6.</span> <span class="toc-text">Docker总结</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81-Docker%E6%9E%B6%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">二、 Docker架构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">2.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.2.</span> <span class="toc-text">Docker 基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-%E5%BC%95%E6%93%8E"><span class="toc-number">2.3.</span> <span class="toc-text">Docker 引擎</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-%E6%9E%B6%E6%9E%84"><span class="toc-number">2.4.</span> <span class="toc-text">Docker 架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-%E9%95%9C%E5%83%8F"><span class="toc-number">2.4.1.</span> <span class="toc-text">Docker 镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%B1%82%E5%AD%98%E5%82%A8"><span class="toc-number">2.4.1.1.</span> <span class="toc-text">分层存储</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-%E5%AE%B9%E5%99%A8"><span class="toc-number">2.4.2.</span> <span class="toc-text">Docker 容器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81Docker-%E4%BB%93%E5%BA%93"><span class="toc-number">3.</span> <span class="toc-text">三、Docker 仓库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AC%E6%9C%89-Docker-Registry"><span class="toc-number">3.1.</span> <span class="toc-text">公有 Docker Registry</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%81%E6%9C%89-Docker-Registry"><span class="toc-number">3.2.</span> <span class="toc-text">私有 Docker Registry</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81Docker%E5%AE%89%E8%A3%85"><span class="toc-number">4.</span> <span class="toc-text">四、Docker安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E6%8F%90%E4%BE%9B%E7%9A%84%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B"><span class="toc-number">4.0.0.1.</span> <span class="toc-text">官方提供的安装教程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CentOS%E5%AE%89%E8%A3%85%E8%A6%81%E6%B1%82"><span class="toc-number">4.1.</span> <span class="toc-text">CentOS安装要求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">4.2.</span> <span class="toc-text">安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%A0%A1%E9%AA%8C%E7%89%88%E6%9C%AC"><span class="toc-number">4.2.0.1.</span> <span class="toc-text">1 校验版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%A7%BB%E9%99%A4%E6%97%A7%E7%9A%84%E7%89%88%E6%9C%AC"><span class="toc-number">4.2.0.2.</span> <span class="toc-text">2 移除旧的版本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85%E4%B8%80%E4%BA%9B%E5%BF%85%E8%A6%81%E7%9A%84%E7%B3%BB%E7%BB%9F%E5%B7%A5%E5%85%B7"><span class="toc-number">4.2.0.3.</span> <span class="toc-text">3 安装一些必要的系统工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%B7%BB%E5%8A%A0%E8%BD%AF%E4%BB%B6%E6%BA%90%E4%BF%A1%E6%81%AF"><span class="toc-number">4.2.0.4.</span> <span class="toc-text">4 添加软件源信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%9B%B4%E6%96%B0-yum-%E7%BC%93%E5%AD%98"><span class="toc-number">4.2.0.5.</span> <span class="toc-text">5 更新 yum 缓存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%AE%89%E8%A3%85-Docker-CE"><span class="toc-number">4.2.0.6.</span> <span class="toc-text">6 安装 Docker-CE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E5%90%AF%E5%8A%A8-Docker-%E5%90%8E%E5%8F%B0%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.2.0.7.</span> <span class="toc-text">7 启动 Docker 后台服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E9%87%8D%E5%90%AF-Docker%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.2.0.8.</span> <span class="toc-text">8 重启 Docker服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F%E5%90%8E%E5%8F%AF%E9%80%9A%E8%BF%87%E6%9F%A5%E7%9C%8B"><span class="toc-number">4.2.0.9.</span> <span class="toc-text">9 安装成功后可通过查看</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E6%B5%8B%E8%AF%95"><span class="toc-number">4.2.0.10.</span> <span class="toc-text">10 测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD"><span class="toc-number">4.3.</span> <span class="toc-text">卸载</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81Docker-%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">五、Docker 镜像加速器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E5%AE%98%E6%96%B9%E5%8A%A0%E9%80%9F%E5%99%A8"><span class="toc-number">5.1.</span> <span class="toc-text">Docker官方加速器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A0%E9%80%9F%E5%99%A8"><span class="toc-number">5.2.</span> <span class="toc-text">阿里云加速器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%8A%A0%E9%80%9F%E5%99%A8%E6%98%AF%E5%90%A6%E7%94%9F%E6%95%88"><span class="toc-number">5.3.</span> <span class="toc-text">检查加速器是否生效</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-number">5.4.</span> <span class="toc-text">测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81Docker%E9%95%9C%E5%83%8F"><span class="toc-number">6.</span> <span class="toc-text">六、Docker镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-%E8%8E%B7%E5%8F%96%E9%95%9C%E5%83%8F"><span class="toc-number">6.1.</span> <span class="toc-text">Docker 获取镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E9%95%9C%E5%83%8F"><span class="toc-number">6.1.1.</span> <span class="toc-text">查找镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%95%9C%E5%83%8F"><span class="toc-number">6.1.2.</span> <span class="toc-text">获取镜像</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-%E5%88%97%E5%87%BA%E9%95%9C%E5%83%8F"><span class="toc-number">6.2.</span> <span class="toc-text">Docker 列出镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%82%AC%E9%95%9C%E5%83%8F"><span class="toc-number">6.2.1.</span> <span class="toc-text">虚悬镜像</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-%E5%88%A0%E9%99%A4%E6%9C%AC%E5%9C%B0%E9%95%9C%E5%83%8F"><span class="toc-number">6.3.</span> <span class="toc-text">Docker 删除本地镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E5%85%B6%E5%AE%83%E8%BE%85%E5%8A%A9%E5%91%BD%E4%BB%A4"><span class="toc-number">6.4.</span> <span class="toc-text">Docker其它辅助命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E4%BF%9D%E5%AD%98%E9%95%9C%E5%83%8F"><span class="toc-number">6.5.</span> <span class="toc-text">Docker保存镜像</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81Docker-%E5%AE%B9%E5%99%A8"><span class="toc-number">7.</span> <span class="toc-text">七、Docker 容器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E7%8A%B6%E6%80%81"><span class="toc-number">7.1.</span> <span class="toc-text">1 查看容器状态</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Docker-%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"><span class="toc-number">7.2.</span> <span class="toc-text">2 Docker 启动容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-1"><span class="toc-number">7.2.1.</span> <span class="toc-text">练习 1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%9F%A5%E7%9C%8B%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E5%AE%B9%E5%99%A8"><span class="toc-number">7.3.</span> <span class="toc-text">3 查看正在运行的容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E5%AE%B9%E5%99%A8"><span class="toc-number">7.4.</span> <span class="toc-text">4 查看所有容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%81%9C%E6%AD%A2%E5%AE%B9%E5%99%A8"><span class="toc-number">7.5.</span> <span class="toc-text">5 停止容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%90%AF%E5%8A%A8%E5%B7%B2%E7%BB%88%E6%AD%A2%E5%AE%B9%E5%99%A8"><span class="toc-number">7.6.</span> <span class="toc-text">6 启动已终止容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E9%87%8D%E5%90%AF%E5%B7%B2%E5%85%B3%E9%97%AD%E5%AE%B9%E5%99%A8"><span class="toc-number">7.7.</span> <span class="toc-text">7 重启已关闭容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%85%B3%E9%97%AD%E5%92%8C%E5%88%A0%E9%99%A4%E5%AE%B9%E5%99%A8"><span class="toc-number">7.8.</span> <span class="toc-text">8 关闭和删除容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0-2"><span class="toc-number">7.8.1.</span> <span class="toc-text">练习 2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-Docker-%E5%AE%88%E6%8A%A4%E6%80%81%E8%BF%90%E8%A1%8C"><span class="toc-number">7.9.</span> <span class="toc-text">9 Docker 守护态运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-Docker-%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8"><span class="toc-number">7.10.</span> <span class="toc-text">10 Docker 进入容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">7.10.1.</span> <span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E5%9C%A8%E5%AE%BF%E4%B8%BB%E6%9C%BA%E5%92%8C%E5%AE%B9%E5%99%A8%E4%B9%8B%E9%97%B4%E4%BA%A4%E6%8D%A2%E6%96%87%E4%BB%B6"><span class="toc-number">7.11.</span> <span class="toc-text">11 在宿主机和容器之间交换文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81Docker-%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97"><span class="toc-number">8.</span> <span class="toc-text">八、Docker 查看日志</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E6%A1%88%E4%BE%8B"><span class="toc-number">9.</span> <span class="toc-text">九、案例</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E3%80%81Docker-%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-number">10.</span> <span class="toc-text">十、Docker 数据卷</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-number">10.1.</span> <span class="toc-text">什么是数据卷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%95%B0%E6%8D%AE%E5%8D%B7%EF%BC%9F"><span class="toc-number">10.2.</span> <span class="toc-text">为什么需要数据卷？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%BA%94%E7%94%A8"><span class="toc-number">10.3.</span> <span class="toc-text">数据卷应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-1"><span class="toc-number">10.4.</span> <span class="toc-text">案例 1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E6%96%B9%E5%BC%8F"><span class="toc-number">10.4.0.1.</span> <span class="toc-text">数据卷方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E6%96%B9%E5%BC%8F"><span class="toc-number">10.4.0.2.</span> <span class="toc-text">路径方式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B-2"><span class="toc-number">10.5.</span> <span class="toc-text">案例 2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Centos%E9%98%B2%E7%81%AB%E5%A2%99%E7%AB%AF%E5%8F%A3"><span class="toc-number">11.</span> <span class="toc-text">Centos防火墙端口</span></a></li></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/3d9e6dac.html" title="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia"><img src="/img/14.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia"></a><div class="content"><a class="title" href="/posts/3d9e6dac.html" title="004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia">004_鸿蒙如何实现自定义 Canvas？底层如何进行 Ui 的渲染 flutter skia</a><time datetime="2024-06-12T21:53:42.000Z" title="发表于 2024-06-12 21:53:42">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4f9a63a7.html" title="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？"><img src="/img/18.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？"></a><div class="content"><a class="title" href="/posts/4f9a63a7.html" title="003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？">003_了解过鸿蒙的 Napi 吗？如果我需要编译三方库如何链接？</a><time datetime="2024-06-12T21:45:44.000Z" title="发表于 2024-06-12 21:45:44">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dda8b3d8.html" title="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分"><img src="/img/jujingyi.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分"></a><div class="content"><a class="title" href="/posts/dda8b3d8.html" title="002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分">002_音视频开发，鸿蒙实现播放器的 Ui 部分+底层部分</a><time datetime="2024-06-12T21:35:34.000Z" title="发表于 2024-06-12 21:35:34">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1faddbca.html" title="001_组件化开发原理，鸿蒙组件化实现思路"><img src="/img/1.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="001_组件化开发原理，鸿蒙组件化实现思路"></a><div class="content"><a class="title" href="/posts/1faddbca.html" title="001_组件化开发原理，鸿蒙组件化实现思路">001_组件化开发原理，鸿蒙组件化实现思路</a><time datetime="2024-06-12T21:28:54.000Z" title="发表于 2024-06-12 21:28:54">2024-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/6d6b0b0f.html" title="019_Gauge"><img src="/img/9.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="019_Gauge"></a><div class="content"><a class="title" href="/posts/6d6b0b0f.html" title="019_Gauge">019_Gauge</a><time datetime="2024-06-12T21:24:14.000Z" title="发表于 2024-06-12 21:24:14">2024-06-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2024 By 许小墨</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_60306931/category_12251529.html">blog</a>!<br><span>备案号：xxxxxx</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach(((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,a="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent,i=mermaid.render(r,a);var m;"string"==typeof i?(m=i,d.insertAdjacentHTML("afterend",m)):i.then((({svg:e})=>{d.insertAdjacentHTML("afterend",e)}))}))},n=()=>{window.loadMermaid?t():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(t)};btf.addGlobalFn("themeChange",t,"mermaid"),window.pjax?n():document.addEventListener("DOMContentLoaded",n)})()</script><script>(()=>{let n=window.walineFn||null;const e=n=>{const e=n(Object.assign({el:"#waline-wrap",serverURL:"https://xuxiaomo-waline-i53b26l6n-xuxiaomo-xyj.vercel.app/",pageview:!1,dark:'html[data-theme="dark"]',path:window.location.pathname,comment:!1},null));btf.addGlobalFn("pjax",(()=>{e.destroy()}),"destroyWaline")},t=async()=>{if(n)e(n);else{await getCSS("https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css");const{init:t}=await import("https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js");n=t||Waline.init,e(n),window.walineFn=n}};btf.loadComment(document.getElementById("waline-wrap"),t)})()</script><script>(()=>{const t=function(){this.page.url="https://angelxyj.github.io/posts/deffaa61.html",this.page.identifier="/posts/deffaa61.html",this.page.title="docker1-基础"},e=()=>{window.DISQUS&&window.DISQUS.reset({reload:!0,config:t})};btf.addGlobalFn("themeChange",e,"disqus");const i=()=>{if(window.DISQUS)e();else{const t=document.createElement("script");t.src="https://xuxiaomo.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),document.head.appendChild(t)}};window.loadOtherComment=i})()</script></div><script>window.addEventListener("load",(()=>{const e=e=>{let t="";if(e.length)for(let a=0;a<e.length;a++){t+="<div class='aside-list-item'>";{const n="src";t+=`<a href='${e[a].url}' class='thumbnail'><img ${n}='${e[a].avatar}' alt='${e[a].nick}'></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[a].url}' title='${e[a].content}'>${e[a].content}</a>\n        <div class='name'><span>${e[a].nick} / </span><time datetime="${e[a].date}">${btf.diffDate(e[a].date,!0)}</time></div>\n        </div></div>`}else t+="没有评论";let a=document.querySelector("#card-newest-comments .aside-list");a&&(a.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(a)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("waline-newest-comments");t?e(JSON.parse(t)):(async()=>{try{const t=await fetch("https://xuxiaomo-waline-i53b26l6n-xuxiaomo-xyj.vercel.app/api/comment?type=recent&count=6",{method:"GET"}),a=(await t.json()).data.map((e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[图片]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[链接]")).replace(/<pre><code>.*?<\/pre>/gi,"[代码]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.objectId,date:e.time||e.insertedAt};var t}));saveToLocal.set("waline-newest-comments",JSON.stringify(a),10/1440),e(a)}catch(e){console.error(e),document.querySelector("#card-newest-comments .aside-list").textContent="无法获取评论，请确认相关配置是否正确"}})()}};t(),document.addEventListener("pjax:complete",t)}))</script><div class="aplayer no-destroy" data-id="8760365089" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-autoplay="false"></div><script defer src="/live2d-widget/autoload.js"></script><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="true" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script src="//code.tidio.co/fpezrlnx14lzqj1yzhyigw0j3rkhtyzv.js" async></script><script>(()=>{{let i=!1;const d=()=>{window.tidioChatApi.hide(),i=!1},o=()=>{window.tidioChatApi.open(),window.tidioChatApi.show(),i=!0},t=()=>{window.tidioChatApi.hide(),window.tidioChatApi.on("close",d)};window.tidioChatApi?window.tidioChatApi.on("ready",t):document.addEventListener("tidioChat-ready",t),window.chatBtnFn=()=>{window.tidioChatApi&&(i?d():o())}}})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(btf.removeGlobalFnEvent("pjax"),btf.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div><div class="app-refresh" id="app-refresh" style="position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease"><div class="app-refresh-wrap" style="display:flex;color:#fff;height:100%;align-items:center;justify-content:center"><label>✨ 糖果屋上新啦！ 👉</label><a href="javascript:void(0)" onclick="location.reload()"><span style="color:#fff;text-decoration:underline;cursor:pointer">🍭查看新品🍬</span></a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"✨ 糖果屋上新啦！ 👉",backgroundColor:t,duration:5e5,pos:e,actionText:"🍭查看新品🍬",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script></div></body></html>